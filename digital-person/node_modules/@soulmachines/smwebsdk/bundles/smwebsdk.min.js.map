{"version":3,"file":"smwebsdk.min.js","mappings":"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","sources":["webpack://@soulmachines/smwebsdk/webpack/universalModuleDefinition","webpack://@soulmachines/smwebsdk/webpack/bootstrap","webpack://@soulmachines/smwebsdk/webpack/runtime/define property getters","webpack://@soulmachines/smwebsdk/webpack/runtime/global","webpack://@soulmachines/smwebsdk/webpack/runtime/hasOwnProperty shorthand","webpack://@soulmachines/smwebsdk/webpack/runtime/make namespace object","webpack://@soulmachines/smwebsdk/./src/SmEvent.ts","webpack://@soulmachines/smwebsdk/./src/Persona.ts","webpack://@soulmachines/smwebsdk/./node_modules/tslib/tslib.es6.mjs","webpack://@soulmachines/smwebsdk/./src/Deferred.ts","webpack://@soulmachines/smwebsdk/./src/Features.ts","webpack://@soulmachines/smwebsdk/./src/utils/Logger.ts","webpack://@soulmachines/smwebsdk/./src/utils/make-error.ts","webpack://@soulmachines/smwebsdk/./src/LocalSession.ts","webpack://@soulmachines/smwebsdk/./src/websocket-message/scene/response-body/SpeechMarker.ts","webpack://@soulmachines/smwebsdk/./src/websocket-message/scene/response-body/StateResponseBody.ts","webpack://@soulmachines/smwebsdk/./src/websocket-message/scene/SceneResponseError.ts","webpack://@soulmachines/smwebsdk/./src/types/scene.ts","webpack://@soulmachines/smwebsdk/./src/enums/ConnectionStateTypes.ts","webpack://@soulmachines/smwebsdk/./src/dedicated-workers/chroma-key.worker.ts","webpack://@soulmachines/smwebsdk/./src/Session.ts","webpack://@soulmachines/smwebsdk/./src/websocket-message/enums/WebsocketCategory.ts","webpack://@soulmachines/smwebsdk/./src/websocket-message/enums/WebsocketKind.ts","webpack://@soulmachines/smwebsdk/./src/websocket-message/enums/SpeechState.ts","webpack://@soulmachines/smwebsdk/./src/WebSocketSession.ts","webpack://@soulmachines/smwebsdk/./node_modules/@juggle/resize-observer/lib/utils/resizeObservers.js","webpack://@soulmachines/smwebsdk/./node_modules/@juggle/resize-observer/lib/ResizeObserverBoxOptions.js","webpack://@soulmachines/smwebsdk/./node_modules/@juggle/resize-observer/lib/algorithms/deliverResizeLoopError.js","webpack://@soulmachines/smwebsdk/./node_modules/@juggle/resize-observer/lib/utils/freeze.js","webpack://@soulmachines/smwebsdk/./node_modules/@juggle/resize-observer/lib/utils/queueMicroTask.js","webpack://@soulmachines/smwebsdk/./node_modules/@juggle/resize-observer/lib/ResizeObserverSize.js","webpack://@soulmachines/smwebsdk/./node_modules/@juggle/resize-observer/lib/DOMRectReadOnly.js","webpack://@soulmachines/smwebsdk/./node_modules/@juggle/resize-observer/lib/utils/element.js","webpack://@soulmachines/smwebsdk/./node_modules/@juggle/resize-observer/lib/utils/global.js","webpack://@soulmachines/smwebsdk/./node_modules/@juggle/resize-observer/lib/algorithms/calculateBoxSize.js","webpack://@soulmachines/smwebsdk/./node_modules/@juggle/resize-observer/lib/ResizeObserverEntry.js","webpack://@soulmachines/smwebsdk/./node_modules/@juggle/resize-observer/lib/algorithms/calculateDepthForNode.js","webpack://@soulmachines/smwebsdk/./node_modules/@juggle/resize-observer/lib/algorithms/broadcastActiveObservations.js","webpack://@soulmachines/smwebsdk/./node_modules/@juggle/resize-observer/lib/algorithms/gatherActiveObservationsAtDepth.js","webpack://@soulmachines/smwebsdk/./node_modules/@juggle/resize-observer/lib/utils/process.js","webpack://@soulmachines/smwebsdk/./node_modules/@juggle/resize-observer/lib/algorithms/hasActiveObservations.js","webpack://@soulmachines/smwebsdk/./node_modules/@juggle/resize-observer/lib/algorithms/hasSkippedObservations.js","webpack://@soulmachines/smwebsdk/./node_modules/@juggle/resize-observer/lib/utils/scheduler.js","webpack://@soulmachines/smwebsdk/./node_modules/@juggle/resize-observer/lib/utils/queueResizeObserver.js","webpack://@soulmachines/smwebsdk/./node_modules/@juggle/resize-observer/lib/ResizeObservation.js","webpack://@soulmachines/smwebsdk/./node_modules/@juggle/resize-observer/lib/ResizeObserverDetail.js","webpack://@soulmachines/smwebsdk/./node_modules/@juggle/resize-observer/lib/ResizeObserverController.js","webpack://@soulmachines/smwebsdk/./node_modules/@juggle/resize-observer/lib/ResizeObserver.js","webpack://@soulmachines/smwebsdk/./src/utils/allImagesLoaded.ts","webpack://@soulmachines/smwebsdk/./src/utils/debounce.ts","webpack://@soulmachines/smwebsdk/./src/ContentAwareness.ts","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/api/build/esm/platform/browser/globalThis.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/api/build/esm/version.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/api/build/esm/internal/semver.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/api/build/esm/internal/global-utils.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/api/build/esm/diag/ComponentLogger.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/api/build/esm/diag/types.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/api/build/esm/api/diag.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/api/build/esm/diag/internal/logLevelLogger.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/api/build/esm/baggage/internal/baggage-impl.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/api/build/esm/baggage/internal/symbol.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/api/build/esm/baggage/utils.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/api/build/esm/diag/consoleLogger.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/api/build/esm/propagation/TextMapPropagator.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/api/build/esm/context/context.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/api/build/esm/trace/trace_flags.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/api/build/esm/context/NoopContextManager.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/api/build/esm/api/context.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/api/build/esm/trace/invalid-span-constants.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/api/build/esm/trace/NonRecordingSpan.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/api/build/esm/trace/context-utils.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/api/build/esm/trace/spancontext-utils.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/api/build/esm/trace/NoopTracer.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/api/build/esm/trace/ProxyTracer.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/api/build/esm/trace/SamplingResult.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/api/build/esm/trace/span_kind.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/api/build/esm/trace/status.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/api/build/esm/trace/ProxyTracerProvider.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/api/build/esm/trace/NoopTracerProvider.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/api/build/esm/trace/internal/tracestate-validators.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/api/build/esm/trace/internal/tracestate-impl.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/api/build/esm/api/trace.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/api/build/esm/propagation/NoopTextMapPropagator.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/api/build/esm/baggage/context-helpers.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/api/build/esm/api/propagation.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/api/build/esm/index.js","webpack://@soulmachines/smwebsdk/./src/utils/convertToUserMedia.ts","webpack://@soulmachines/smwebsdk/./src/utils/utils.ts","webpack://@soulmachines/smwebsdk/./src/enums/ConversationStateTypes.ts","webpack://@soulmachines/smwebsdk/./src/ConversationState.ts","webpack://@soulmachines/smwebsdk/./src/ContentCardFormatter.ts","webpack://@soulmachines/smwebsdk/./src/Conversation.ts","webpack://@soulmachines/smwebsdk/./src/MetadataSender.ts","webpack://@soulmachines/smwebsdk/./src/ConnectionState.ts","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/resources/node_modules/@opentelemetry/semantic-conventions/build/esm/resource/SemanticResourceAttributes.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/core/build/esm/trace/suppress-tracing.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/core/build/esm/baggage/constants.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/core/build/esm/baggage/utils.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/core/build/esm/baggage/propagation/W3CBaggagePropagator.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/core/build/esm/common/anchored-clock.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/core/build/esm/common/global-error-handler.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/core/build/esm/utils/sampling.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/core/build/esm/common/logging-error-handler.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/core/build/esm/platform/browser/globalThis.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/core/build/esm/utils/environment.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/core/build/esm/platform/browser/environment.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/core/build/esm/platform/browser/hex-to-base64.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/core/build/esm/platform/browser/RandomIdGenerator.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/core/build/esm/platform/browser/performance.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/core/build/esm/platform/browser/sdk-info.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/core/node_modules/@opentelemetry/semantic-conventions/build/esm/resource/SemanticResourceAttributes.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/core/build/esm/version.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/core/build/esm/common/time.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/core/build/esm/ExportResult.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/core/build/esm/propagation/composite.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/core/build/esm/internal/validators.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/core/build/esm/trace/TraceState.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/core/build/esm/trace/W3CTraceContextPropagator.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/core/build/esm/trace/rpc-metadata.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/core/build/esm/trace/sampler/AlwaysOffSampler.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/core/build/esm/trace/sampler/AlwaysOnSampler.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/core/build/esm/utils/lodash.merge.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/core/build/esm/trace/sampler/ParentBasedSampler.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/core/build/esm/trace/sampler/TraceIdRatioBasedSampler.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/core/build/esm/utils/promise.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/core/build/esm/utils/callback.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/resources/build/esm/platform/browser/detect-resources.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-trace-base/node_modules/@opentelemetry/core/build/esm/utils/sampling.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/resources/build/esm/detectors/NoopDetector.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/resources/build/esm/Resource.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/resources/build/esm/platform/browser/default-service-name.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/resources/build/esm/detectors/BrowserDetector.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/resources/build/esm/detectors/EnvDetector.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/resources/build/esm/detectors/ProcessDetector.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/semantic-conventions/build/esm/resource/SemanticResourceAttributes.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-trace-base/node_modules/@opentelemetry/core/build/esm/platform/browser/globalThis.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-trace-base/node_modules/@opentelemetry/core/build/esm/utils/environment.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-trace-base/node_modules/@opentelemetry/core/build/esm/platform/browser/environment.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-trace-base/node_modules/@opentelemetry/core/build/esm/utils/promise.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-trace-base/node_modules/@opentelemetry/core/build/esm/ExportResult.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-trace-base/node_modules/@opentelemetry/core/build/esm/utils/callback.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-trace-base/node_modules/@opentelemetry/core/build/esm/trace/suppress-tracing.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-trace-base/node_modules/@opentelemetry/core/build/esm/common/global-error-handler.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-trace-base/node_modules/@opentelemetry/core/build/esm/common/logging-error-handler.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-trace-base/build/esm/export/BatchSpanProcessorBase.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-trace-base/build/esm/platform/browser/export/BatchSpanProcessor.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-trace-base/node_modules/@opentelemetry/core/build/esm/utils/lodash.merge.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-trace-base/node_modules/@opentelemetry/core/build/esm/utils/merge.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-trace-base/node_modules/@opentelemetry/core/build/esm/propagation/composite.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-trace-base/node_modules/@opentelemetry/core/build/esm/internal/validators.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-trace-base/node_modules/@opentelemetry/core/build/esm/trace/TraceState.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-trace-base/node_modules/@opentelemetry/core/build/esm/trace/W3CTraceContextPropagator.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-trace-base/node_modules/@opentelemetry/core/build/esm/baggage/constants.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-trace-base/node_modules/@opentelemetry/core/build/esm/baggage/utils.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-trace-base/node_modules/@opentelemetry/core/build/esm/baggage/propagation/W3CBaggagePropagator.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-trace-base/node_modules/@opentelemetry/core/build/esm/platform/browser/sdk-info.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-trace-base/node_modules/@opentelemetry/core/build/esm/version.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-trace-base/node_modules/@opentelemetry/resources/build/esm/Resource.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-trace-base/node_modules/@opentelemetry/resources/build/esm/platform/browser/default-service-name.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-trace-base/node_modules/@opentelemetry/core/build/esm/common/attributes.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-trace-base/node_modules/@opentelemetry/core/build/esm/platform/browser/performance.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-trace-base/node_modules/@opentelemetry/core/build/esm/common/time.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/semantic-conventions/build/esm/trace/SemanticAttributes.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-trace-base/build/esm/Sampler.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-trace-base/build/esm/Span.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-trace-base/build/esm/enums.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-trace-base/build/esm/sampler/AlwaysOffSampler.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-trace-base/build/esm/sampler/AlwaysOnSampler.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-trace-base/build/esm/sampler/ParentBasedSampler.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-trace-base/build/esm/sampler/TraceIdRatioBasedSampler.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-trace-base/build/esm/config.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-trace-base/build/esm/utility.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-trace-base/build/esm/platform/browser/RandomIdGenerator.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-trace-base/build/esm/Tracer.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-trace-base/build/esm/BasicTracerProvider.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-trace-base/build/esm/MultiSpanProcessor.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-trace-base/build/esm/export/NoopSpanProcessor.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-trace-web/build/esm/StackContextManager.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-trace-web/build/esm/WebTracerProvider.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/otlp-exporter-base/build/esm/util.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/otlp-exporter-base/build/esm/OTLPExporterBase.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/otlp-exporter-base/build/esm/types.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/otlp-exporter-base/build/esm/platform/browser/util.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/otlp-exporter-base/build/esm/platform/browser/OTLPExporterBrowserBase.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/otlp-transformer/build/esm/trace/types.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/otlp-transformer/build/esm/common/internal.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/otlp-transformer/build/esm/trace/internal.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/otlp-transformer/build/esm/trace/index.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/api-metrics/build/esm/NoopMeter.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/api-metrics/build/esm/types/Metric.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/api-metrics/build/esm/NoopMeterProvider.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/api-metrics/build/esm/platform/browser/globalThis.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/api-metrics/build/esm/api/global-utils.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-metrics/build/esm/export/AggregationTemporality.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-metrics/build/esm/export/MetricData.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/api-metrics/build/esm/api/metrics.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/api-metrics/build/esm/index.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-metrics/build/esm/utils.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-metrics/build/esm/aggregator/types.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-metrics/build/esm/aggregator/Drop.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-metrics/build/esm/InstrumentDescriptor.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-metrics/build/esm/aggregator/Histogram.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-metrics/build/esm/aggregator/LastValue.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-metrics/build/esm/aggregator/Sum.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-metrics/build/esm/view/Aggregation.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-metrics/build/esm/export/AggregationSelector.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-metrics/build/esm/export/MetricReader.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-metrics/build/esm/export/PeriodicExportingMetricReader.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-metrics/build/esm/export/ConsoleMetricExporter.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-metrics/build/esm/export/InMemoryMetricExporter.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-metrics/build/esm/view/ViewRegistry.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-metrics/build/esm/Instruments.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-metrics/build/esm/Meter.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-metrics/build/esm/state/MetricStorage.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-metrics/build/esm/state/HashMap.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-metrics/build/esm/state/DeltaMetricProcessor.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-metrics/build/esm/state/TemporalMetricProcessor.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-metrics/build/esm/state/AsyncMetricStorage.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-metrics/build/esm/view/RegistrationConflicts.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-metrics/build/esm/state/MetricStorageRegistry.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-metrics/build/esm/state/MultiWritableMetricStorage.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-metrics/build/esm/ObservableResult.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-metrics/build/esm/state/ObservableRegistry.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-metrics/build/esm/state/SyncMetricStorage.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-metrics/build/esm/view/AttributesProcessor.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-metrics/build/esm/state/MeterSharedState.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-metrics/build/esm/state/MeterProviderSharedState.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-metrics/build/esm/state/MetricCollector.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-metrics/build/esm/MeterProvider.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-metrics/build/esm/view/Predicate.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-metrics/build/esm/view/InstrumentSelector.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/sdk-metrics/build/esm/view/MeterSelector.js","webpack://@soulmachines/smwebsdk/./node_modules/@opentelemetry/exporter-trace-otlp-http/build/esm/platform/browser/OTLPTraceExporter.js","webpack://@soulmachines/smwebsdk/./src/SmTelemetry.ts","webpack://@soulmachines/smwebsdk/./src/env-vars.ts","webpack://@soulmachines/smwebsdk/./src/Scene.ts","webpack://@soulmachines/smwebsdk/./src/SmWebSdk.ts"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(self, () => {\nreturn ","// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/**\n * @module smwebsdk\n */\n\n/*\n * Copyright 2017-2020 Soul Machines Ltd. All Rights Reserved.\n */\n\n/**\n * An event which can have a set of listeners registered against it using addListener().\n * @public\n */\nexport class SmEvent {\n  // eslint-disable-next-line @typescript-eslint/ban-types\n  private _callbacks: Function[] = [];\n\n  /**\n   * Register a new listener for this event.\n   * @param callback - Function called each time the event is triggered.\n   */\n  // eslint-disable-next-line @typescript-eslint/ban-types\n  public addListener(callback: Function): void {\n    this._callbacks.push(callback);\n  }\n\n  /**\n   * Deregister a existing listener for this event.\n   * @param callback - Previously registered function to be removed. It is a safe no-op to pass\n   * a callback which was never registered against this event.\n   */\n  // eslint-disable-next-line @typescript-eslint/ban-types\n  public removeListener(callback: Function): void {\n    const callbackIndex = this._callbacks.indexOf(callback);\n    if (callbackIndex > -1) {\n      this._callbacks.splice(callbackIndex, 1);\n    }\n  }\n\n  /**\n   * Trigger the event, calling each registered listener, and passing on any parameters.\n   */\n  public call(...args: any[]) {\n    this._callbacks.forEach((callback) => {\n      callback.apply(callback, args);\n    }, this);\n  }\n}\n","/**\n * @module smwebsdk\n */\n\n/*\n * Copyright 2017-2020 Soul Machines Ltd. All Rights Reserved.\n */\n\nimport { Scene } from './Scene';\nimport { SmEvent } from './SmEvent';\nimport {\n  ConversationSetVariablesRequestBody,\n  StartSpeakingOptionalArgs,\n  StartSpeakingRequestBody,\n  PersonaRequestBody,\n  ConversationSendRequestBody,\n  AnimateToNamedCameraRequestBody,\n  PlayAnimationRequestBody,\n  StopBlProfilingRequestBody,\n  GetModelFilterSearchResultRequestBody,\n  GetModelChildrenRequestBody,\n  GetModelVariableFilterSearchResultRequestBody,\n  GetModelVariablesListRequestBody,\n  GetVariablesListRequestBody,\n  SetVariablesRequestBody,\n  GetVariablesRequestBody,\n} from './websocket-message/scene/index';\nimport { VariablesModel, AnimationModel } from './models/index';\nimport { PersonaId } from './models/PersonaId';\n\n/**\n * Persona class to control a scene persona\n * @public\n */\nexport class Persona {\n  protected _scene: Scene;\n  protected _personaId: PersonaId;\n\n  private _onConversationResultEvent: SmEvent;\n  private _onSpeechMarkerEvent: SmEvent;\n\n  /**\n   * @param scene - The scene the persona resides in\n   * @param personaId - The id of the persona as received in a state callback\n   */\n  constructor(scene: Scene, personaId: PersonaId) {\n    this._scene = scene;\n    this._personaId = personaId;\n\n    if (!this._scene.onConversationResultEvents[personaId]) {\n      this._scene.onConversationResultEvents[personaId] = new SmEvent();\n    }\n\n    // /** Event which will be triggered whenever conversation results are received. Use\n    //   *  onConversationResultEvents.addListener() to register a callback for this event.\n    //   *  The single parameter to the callback will be an object with the fields:\n    //   *    - **status**        - Status code\n    //   *    - **errorMessage**  - Optional error strubg\n    //   *    - **personaId**     - Numeric ID of Persona\n    //   *    - **output:**\n    //   *      - **text**        - Textual response from the converstation backend\n    //   *    - **context**       - Dictionary of public conversation variables\n    //   *    - **provider:**\n    //   *      - **kind**        - Conversation backend name, eg \"watson\"\n    //   *      - **meta**        - Conversation backend specific metadata\n    //   */\n    this._onConversationResultEvent =\n      this._scene.onConversationResultEvents[personaId];\n\n    if (!this._scene.onSpeechMarkerEvents[personaId]) {\n      this._scene.onSpeechMarkerEvents[personaId] = new SmEvent();\n    }\n\n    // /** Event which will be triggered whenever a speech marker is reached. Use\n    //   * onSpeechMarkerEvents.addListener() to register a callback for this event.\n    //   * A speech marker is triggered using the format @marker(markername, param0,... paramn)\n    //   * in speech. There are also other verbs which establish speech markers.\n    //   * Eg @showcards(cardA, cardB). When using a speech marker with Watson Assistant,\n    //   * the @ symbol must be escaped with a backslash, as follows:\n    //   * \\@marker(markername, param0,... paramn)\n    //   * The single parameter to the callback will be an object with the fields:\n    //   *    - **personaId**     - Numeric ID of Persona\n    //   *    - **name**          - Kind of speech marker, eg, \"showcards\", \"hidecards\"\n    //   *    - **arguements**    - Marker specific arguements.\n    //   */\n    this._onSpeechMarkerEvent = this._scene.onSpeechMarkerEvents[personaId];\n  }\n\n  /**\n   * Start speaking the given text\n   * @internal\n   * @param text - The text to speak\n   * @param context - The context included in the transcript\n   * @param optionalArgs - Optional start speaking arguments or null\n   */\n  public startSpeaking(\n    text: string,\n    context: string | null = null,\n    optionalArgs: StartSpeakingOptionalArgs | null = null\n  ): Promise<any> {\n    const body: StartSpeakingRequestBody = {\n      personaId: this._personaId,\n      text,\n    };\n    if (context) {\n      body.context = context;\n    }\n    if (optionalArgs) {\n      body.optionalArgs = optionalArgs;\n    }\n    return this._scene.sendRequest('startSpeaking', body);\n  }\n\n  /**\n   * Stop speaking\n   */\n  public stopSpeaking(): Promise<any> {\n    const body: PersonaRequestBody = {\n      personaId: this._personaId,\n    };\n    return this._scene.sendRequest('stopSpeaking', body);\n  }\n\n  /**\n   * Send a chat message to conversation\n   * @param text - Text to send to conversation\n   * @param variables - Variables to send to the conversation provider\n   * @param optionalArgs - Optional arguments object (none currently supported)\n   */\n  public conversationSend(\n    text: string,\n    variables: VariablesModel,\n    optionalArgs: Record<string, unknown>\n  ): Promise<any> {\n    const body: ConversationSendRequestBody = {\n      personaId: this._personaId,\n      text,\n      variables,\n      optionalArgs,\n    };\n    return this._scene.sendRequest('conversationSend', body);\n  }\n\n  /**\n   * Set variables that will be applied on the next conversation request\n   * triggered by speech to text or a conversationSend()\n   * @param variables - Variables to send to the conversation provider\n   */\n  public conversationSetVariables(variables: VariablesModel): Promise<any> {\n    const body: ConversationSetVariablesRequestBody = {\n      personaId: this._personaId,\n      variables,\n    };\n    return this._scene.sendRequest('conversationSetVariables', body);\n  }\n\n  /**\n   * Get variables will return the current conversation variable values\n   * in the promise completion.\n   * Completion/promise receives an object with member 'variables'.\n   */\n  public conversationGetVariables(): Promise<any> {\n    const body: PersonaRequestBody = {\n      personaId: this._personaId,\n    };\n    return this._scene.sendRequest('conversationGetVariables', body);\n  }\n\n  /**\n   * Cut or animate to a named camera position, with support for camera adjustment.\n   * @param cameraName - Named camera position. The currently supported option is \"CloseUp\".\n   * @param time - Time in seconds for the animation to run. 0 indicates a cut.\n   * @param orbitDegX - Degrees of horizontal rotation around implicit orbit point of camera position (typically the middle of the Persona's head)\n   * @param orbitDegY - Degrees of vertical rotation around implicit orbit point of camera position (typically the middle of the Persona's head)\n   * @param panDeg - Degrees of camera pan. Orbital adjustment is applied before pan adjustment.\n   * @param tiltDeg - Degrees of camera tilt. Orbital adjustment is applied before tilt adjustment.\n   */\n  public animateToNamedCameraWithOrbitPan(\n    cameraName: string,\n    time: number,\n    orbitDegX: number,\n    orbitDegY: number,\n    panDeg: number,\n    tiltDeg: number\n  ): Promise<VariablesModel> {\n    const body: AnimateToNamedCameraRequestBody = {\n      personaId: this._personaId,\n      cameraName,\n      time,\n      orbitDegX,\n      orbitDegY,\n      panDeg,\n      tiltDeg,\n    };\n    return this._scene.sendRequest('animateToNamedCamera', body);\n  }\n\n  /**\n   * Play an animation.\n   * @internal\n   * @param animation - Structured animation data.\n   */\n  public playAnimation(animation: AnimationModel): Promise<VariablesModel> {\n    const body: PlayAnimationRequestBody = {\n      personaId: this._personaId,\n      animation,\n    };\n    return this._scene.sendRequest('playAnimation', body);\n  }\n\n  /**\n   * Get & Set bl variables.\n   * @internal\n   */\n  public getVariables(\n    names: string[],\n    errorTolerant = false,\n    format = ''\n  ): Promise<VariablesModel> {\n    const body: GetVariablesRequestBody = {\n      personaId: this._personaId,\n      names,\n      errorTolerant,\n      format,\n    };\n    return this._scene.sendRequest('getVariables', body);\n  }\n\n  /**\n   * @internal\n   */\n  public setVariables(variables: VariablesModel): Promise<any> {\n    const body: SetVariablesRequestBody = {\n      personaId: this._personaId,\n      Variables: variables,\n    };\n    return this._scene.sendRequest('setVariables', body);\n  }\n\n  /**\n   * @internal\n   */\n  public setVariablesOneway(variables: VariablesModel): void {\n    const body: SetVariablesRequestBody = {\n      personaId: this._personaId,\n      Variables: variables,\n    };\n    this._scene.sendOnewaySceneRequest('setVariables', body);\n  }\n\n  /**\n   * Get bl variables list.\n   * @internal\n   */\n  public getVariablesList(): Promise<any> {\n    const body: GetVariablesListRequestBody = {\n      personaId: this._personaId,\n    };\n    return this._scene.sendRequest('getVariablesList', body);\n  }\n\n  /**\n   * Get model bl variables list.\n   * @internal\n   */\n  public getModelVariablesList(modelName: string): Promise<any> {\n    const body: GetModelVariablesListRequestBody = {\n      personaId: this._personaId,\n      Models: modelName,\n    };\n    return this._scene.sendRequest('getModelVariablesList', body);\n  }\n\n  /**\n   * Get model children.\n   * @internal\n   */\n  public getModelChildren(modelName: string): Promise<any> {\n    const body: GetModelChildrenRequestBody = {\n      personaId: this._personaId,\n      Models: modelName,\n    };\n    return this._scene.sendRequest('getModelChildren', body);\n  }\n\n  /**\n   * Get model list by snippet.\n   * @internal\n   */\n  public getModelFilterSearchResult(modelName: string): Promise<any> {\n    const body: GetModelFilterSearchResultRequestBody = {\n      personaId: this._personaId,\n      Models: modelName,\n    };\n    return this._scene.sendRequest('getModelFilterSearchResult', body);\n  }\n\n  /**\n   * Get model variable list by snippet.\n   * @internal\n   */\n  public getModelVariableFilterSearchResult(\n    variableName: string\n  ): Promise<any> {\n    const body: GetModelVariableFilterSearchResultRequestBody = {\n      personaId: this._personaId,\n      Models: variableName,\n    };\n    return this._scene.sendRequest('getModelVariableFilterSearchResult', body);\n  }\n\n  /**\n   * Get connector entries.\n   * @internal\n   */\n  public getConnectorEntries(model: string): Promise<any> {\n    const body: any = {\n      personaId: this._personaId,\n      model,\n    };\n    return this._scene.sendRequest('getConnectorEntries', body);\n  }\n\n  /**\n   * Start BL profiling.\n   * @internal\n   */\n  public startBlProfiling(): Promise<any> {\n    const body: PersonaRequestBody = {\n      personaId: this._personaId,\n    };\n    return this._scene.sendRequest('startBlProfiling', body);\n  }\n\n  /**\n   * Stop BL profiling.\n   * @internal\n   */\n  public stopBlProfiling(reverse: boolean): Promise<any> {\n    const body: StopBlProfilingRequestBody = {\n      personaId: this._personaId,\n      reverse,\n    };\n    return this._scene.sendRequest('stopBlProfiling', body);\n  }\n\n  /**\n   * Get model hierarchy.\n   * @internal\n   */\n  public getModelHierarchy(model: string): Promise<any> {\n    const body: any = {\n      personaId: this._personaId,\n      model,\n    };\n    return this._scene.sendRequest('getModelHierarchy', body);\n  }\n\n  /**\n   * Monitor bl variables.\n   * @internal\n   */\n  public createMonitorSet(\n    setName: string,\n    variables: Record<string, unknown>\n  ): Promise<any> {\n    const body = {\n      personaId: this._personaId,\n      setName: [{ SetName: setName }],\n      variables,\n    };\n    return this._scene.sendRequest('createMonitorSet', body);\n  }\n\n  /**\n   * @internal\n   */\n  public removeMonitorSet(setName: string): Promise<any> {\n    const body = {\n      personaId: this._personaId,\n      setName: [{ SetName: setName }],\n    };\n    return this._scene.sendRequest('removeMonitorSet', body);\n  }\n\n  /**\n   * @internal\n   */\n  public addVariableToMonitorSet(\n    setName: string,\n    variables: Record<string, unknown>\n  ): Promise<any> {\n    const body = {\n      personaId: this._personaId,\n      setName: [{ SetName: setName }],\n      variables,\n    };\n    return this._scene.sendRequest('addVariableToMonitorSet', body);\n  }\n\n  /**\n   * @internal\n   */\n  public removeVariableFromMonitorSet(\n    setName: string,\n    variables: Record<string, unknown>\n  ): Promise<any> {\n    const body = {\n      personaId: this._personaId,\n      setName: [{ SetName: setName }],\n      variables,\n    };\n    return this._scene.sendRequest('removeVariableFromMonitorSet', body);\n  }\n\n  /**\n   * @internal\n   */\n  public renderModel(modelName: string): Promise<any> {\n    const body = {\n      personaId: this._personaId,\n      modelName,\n    };\n    return this._scene.sendRequest('renderModel', body);\n  }\n\n  get onConversationResultEvent(): SmEvent {\n    return this._onConversationResultEvent;\n  }\n\n  get onSpeechMarkerEvent(): SmEvent {\n    return this._onSpeechMarkerEvent;\n  }\n}\n","/******************************************************************************\nCopyright (c) Microsoft Corporation.\n\nPermission to use, copy, modify, and/or distribute this software for any\npurpose with or without fee is hereby granted.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\nPERFORMANCE OF THIS SOFTWARE.\n***************************************************************************** */\n/* global Reflect, Promise, SuppressedError, Symbol */\n\nvar extendStatics = function(d, b) {\n  extendStatics = Object.setPrototypeOf ||\n      ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n      function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n  return extendStatics(d, b);\n};\n\nexport function __extends(d, b) {\n  if (typeof b !== \"function\" && b !== null)\n      throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n  extendStatics(d, b);\n  function __() { this.constructor = d; }\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\nexport var __assign = function() {\n  __assign = Object.assign || function __assign(t) {\n      for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n          for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n      return t;\n  }\n  return __assign.apply(this, arguments);\n}\n\nexport function __rest(s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n      t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n      for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n          if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n              t[p[i]] = s[p[i]];\n      }\n  return t;\n}\n\nexport function __decorate(decorators, target, key, desc) {\n  var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n  else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n}\n\nexport function __param(paramIndex, decorator) {\n  return function (target, key) { decorator(target, key, paramIndex); }\n}\n\nexport function __esDecorate(ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\n  function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\n  var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\n  var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\n  var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\n  var _, done = false;\n  for (var i = decorators.length - 1; i >= 0; i--) {\n      var context = {};\n      for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\n      for (var p in contextIn.access) context.access[p] = contextIn.access[p];\n      context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\n      var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\n      if (kind === \"accessor\") {\n          if (result === void 0) continue;\n          if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\n          if (_ = accept(result.get)) descriptor.get = _;\n          if (_ = accept(result.set)) descriptor.set = _;\n          if (_ = accept(result.init)) initializers.unshift(_);\n      }\n      else if (_ = accept(result)) {\n          if (kind === \"field\") initializers.unshift(_);\n          else descriptor[key] = _;\n      }\n  }\n  if (target) Object.defineProperty(target, contextIn.name, descriptor);\n  done = true;\n};\n\nexport function __runInitializers(thisArg, initializers, value) {\n  var useValue = arguments.length > 2;\n  for (var i = 0; i < initializers.length; i++) {\n      value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\n  }\n  return useValue ? value : void 0;\n};\n\nexport function __propKey(x) {\n  return typeof x === \"symbol\" ? x : \"\".concat(x);\n};\n\nexport function __setFunctionName(f, name, prefix) {\n  if (typeof name === \"symbol\") name = name.description ? \"[\".concat(name.description, \"]\") : \"\";\n  return Object.defineProperty(f, \"name\", { configurable: true, value: prefix ? \"\".concat(prefix, \" \", name) : name });\n};\n\nexport function __metadata(metadataKey, metadataValue) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\n}\n\nexport function __awaiter(thisArg, _arguments, P, generator) {\n  function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n  return new (P || (P = Promise))(function (resolve, reject) {\n      function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n      function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n      function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n      step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n}\n\nexport function __generator(thisArg, body) {\n  var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n  return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n  function verb(n) { return function (v) { return step([n, v]); }; }\n  function step(op) {\n      if (f) throw new TypeError(\"Generator is already executing.\");\n      while (g && (g = 0, op[0] && (_ = 0)), _) try {\n          if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n          if (y = 0, t) op = [op[0] & 2, t.value];\n          switch (op[0]) {\n              case 0: case 1: t = op; break;\n              case 4: _.label++; return { value: op[1], done: false };\n              case 5: _.label++; y = op[1]; op = [0]; continue;\n              case 7: op = _.ops.pop(); _.trys.pop(); continue;\n              default:\n                  if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                  if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                  if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                  if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                  if (t[2]) _.ops.pop();\n                  _.trys.pop(); continue;\n          }\n          op = body.call(thisArg, _);\n      } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n      if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n  }\n}\n\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n  }\n  Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nexport function __exportStar(m, o) {\n  for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\n}\n\nexport function __values(o) {\n  var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n  if (m) return m.call(o);\n  if (o && typeof o.length === \"number\") return {\n      next: function () {\n          if (o && i >= o.length) o = void 0;\n          return { value: o && o[i++], done: !o };\n      }\n  };\n  throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n}\n\nexport function __read(o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o), r, ar = [], e;\n  try {\n      while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  }\n  catch (error) { e = { error: error }; }\n  finally {\n      try {\n          if (r && !r.done && (m = i[\"return\"])) m.call(i);\n      }\n      finally { if (e) throw e.error; }\n  }\n  return ar;\n}\n\n/** @deprecated */\nexport function __spread() {\n  for (var ar = [], i = 0; i < arguments.length; i++)\n      ar = ar.concat(__read(arguments[i]));\n  return ar;\n}\n\n/** @deprecated */\nexport function __spreadArrays() {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n  for (var r = Array(s), k = 0, i = 0; i < il; i++)\n      for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n          r[k] = a[j];\n  return r;\n}\n\nexport function __spreadArray(to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n      if (ar || !(i in from)) {\n          if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n          ar[i] = from[i];\n      }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n}\n\nexport function __await(v) {\n  return this instanceof __await ? (this.v = v, this) : new __await(v);\n}\n\nexport function __asyncGenerator(thisArg, _arguments, generator) {\n  if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n  var g = generator.apply(thisArg, _arguments || []), i, q = [];\n  return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\n  function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\n  function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\n  function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\n  function fulfill(value) { resume(\"next\", value); }\n  function reject(value) { resume(\"throw\", value); }\n  function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\n}\n\nexport function __asyncDelegator(o) {\n  var i, p;\n  return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\n  function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: false } : f ? f(v) : v; } : f; }\n}\n\nexport function __asyncValues(o) {\n  if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n  var m = o[Symbol.asyncIterator], i;\n  return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\n  function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\n  function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\n}\n\nexport function __makeTemplateObject(cooked, raw) {\n  if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\n  return cooked;\n};\n\nvar __setModuleDefault = Object.create ? (function(o, v) {\n  Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n  o[\"default\"] = v;\n};\n\nexport function __importStar(mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  __setModuleDefault(result, mod);\n  return result;\n}\n\nexport function __importDefault(mod) {\n  return (mod && mod.__esModule) ? mod : { default: mod };\n}\n\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n  return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n}\n\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\n  if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n  return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n}\n\nexport function __classPrivateFieldIn(state, receiver) {\n  if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\n  return typeof state === \"function\" ? receiver === state : state.has(receiver);\n}\n\nexport function __addDisposableResource(env, value, async) {\n  if (value !== null && value !== void 0) {\n    if (typeof value !== \"object\" && typeof value !== \"function\") throw new TypeError(\"Object expected.\");\n    var dispose;\n    if (async) {\n        if (!Symbol.asyncDispose) throw new TypeError(\"Symbol.asyncDispose is not defined.\");\n        dispose = value[Symbol.asyncDispose];\n    }\n    if (dispose === void 0) {\n        if (!Symbol.dispose) throw new TypeError(\"Symbol.dispose is not defined.\");\n        dispose = value[Symbol.dispose];\n    }\n    if (typeof dispose !== \"function\") throw new TypeError(\"Object not disposable.\");\n    env.stack.push({ value: value, dispose: dispose, async: async });\n  }\n  else if (async) {\n    env.stack.push({ async: true });\n  }\n  return value;\n}\n\nvar _SuppressedError = typeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\n  var e = new Error(message);\n  return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\n};\n\nexport function __disposeResources(env) {\n  function fail(e) {\n    env.error = env.hasError ? new _SuppressedError(e, env.error, \"An error was suppressed during disposal.\") : e;\n    env.hasError = true;\n  }\n  function next() {\n    while (env.stack.length) {\n      var rec = env.stack.pop();\n      try {\n        var result = rec.dispose && rec.dispose.call(rec.value);\n        if (rec.async) return Promise.resolve(result).then(next, function(e) { fail(e); return next(); });\n      }\n      catch (e) {\n          fail(e);\n      }\n    }\n    if (env.hasError) throw env.error;\n  }\n  return next();\n}\n\nexport default {\n  __extends,\n  __assign,\n  __rest,\n  __decorate,\n  __param,\n  __metadata,\n  __awaiter,\n  __generator,\n  __createBinding,\n  __exportStar,\n  __values,\n  __read,\n  __spread,\n  __spreadArrays,\n  __spreadArray,\n  __await,\n  __asyncGenerator,\n  __asyncDelegator,\n  __asyncValues,\n  __makeTemplateObject,\n  __importStar,\n  __importDefault,\n  __classPrivateFieldGet,\n  __classPrivateFieldSet,\n  __classPrivateFieldIn,\n  __addDisposableResource,\n  __disposeResources,\n};\n","/**\n * @module smwebsdk\n */\n\n/*\n * Copyright 2017-2020 Soul Machines Ltd. All Rights Reserved.\n */\n\n/**\n * Deferred class\n * @preferred\n */\nexport class Deferred<T> {\n  public promise: Promise<T>;\n\n  private fate: 'resolved' | 'unresolved';\n  private state: 'pending' | 'fulfilled' | 'rejected';\n\n  private _resolve!: (value: any) => void;\n  private _reject!: (value: any) => void;\n\n  constructor() {\n    this.state = 'pending';\n    this.fate = 'unresolved';\n    this.promise = new Promise((resolve, reject) => {\n      this._resolve = resolve;\n      this._reject = reject;\n    });\n    this.promise.then(\n      () => (this.state = 'fulfilled'),\n      () => (this.state = 'rejected')\n    );\n  }\n\n  resolve(value?: any) {\n    if (this.fate === 'resolved') {\n      console.error('Deferred cannot be resolved twice');\n      return;\n    }\n    this.fate = 'resolved';\n    this._resolve(value);\n  }\n\n  reject(reason?: any) {\n    if (this.fate === 'resolved') {\n      console.error('Deferred cannot be resolved twice');\n      return;\n    }\n    this.fate = 'resolved';\n    this._reject(reason);\n  }\n\n  isResolved() {\n    return this.fate === 'resolved';\n  }\n\n  isPending() {\n    return this.state === 'pending';\n  }\n\n  isFulfilled() {\n    return this.state === 'fulfilled';\n  }\n\n  isRejected() {\n    return this.state === 'rejected';\n  }\n}\n","/**\n * @module smwebsdk\n */\n\n/*\n * Copyright 2017-2020 Soul Machines Ltd. All Rights Reserved.\n */\n\n/**\n * Features class\n *\n * An instance of this class can also be created by the convenience API function DetectCapabilities()\n *\n * ```ts\n * var features  = window.smwebsdk.DetectCapabilities();\n * ```\n *\n * which also calls the detectWebRTCFeatures() method.\n */\nexport class Features {\n  private _hasMicrophone = false;\n  private _hasCamera = false;\n  private _isAndroid = false;\n  private _isBrowserSupported = false;\n  private _isEdge = false;\n  private _isIos = false;\n\n  constructor() {\n    this._isAndroid = this.detectAndroid();\n    this._isEdge = this.detectEdge();\n    this._isIos = this.detectIos();\n  }\n\n  private detectEdge(): boolean {\n    return this.userAgentMatches('Edge');\n  }\n\n  private detectAndroid(): boolean {\n    return this.userAgentMatches('Android');\n  }\n\n  private detectIos(): boolean {\n    const isIOS =\n      (/iPad|iPhone|iPod/i.test(navigator.platform) ||\n        (navigator &&\n          navigator.platform === 'MacIntel' &&\n          navigator.maxTouchPoints > 1)) &&\n      !window.MSStream;\n    return isIOS;\n  }\n\n  private userAgentMatches(text: string): boolean {\n    const userAgent = window.navigator.userAgent;\n    const matches: RegExpMatchArray | null = userAgent.match(text);\n    if (matches) {\n      return matches.length > 0 ? true : false;\n    }\n    return false;\n  }\n\n  public detectWebRTCFeatures(): Promise<Features> {\n    return new Promise(\n      (resolve: (value: any) => void, reject: (value: any) => void) => {\n        // Check for runtime host\n        if (window.SmIsUnderRuntimeHost) {\n          // TODO - detect whether camera/microphone is available in runtime host\n          this._isBrowserSupported = true;\n          this._hasMicrophone = true;\n          this._hasCamera = true;\n          resolve(this);\n        }\n\n        // This approach heavily influenced by the helpful and MIT licensed:\n        //    https://github.com/muaz-khan/DetectRTC/blob/master/DetectRTC.js\n\n        // Detect webrtc support\n        let isWebRTCSupported = false;\n        [\n          'RTCPeerConnection',\n          'webkitRTCPeerConnection',\n          'mozRTCPeerConnection',\n          'RTCIceGatherer',\n        ].forEach((item) => {\n          if (isWebRTCSupported) {\n            return;\n          }\n\n          if (item in window) {\n            isWebRTCSupported = true;\n          }\n        });\n\n        // Apparently IE11 injected iPhone into user agent string, hence check for not MSStream\n        const iOS =\n          navigator.userAgent.match(/iPhone|iPad|iPod/i) && !window.MSStream;\n        const isSafari = /^((?!chrome|android).)*safari/i.test(\n          navigator.userAgent\n        );\n        if (isWebRTCSupported && iOS && !isSafari) {\n          // Webrtc is not supported on an iOS device using webview instead of full Safari\n          isWebRTCSupported = false;\n        }\n\n        this._isBrowserSupported = isWebRTCSupported;\n\n        if (!this._isBrowserSupported) {\n          resolve(this);\n        }\n\n        // Find the enumerate devices function if available\n        let navEnumerateDevices = null;\n        if (navigator.mediaDevices && navigator.mediaDevices.enumerateDevices) {\n          // Firefox 38+ seems having support of enumerateDevices\n          // Thanks @xdumaine/enumerateDevices\n          // eslint-disable-next-line @typescript-eslint/ban-types\n          navEnumerateDevices = (callback: Function) => {\n            Promise.resolve(navigator.mediaDevices.enumerateDevices())\n              .then((value: MediaDeviceInfo[] = []) => {\n                callback(value);\n              })\n              .catch(() => {\n                callback([]);\n              });\n          };\n        }\n\n        const { MediaStreamTrack } = window;\n        if (\n          !navEnumerateDevices &&\n          MediaStreamTrack &&\n          MediaStreamTrack.getSources\n        ) {\n          navEnumerateDevices =\n            MediaStreamTrack.getSources.bind(MediaStreamTrack);\n        }\n\n        if (!navEnumerateDevices && navigator.enumerateDevices) {\n          // ! block was originally unreachable until bug is fixed in trunk\n          navEnumerateDevices = navigator.enumerateDevices.bind(navigator);\n        }\n\n        // Enumerate the media devices\n        if (navEnumerateDevices) {\n          navEnumerateDevices((devices: MediaDeviceInfo[]) => {\n            devices.forEach((device: MediaDeviceInfo) => {\n              if (device.kind === 'audioinput') {\n                this._hasMicrophone = true;\n              }\n              if (device.kind === 'videoinput') {\n                this._hasCamera = true;\n              }\n            });\n\n            resolve(this);\n          });\n        } else {\n          resolve(this);\n        }\n      }\n    );\n  }\n\n  get hasMicrophone(): boolean {\n    return this._hasMicrophone;\n  }\n\n  get hasCamera(): boolean {\n    return this._hasCamera;\n  }\n\n  get isAndroid(): boolean {\n    return this._isAndroid;\n  }\n\n  get isBrowserSupported(): boolean {\n    return this._isBrowserSupported;\n  }\n\n  get isEdge(): boolean {\n    return this._isEdge;\n  }\n\n  get isIos(): boolean {\n    return this._isIos;\n  }\n}\n","const logLevels = ['debug', 'log', 'warn', 'error'] as const;\n\n/**\n * @public\n */\nexport type LogLevel = (typeof logLevels)[number];\n\nexport class Logger {\n  private availableLogLevels: LogLevel[] = [];\n  private _minLogLevel: LogLevel = 'log';\n\n  constructor(minLogLevel: LogLevel = 'log', public isEnabled = true) {\n    this.setMinLogLevel(minLogLevel);\n  }\n\n  log(type: LogLevel, ...args: any) {\n    if (this.isEnabled && this.availableLogLevels.includes(type)) {\n      console[type](...args);\n    }\n  }\n\n  enableLogging(enable: boolean) {\n    this.isEnabled = enable;\n  }\n\n  getMinLogLevel() {\n    return this._minLogLevel;\n  }\n\n  setMinLogLevel(level: LogLevel) {\n    const index = logLevels.indexOf(level);\n\n    this._minLogLevel = level;\n    this.availableLogLevels = logLevels.slice(index);\n  }\n}\n","export function makeError(message: string, reason: string): Error {\n  const error = new Error(message);\n  error.name = reason;\n  return error;\n}\n","/**\n * @module smwebsdk\n */\n\n/*\n * Copyright 2017-2020 Soul Machines Ltd. All Rights Reserved.\n */\n\nimport { Deferred } from './Deferred';\nimport { Features } from './Features';\nimport { Logger, LogLevel } from './utils/Logger';\nimport { makeError } from './utils/make-error';\nimport { WebsocketResponse } from './websocket-message/index';\n\nexport interface MessageFunction {\n  (message: string): void;\n}\n\nexport interface WebsocketFunction {\n  (message: WebsocketResponse): void;\n}\n\nexport interface SessionFunction {\n  (\n    resumeRequested: boolean,\n    isResumedSession: boolean,\n    server: string,\n    sessionId: string\n  ): void;\n}\n\n/**\n *  LocalSession class\n */\nexport class LocalSession {\n  public videoMediaStream!: MediaStream | null;\n  private _viewport_element: HTMLVideoElement | undefined;\n  private _isMicrophoneConnected = false;\n  private _isCameraConnected = false;\n\n  private _onConnectedStorage: SessionFunction = (\n    resumeRequested: boolean,\n    isResumedSession: boolean,\n    server: string,\n    sessionId: string\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\n  ) => {};\n  private _onClose: MessageFunction;\n  private _onMessage: WebsocketFunction;\n  private _onUserText: MessageFunction;\n\n  private _closed = false;\n\n  private _sessionId: string | undefined;\n  private _outgoingQueue: any[] = [];\n\n  private _features: Features;\n\n  private _serverConnection!: WebSocket;\n\n  // Duration that microphone mute is maintained by the web sdk after the persona has\n  // finished speaking.  Set to -1 to disable.  Default value is -1 (disabled).\n  private _microphoneMuteDelay = -1;\n\n  private _offsetX = 0;\n  private _offsetY = 0;\n\n  constructor(\n    videoElement: HTMLVideoElement | undefined,\n    private logger = new Logger()\n  ) {\n    if (videoElement) {\n      this._viewport_element = videoElement;\n    }\n\n    window.SmRuntimeHostReceiveMessage = this.receiveMessage.bind(this);\n\n    if (typeof window.SmRuntimeHostStyleViewportElement === 'function') {\n      window.SmRuntimeHostStyleViewportElement(this._viewport_element);\n    }\n\n    // owner specifies custom close method\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\n    this._onClose = (reason: string) => {};\n    // owner specifies custom message handler\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\n    this._onMessage = (message: WebsocketResponse) => {};\n    // owner specifies custom rtc user text message handler\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\n    this._onUserText = (text: string) => {};\n\n    this.sendVideoBounds(0, 0);\n\n    // The initial positioning can take a while. Would be nice to make this more deterministic.\n    setTimeout(() => {\n      this.sendVideoBounds(0, 0);\n    }, 3000);\n\n    this._features = new Features();\n\n    this.log('Local session created!');\n  }\n\n  public setVideoElement(videoElement: HTMLVideoElement) {\n    this._viewport_element = videoElement;\n\n    if (typeof window.SmRuntimeHostStyleViewportElement === 'function') {\n      window.SmRuntimeHostStyleViewportElement(this._viewport_element);\n    }\n\n    this.log(`Updating bounds after videoElement is updated: 0, 0`);\n    this.sendVideoBounds(0, 0);\n  }\n\n  public receiveMessage(raw_text: string) {\n    const message = JSON.parse(raw_text);\n    this.log(`message received: ${raw_text}`);\n    this._onMessage(message);\n    if (\n      message.name === 'state' &&\n      message.category === 'scene' &&\n      message.body?.session?.state === 'idle'\n    ) {\n      this.log('Local session ending - conversationEnded');\n      this.close(true, 'conversationEnded');\n    }\n  }\n\n  set onConnected(sessionFunction: SessionFunction) {\n    this._onConnectedStorage = sessionFunction;\n  }\n\n  set onClose(closeFunction: MessageFunction) {\n    this._onClose = closeFunction;\n  }\n\n  set onMessage(messageFunction: WebsocketFunction) {\n    this._onMessage = messageFunction;\n  }\n\n  set onUserText(userTextFunction: MessageFunction) {\n    this._onUserText = userTextFunction;\n  }\n\n  /**\n   * @deprecated use setLogging(boolean).\n   */\n  set loggingEnabled(enable: boolean) {\n    this.logger.log(\n      'warn',\n      'loggingEnabled is deprecated and will be removed in a future version. Please use setLogging(boolean)'\n    );\n    this.logger.enableLogging(enable);\n  }\n\n  get loggingEnabled(): boolean {\n    return this.logger.isEnabled;\n  }\n\n  public setMinLogLevel(level: LogLevel) {\n    this.logger.setMinLogLevel(level);\n  }\n\n  public setLogging(enable: boolean) {\n    this.logger.enableLogging(enable);\n  }\n\n  public log(text: string): void {\n    this.logger.log('log', text);\n  }\n\n  public sendVideoBounds(widthIgnored: number, heightIgnored: number) {\n    // We need to defer the update very slightly to give the browser time to reflow,\n    // otherwise we get out of date values for width, height etc:\n    setTimeout(() => {\n      const el: HTMLVideoElement | undefined = this._viewport_element;\n      if (el) {\n        const view = document.defaultView || window;\n        const width = parseInt(<string>view.getComputedStyle(el).width, 10);\n        const height = parseInt(<string>view.getComputedStyle(el).height, 10);\n\n        if (width === 0 || height === 0) return;\n\n        const rect = el.getBoundingClientRect();\n        this._offsetX = rect.x;\n        this._offsetY = rect.y;\n\n        this.log(\n          `Updating bounds: x =  ${this._offsetX} , y = ${this._offsetY}', w = ${width}, h = ${height}`\n        );\n\n        // update bounds\n        const top = this._offsetY;\n        const left = this._offsetX;\n        const bottom = this._offsetY + height;\n        const right = this._offsetX + width;\n\n        const payload = {\n          name: 'videoBounds',\n          body: { top, left, bottom, right },\n          category: 'local',\n          kind: 'event',\n        };\n        this.sendMessage(payload);\n      }\n    }, 0);\n  }\n\n  private hideVideo() {\n    const top = 0;\n    const left = 0;\n    const bottom = 0;\n    const right = 0;\n\n    const payload = {\n      name: 'videoBounds',\n      body: { top, left, bottom, right },\n      category: 'local',\n      kind: 'event',\n    };\n    this.sendMessage(payload);\n  }\n\n  public sendRtcEvent(name: string, body: any) {\n    // NOOP: Stuff for compatibility with Session in Scene\n  }\n\n  public async connect(): Promise<string | undefined | any> {\n    const deferred = new Deferred<any>();\n\n    this.log('Local session connecting!');\n    this._closed = false;\n\n    const result = await this._features.detectWebRTCFeatures();\n    this._closed = false;\n    this._sessionId = undefined;\n    this._isMicrophoneConnected = result.hasMicrophone;\n    this._isCameraConnected = result.hasCamera;\n\n    if (typeof window.local_websocket_port === 'number') {\n      this._serverConnection = new WebSocket(\n        'ws://localhost:' + window.local_websocket_port\n      );\n      this.log('websocket open');\n\n      this._serverConnection.onmessage = (msg: MessageEvent) => {\n        this.gotMessageFromServer(msg);\n      };\n\n      this._serverConnection.onerror = (event) => {\n        if (deferred.isPending()) {\n          deferred.reject(\n            makeError('websocket failed', 'serverConnectionFailed')\n          );\n        }\n      };\n\n      this._serverConnection.onopen = (event: Event) => {\n        // disable SmRuntimeHostReceiveMessage\n        // eslint-disable-next-line @typescript-eslint/no-empty-function\n        window.SmRuntimeHostReceiveMessage = () => {};\n        this.log('Local session connected!');\n\n        // send out messages in queue\n        for (let i = 0; i < this._outgoingQueue.length; i++) {\n          this._serverConnection.send(JSON.stringify(this._outgoingQueue[i]));\n          this.logger.log(\n            'log',\n            'SmLocalSession.prototype.sendMessage, forwarding message to Web Socket: ' +\n              this._outgoingQueue[i]\n          );\n        }\n        this._outgoingQueue = [];\n\n        if (deferred.isPending()) {\n          deferred.resolve();\n        }\n      };\n\n      this._serverConnection.onclose = (event: CloseEvent) => {\n        this.logger.log(\n          'log',\n          `websocket closed: code(${event.code}), reason(${event.reason}), clean(${event.wasClean})`\n        );\n        if (!deferred.isRejected) {\n          this.close(false, 'normal');\n        }\n      };\n    } else {\n      this.log('local_websocket_port not found! Failed to create WebSocket');\n\n      if (deferred.isPending()) {\n        deferred.reject(\n          makeError('websocket failed', 'local_websocket_port not found')\n        );\n      }\n    }\n\n    const payload = {\n      name: 'startSession',\n      body: {},\n      category: 'scene',\n      kind: 'request',\n    };\n    this.sendMessage(payload);\n    return deferred.promise;\n  }\n\n  private gotMessageFromServer(websocket_message: MessageEvent): void {\n    const raw_text = websocket_message.data;\n    const message = JSON.parse(raw_text);\n\n    const category = message.category;\n    const name = message.name;\n    const body = message.body;\n\n    if (category !== 'webrtc') {\n      // forward on non-webrtc messages (e.g. scene)\n      this._onMessage(message);\n    } else if (name === 'close') {\n      this.close(false, body.reason);\n    }\n\n    if (\n      name === 'state' &&\n      category === 'scene' &&\n      body.session !== null &&\n      body.session !== undefined &&\n      body.session.state === 'idle'\n    ) {\n      this.log('Local session ending due to server idle message');\n      this.close(true, 'conversationEnded');\n    }\n  }\n\n  public sendMessage(message: any): void {\n    const msg = JSON.stringify(message);\n    if (\n      this._serverConnection &&\n      this._serverConnection.readyState === WebSocket.OPEN\n    ) {\n      this._serverConnection.send(msg);\n      this.log(\n        `SmLocalSession.prototype.sendMessage, forwarding message to Web Socket: ${msg}`\n      );\n    } else {\n      this._outgoingQueue.push(message);\n    }\n  }\n\n  public sendUserText(text: string): void {\n    this.logger.log(\n      'log',\n      'SmLocalSession.prototype.sendUserText, discarding text: ' + text\n    );\n  }\n\n  public close(sendRtcClose = true, reason = 'normal'): void {\n    if (this._closed) {\n      return;\n    }\n\n    this._closed = true;\n    this._onClose(reason);\n    this._isMicrophoneConnected = false;\n    this._isCameraConnected = false;\n\n    this.hideVideo();\n\n    if (this._serverConnection) {\n      this.log('closing server connection');\n      const normalClosureCode = 1000;\n      this._serverConnection.close(normalClosureCode, reason);\n    }\n  }\n\n  get peerConnection(): RTCPeerConnection | null {\n    return null;\n  }\n\n  get userMediaStream(): MediaStream | null {\n    return null;\n  }\n\n  get serverConnection(): WebSocket {\n    return this._serverConnection;\n  }\n\n  get sessionId(): string | undefined {\n    return this._sessionId;\n  }\n\n  get isMicrophoneConnected(): boolean {\n    return this._isMicrophoneConnected;\n  }\n\n  get isCameraConnected(): boolean {\n    return this._isCameraConnected;\n  }\n\n  get features(): Features {\n    return this._features;\n  }\n\n  get microphoneMuteDelay(): number {\n    return this._microphoneMuteDelay;\n  }\n\n  set microphoneMuted(mute: boolean) {\n    // todo - RuntimeHost does not yet support this,\n    //        currently only needed in webrtc sessions and tests\n    if (typeof window.SmRuntimeHostMuteMicrophone === 'function') {\n      window.SmRuntimeHostMuteMicrophone(mute);\n    }\n  }\n\n  get microphoneMuted(): boolean {\n    // todo - RuntimeHost does not yet support this,\n    //        currently only needed in webrtc sessions and tests\n    if (typeof window.SmRuntimeHostIsMicrophoneMuted === 'function') {\n      return window.SmRuntimeHostIsMicrophoneMuted();\n    }\n\n    return false;\n  }\n\n  get offsetX(): number {\n    return this._offsetX;\n  }\n\n  get offsetY(): number {\n    return this._offsetY;\n  }\n\n  isMicrophoneActive(): boolean {\n    return this.isMicrophoneConnected && !this.microphoneMuted;\n  }\n\n  isCameraActive(): boolean {\n    return this.isCameraConnected;\n  }\n\n  async setMediaDeviceActive({\n    microphone,\n    camera,\n  }: {\n    microphone?: boolean;\n    camera?: boolean;\n  }): Promise<void> {\n    throw makeError(\n      'setMediaDeviceActive not supported on LocalSession',\n      'notSupported'\n    );\n  }\n}\n","import { PersonaId } from '../../../models/PersonaId';\n\nexport enum SpeechMarkerName {\n  Showcards = 'showcards',\n  Hidecards = 'hidecards',\n  Feature = 'feature',\n  Marker = 'marker',\n}\n\nexport interface SpeechMarker {\n  name:\n    | SpeechMarkerName.Showcards\n    | SpeechMarkerName.Hidecards\n    | SpeechMarkerName.Feature\n    | SpeechMarkerName.Marker;\n  arguments: string[];\n  personaId?: string;\n}\n\n/**\n * @public\n */\nexport interface SpeechMarkerResponseBody {\n  personaId: PersonaId;\n  name: string;\n  arguments: string[];\n}\n","import { ConfigurationModel } from '../../../models/index';\nimport { SpeechState } from '../../enums/SpeechState';\n\nexport enum FeatureFlag {\n  UI_CONTENT_AWARENESS = 'UI_CONTENT_AWARENESS',\n  UI_SDK_CAMERA_CONTROL = 'UI_SDK_CAMERA_CONTROL',\n}\n/**\n * @public\n */\nexport interface StateResponseBody {\n  scene?: {\n    featureFlags?: FeatureFlag[];\n    runtime?: string;\n    runtimeBuild?: string;\n    sceneId?: string;\n    sdkVersion?: string;\n    [key: string]: unknown;\n  };\n  configuration?: ConfigurationModel;\n  persona?: {\n    [index: string]: {\n      conversationProvider?: string;\n      lastPreset?: string;\n      users?: Record<string, unknown>[];\n      speechState?: SpeechState;\n      currentSpeech?: string;\n      currentSpeechEML?: string;\n      currentSpeechContext?: string;\n      [index: string]: any;\n    };\n  };\n  recognizing?: boolean;\n  session?: {\n    sessionId: string;\n    state: string;\n    userInfo?: string;\n  };\n}\n","/**\n * @public\n */\nexport class SceneResponseError extends Error {\n  requestName = '';\n  status = 0;\n  responseBody: any;\n\n  get message() {\n    return `Scene response failed, status: ${this.status}`;\n  }\n}\n","import { LogLevel } from '../utils/Logger';\nexport * from '../websocket-message/scene';\nexport * from '../models/Conversation';\n\n/**\n * Represents the different combinations of User Media that are supported\n * @public\n */\nexport enum UserMedia {\n  None,\n  Microphone,\n  MicrophoneAndCamera,\n  Camera,\n}\n\n/**\n * @public\n */\nexport enum NLPIntent {\n  PAGE_METADATA = 'PAGE_METADATA',\n}\n\n/**\n * @public\n */\nexport interface RetryOptions {\n  maxRetries?: number;\n  delayMs?: number;\n}\n\n/**\n * @public\n */\nexport type LoggingConfig = Record<\n  'session' | 'contentAwareness',\n  {\n    minLogLevel?: LogLevel;\n    enabled?: boolean;\n  }\n>;\n\n/**\n * @public\n */\nexport type MediaDeviceOptions = {\n  microphone?: boolean;\n  camera?: boolean;\n};\n","/**\n * @public\n */\nexport enum ConnectionStateTypes {\n  Disconnected = 'Disconnected',\n  //websocket open - searching for an available DP scene, may require queuing\n  SearchingForDigitalPerson = 'SearchingForDigitalPerson',\n  //established - scene is available/found, downloading/preparing DP assets on the server\n  DownloadingAssets = 'DownloadingAssets',\n  //accepted - DP is starting / forming webrtc connection\n  ConnectingToDigitalPerson = 'ConnectingToDigitalPerson',\n  //connected - DP is started and ready the webrtc session has connected\n  Connected = 'Connected',\n}\n\n/**\n * @public\n */\nexport interface ConnectionStateData {\n  name: ConnectionStateTypes;\n  currentStep: number;\n  totalSteps: number;\n  percentageLoaded: number;\n}\n","/// <reference types=\"dom-webcodecs\" />\n\n'use strict';\n\n/**\n * The chroma key shader works in the YUV color space,\n * using the U and V components to measure how far a pixel is from the key color.\n *\n * If the distance is below a threshold called similarity, the pixel is fully transparent.\n * Beyond that, the transparency rises. The smoothness parameter controls how quickly the transparency rises\n *\n * Similarly, the pixel is desaturated to the extent that its chrominance is close to the key color.\n * This attempts to account for light reflected from the subject\n * The spill parameter controls how quickly this desaturation drops off.\n */\n\nexport interface KeyColor {\n  r: number;\n  g: number;\n  b: number;\n}\n\n/**\n * This Documention is intended to belong in docs/web-sdk/guides/scene-configurations.md\n * But it is kept here while this feature is not supported.\n * \n * The file /dedicated-workers/chroma-key.worker.js must also be hosted at this path for the smwebsdk to load it\n * upon enabling of this feature. There are no consequences in its absence if this feature is not enabled\n * \n * - optional `chromaKeyOptions`: By default, the Soul Machines Web SDK will  not apply chromaKey compositing. Optionally, chromaKey compositing can be activated by setting chomaKeyOptions to `{ enabled: true }`. There are more options for chromaKey settings.\n * ```\n * interface ChromaKeyOptions {\n *   enabled: boolean;     // enable or disable chromaKey compositing\n *   keyColor?: KeyColor;  // the background color to be made transparent.\n *                         // default value as {  r: 4 / 255, g: 244 / 255, b: 4 / 255}\n *   similarity?: number;  // The chroma key shader works in the YUV color space, using\n *                         // the U and V components to measure how far a pixel is from\n *                         // the key color.\n *                         // If the distance is below a threshold called similarity, the\n *                         // pixel is fully transparent. Beyond that, the transparency rises.\n *                         // default value is 0.4\n *   smoothness?: number;  // the pixel is desaturated to the extent that its chrominance\n *                         // is close to the key color.\n *                         // This attempts to account for light reflected from the subject\n *                         // default value is 0.08\n *   spill?: number;       // this parameter controls how quickly this desaturation drops off\n *                         // default value is 0.1\n * }\n\n * export interface KeyColor {\n *   r: number; // [0, 1]\n *   g: number; // [0, 1]\n *   b: number; // [0, 1]\n * }\n * ```\n */\nexport interface ChromaKeyOptions {\n  enabled: boolean;\n  keyColor?: KeyColor;\n  similarity?: number;\n  smoothness?: number;\n  spill?: number;\n}\n\nlet keyColor: KeyColor = {\n  r: 4 / 255,\n  g: 244 / 255,\n  b: 4 / 255,\n};\nlet similarity = 0.4;\nlet smoothness = 0.08;\nlet spill = 0.1;\n\nexport function updateChromaKeyOptions(options: ChromaKeyOptions) {\n  keyColor = options.keyColor || keyColor;\n  similarity = options.similarity || similarity;\n  smoothness = options.smoothness || smoothness;\n  spill = options.spill || spill;\n}\n\nexport let offscreenCanvas: OffscreenCanvas | any;\nlet gl: any;\nlet buffer: any;\nlet visibleRect: any;\nlet format: string | null;\n\nlet keyColorLoc: any;\nlet similarityLoc: any;\nlet smoothnessLoc: any;\nlet spillLoc: any;\n\nconst videoFrameBufferInit: VideoFrameBufferInit = {\n  timestamp: 0,\n  codedWidth: 0,\n  codedHeight: 0,\n  format: 'RGBA',\n};\n\nconst chromaKeyOptions = `\nuniform vec3 keyColor;\nuniform float similarity;\nuniform float smoothness;\nuniform float spill;\n`;\n\nconst RGBtoUV = `\nvec2 RGBtoUV(vec3 rgb) {\n  return vec2(\n    rgb.r * -0.169 + rgb.g * -0.331 + rgb.b *  0.5    + 0.5,\n    rgb.r *  0.5   + rgb.g * -0.419 + rgb.b * -0.081  + 0.5\n  );\n}\n`;\n\nconst processChromaKey = `\nvec4 ProcessChromaKey(vec2 texCoord, vec4 rgba) {\n    float chromaDist = distance(RGBtoUV(rgba.rgb), RGBtoUV(keyColor));\n    float baseMask = chromaDist - similarity;\n    float fullMask = pow(clamp(baseMask / smoothness, 0., 1.), 1.5);\n    rgba.a = fullMask;\n    float spillVal = pow(clamp(baseMask / spill, 0., 1.), 1.5);\n    float desat = clamp(rgba.r * 0.2126 + rgba.g * 0.7152 + rgba.b * 0.0722, 0., 1.);\n    rgba.rgb = mix(vec3(desat, desat, desat), rgba.rgb, spillVal);\n    return rgba;\n}\n`;\n\nconst rgb_FragmentShader = `\nprecision highp float;\n\nuniform sampler2D tex_y;\nvarying vec2 v_texCoord;\n\n${chromaKeyOptions}\n\n${RGBtoUV}\n\n${processChromaKey}\n\nvoid main() {\n    vec4 video_pixels_rgba = texture2D(tex_y, v_texCoord);\n    gl_FragColor = ProcessChromaKey(v_texCoord, video_pixels_rgba);\n}\n`;\n\nconst rgb_VertexShader = `\nattribute vec4 a_vertexPosition;\nattribute vec2 a_texturePosition;\nvarying vec2 v_texCoord;\nvoid main(void)\n{\n  gl_Position = a_vertexPosition;\n  v_texCoord = a_texturePosition;\n}\n`;\n\nconst i420_to_rgb_FragmentShader = `\nprecision highp float;\n\nuniform sampler2D u_image_frame;\nuniform vec2 u_resolution;\nvarying vec2 v_texCoord;\n\n${chromaKeyOptions}\n\n${RGBtoUV}\n\n${processChromaKey}\n\nvoid main() {\n  float x_offset = mod( gl_FragCoord.y ,2.0  ) < 1.0 ? 0.5 : 0.0 ;\n  vec4 y4 =  texture2D(u_image_frame, vec2 ( v_texCoord.x / 1.0  , v_texCoord.y / 1.5  )   )  ;\n  vec4 u4 = (texture2D(u_image_frame, vec2 ( x_offset + v_texCoord.x  / 2.0  ,2.0/3.0 +  v_texCoord.y / 6.0  )   ) -0.50 ) * 2.0 ;\n  vec4 v4 = (texture2D(u_image_frame, vec2 ( x_offset + v_texCoord.x / 2.0  , 5.0/6.0 + v_texCoord.y / 6.0  )   ) -0.50 ) * 2.0 ;   \n  \n  float y = y4[0] ;\n  float u = u4[0] ;\n  float v = v4[0] ;   \n\n  float R = clamp(y + 1.13 * v, 0.0, 1.0) ;\n  float G = clamp(y - 0.39 * u - 0.58 * v, 0.0, 1.0) ;\n  float B = clamp(y + 2.03 * u, 0.0, 1.0) ;\n\n  vec4 video_pixels_rgba = vec4( vec3(R,G,B), 1.0) ;\n\n  gl_FragColor = ProcessChromaKey(vec2 ( v_texCoord.x / 1.0  , v_texCoord.y / 1.5  ), video_pixels_rgba);\n}\n`;\n\nconst i420_to_rgb_VertexShader = `\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\nuniform vec2 u_resolution; \nvarying vec2 v_texCoord;\n  \nvoid main() {  \n  gl_Position =  vec4(( (a_position / u_resolution * 2.0) - 1.0)  * vec2(1, -1), 0, 1);  \n  v_texCoord = a_texCoord;  \n}\n`;\n\nconst n12_to_rgb_FragmentShader = `\nprecision highp float;\nvarying vec2 v_texCoord;\nuniform sampler2D tex_y;\nuniform sampler2D tex_uv;\n\n${chromaKeyOptions}\n\n${RGBtoUV}\n\n${processChromaKey}\n\nvoid main() \n{\n    vec3 yuv, rgb;\n    vec3 yuv2r = vec3(1.164, 0.0, 1.596);\n    vec3 yuv2g = vec3(1.164, -0.391, -0.813);\n    vec3 yuv2b = vec3(1.164, 2.018, 0.0);\n\n    yuv.x = texture2D(tex_y, v_texCoord).r - 0.0625;\n    yuv.y = texture2D(tex_uv, v_texCoord).r - 0.5;\n    yuv.z = texture2D(tex_uv, v_texCoord).a - 0.5;\n\n    rgb.x = dot(yuv, yuv2r);\n    rgb.y = dot(yuv, yuv2g);\n    rgb.z = dot(yuv, yuv2b);\n\n    vec4 video_pixels_rgba  = vec4(rgb, 1.0);\n\n    gl_FragColor = ProcessChromaKey(v_texCoord, video_pixels_rgba);\n}\n`;\n\nconst n12_to_rgb_VertexShader = `\nattribute vec4 a_vertexPosition;\nattribute vec2 a_texturePosition;\nvarying vec2 v_texCoord;\nvoid main(void)\n{\n  gl_Position = a_vertexPosition;\n  v_texCoord = a_texturePosition;\n}\n`;\n\nfunction getGl(width: number, height: number) {\n  // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n  // @ts-ignore\n  offscreenCanvas = new OffscreenCanvas(width, height);\n  gl = offscreenCanvas.getContext('webgl', { premultipliedAlpha: false });\n  if (gl) {\n    return true;\n  }\n  return false;\n}\n\nfunction getCanvasGL(canvas: any) {\n  gl = canvas.getContext('webgl', { premultipliedAlpha: false });\n  if (gl) {\n    return true;\n  }\n  return false;\n}\n\nfunction createShader(type: any, src: any) {\n  const shader = gl.createShader(type);\n  gl.shaderSource(shader, src);\n  gl.compileShader(shader);\n  if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n    console.error(gl.getShaderInfoLog(shader));\n  }\n  return shader;\n}\n\nfunction createProgram(vertexShader: any, fragmentShader: any) {\n  const program = gl.createProgram();\n  gl.attachShader(program, vertexShader);\n  gl.attachShader(program, fragmentShader);\n  gl.linkProgram(program);\n  gl.useProgram(program);\n  if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {\n    console.error(gl.getShaderInfoLog(program));\n  }\n  return program;\n}\n\nfunction createTexture(filter = gl.LINEAR) {\n  const t = gl.createTexture();\n\n  gl.bindTexture(gl.TEXTURE_2D, t);\n\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, filter);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, filter);\n  return t;\n}\n\nexport async function initWebGL_rgb(width: number, height: number) {\n  if (!getGl(width, height)) return;\n\n  initWebGL_rgb_with_gl();\n}\n\nexport function initWebGL_rgb_with_canvas(canvas: any) {\n  if (!getCanvasGL(canvas)) return;\n\n  initWebGL_rgb_with_gl();\n}\n\nfunction initWebGL_rgb_with_gl() {\n  gl.pixelStorei(gl.UNPACK_ALIGNMENT, 1);\n\n  const vs = createShader(gl.VERTEX_SHADER, rgb_VertexShader);\n  const fs = createShader(gl.FRAGMENT_SHADER, rgb_FragmentShader);\n  const program = createProgram(vs, fs);\n\n  initVertexBuffers(program);\n\n  gl.activeTexture(gl.TEXTURE0);\n  gl.y = createTexture();\n  gl.uniform1i(gl.getUniformLocation(program, 'tex_y'), 0);\n\n  keyColorLoc = gl.getUniformLocation(program, 'keyColor');\n  similarityLoc = gl.getUniformLocation(program, 'similarity');\n  smoothnessLoc = gl.getUniformLocation(program, 'smoothness');\n  spillLoc = gl.getUniformLocation(program, 'spill');\n}\n\nasync function initWebGL_I420(width: number, height: number) {\n  if (!getGl(width, height)) return;\n\n  const vs = createShader(gl.VERTEX_SHADER, i420_to_rgb_VertexShader);\n  const fs = createShader(gl.FRAGMENT_SHADER, i420_to_rgb_FragmentShader);\n  const program = createProgram(vs, fs);\n\n  const positionLocation = gl.getAttribLocation(program, 'a_position');\n  const texcoordLocation = gl.getAttribLocation(program, 'a_texCoord');\n\n  const positionBuffer = gl.createBuffer();\n\n  gl.bindBuffer(gl.ARRAY_BUFFER, positionBuffer);\n\n  // Set a rectangle the same size as the image.\n  const x1 = 0;\n  const x2 = 0 + width;\n  const y1 = 0;\n  const y2 = 0 + height;\n  gl.bufferData(\n    gl.ARRAY_BUFFER,\n    new Float32Array([x1, y1, x2, y1, x1, y2, x1, y2, x2, y1, x2, y2]),\n    gl.STATIC_DRAW\n  );\n\n  // provide texture coordinates for the rectangle.\n  const texcoordBuffer = gl.createBuffer();\n  gl.bindBuffer(gl.ARRAY_BUFFER, texcoordBuffer);\n  gl.bufferData(\n    gl.ARRAY_BUFFER,\n    new Float32Array([\n      0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 1.0, 1.0,\n    ]),\n    gl.STATIC_DRAW\n  );\n\n  const textures = [];\n\n  // create texture for the video frame\n  {\n    const texture = gl.createTexture();\n    gl.bindTexture(gl.TEXTURE_2D, texture);\n\n    // Set the parameters so we can render any size image.\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n\n    const pixelData = new Uint8Array(1.5 * width * height);\n\n    // Upload the image into the texture.\n    gl.texImage2D(\n      gl.TEXTURE_2D,\n      0,\n      gl.LUMINANCE,\n      width,\n      height * 1.5,\n      0,\n      gl.LUMINANCE,\n      gl.UNSIGNED_BYTE,\n      pixelData\n    );\n\n    textures[0] = texture;\n  }\n\n  const u_image_frame = gl.getUniformLocation(program, 'u_image_frame');\n\n  // set which texture units to render with.\n  gl.uniform1i(u_image_frame, 0); // texture unit 1\n\n  gl.activeTexture(gl.TEXTURE0);\n  gl.bindTexture(gl.TEXTURE_2D, textures[0]);\n\n  gl.viewport(0, 0, gl.canvas.width, gl.canvas.height);\n\n  gl.clearColor(0, 0, 0, 0);\n  gl.clear(gl.COLOR_BUFFER_BIT);\n\n  // Turn on the position attribute\n  gl.enableVertexAttribArray(positionLocation);\n\n  // Bind the position buffer.\n  gl.bindBuffer(gl.ARRAY_BUFFER, positionBuffer);\n\n  // Tell the position attribute how to get data out of positionBuffer (ARRAY_BUFFER)\n  {\n    const size = 2;\n    const type = gl.FLOAT;\n    const normalize = false;\n    const stride = 0;\n    const offset = 0;\n    gl.vertexAttribPointer(\n      positionLocation,\n      size,\n      type,\n      normalize,\n      stride,\n      offset\n    );\n  }\n\n  // Turn on the texcoord attribute\n  gl.enableVertexAttribArray(texcoordLocation);\n\n  // bind the texcoord buffer.\n  gl.bindBuffer(gl.ARRAY_BUFFER, texcoordBuffer);\n\n  // Tell the texcoord attribute how to get data out of texcoordBuffer (ARRAY_BUFFER)\n  {\n    const size = 2;\n    const type = gl.FLOAT;\n    const normalize = false;\n    const stride = 0;\n    const offset = 0;\n    gl.vertexAttribPointer(\n      texcoordLocation,\n      size,\n      type,\n      normalize,\n      stride,\n      offset\n    );\n  }\n\n  // lookup uniforms\n  const resolutionLocation = gl.getUniformLocation(program, 'u_resolution');\n  // set the resolution\n  gl.uniform2f(resolutionLocation, gl.canvas.width, gl.canvas.height);\n\n  keyColorLoc = gl.getUniformLocation(program, 'keyColor');\n  similarityLoc = gl.getUniformLocation(program, 'similarity');\n  smoothnessLoc = gl.getUniformLocation(program, 'smoothness');\n  spillLoc = gl.getUniformLocation(program, 'spill');\n\n  // Draw the rectangle.\n  gl.drawArrays(gl.TRIANGLES, 0, 6);\n}\n\nfunction initVertexBuffers(program: any) {\n  const vertexBuffer = gl.createBuffer();\n  const vertexRectangle = new Float32Array([\n    1.0, 1.0, 0.0, -1.0, 1.0, 0.0, 1.0, -1.0, 0.0, -1.0, -1.0, 0.0,\n  ]);\n  gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);\n  gl.bufferData(gl.ARRAY_BUFFER, vertexRectangle, gl.STATIC_DRAW);\n\n  const vertexPositionAttribute = gl.getAttribLocation(\n    program,\n    'a_vertexPosition'\n  );\n  gl.vertexAttribPointer(vertexPositionAttribute, 3, gl.FLOAT, false, 0, 0);\n  gl.enableVertexAttribArray(vertexPositionAttribute);\n\n  const textureRectangle = new Float32Array([\n    1.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 1.0,\n  ]);\n  const textureBuffer = gl.createBuffer();\n  gl.bindBuffer(gl.ARRAY_BUFFER, textureBuffer);\n  gl.bufferData(gl.ARRAY_BUFFER, textureRectangle, gl.STATIC_DRAW);\n  const textureCoord = gl.getAttribLocation(program, 'a_texturePosition');\n  gl.vertexAttribPointer(textureCoord, 2, gl.FLOAT, false, 0, 0);\n  gl.enableVertexAttribArray(textureCoord);\n}\n\nasync function initWebGL_NV12(width: number, height: number) {\n  if (!getGl(width, height)) return;\n\n  gl.pixelStorei(gl.UNPACK_ALIGNMENT, 1);\n\n  const vs = createShader(gl.VERTEX_SHADER, n12_to_rgb_VertexShader);\n  const fs = createShader(gl.FRAGMENT_SHADER, n12_to_rgb_FragmentShader);\n  const program = createProgram(vs, fs);\n\n  initVertexBuffers(program);\n\n  gl.activeTexture(gl.TEXTURE0);\n  gl.y = createTexture();\n  gl.uniform1i(gl.getUniformLocation(program, 'tex_y'), 0);\n\n  gl.activeTexture(gl.TEXTURE1);\n  gl.uv = createTexture();\n  gl.uniform1i(gl.getUniformLocation(program, 'tex_uv'), 1);\n\n  keyColorLoc = gl.getUniformLocation(program, 'keyColor');\n  similarityLoc = gl.getUniformLocation(program, 'similarity');\n  smoothnessLoc = gl.getUniformLocation(program, 'smoothness');\n  spillLoc = gl.getUniformLocation(program, 'spill');\n}\n\nconst ArrayBufferViewValue = Object.getPrototypeOf(\n  Object.getPrototypeOf(new Uint8Array())\n).constructor;\n\nexport function render_rgb(width: number, height: number, data: any) {\n  gl.viewport(0, 0, width, height);\n\n  gl.bindTexture(gl.TEXTURE_2D, gl.y);\n\n  if (data instanceof ArrayBufferViewValue) {\n    gl.texImage2D(\n      gl.TEXTURE_2D,\n      0,\n      gl.RGBA,\n      width,\n      height,\n      0,\n      gl.RGBA,\n      gl.UNSIGNED_BYTE,\n      data\n    );\n  } else {\n    // HTMLVideoElement\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, data);\n  }\n\n  gl.uniform3f(keyColorLoc, keyColor.r, keyColor.g, keyColor.b);\n  gl.uniform1f(similarityLoc, similarity);\n  gl.uniform1f(smoothnessLoc, smoothness);\n  gl.uniform1f(spillLoc, spill);\n\n  gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n  gl.flush();\n  gl.finish();\n}\n\nfunction render_nv12(width: number, height: number, data: ArrayBuffer) {\n  const uvOffset = width * height;\n\n  const view = new Uint8Array(data);\n  gl.bindTexture(gl.TEXTURE_2D, gl.y);\n  gl.texImage2D(\n    gl.TEXTURE_2D,\n    0,\n    gl.LUMINANCE,\n    width,\n    height,\n    0,\n    gl.LUMINANCE,\n    gl.UNSIGNED_BYTE,\n    view.subarray(0, uvOffset)\n  );\n\n  gl.bindTexture(gl.TEXTURE_2D, gl.uv);\n  gl.texImage2D(\n    gl.TEXTURE_2D,\n    0,\n    gl.LUMINANCE_ALPHA,\n    width / 2,\n    height / 2,\n    0,\n    gl.LUMINANCE_ALPHA,\n    gl.UNSIGNED_BYTE,\n    view.subarray(uvOffset)\n  );\n\n  gl.uniform3f(keyColorLoc, keyColor.r, keyColor.g, keyColor.b);\n  gl.uniform1f(similarityLoc, similarity);\n  gl.uniform1f(smoothnessLoc, smoothness);\n  gl.uniform1f(spillLoc, spill);\n\n  gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n  gl.flush();\n  gl.finish();\n}\n\nfunction render_i420(width: number, height: number, data: ArrayBuffer) {\n  const view = new Uint8Array(data);\n\n  gl.activeTexture(gl.TEXTURE0);\n  gl.texImage2D(\n    gl.TEXTURE_2D,\n    0,\n    gl.LUMINANCE,\n    width,\n    height * 1.5,\n    0,\n    gl.LUMINANCE,\n    gl.UNSIGNED_BYTE,\n    view,\n    0\n  );\n\n  gl.uniform3f(keyColorLoc, keyColor.r, keyColor.g, keyColor.b);\n  gl.uniform1f(similarityLoc, similarity);\n  gl.uniform1f(smoothnessLoc, smoothness);\n  gl.uniform1f(spillLoc, spill);\n\n  gl.drawArrays(gl.TRIANGLES, 0, 6);\n  gl.flush();\n  gl.finish();\n}\n\nasync function transform(\n  frame: VideoFrame,\n  controller: TransformStreamDefaultController\n) {\n  // When called from RTCRtpScriptTransforms the frame is an RtcEncodedVideoFrame, which is before decoding.\n  // It looks like we should be able to use WebCodecs API to decode the RtcEncodedVideoFrame, but that isnt available\n  // on Safari yet...\n\n  if (\n    !gl ||\n    format !== frame.format ||\n    offscreenCanvas.width !== frame.codedWidth ||\n    offscreenCanvas.height !== frame.codedHeight\n  ) {\n    if (frame.format === 'NV12') {\n      initWebGL_NV12(frame.codedWidth, frame.codedHeight);\n    } else if (frame.format === 'I420') {\n      initWebGL_I420(frame.codedWidth, frame.codedHeight);\n    }\n    format = frame.format;\n\n    // avoid error below:\n    // Failed to execute 'allocationSize' on 'VideoFrame': Invalid visibleRect.\n    // Expected height to be a multiple of 2 in plane 1 for format NV12; was 749.\n    // Consider rounding visibleRect inward or outward to a sample boundary.\n    let height = 0;\n    if (frame.visibleRect) height = frame.visibleRect.height;\n    const roundedFrameHeight = height - (height % 2);\n    if (roundedFrameHeight !== height && frame.visibleRect) {\n      const rect = {\n        x: frame.visibleRect.x,\n        y: frame.visibleRect.y,\n        width: frame.visibleRect.width,\n        height: roundedFrameHeight,\n      };\n      visibleRect = rect;\n      buffer = new ArrayBuffer(frame.allocationSize({ rect: rect }));\n    } else {\n      visibleRect = frame.visibleRect;\n      buffer = new ArrayBuffer(frame.allocationSize({ rect: visibleRect }));\n    }\n    videoFrameBufferInit.codedWidth = frame.codedWidth;\n    videoFrameBufferInit.codedHeight = frame.codedHeight;\n  }\n\n  if (visibleRect) {\n    try {\n      await frame.copyTo(buffer, { rect: visibleRect });\n    } catch (error) {\n      return;\n    }\n\n    if (frame.format === 'NV12') {\n      render_nv12(visibleRect.width, visibleRect.height, buffer);\n    } else if (frame.format === 'I420') {\n      render_i420(visibleRect.width, visibleRect.height, buffer);\n    }\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n  videoFrameBufferInit.timestamp = frame.timestamp!;\n\n  const newFrame = new VideoFrame(gl.canvas, videoFrameBufferInit);\n\n  frame.close();\n  controller.enqueue(newFrame);\n}\n\nfunction handleTransform(\n  readable: ReadableStream<VideoFrame>,\n  writable: WritableStream<VideoFrame>\n) {\n  readable.pipeThrough(new TransformStream({ transform })).pipeTo(writable);\n}\n\nfunction isUnderJest(): boolean {\n  return (\n    typeof process !== 'undefined' &&\n    typeof process.env !== 'undefined' &&\n    typeof process.env.JEST_WORKER_ID !== 'undefined'\n  );\n}\n\nif (!isUnderJest() && typeof onmessage !== 'undefined') {\n  onmessage = async (event: MessageEvent<any>) => {\n    if (!event.data) return;\n\n    if (event.data.readable && event.data.writable) {\n      return handleTransform(event.data.readable, event.data.writable);\n    } else if (event.data.chromaKeyOptions) {\n      updateChromaKeyOptions(event.data.chromaKeyOptions);\n    }\n  };\n}\n\n// Handler for RTCRtpScriptTransforms.\nif (typeof self !== 'undefined' && (self as any).RTCTransformEvent) {\n  (self as any).onrtctransform = (event: any) => {\n    const transformer = event.transformer;\n    handleTransform(transformer.readable, transformer.writable);\n  };\n}\n","/// <reference types=\"dom-mediacapture-transform\" />\n\n/**\n * @module smwebsdk\n */\n\n/*\n * Copyright 2017-2020 Soul Machines Ltd. All Rights Reserved.\n */\n\nimport { Deferred } from './Deferred';\nimport { Features } from './Features';\nimport { SmEvent } from './SmEvent';\nimport { Logger, LogLevel } from './utils/Logger';\nimport { WebsocketResponse } from './websocket-message/index';\nimport { UserMedia } from './types/scene';\nimport { makeError } from './utils/make-error';\nimport { ConnectionStateTypes } from './enums/ConnectionStateTypes';\nimport { ConnectionState } from './ConnectionState';\nimport {\n  ChromaKeyOptions,\n  initWebGL_rgb_with_canvas,\n  render_rgb,\n  updateChromaKeyOptions,\n} from './dedicated-workers/chroma-key.worker';\n\n// Reexporting here to keep backwards compatibility\nexport { UserMedia } from './types/scene';\n\nexport interface MessageFunction {\n  (message: string): void;\n}\n\nexport interface WebsocketFunction {\n  (message: WebsocketResponse): void;\n}\n\nexport interface SessionFunction {\n  (\n    resumeRequested: boolean,\n    isResumedSession: boolean,\n    server: string,\n    sessionId: string\n  ): void;\n}\n\nexport interface ConnectionStateFunction {\n  (connectionState: ConnectionStateTypes): void;\n}\n\ninterface JwtResponse {\n  url: string;\n  jwt: string;\n}\n\ninterface ChangeUserMediaOp {\n  deferred: Deferred<any>;\n  microphone: boolean | undefined;\n  camera: boolean | undefined;\n}\n\ninterface RemoveListener {\n  target: any;\n  name: string;\n  callback: any;\n}\n\n/**\n *  Session class\n */\nexport class Session {\n  public videoMediaStream!: MediaStream | null;\n  private _videoElement: HTMLVideoElement;\n  private _chromaKeyedCanvas: HTMLCanvasElement | null = null;\n  private _videoElementStyleObserver: MutationObserver | null = null;\n  private _serverUri: string;\n  private _connectUserText: string;\n  private _accessToken: string;\n  private _peerConnection!: RTCPeerConnection;\n  private _localStream!: MediaStream | null;\n  private _remoteStream!: MediaStream | null;\n  // eslint-disable-next-line @typescript-eslint/ban-types\n  private _connectPendingRemoteStream: Function | null = null;\n  private _serverConnection!: WebSocket;\n  private _sessionId!: string;\n  private _resumeRequested = false;\n  private _isResumedSession = false;\n  private _outgoingQueue: any[] = [];\n\n  private _server!: string;\n  private _sceneId!: number;\n\n  private _controlUrl!: string;\n  private _controlConnection!: WebSocket;\n  private _controlOpen = false;\n  private _controlQueue: any[] = [];\n\n  private _chromaKeyOptions: ChromaKeyOptions | undefined = undefined;\n\n  private _audioOnly: boolean;\n  private _requestedUserMedia: UserMedia = UserMedia.None;\n  private _requiredUserMedia: UserMedia = UserMedia.None;\n\n  private _onConnected: SessionFunction = (\n    resumeRequested: boolean,\n    isResumedSession: boolean,\n    server: string,\n    sessionId: string\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\n  ) => {};\n  private _onClose: MessageFunction;\n  private _onMessage: WebsocketFunction;\n  private _onUserText: MessageFunction;\n  private _sessionError: MessageFunction;\n\n  private _pendingLog: string[] = [];\n\n  private _closed = false;\n\n  private _shouldLogToServer = false;\n\n  private _features: Features;\n\n  private _connectionState: ConnectionState;\n\n  private _logger: Logger;\n\n  // Duration that microphone mute is maintained by the web sdk after the persona has\n  // finished speaking.  Set to -1 to disable.  Default value is -1 (disabled) if not specified\n  // by server in 'established' message.\n  private _microphoneMuteDelay = -1;\n\n  private _changeUserMediaQueue: Array<ChangeUserMediaOp> =\n    new Array<ChangeUserMediaOp>();\n\n  private _onMicrophoneActive?: SmEvent;\n  private _onCameraActive?: SmEvent;\n\n  private _removeListeners: Array<RemoveListener> = new Array<RemoveListener>();\n\n  private _videoOptions: MediaTrackConstraints = {\n    frameRate: 10.0,\n    width: 640.0,\n    height: 480.0,\n    facingMode: 'user',\n  };\n\n  // TypeScript support to MediaTrackConstraints is not complete, thus using any here\n  private _audioOptions: Record<string, any> = {\n    noiseSuppression: false,\n    autoGainControl: false,\n    channelCount: 1,\n    sampleRate: 16000,\n    sampleSize: 16,\n    echoCancellation: true,\n  };\n\n  constructor(\n    videoElement: HTMLVideoElement,\n    serverUri: string,\n    connectUserText: string | undefined,\n    accessToken: string,\n    audioOnly: boolean,\n    requestedUserMedia: UserMedia,\n    requiredUserMedia: UserMedia,\n    echoCancellationEnabled: boolean,\n    logger: Logger,\n    connectionState: ConnectionState,\n    chromaKeyOptions?: ChromaKeyOptions\n  ) {\n    this._videoElement = videoElement;\n    this._serverUri = serverUri;\n    this._connectUserText = connectUserText || '';\n    this._accessToken = accessToken;\n    this._audioOnly = audioOnly;\n    this._audioOptions.echoCancellation = echoCancellationEnabled;\n    this._requiredUserMedia = requiredUserMedia;\n    this._requestedUserMedia = requestedUserMedia;\n    this._logger = logger;\n    this._chromaKeyOptions = chromaKeyOptions;\n\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\n    this._onClose = (reason: string) => {}; // owner specifies custom close method\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\n    this._onMessage = (message: WebsocketResponse) => {}; // owner specifies custom message handler\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\n    this._onUserText = (text: string) => {}; // owner specifies custom rtc user text message handler\n\n    this._sessionError = (error: string) => {\n      // owner can specify custom session error handler\n      this.log(`session error: ${error}`, 'error');\n    };\n\n    this._features = new Features();\n    this._connectionState = connectionState;\n  }\n\n  public setVideoElement(videoElement: HTMLVideoElement) {\n    if (videoElement === this._videoElement) {\n      return;\n    }\n    if (this._videoElement) {\n      this._videoElement.removeEventListener(\n        'loadeddata',\n        this.onVideoLoaded.bind(this)\n      );\n      this._removeListeners = this._removeListeners.filter(\n        (removeLister) => removeLister.target !== this._videoElement\n      );\n\n      if (videoElement) {\n        videoElement.srcObject = this._videoElement.srcObject;\n      }\n    }\n\n    this._videoElementStyleObserver?.disconnect();\n    this._videoElement = videoElement;\n    this.setupVideoElement();\n\n    if (this._chromaKeyOptions?.enabled) this.restoreChromaKeySettings();\n  }\n\n  private restoreChromaKeySettings() {\n    if (!this._videoElement) return;\n\n    // restore chromaKey settings\n    if (this._videoElement.srcObject) {\n      // Session must have been connected before if video element's srcObject was set.\n      // For browsers support insertableStreams and transferableStreams, the video element's\n      // srcObject was alreayd a stream has been chromaKeyd, so nothing more is needed.\n      if (\n        !(this.supportsInsertableStreams && this.supportsTransferableStreams) &&\n        this._chromaKeyedCanvas\n      ) {\n        // For browsers doesn't support insertableStreams and transferableStreams,\n        // chromaKeyedCanvas was created to display the chromaKeyed video, and the below\n        // needs to be done.\n\n        // Move chromaKeyedCanvas to the sibling position of the video element\n        this._chromaKeyedCanvas.parentElement?.removeChild(\n          this._chromaKeyedCanvas\n        );\n        this._videoElement.parentElement?.appendChild(this._chromaKeyedCanvas);\n        this.copyStyleFromVideoElementToCanvas();\n        this.hideVideoElement(this._videoElement);\n        this.observeAndCopyStyleChangesFromVideoElementToCanvas();\n\n        if ('requestVideoFrameCallback' in HTMLVideoElement.prototype) {\n          // For browsers support requestVideoFrameCallback, the callback needs\n          // to be called again on the new video element\n          this._videoElement.requestVideoFrameCallback(\n            this.processFrameForChromaKey.bind(this)\n          );\n        }\n        // Else for browsers doesn't support requestVideoFrameCallback,\n        // nothing more needs to be restored, because requestAnimationFrame\n        // has alread been called recursively with this._videoElement after\n        // session was connected.\n      }\n    } else if (this._remoteStream) {\n      // If video element's srcObject was not set, but remoteSteam has been set,\n      // the video element must be null when onConnectedSuccess() was called.\n      // so setup chromaKeyed video from scratch.\n      this.setupChromaKeyedVideo();\n    }\n    // Else session hasn't been connected, chromaKeyed video will be setup after session is connected.\n  }\n\n  get chromaKeyedCanvas(): HTMLCanvasElement | null {\n    return this._chromaKeyedCanvas;\n  }\n\n  set onConnected(sessionFunction: SessionFunction) {\n    this._onConnected = sessionFunction;\n  }\n\n  set onClose(closeFunction: MessageFunction) {\n    this._onClose = closeFunction;\n  }\n\n  set onMessage(messageFunction: WebsocketFunction) {\n    this._onMessage = messageFunction;\n  }\n\n  set onUserText(userTextFunction: MessageFunction) {\n    this._onUserText = userTextFunction;\n  }\n\n  /**\n   * @deprecated use Scene\n   */\n  set loggingEnabled(enable: boolean) {\n    this.log(\n      'loggingEnabled is deprecated and will be removed in a future version. Please use setLogging(boolean)',\n      'warn'\n    );\n\n    this._logger.enableLogging(enable);\n  }\n\n  /**\n   * @deprecated use Scene method\n   */\n  get loggingEnabled(): boolean {\n    return this._logger.isEnabled;\n  }\n\n  /**\n   * @deprecated use Scene method\n   */\n  public setMinLogLevel(level: LogLevel) {\n    this._logger.setMinLogLevel(level);\n  }\n\n  /**\n   * @deprecated use Scene method\n   */\n  public setLogging(enable: boolean) {\n    this._logger.enableLogging(enable);\n  }\n\n  public log(text: string, level: LogLevel = 'debug') {\n    if (this._logger.isEnabled) {\n      const now = new Date();\n      const msg = `smsdk: ${now.toISOString()}: ${text}`;\n\n      if (this._shouldLogToServer) {\n        this.logToServer(msg);\n      }\n      this._logger.log(level, msg);\n    }\n  }\n\n  private logToServer(msg: string) {\n    if (this.sessionId) {\n      this.sendlogMessage([msg]);\n    } else {\n      this._pendingLog.push(msg);\n    }\n  }\n\n  public sendlogMessage(textArray: string[]): void {\n    if (this._sessionId && textArray && textArray.length > 0) {\n      const payload: any = {\n        category: 'diagnostics',\n        kind: 'event',\n        name: 'log',\n        body: { name: 'browser', text: textArray },\n      };\n      this.sendMessage(payload);\n    }\n  }\n\n  public async connect(userText?: string): Promise<string | undefined | any> {\n    const deferred = new Deferred<any>();\n\n    this._closed = false;\n    if (userText) {\n      this._connectUserText = userText;\n    }\n\n    if (\n      this._serverUri &&\n      (this._serverUri.startsWith('ws:') || this._serverUri.startsWith('wss:'))\n    ) {\n      // A server uri has been specified, continue with the connection\n      // by acquiring user media (microphone/camera) as needed\n      this.selectUserMedia(\n        this._requestedUserMedia,\n        this._requiredUserMedia,\n        deferred,\n        this.getUserMediaSuccess.bind(this)\n      );\n      return deferred.promise;\n    }\n\n    // Attempt to use the implicit /api/jwt REST get url to aquire\n    // an access token from the server this site was served from\n    const xhr = new XMLHttpRequest();\n    xhr.open('GET', '/api/jwt' + window.location.search);\n    xhr.onreadystatechange = async (ev: Event) => {\n      if (xhr.readyState === XMLHttpRequest.DONE) {\n        if (xhr.status === 200) {\n          this.log(`JWT request returned: ${xhr.responseText}`);\n          const response = JSON.parse(xhr.responseText) as JwtResponse;\n          this._serverUri = response.url;\n          this._accessToken = response.jwt;\n\n          this.selectUserMedia(\n            this._requestedUserMedia,\n            this._requiredUserMedia,\n            deferred,\n            this.getUserMediaSuccess.bind(this)\n          );\n        } else {\n          this.log(`JWT Request failed, status: ${xhr.statusText}`, 'error');\n          deferred.reject(\n            makeError('Failed to acquire jwt at /api/jwt', 'noServer')\n          );\n        }\n      }\n    };\n\n    xhr.send();\n    return deferred.promise;\n  }\n\n  private webcamRequested(\n    requestedMedia: UserMedia,\n    requiredMedia: UserMedia\n  ): boolean {\n    return (\n      !this._audioOnly &&\n      [UserMedia.MicrophoneAndCamera, UserMedia.Camera].some((r) =>\n        [requestedMedia, requiredMedia].includes(r)\n      )\n    );\n  }\n\n  private micRequested(requestedMedia: UserMedia, requiredMedia: UserMedia) {\n    return [UserMedia.Microphone, UserMedia.MicrophoneAndCamera].some((r) =>\n      [requestedMedia, requiredMedia].includes(r)\n    );\n  }\n\n  public getMediaConstraints(\n    requestedMedia: UserMedia,\n    requiredMedia: UserMedia\n  ): MediaStreamConstraints {\n    // checking supported constraints only for debugging purpose, no need to use it when applying constraints\n    // as providing specific values for constraints, means they are a 'best effort' rather than required\n    // https://developer.mozilla.org/en-US/docs/Web/API/Media_Streams_API/Constraints#requesting_a_specific_value_for_a_setting\n\n    const supports = navigator.mediaDevices.getSupportedConstraints() as any;\n    this.log(`Browser supports media constraints: ${supports}`);\n\n    return {\n      audio: this.micRequested(requestedMedia, requiredMedia)\n        ? this.buildAudioOptions()\n        : false,\n      video: this.webcamRequested(requestedMedia, requiredMedia)\n        ? this._videoOptions\n        : false,\n    };\n  }\n\n  private buildAudioOptions() {\n    const supportedConstraints: Record<string, any> =\n      navigator.mediaDevices.getSupportedConstraints();\n    const constraints = { ...this._audioOptions };\n\n    // Remove unknown and unsupported constraints, as these were causing errors in the latest version on Safari\n    Object.keys(constraints).forEach((constraint) => {\n      if (!supportedConstraints[constraint]) {\n        delete constraints[constraint];\n      }\n    });\n\n    return constraints;\n  }\n\n  selectUserMedia(\n    requestedMedia: UserMedia,\n    requiredMedia: UserMedia,\n    deferred: Deferred<any>,\n    completion: (stream: MediaStream | null, deferred: Deferred<any>) => any\n  ) {\n    if (requestedMedia === UserMedia.None && requiredMedia === UserMedia.None) {\n      // no microphone or camera is required or requested\n      completion(null, deferred);\n      return;\n    }\n\n    if (navigator.mediaDevices.getUserMedia) {\n      const constraints = this.getMediaConstraints(\n        requestedMedia,\n        requiredMedia\n      );\n      this.log(`Best video constraints: ${constraints}`);\n\n      navigator.mediaDevices\n        .getUserMedia(constraints)\n        .then((stream) => {\n          completion(stream, deferred);\n        })\n        .catch((error: DOMException) => {\n          //fail when required media wasn't obtained\n          if (requiredMedia === requestedMedia) {\n            this.log(\n              `getUserMedia could not get required media, error given: ${error}`,\n              'error'\n            );\n\n            deferred.reject(this.MakeErrorForUserMedia(error));\n          }\n          //re-try required media fallback\n          else if (requiredMedia !== UserMedia.None) {\n            this.getUserMediaRequiredOnlyFallback(\n              requiredMedia,\n              deferred,\n              completion\n            );\n          }\n          //re-try mic only fallback\n          else if (requestedMedia === UserMedia.MicrophoneAndCamera) {\n            this.getUserMediaAudioOnlyFallback(deferred, completion);\n          }\n          //complete without a stream\n          else {\n            completion(null, deferred);\n          }\n        });\n    } else {\n      deferred.reject(\n        makeError(\n          'Your browser does not support getUserMedia API',\n          'notSupported'\n        )\n      );\n    }\n  }\n\n  private getUserMediaRequiredOnlyFallback(\n    requiredMedia: UserMedia,\n    deferred: Deferred<any>,\n    completion: (stream: MediaStream | null, deferred: Deferred<any>) => any\n  ) {\n    this.log('Retrying with required media only');\n    const constraints = this.getMediaConstraints(UserMedia.None, requiredMedia);\n    this.log(`Attempt constraints: ${constraints}`);\n    return navigator.mediaDevices\n      .getUserMedia(constraints)\n      .then((stream) => {\n        completion(stream, deferred);\n      })\n      .catch((error: DOMException) => {\n        this.log(\n          `getUserMedia could not get required media, error given: ${error}`,\n          'error'\n        );\n        //fail when required media wasn't obtained\n        deferred.reject(this.MakeErrorForUserMedia(error));\n      });\n  }\n\n  private getUserMediaAudioOnlyFallback(\n    deferred: Deferred<any>,\n    completion: (stream: MediaStream | null, deferred: Deferred<any>) => any\n  ) {\n    this.log('Retrying with microphone only');\n    const constraints = {\n      video: false,\n      audio: this.buildAudioOptions(),\n    };\n    this.log(`Attempt constraints: ${constraints}`);\n    return navigator.mediaDevices\n      .getUserMedia(constraints)\n      .then((stream) => {\n        completion(stream, deferred);\n      })\n      .catch((error: DOMException) => {\n        this.log(\n          `getUserMedia could not get microphone audio, error given: ${error}`,\n          'error'\n        );\n\n        // still succeed as fallback is only tried if media was required, not requested\n        completion(null, deferred);\n      });\n  }\n\n  private MakeErrorForUserMedia(error: DOMException): Error {\n    const name = 'noUserMedia';\n    // Returning more specific errors below is considered a breaking change which we\n    // cannot accommodate currently. This will be reinstated in the future, likely for v15\n    // At that time, the error codes in Scene.connect() and scene.setMediaDeviceActive() need re-documenting -\n    // see https://github.com/soulmachines/smwebsdk/blob/dfe3e1dc8d57aac17cb0be38fa2527190cd78ef4/src/Scene.ts#L916-L918\n\n    // if (error.name === 'NotAllowedError' || error.name === 'SecurityError') {\n    //   name = 'userMediaNotAllowed';\n    // } else if (\n    //   error.name === 'AbortError' ||\n    //   error.name === 'NotReadableError'\n    // ) {\n    //   name = 'userMediaFailed';\n    // }\n    return makeError(error.message, name);\n  }\n\n  private getUserMediaSuccess(\n    stream: MediaStream | null,\n    deferred: Deferred<any>\n  ): void {\n    this.log('Got user media');\n\n    this._localStream = stream;\n    this.microphoneMuted = true; // mute the local microphone until the DP is visible\n\n    // Connect to the session server\n\n    // To pass the Json Web Token (jwt) to the server when opening the websocket\n    // we basically have three options with the available javascript api:\n    // 1) pass as a 'access_token' query parameter similar to auth2 bearer tokens when not auth header\n    // 2) pass as basic auth user/pass embedded in the url\n    // 3) pass as a custom protocol which is translated into the 'Sec-WebSocket-Protocol' request header\n    //    more info here: https://stackoverflow.com/questions/4361173/http-headers-in-websockets-client-api\n    // We've gone with using a query parameter with ssl.\n\n    // create and connect the websocket\n    // Note that javscript websockets do not allow most request headers to be set.  The two exceptions\n    // are the Authorization header (via basic auth) and the protocol header - neither of which\n    // are ideal for our jwt token.  Hence instead we pass the jwt as a query parameter.\n    this.log(`connecting to: ${this._serverUri}`);\n    if (!this._accessToken) {\n      this._serverConnection = new WebSocket(this._serverUri);\n    } else {\n      this._serverConnection = new WebSocket(\n        this._serverUri + '?access_token=' + this._accessToken\n      );\n    }\n\n    this._serverConnection.onmessage = (msg: MessageEvent) => {\n      try {\n        this.gotMessageFromServer(msg, deferred);\n      } catch (e) {\n        this.log(\n          `unexpected exception processing received message: ${e}`,\n          'error'\n        );\n      }\n    };\n\n    this._serverConnection.onerror = (event) => {\n      if (deferred.isPending()) {\n        deferred.reject(\n          makeError('websocket failed', 'serverConnectionFailed')\n        );\n      }\n    };\n\n    // wait for the websocket to open, then continue with setup\n    this._serverConnection.onopen = (event: Event) => {\n      this.log('Websocket open');\n      // wait for the welcome 'established' message to receive the ice servers, hence nothing more to do here\n      // websocket open - searching for an available DP scene, may require queuing\n      this._connectionState.setConnectionState(\n        ConnectionStateTypes.SearchingForDigitalPerson\n      );\n    };\n\n    // setup a close handler\n    this._serverConnection.onclose = (event: CloseEvent) => {\n      this.log(\n        `websocket closed: code(${event.code}), reason(${event.reason}), clean(${event.wasClean})`\n      );\n      if (!deferred.isRejected) {\n        this.close(false, 'normal', deferred);\n      }\n    };\n  }\n\n  private hasTurnServer(iceServers: RTCIceServer[]): boolean {\n    // Check for at least one turn server by url in the array of ice servers\n    if (!iceServers) {\n      return false;\n    }\n\n    for (const server of iceServers) {\n      if (!server || !server.urls) {\n        continue;\n      }\n\n      for (const url of server.urls) {\n        if (url.indexOf('turn:') === 0) {\n          return true;\n        }\n      }\n    }\n\n    return false;\n  }\n\n  private gotMessageFromServer(\n    websocket_message: MessageEvent,\n    deferred?: Deferred<any>\n  ): void {\n    const raw_text = websocket_message.data;\n    this.log(`message received: ${raw_text}`);\n    const message = JSON.parse(raw_text);\n\n    const category = message.category;\n    const name = message.name;\n    const body = message.body;\n\n    if (category !== 'webrtc') {\n      // If there is a control connection then forward 'scene' messages to that\n      if (this._controlConnection !== null && category === 'scene') {\n        if (\n          this._controlOpen &&\n          this._serverConnection.readyState === WebSocket.OPEN\n        ) {\n          this._controlConnection.send(raw_text);\n        } else {\n          this._controlQueue.push(raw_text);\n        }\n      }\n\n      // forward on non-webrtc messages (e.g. scene)\n      this._onMessage(message);\n      return;\n    }\n\n    if (message.kind !== 'event') {\n      // currently ignore requests and responses\n      return;\n    }\n\n    if (name === 'established') {\n      // established - scene is available/found, downloading/preparing DP assets on the server\n      this._connectionState.setConnectionState(\n        ConnectionStateTypes.DownloadingAssets\n      );\n\n      // Create the peer connection configuration from the established body\n      // which includes the ice servers we should use\n      const config: RTCConfiguration = { iceServers: [] };\n      if (body.iceServers) {\n        config.iceServers = body.iceServers;\n\n        // If at least one ice server is a turn server then force\n        // our traffic to route over turn (relay)\n        if (this.hasTurnServer(body.iceServers)) {\n          this.log('Detected turn server, forcing relay mode');\n          config.iceTransportPolicy = 'relay';\n        }\n      }\n      this.log(`selected ice servers: ${config.iceServers}`);\n\n      if (\n        body.settings &&\n        typeof body.settings.microphoneMuteDelay === 'number'\n      ) {\n        this._microphoneMuteDelay = body.settings.microphoneMuteDelay;\n      }\n      this.log(\n        `microphone mute delay after persona speech: ${this._microphoneMuteDelay}`\n      );\n\n      // Send logging to server if requested by the server\n      this._shouldLogToServer = body.settings?.logToServer ?? false;\n\n      // Setup the WebRTC peer connection\n      this._peerConnection = new RTCPeerConnection(config);\n      // ref: Ice candidate will only trigger when media video is enabled in Safari\n      // https://stackoverflow.com/a/53914556\n      this._peerConnection.onicecandidate = this.gotIceCandidate.bind(this);\n      if ('ontrack' in this._peerConnection && !this._features.isEdge) {\n        // todo update when angular 7\n        // This doesnt work with angular yet because of old definitions\n        // this._peerConnection.ontrack = (event:RTCTrackEvent)=>{\n        (this._peerConnection as any).ontrack = (event: any) => {\n          if (event.track.kind === 'video' || event.track.kind === 'audio') {\n            if (\n              !this._remoteStream ||\n              (!this._audioOnly && event.track.kind === 'video')\n            ) {\n              this.onRemoteStream(event.streams[0]);\n            }\n          }\n        };\n\n        this.setupVideoElement();\n      } else {\n        // fallback to stream (for IE/Safari plugin)\n        // onaddstream is deprecated\n        // This feature has been removed from the Web standards.\n        // Though some browsers may still support it, it is in the process of being dropped.\n        // Writing like this to pass type checking as this isnt in current spec and therefore\n        // neither the type definitions\n        (this._peerConnection as any).onaddstream = (\n          // as any because MediaStreamEvent has been removed from lib.dom.d.ts\n          streamEvent: any\n        ) => {\n          this.onRemoteStream(streamEvent.stream);\n        };\n      }\n      this._peerConnection.oniceconnectionstatechange = (e) => {\n        // `this._peerConnection.iceConnectionState === 'disconnected'` is quite handy\n        this.log(\n          `ICE connection state: ${this._peerConnection.iceConnectionState}`\n        );\n        if (this._peerConnection.iceConnectionState === 'failed') {\n          makeError('ice connection failed', 'mediaStreamFailed');\n          if (deferred && deferred.isPending()) {\n            // Close the connection and reject the connect()\n            this._serverConnection.close();\n            if (\n              this._controlConnection &&\n              (this._controlConnection.readyState === WebSocket.OPEN ||\n                this._controlConnection.readyState === WebSocket.CONNECTING)\n            ) {\n              this._controlConnection.close();\n            }\n            deferred.reject(\n              makeError('ice connection failed', 'mediaStreamFailed')\n            );\n          }\n        }\n      };\n      this.log('adding local media stream if any');\n      if (this._localStream) {\n        if (!(this._peerConnection as any).addTrack) {\n          (this._peerConnection as any).addStream(this._localStream);\n          this.log('adding local media stream by stream');\n        } else {\n          try {\n            this.log('adding local media stream by track');\n            this._localStream.getTracks().forEach((track) => {\n              (this._peerConnection as any).addTrack(\n                track,\n                this._localStream as MediaStream\n              );\n            });\n          } catch (e) {\n            this.log(`error: ${e}`, 'error');\n          }\n        }\n      }\n\n      // Add an audio and video transceiver that are send and receive,\n      // regardless of whether the user microphone / camera is currently\n      // available.\n      this._peerConnection.addTransceiver('audio', { direction: 'sendrecv' });\n      this._peerConnection.addTransceiver('video', { direction: 'sendrecv' });\n\n      // create updateOffer if resumeSessionId exists\n      if (body.resumeSessionId) {\n        const offerOptions: any = {\n          voiceActivityDetection: false,\n          iceRestart: true,\n        };\n        this._sessionId = body.resumeSessionId;\n        this._isResumedSession = true;\n        this.log(\n          `established, trying to resume session with session_id = ${body.resumeSessionId}`\n        );\n        this.createOffer(this._peerConnection, offerOptions)\n          .then((sessionDescription: RTCSessionDescriptionInit) => {\n            this.createdDescription.bind(this);\n            this.createdDescription(sessionDescription, 'updateOffer');\n          })\n          .catch(this._sessionError.bind(this));\n      } else {\n        // Create a webrtc offer\n        const offerOptions: any = {\n          voiceActivityDetection: false,\n          iceRestart: false,\n        };\n        this._isResumedSession = false;\n        this.createOffer(this._peerConnection, offerOptions)\n          .then(this.createdDescription.bind(this))\n          .catch(this._sessionError.bind(this));\n      }\n    } else if (name === 'accepted') {\n      // accepted - DP is starting / forming webrtc connection\n      this._connectionState.setConnectionState(\n        ConnectionStateTypes.ConnectingToDigitalPerson\n      );\n\n      this.log(`accepted, session_id = ${body.sessionId}`);\n\n      this._sessionId = body.sessionId;\n      this._resumeRequested = body.resumeRequested;\n\n      this._server = body.server;\n      this._sceneId = body.sceneId;\n\n      // The session has been accepted, send any outgoing queued messages\n      for (let i = 0; i < this._outgoingQueue.length; i++) {\n        this._outgoingQueue[i].body.sessionId = this._sessionId;\n        this.sendMessage(this._outgoingQueue[i]);\n      }\n      this._outgoingQueue = [];\n\n      // Monitor for orientation change events to update the camera rotation\n      const callback = () => {\n        if (this) {\n          this.sendCameraRotation();\n        }\n      };\n      window.addEventListener('orientationchange', callback);\n      this._removeListeners.push({\n        target: window,\n        name: 'orientationchange',\n        callback: callback,\n      });\n\n      this.sendCameraRotation();\n      const view = document.defaultView || window;\n      const style = view.getComputedStyle(this._videoElement);\n      const video_width = parseInt(`${style.width}`, 10); // cs check changed frm this.videoElement\n      const video_height = parseInt(`${style.height}`, 10);\n      this.log(\n        `accepted, sending video width/height: ${video_width} / ${video_height}`\n      );\n      this.sendVideoBounds(video_width, video_height);\n\n      // Send all pending log messages\n      this.sendlogMessage(this._pendingLog);\n      this._pendingLog = [];\n\n      // Check whether the the server needs us to route control messages to the\n      // orchestration server.\n      if (body.controlUrl) {\n        this._controlUrl = body.controlUrl;\n        this._controlQueue = [];\n        this._controlOpen = false;\n        this._controlConnection = new WebSocket(\n          body.controlUrl + '?access_token=' + this._accessToken\n        );\n\n        this._controlConnection.onmessage = (msg: MessageEvent) => {\n          const raw_text = msg.data;\n          if (raw_text) {\n            // forward this message to the session server\n            if (this._serverConnection.readyState === WebSocket.OPEN) {\n              this._serverConnection.send(raw_text);\n            }\n          }\n        };\n        this._controlConnection.onerror = () => {\n          this.close(true, 'controlFailed', deferred);\n        };\n\n        // wait for the websocket to open, then continue with setup\n        this._controlConnection.onopen = (event: Event) => {\n          this.log('control websocket open');\n          if (!this._controlOpen) {\n            this._controlOpen = true;\n\n            // send any pending orchestration/control messages in the order they were received\n            for (let i = 0; i < this._controlQueue.length; i++) {\n              this.log(\n                `control websocket now open, forwarding queued message: ${this._controlQueue[i]}`\n              );\n              this._controlConnection.send(this._controlQueue[i]);\n            }\n\n            this._controlQueue = [];\n          }\n        };\n\n        // setup a close handler\n        this._controlConnection.onclose = (event: CloseEvent) => {\n          this.log(\n            `control closed: code(${event.code}), reason(${event.reason}), clean(${event.wasClean})`\n          );\n          this.close(true, 'controlDisconnected', deferred);\n        };\n      }\n    } else if (name === 'answer') {\n      this.log('set remote description');\n      this.log(JSON.stringify(body));\n\n      const sessionDescription: RTCSessionDescriptionInit = {\n        sdp: body.sdp,\n        type: 'answer',\n      };\n      this.setRemoteDescription(this._peerConnection, sessionDescription)\n        .then(() => {\n          // Currently there's nothing to do\n        })\n        .catch(this._sessionError.bind(this));\n    } else if (name === 'connected') {\n      if (this._remoteStream) {\n        // connected - DP is started and ready the webrtc session has connected\n        this._connectionState.setConnectionState(\n          ConnectionStateTypes.Connected\n        );\n        this.onConnectedSuccess();\n        if (deferred) {\n          deferred.resolve(body.sessionId);\n        }\n      } else {\n        this.log('Connected but no remote media stream available');\n        // The remote stream has not connected yet, give it more time to connect\n        this._connectPendingRemoteStream = () => {\n          this.onConnectedSuccess();\n          if (deferred) {\n            deferred.resolve(body.sessionId);\n          }\n        };\n      }\n    } else if (name === 'ice') {\n      this.log('add ice candidate');\n      let addCandidate: Promise<void> | undefined;\n      if (body.complete) {\n        if (this._features.isEdge) {\n          addCandidate = this._peerConnection.addIceCandidate(\n            new RTCIceCandidate({\n              candidate: '',\n              sdpMid: '',\n              sdpMLineIndex: 0,\n            })\n          );\n        }\n      } else {\n        const iceCandidate = new RTCIceCandidate({\n          candidate: body.candidate,\n          sdpMid: body.sdpMid,\n          sdpMLineIndex: body.sdpMLineIndex,\n        });\n        addCandidate = this._peerConnection.addIceCandidate(iceCandidate);\n      }\n      if (addCandidate) {\n        addCandidate.catch(this._sessionError.bind(this));\n      }\n    } else if (name === 'offer') {\n      // NB: For calls inbound to browser, currently not used\n      //     Perhaps we might use this for queueing to talk to an avatar?\n      this._sessionId = body.sessionId;\n\n      const sessionDescription: RTCSessionDescriptionInit = {\n        sdp: body.sdp,\n        type: 'offer',\n      };\n      this.setRemoteDescription(this._peerConnection, sessionDescription)\n        // Create an answer in response to the offer\n        .then(() => this.createAnswer(this._peerConnection))\n        .then(this.createdDescription.bind(this))\n        .catch(this._sessionError.bind(this));\n    } else if (name === 'userText') {\n      this.log(`rtc - user text message received: ${body.userText}`);\n      this._onUserText(body.userText);\n    } else if (name === 'close') {\n      this.close(false, body.reason, deferred);\n    }\n  }\n\n  private setupVideoElement() {\n    if (this._videoElement) {\n      // Attach a video loaded event so the server can be notified when the video is\n      // ready to start playing\n      this._videoElement.addEventListener(\n        'loadeddata',\n        this.onVideoLoaded.bind(this)\n      );\n      this._removeListeners.push({\n        target: this._videoElement,\n        name: 'loadeddata',\n        callback: this.onVideoLoaded,\n      });\n    }\n  }\n\n  private gotIceCandidate(event: RTCPeerConnectionIceEvent) {\n    if (event.candidate) {\n      this.log('got local ice candidate');\n      // Note we name each ice field as the IE/Safari plugin doesn't reflect these for json serialization\n      this.sendRtcEvent('ice', {\n        complete: false,\n        candidate: event.candidate.candidate,\n        sdpMid: event.candidate.sdpMid,\n        sdpMLineIndex: event.candidate.sdpMLineIndex,\n      });\n    } else {\n      this.log('end ice candidate');\n      // all ice candidates have been gathered, send an end of ice notification\n      this.sendRtcEvent('ice', {\n        complete: true,\n        candidate: '',\n        sdpMid: '',\n        sdpMLineIndex: 0,\n      });\n    }\n  }\n\n  private createdDescription(\n    description: RTCSessionDescriptionInit,\n    messageName = 'offer'\n  ) {\n    this.log('got description');\n\n    // Note we name each ice field as the IE/Safari plugin doesn't  reflect these for json serialization\n    const descriptionObj = { sdp: description.sdp, type: description.type };\n    this.log(JSON.stringify({ sdp: descriptionObj }));\n\n    this.setLocalDescription(this._peerConnection, description)\n      .then(() => {\n        // Note with the sdp offer information we also send the\n        // current video element width/height to remote end when\n        // setting up webrtc session so that it can send the best\n        // width/height\n        this.log('send sdp offer to server');\n\n        // Note we name each sdp field as the IE/Safari plugin doesn't  reflect these for json serialization\n        this.sendRtcEvent(messageName, {\n          sdp: this._peerConnection.localDescription\n            ? this._peerConnection.localDescription.sdp\n            : null,\n          type: this._peerConnection.localDescription\n            ? this._peerConnection.localDescription.type\n            : null,\n          user_text: this._connectUserText,\n          features: { videoStartedEvent: true },\n        });\n      })\n      .catch(this._sessionError.bind(this));\n  }\n\n  private onRemoteStream(stream: MediaStream | null) {\n    this.log('got remote stream');\n    this._remoteStream = stream;\n\n    this.log(\n      `ICE connection state: ${this._peerConnection.iceConnectionState}`\n    );\n    if (this._connectPendingRemoteStream) {\n      // A connect has been received however it has been paused while\n      // we waited for the remote stream - continue it now\n      this._connectPendingRemoteStream();\n      this._connectPendingRemoteStream = null;\n    }\n  }\n\n  private copyStyleFromVideoElementToCanvas() {\n    if (this._chromaKeyedCanvas && this._videoElement) {\n      const videoElementStyles = getComputedStyle(this._videoElement);\n      let cssText = videoElementStyles.cssText;\n      if (!cssText) {\n        cssText = Array.from(videoElementStyles).reduce(\n          (cssString: string, property: string) => {\n            let propertyValue: string;\n            if (property === 'display') {\n              // don't copy display:none style because video element is hidden on purpose\n              propertyValue = videoElementStyles\n                .getPropertyValue(property)\n                .replace('none', '');\n            } else {\n              propertyValue = videoElementStyles.getPropertyValue(property);\n            }\n            return `${cssString}${property}:${propertyValue};`;\n          },\n          ''\n        );\n        this._chromaKeyedCanvas.style.cssText = cssText;\n      }\n    }\n  }\n\n  private observeAndCopyStyleChangesFromVideoElementToCanvas() {\n    if (!this._videoElementStyleObserver) {\n      this._videoElementStyleObserver = new MutationObserver(\n        (mutationList, observer) => {\n          this.copyStyleFromVideoElementToCanvas();\n        }\n      );\n    }\n\n    this._videoElementStyleObserver.observe(this._videoElement, {\n      attributes: true,\n    });\n    this._videoElement.addEventListener(\n      'resize',\n      this.copyStyleFromVideoElementToCanvas.bind(this)\n    );\n  }\n\n  private processFrameForChromaKey(now: DOMHighResTimeStamp, metadata: any) {\n    if (this._chromaKeyedCanvas) {\n      this._chromaKeyedCanvas.width = metadata.width;\n      this._chromaKeyedCanvas.height = metadata.height;\n\n      render_rgb(\n        this._chromaKeyedCanvas.width,\n        this._chromaKeyedCanvas.height,\n        this._videoElement\n      );\n      this._videoElement.requestVideoFrameCallback(\n        this.processFrameForChromaKey.bind(this)\n      );\n    }\n  }\n\n  private onConnectedSuccess() {\n    this._onConnected(\n      this._resumeRequested,\n      this._isResumedSession,\n      this._server,\n      this.sessionId\n    );\n\n    if (this._chromaKeyOptions?.enabled && this._videoElement) {\n      this.setupChromaKeyedVideo();\n    } else if (this._videoElement) {\n      this._videoElement.srcObject = this._remoteStream;\n      this._videoElement.hidden = false;\n    }\n\n    const callback = async (event: RTCTrackEvent) => {\n      if (this._remoteStream) {\n        this._remoteStream.addTrack(event.track);\n      }\n    };\n    this._peerConnection.addEventListener('track', callback);\n    this._removeListeners.push({\n      target: this._peerConnection,\n      name: 'track',\n      callback: callback,\n    });\n\n    this.log('video enabled');\n\n    // Update the server of the current camera active state\n    this.sendUserCamera();\n\n    // Update the application of the current microphone & camera state\n    this._onMicrophoneActive?.call(this.isMicrophoneActive());\n    this._onCameraActive?.call(this.isCameraActive());\n  }\n\n  private hideVideoElement(videoElement: HTMLVideoElement) {\n    videoElement.hidden = true;\n    videoElement.style.display = 'none';\n  }\n\n  private setupChromaKeyedVideo() {\n    if (this._videoElement && this._chromaKeyOptions?.enabled) {\n      if (this.supportsInsertableStreams && this.supportsTransferableStreams) {\n        // For browsers that support insertable streams and transferable streams\n        // Chrome\n        this.setupTransferableStreamChromaKeyedVideo();\n      } else {\n        // For browsers that do not support insertable streams and transferable streams\n        this.setupChromaKeyedCanvas(this._chromaKeyOptions);\n\n        this._videoElement.srcObject = this._remoteStream;\n\n        if ('requestVideoFrameCallback' in HTMLVideoElement.prototype) {\n          // For browsers that support VideoElement::requestVideoFrameCallback()\n          // Firefox\n          this.setupRequestVideoFrameCallbackChromaKeyedVideo();\n        } else {\n          // For browsers that do not support VideoElement::requestVideoFrameCallback()\n          // Safari\n          this.setupRequestAnimationFrameChromaKeyedVideo();\n        }\n      }\n    }\n  }\n\n  private setupChromaKeyedCanvas(chromaKeyOptions: ChromaKeyOptions) {\n    this._chromaKeyedCanvas = document.createElement(\n      'canvas'\n    ) as HTMLCanvasElement;\n    this.copyStyleFromVideoElementToCanvas();\n    this._videoElement.parentElement?.appendChild(this._chromaKeyedCanvas);\n    this.hideVideoElement(this._videoElement);\n    this.observeAndCopyStyleChangesFromVideoElementToCanvas();\n\n    updateChromaKeyOptions(chromaKeyOptions);\n    initWebGL_rgb_with_canvas(this._chromaKeyedCanvas);\n  }\n\n  private setupTransferableStreamChromaKeyedVideo() {\n    const worker = new Worker('/dedicated-workers/chroma-key.worker.js', {\n      type: 'module',\n    });\n\n    worker.postMessage({ chromaKeyOptions: this._chromaKeyOptions });\n\n    if ((window as any).RTCRtpScriptTransform) {\n      // No use of script transform until WebCodecs api is further along\n      const transceiver = this._peerConnection.getTransceivers()[0];\n      (transceiver.receiver as any).transform = new (\n        window as any\n      ).RTCRtpScriptTransform(worker, { name: 'receiverTransform' });\n    } else {\n      const videoTrack = this.getTrackByKind(\n        this._remoteStream,\n        'video'\n      ) as MediaStreamVideoTrack;\n\n      const audioTrack = this.getTrackByKind(\n        this._remoteStream,\n        'audio'\n      ) as MediaStreamAudioTrack;\n\n      const processor = new MediaStreamTrackProcessor({\n        track: videoTrack,\n      });\n      const { readable } = processor;\n\n      const generator = new MediaStreamTrackGenerator({ kind: 'video' });\n      const { writable } = generator;\n\n      const mediaStream = new MediaStream([generator]);\n      mediaStream.addTrack(audioTrack);\n\n      if (this._videoElement) {\n        this._videoElement.srcObject = mediaStream;\n        this._videoElement.hidden = false;\n      } else {\n        this.videoMediaStream = mediaStream;\n        this.sendRtcEvent('videoStarted', {});\n      }\n\n      worker.postMessage(\n        {\n          readable,\n          writable,\n        },\n        [readable as any, writable]\n      );\n    }\n  }\n\n  private setupRequestVideoFrameCallbackChromaKeyedVideo() {\n    this._videoElement.requestVideoFrameCallback(\n      this.processFrameForChromaKey.bind(this)\n    );\n  }\n\n  private setupRequestAnimationFrameChromaKeyedVideo() {\n    const update = () => {\n      if (this._chromaKeyedCanvas) {\n        this._chromaKeyedCanvas.width = this._videoElement.videoWidth;\n        this._chromaKeyedCanvas.height = this._videoElement.videoHeight;\n\n        render_rgb(\n          this._chromaKeyedCanvas.width,\n          this._chromaKeyedCanvas.height,\n          this._videoElement\n        );\n        setTimeout(() => {\n          requestAnimationFrame(update);\n        }, 1000 / 30); // limit to 30fps because our webrtc stream is about 30fps\n      }\n    };\n    requestAnimationFrame(update);\n  }\n\n  private onVideoLoaded(e: Event) {\n    this.log('video has loaded');\n\n    const videoStarted = () => {\n      this.log('video has started playing');\n      this.sendRtcEvent('videoStarted', {});\n      this.microphoneMuted = false; // allow the user to speak now that the DP is visible\n    };\n\n    // If the video element isn't muted the videoStarted event can be sent immediately\n    if (!this._videoElement.muted) {\n      videoStarted();\n      return;\n    }\n\n    // The video element is muted, wait for it to be unmuted before declaring the video fully started\n    // there isn't an event for unmuted however volumechange apparently provides a\n    // fair alternative: https://stackoverflow.com/questions/25105414/html5-video-onmuted-and-onloop-event\n    const unmuteCallback = () => {\n      videoStarted();\n      this._videoElement.removeEventListener('volumechange', unmuteCallback);\n    };\n\n    this._videoElement.addEventListener('volumechange', unmuteCallback, false);\n  }\n\n  public sendRtcEvent(name: string, body: any) {\n    if (this._serverConnection === null) {\n      return;\n    }\n\n    if (this._sessionId) {\n      body.sessionId = this._sessionId;\n    }\n\n    const payload = { category: 'webrtc', kind: 'event', name, body };\n\n    if (this._sessionId || name === 'offer') {\n      this.sendMessage(payload);\n    } else {\n      // The session has not yet been accepted, queue the message until it is\n      this._outgoingQueue.push(payload);\n    }\n  }\n\n  public sendVideoBounds(width: number, height: number) {\n    this.sendRtcEvent('videoBounds', { width, height });\n  }\n\n  /**\n   * Sends updated user camera rotation to server\n   * this gives the app the chance to choose the required rotation of the user camera\n   * such that it matches the devices orientation.  Values can be 0, 90, 180, 270.\n   * @param rotation - The clockwise rotation in degrees of the user video feed (0, 90, 180 or 270)\n   * @internal\n   */\n  private sendUserCamera(rotation?: number) {\n    const body = { active: this.isCameraActive() } as Record<string, any>;\n    if (rotation !== undefined) {\n      body.rotation = rotation;\n    }\n    this.sendRtcEvent('userCamera', body);\n  }\n\n  private sendCameraRotation() {\n    if (this._features.isIos) {\n      const orientation = window.orientation;\n      this.log(\n        `send updated camera rotation, device orientation: ${orientation}`\n      );\n\n      // Compute the camera orientation for iOS, degrees to rotate the image to the right\n      // to give it a correct orientation relative to how the iOS device is held\n      let rotateCamera = 0;\n\n      // NB: iOS safari fixedCameraOrientation = -90; - iOS front camera orientation in terms of window orientation positions\n      if (orientation === 0) {\n        rotateCamera = 90;\n      } else if (orientation === 90) {\n        rotateCamera = 180;\n      } else if (orientation === 180) {\n        rotateCamera = 270;\n      } else if (orientation === -90) {\n        rotateCamera = 0;\n      }\n\n      this.sendUserCamera(rotateCamera);\n    }\n  }\n\n  public sendMessage(message: any): void {\n    if (!this._serverConnection) {\n      return;\n    }\n\n    if (this._serverConnection.readyState === WebSocket.OPEN) {\n      // connected\n      this._serverConnection.send(JSON.stringify(message));\n    } else {\n      this.log(`server connection not ready, discarding message: ${message}`);\n    }\n  }\n\n  public sendUserText(text: string) {\n    this.sendRtcEvent('userText', { userText: text });\n  }\n\n  private hasCamera(userMedia: UserMedia): boolean {\n    return (\n      userMedia === UserMedia.Camera ||\n      userMedia === UserMedia.MicrophoneAndCamera\n    );\n  }\n\n  private hasMicrophone(userMedia: UserMedia): boolean {\n    return (\n      userMedia === UserMedia.Microphone ||\n      userMedia === UserMedia.MicrophoneAndCamera\n    );\n  }\n\n  private makeUserMedia(microphone: boolean, webcam: boolean): UserMedia {\n    if (microphone && webcam) {\n      return UserMedia.MicrophoneAndCamera;\n    } else if (microphone) {\n      return UserMedia.Microphone;\n    } else if (webcam) {\n      return UserMedia.Camera;\n    }\n    return UserMedia.None;\n  }\n\n  private findSenderTrackByKind(kind: string): MediaStreamTrack | null {\n    if (!this._peerConnection) {\n      return null;\n    }\n\n    const senders = this._peerConnection.getSenders();\n    for (const sender of senders) {\n      if (sender.track && sender.track?.kind === kind) {\n        return sender.track;\n      }\n    }\n    return null;\n  }\n\n  private findSenderByKind(kind: string): RTCRtpSender | null {\n    if (!this._peerConnection) {\n      return null;\n    }\n\n    for (const transceiver of this._peerConnection.getTransceivers()) {\n      if (\n        transceiver.direction === 'sendrecv' &&\n        transceiver.receiver?.track?.kind === kind\n      ) {\n        return transceiver.sender;\n      }\n    }\n\n    for (const sender of this._peerConnection.getSenders()) {\n      if (sender.track === null || sender.track.kind === kind) {\n        return sender;\n      }\n    }\n\n    return null;\n  }\n\n  private async processChangeUserMediaQueue() {\n    let operation: ChangeUserMediaOp | undefined;\n\n    do {\n      operation =\n        this._changeUserMediaQueue.length > 0\n          ? this._changeUserMediaQueue[0]\n          : undefined;\n      if (operation) {\n        try {\n          const lastMicrophoneActive = this.isMicrophoneActive();\n          const lastCameraActive = this.isCameraActive();\n\n          // Change the media to that requested by the operation\n          await this.changeUserMediaInternal(\n            this.makeUserMedia(\n              operation.microphone ?? lastMicrophoneActive,\n              operation.camera ?? lastCameraActive\n            )\n          );\n\n          // Notify of any change of microphone state\n          if (\n            operation.microphone !== undefined &&\n            operation.microphone !== lastMicrophoneActive\n          ) {\n            this._onMicrophoneActive?.call(this.isMicrophoneActive());\n          }\n\n          // Notify of any change of camera state\n          if (\n            operation.camera !== undefined &&\n            operation.camera !== lastCameraActive\n          ) {\n            this._onCameraActive?.call(this.isCameraActive());\n          }\n\n          // The operation has completed successfully\n          operation.deferred.resolve();\n        } catch (e) {\n          operation.deferred.reject(e);\n        }\n\n        // Remove the operation as it's now finished\n        this._changeUserMediaQueue.shift();\n      }\n    } while (operation);\n  }\n\n  private async changeUserMediaInternal(\n    newUserMedia: UserMedia\n  ): Promise<void> {\n    const microphoneTrack = this.findSenderTrackByKind('audio');\n    const cameraTrack = this.findSenderTrackByKind('video');\n\n    // Find out if we need to upgrade the user media first (i.e. request a new microphone and/or camera track)\n    const needMicrophoneUpgrade =\n      this.hasMicrophone(newUserMedia) &&\n      (!microphoneTrack || microphoneTrack.readyState === 'ended');\n    const needCameraUpgrade =\n      this.hasCamera(newUserMedia) &&\n      (!cameraTrack || cameraTrack.readyState === 'ended');\n\n    let newMediaStream: MediaStream | null = null;\n\n    if (needMicrophoneUpgrade || needCameraUpgrade) {\n      // Either the microphone or camera is needed and not yet present,\n      // ensure we can get the required user media first\n      const requiredMedia = this.makeUserMedia(\n        needMicrophoneUpgrade,\n        needCameraUpgrade\n      );\n      const mediaDeferred = new Deferred<any>();\n\n      this.selectUserMedia(\n        requiredMedia,\n        requiredMedia,\n        mediaDeferred,\n        async (stream, deferred) => {\n          newMediaStream = stream;\n          deferred.resolve();\n        }\n      );\n\n      await mediaDeferred.promise;\n\n      if (!this._localStream) {\n        this._localStream = new MediaStream();\n      }\n    }\n\n    // Update the microphone track\n    await this.updateSenderTrack(\n      'audio',\n      this.hasMicrophone(newUserMedia),\n      newMediaStream\n    );\n\n    // Update the camera track\n    await this.updateSenderTrack(\n      'video',\n      this.hasCamera(newUserMedia),\n      newMediaStream\n    );\n\n    // Update the server of the current camera active state\n    this.sendUserCamera();\n  }\n\n  // Update the RTP sender / track to the given active state. If active then the newMediaStream must\n  // contain a track for the requested 'kind'\n  private async updateSenderTrack(\n    kind: 'audio' | 'video',\n    active: boolean,\n    newMediaStream: MediaStream | null\n  ): Promise<void> {\n    const sender = this.findSenderByKind(kind);\n    const track = sender?.track;\n\n    // Update the user media track\n    if (!!sender && (!track || active !== track.enabled)) {\n      this.log('new user ' + kind + ' active state = ' + active);\n      if (active) {\n        try {\n          if (track) {\n            this._localStream?.removeTrack(track);\n          }\n          if (newMediaStream) {\n            const newTrack = this.getTrackByKind(newMediaStream, kind);\n            if (newTrack) {\n              this._localStream?.addTrack(newTrack);\n              if (sender.track !== newTrack) {\n                this.log('replacing user ' + kind + ' track');\n                await sender.replaceTrack(newTrack);\n              }\n            }\n          }\n        } catch (e) {\n          this.log(`failed to get user ${kind} track, error: ${e}`, 'error');\n          throw makeError(\n            'failed to get user ' + kind + ': ' + e,\n            'failedUpgrade'\n          );\n        }\n      } else if (track) {\n        track.enabled = false;\n        track.stop();\n      }\n    }\n  }\n\n  private getTrackByKind(\n    stream: MediaStream | null,\n    kind: string\n  ): MediaStreamTrack | undefined {\n    if (stream) {\n      for (const track of stream.getTracks()) {\n        if (track.kind === kind) {\n          return track;\n        }\n      }\n    }\n    return undefined;\n  }\n\n  private isSenderTrackEnabled(kind: 'audio' | 'video'): boolean {\n    const track = this.findSenderTrackByKind(kind);\n    return Boolean(track?.enabled);\n  }\n\n  isMicrophoneActive(): boolean {\n    return this.isSenderTrackEnabled('audio');\n  }\n\n  isCameraActive(): boolean {\n    return this.isSenderTrackEnabled('video');\n  }\n\n  async setMediaDeviceActive({\n    microphone,\n    camera,\n  }: {\n    microphone?: boolean;\n    camera?: boolean;\n  }): Promise<void> {\n    // Queue changes to media so that we execute them one at a time to completion,\n    // this is particularly important when negotiating with the server to\n    // liven the new RTP sender\n    const deferred = new Deferred<any>();\n    this._changeUserMediaQueue.push({ microphone, camera, deferred });\n\n    if (this._changeUserMediaQueue.length === 1) {\n      this.processChangeUserMediaQueue();\n    }\n\n    return deferred.promise;\n  }\n\n  public close(\n    sendRtcClose = true,\n    reason = 'normal',\n    deferred?: Deferred<any>\n  ) {\n    if (this._closed) {\n      return;\n    }\n\n    this._closed = true;\n\n    if (this._peerConnection) {\n      try {\n        this._peerConnection.close();\n      } catch (e) {\n        this.log(`error: ${e}`, 'error');\n      }\n    }\n\n    if (this._localStream) {\n      try {\n        const tracks = this._localStream.getTracks();\n        for (const i in tracks) {\n          tracks[i].stop();\n        }\n      } catch (e) {\n        this.log(`error: ${e}`, 'error');\n      }\n    }\n\n    if (sendRtcClose) {\n      this.sendRtcEvent('close', { reason: 'normal' });\n    }\n\n    if (deferred) {\n      if (deferred.isResolved()) {\n        this._onClose(reason);\n      } else {\n        deferred.reject(makeError('websocket closed: ' + reason, reason));\n      }\n    }\n\n    if (this._serverConnection) {\n      this.log('closing server connection');\n      this._serverConnection.close();\n    }\n\n    if (this._controlConnection) {\n      this._controlConnection.close();\n    }\n\n    // Deregister event listeners\n    for (const listener of this._removeListeners) {\n      listener.target.removeEventListener(listener.name, listener.callback);\n    }\n  }\n\n  private createOffer(\n    peerConnection: RTCPeerConnection,\n    options: RTCOfferOptions\n  ) {\n    return peerConnection.createOffer(options);\n  }\n\n  private setRemoteDescription(\n    peerConnection: RTCPeerConnection,\n    sessionDescription: RTCSessionDescriptionInit\n  ) {\n    return peerConnection.setRemoteDescription(sessionDescription);\n  }\n\n  private setLocalDescription(\n    peerConnection: RTCPeerConnection,\n    description: RTCSessionDescriptionInit\n  ) {\n    return peerConnection.setLocalDescription(description);\n  }\n\n  private createAnswer(peerConnection: RTCPeerConnection) {\n    return peerConnection.createAnswer();\n  }\n\n  get peerConnection(): RTCPeerConnection | null {\n    return this._peerConnection;\n  }\n\n  get serverConnection(): WebSocket {\n    return this._serverConnection;\n  }\n\n  get sessionId(): string {\n    return this._sessionId;\n  }\n\n  get server(): string {\n    return this._server;\n  }\n\n  get sceneId(): number {\n    return this._sceneId;\n  }\n\n  get isMicrophoneConnected(): boolean {\n    return !!this.findSenderTrackByKind('audio');\n  }\n\n  get isCameraConnected(): boolean {\n    return !!this.findSenderTrackByKind('video');\n  }\n\n  get features(): Features {\n    return this._features;\n  }\n\n  get microphoneMuteDelay(): number {\n    return this._microphoneMuteDelay;\n  }\n\n  get userMediaStream(): MediaStream | null {\n    return this._localStream;\n  }\n\n  get microphoneMuted(): boolean {\n    if (!this._localStream) {\n      return true;\n    }\n    const audioTracks = this._localStream.getAudioTracks();\n    if (!audioTracks || audioTracks.length < 1) {\n      return true;\n    }\n\n    return !audioTracks[0].enabled;\n  }\n\n  set microphoneMuted(mute: boolean) {\n    if (!this._localStream) {\n      return;\n    }\n    const audioTracks = this._localStream.getAudioTracks();\n    if (!audioTracks || audioTracks.length < 1) {\n      return;\n    }\n    const audioSender = this.findSenderByKind('audio');\n    if (\n      audioSender?.track?.readyState === 'live' &&\n      audioSender.track === audioTracks[0]\n    ) {\n      const enable = !mute;\n      audioTracks[0].enabled = enable;\n      this.log(`microphone muted active notification: ${enable}`);\n      this._onMicrophoneActive?.call(enable);\n    }\n  }\n\n  get webcamMuted(): boolean {\n    if (!this._localStream) {\n      return true;\n    }\n    const videoTracks = this._localStream.getVideoTracks();\n    if (!videoTracks || videoTracks.length < 1) {\n      return true;\n    }\n\n    return !videoTracks[0].enabled;\n  }\n\n  set webcamMuted(mute: boolean) {\n    if (!this._localStream) {\n      return;\n    }\n    const videoTracks = this._localStream.getVideoTracks();\n    if (!videoTracks || videoTracks.length < 1) {\n      return;\n    }\n\n    const videoSender = this.findSenderByKind('video');\n    if (\n      videoSender?.track?.readyState === 'live' &&\n      videoSender.track === videoTracks[0]\n    ) {\n      const enable = !mute;\n      videoTracks[0].enabled = enable;\n      this._onCameraActive?.call(enable);\n    }\n  }\n\n  get offsetX(): number {\n    return 0;\n  }\n\n  get offsetY(): number {\n    return 0;\n  }\n\n  set microphoneActiveCallbacks(callbacks: SmEvent) {\n    this._onMicrophoneActive = callbacks;\n  }\n\n  set cameraActiveCallbacks(callbacks: SmEvent) {\n    this._onCameraActive = callbacks;\n  }\n\n  /**\n   * Checks if the browser supports WebRTC Encoded Transform, an alternative\n   * to insertable streams.\n   * @returns {boolean} {@code true} if the browser supports it.\n   */\n  get supportsEncodedTransform(): boolean {\n    return Boolean((window as any).RTCRtpScriptTransform);\n  }\n\n  /**\n   * Checks if the browser supports insertable streams.\n   * @returns {boolean} {@code true} if the browser supports insertable streams.\n   */\n  get supportsInsertableStreams() {\n    if (\n      !(\n        typeof window.RTCRtpSender !== 'undefined' &&\n        (window.RTCRtpSender.prototype as any).createEncodedStreams\n      )\n    ) {\n      return false;\n    }\n    return true;\n  }\n\n  /**\n   * Checks if the browser supports transferable streams.\n   * @returns {boolean} {@code true} if the browser supports transferable streams.\n   */\n  get supportsTransferableStreams() {\n    // Feature-detect transferable streams which we need to operate in a worker.\n    // See https://groups.google.com/a/chromium.org/g/blink-dev/c/1LStSgBt6AM/m/hj0odB8pCAAJ\n    const stream: any = new ReadableStream();\n\n    try {\n      window.postMessage(stream, '*', [stream]);\n      return true;\n    } catch {\n      return false;\n    }\n  }\n}\n","export enum WebsocketCategory {\n  Scene = 'scene',\n}\n","/**\n * @public\n */\nexport enum WebsocketKind {\n  Response = 'response',\n  Request = 'request',\n}\n","/*\n * Copyright 2019-2020 Soul Machines Ltd. All Rights Reserved.\n */\n\nexport enum SpeechState {\n  Idle = 'idle',\n  Animating = 'animating',\n  Speaking = 'speaking',\n}\n","/**\n * @module smwebsdk\n */\n\n/*\n * Copyright 2020 Soul Machines Ltd. All Rights Reserved.\n */\n\nimport { Deferred } from './Deferred';\nimport { Features } from './Features';\nimport { Logger, LogLevel } from './utils/Logger';\nimport { makeError } from './utils/make-error';\nimport { WebsocketResponse } from './websocket-message/index';\n\nexport interface MessageFunction {\n  (message: string): void;\n}\n\nexport interface WebsocketFunction {\n  (message: WebsocketResponse): void;\n}\n\nexport interface SessionFunction {\n  (\n    resumeRequested: boolean,\n    isResumedSession: boolean,\n    server: string,\n    sessionId: string\n  ): void;\n}\n\n/**\n *  WebSocketSession class\n */\nexport class WebSocketSession {\n  public videoMediaStream!: MediaStream | null;\n  private _serverUri: string;\n  private _accessToken: string;\n  private _serverConnection!: WebSocket;\n  private _sessionId!: string;\n  private _outgoingQueue: any[] = [];\n\n  private _onConnectedStorage: SessionFunction = (\n    resumeRequested: boolean,\n    isResumedSession: boolean,\n    server: string,\n    sessionId: string\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\n  ) => {};\n  private _onClose: MessageFunction;\n  private _onMessage: WebsocketFunction;\n  private _sessionError: MessageFunction;\n\n  private _features: Features;\n  private _pendingLog: string[] = [];\n  private _closed = false;\n\n  private _shouldLogToServer = false;\n\n  constructor(\n    serverUri: string,\n    accessToken: string,\n    private logger = new Logger()\n  ) {\n    this._serverUri = serverUri;\n    this._accessToken = accessToken;\n\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\n    this._onClose = (reason: string) => {}; // owner specifies custom close method\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\n    this._onMessage = (message: WebsocketResponse) => {}; // owner specifies custom message handler\n\n    this._sessionError = (error: string) => {\n      // owner can specify custom session error handler\n      this.logger.log('error', `session error: ${error}`);\n    };\n\n    this._features = new Features();\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-empty-function\n  setVideoElement(videoElement: HTMLVideoElement) {}\n\n  set onConnected(sessionFunction: SessionFunction) {\n    this._onConnectedStorage = sessionFunction;\n  }\n\n  set onClose(closeFunction: MessageFunction) {\n    this._onClose = closeFunction;\n  }\n\n  set onMessage(messageFunction: WebsocketFunction) {\n    this._onMessage = messageFunction;\n  }\n\n  /**\n   * @deprecated use setLogging(boolean).\n   */\n  set loggingEnabled(enable: boolean) {\n    this.logger.log(\n      'warn',\n      'loggingEnabled is deprecated and will be removed in a future version. Please use setLogging(boolean)'\n    );\n    this.logger.enableLogging(enable);\n  }\n\n  get loggingEnabled(): boolean {\n    return this.logger.isEnabled;\n  }\n\n  public setMinLogLevel(level: LogLevel) {\n    this.logger.setMinLogLevel(level);\n  }\n\n  public setLogging(enable: boolean) {\n    this.logger.enableLogging(enable);\n  }\n\n  public log(text: string) {\n    if (this.loggingEnabled) {\n      if (this._shouldLogToServer) {\n        this.logToServer(text);\n      } else {\n        this.logger.log('log', text);\n      }\n    }\n  }\n\n  private logToServer(text: string) {\n    if (this.sessionId) {\n      this.sendlogMessage([text]);\n    } else {\n      this._pendingLog.push(text);\n    }\n  }\n\n  public sendlogMessage(textArray: string[]): void {\n    if (this._sessionId && textArray && textArray.length > 0) {\n      const payload: any = {\n        category: 'diagnostics',\n        kind: 'event',\n        name: 'log',\n        body: { name: 'browser', text: textArray },\n      };\n      this.sendMessage(payload);\n    }\n  }\n\n  public async connect(): Promise<string | undefined> {\n    const deferred = new Deferred<any>();\n    this._closed = false;\n    if (\n      this._serverUri &&\n      (this._serverUri.startsWith('ws:') || this._serverUri.startsWith('wss:'))\n    ) {\n      // A server uri has been specified, continue with the connection\n      this.connectByWebSocket(deferred);\n    }\n    return deferred.promise;\n  }\n\n  private connectByWebSocket(deferred: Deferred<any>): void {\n    this.log(`connecting to: ${this._serverUri}`);\n    if (!this._accessToken) {\n      this._serverConnection = new WebSocket(this._serverUri);\n    } else {\n      this._serverConnection = new WebSocket(\n        this._serverUri + '?access_token=' + this._accessToken\n      );\n    }\n\n    this._serverConnection.onmessage = (msg: MessageEvent) => {\n      this.gotMessageFromServer(msg, deferred);\n    };\n\n    this._serverConnection.onerror = (event) => {\n      if (deferred.isPending()) {\n        deferred.reject(\n          makeError('websocket failed', 'serverConnectionFailed')\n        );\n      }\n    };\n\n    // wait for the websocket to open, then continue with setup\n    this._serverConnection.onopen = (event: Event) => {\n      this.log('websocket open');\n      deferred.resolve();\n    };\n\n    // setup a close handler\n    this._serverConnection.onclose = (event: CloseEvent) => {\n      this.log(\n        `websocket closed: code(${event.code}), reason(${event.reason}), clean(${event.wasClean})`\n      );\n      if (!deferred.isRejected) {\n        this.close(false, 'normal', deferred);\n      }\n    };\n  }\n\n  private gotMessageFromServer(\n    websocket_message: MessageEvent,\n    deferred?: Deferred<any>\n  ): void {\n    const raw_text = websocket_message.data;\n    this.log(`message received: ${raw_text}`);\n    const message = JSON.parse(raw_text);\n\n    const category = message.category;\n    const name = message.name;\n    const body = message.body;\n\n    if (category !== 'webrtc') {\n      // forward on non-webrtc messages (e.g. scene)\n      this._onMessage(message);\n      return;\n    }\n\n    if (message.kind !== 'event') {\n      // currently ignore requests and responses\n      return;\n    }\n\n    if (name === 'accepted') {\n      this.log(`accepted, session_id = ${body.sessionId}`);\n      this._sessionId = body.sessionId;\n\n      // The session has been accepted, send any outgoing queued messages\n      for (let i = 0; i < this._outgoingQueue.length; i++) {\n        this._outgoingQueue[i].body.sessionId = this._sessionId;\n        this.sendMessage(this._outgoingQueue[i]);\n      }\n      this._outgoingQueue = [];\n\n      // Send all pending log messages\n      this.sendlogMessage(this._pendingLog);\n      this._pendingLog = [];\n    } else if (name === 'close') {\n      this.close(false, body.reason, deferred);\n    }\n  }\n\n  public sendMessage(message: any): void {\n    if (!this._serverConnection) {\n      return;\n    }\n\n    if (this._serverConnection.readyState === WebSocket.OPEN) {\n      // connected\n      this._serverConnection.send(JSON.stringify(message));\n    } else {\n      this.log(`not ready, discarding message: ${message}`);\n    }\n  }\n\n  public close(\n    sendRtcClose = true,\n    reason = 'normal',\n    deferred?: Deferred<any>\n  ) {\n    if (this._closed) {\n      return;\n    }\n\n    this._closed = true;\n\n    if (deferred) {\n      if (deferred.isResolved()) {\n        this._onClose(reason);\n      } else {\n        deferred.reject(makeError('websocket closed: ' + reason, reason));\n      }\n    }\n\n    if (this._serverConnection) {\n      this.log('closing server connection');\n      this._serverConnection.close();\n    }\n  }\n\n  get serverConnection(): WebSocket {\n    return this._serverConnection;\n  }\n\n  get sessionId(): string {\n    return this._sessionId;\n  }\n\n  get peerConnection(): RTCPeerConnection | null {\n    return null;\n  }\n\n  get features(): Features {\n    return this._features;\n  }\n\n  public sendRtcEvent(name: string, body: any) {\n    // NOOP: Stuff for compatibility with Session in Scene\n  }\n\n  public sendVideoBounds(widthIgnored: number, heightIgnored: number) {\n    // NOOP: Stuff for compatibility with Session in Scene\n  }\n\n  public sendUserText(text: string): void {\n    this.logger.log('error', 'WebSocketSession discarding text: ' + text);\n  }\n\n  get microphoneMuteDelay(): number | undefined {\n    return undefined;\n  }\n\n  get microphoneMuted(): boolean | null {\n    return null;\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-empty-function\n  set microphoneMuted(mute: boolean | null) {}\n\n  // eslint-disable-next-line @typescript-eslint/no-empty-function\n  set onUserText(userTextFunction: MessageFunction) {}\n\n  get isMicrophoneConnected(): boolean | null {\n    return null;\n  }\n\n  get isCameraConnected(): boolean | null {\n    return null;\n  }\n\n  get offsetX(): number {\n    return 0;\n  }\n\n  get offsetY(): number {\n    return 0;\n  }\n\n  isMicrophoneActive(): boolean {\n    return false;\n  }\n\n  isCameraActive(): boolean {\n    return false;\n  }\n\n  async setMediaDeviceActive({\n    microphone,\n    camera,\n  }: {\n    microphone?: boolean;\n    camera?: boolean;\n  }): Promise<void> {\n    throw makeError(\n      'setMediaDeviceActive not supported on WebSocketSession',\n      'notSupported'\n    );\n  }\n}\n","var resizeObservers = [];\nexport { resizeObservers };\n","var ResizeObserverBoxOptions;\n(function (ResizeObserverBoxOptions) {\n    ResizeObserverBoxOptions[\"BORDER_BOX\"] = \"border-box\";\n    ResizeObserverBoxOptions[\"CONTENT_BOX\"] = \"content-box\";\n    ResizeObserverBoxOptions[\"DEVICE_PIXEL_CONTENT_BOX\"] = \"device-pixel-content-box\";\n})(ResizeObserverBoxOptions || (ResizeObserverBoxOptions = {}));\nexport { ResizeObserverBoxOptions };\n","var msg = 'ResizeObserver loop completed with undelivered notifications.';\nvar deliverResizeLoopError = function () {\n    var event;\n    if (typeof ErrorEvent === 'function') {\n        event = new ErrorEvent('error', {\n            message: msg\n        });\n    }\n    else {\n        event = document.createEvent('Event');\n        event.initEvent('error', false, false);\n        event.message = msg;\n    }\n    window.dispatchEvent(event);\n};\nexport { deliverResizeLoopError };\n","export var freeze = function (obj) { return Object.freeze(obj); };\n","var trigger;\nvar callbacks = [];\nvar notify = function () { return callbacks.splice(0).forEach(function (cb) { return cb(); }); };\nvar queueMicroTask = function (callback) {\n    if (!trigger) {\n        var toggle_1 = 0;\n        var el_1 = document.createTextNode('');\n        var config = { characterData: true };\n        new MutationObserver(function () { return notify(); }).observe(el_1, config);\n        trigger = function () { el_1.textContent = \"\".concat(toggle_1 ? toggle_1-- : toggle_1++); };\n    }\n    callbacks.push(callback);\n    trigger();\n};\nexport { queueMicroTask };\n","import { freeze } from './utils/freeze';\nvar ResizeObserverSize = (function () {\n    function ResizeObserverSize(inlineSize, blockSize) {\n        this.inlineSize = inlineSize;\n        this.blockSize = blockSize;\n        freeze(this);\n    }\n    return ResizeObserverSize;\n}());\nexport { ResizeObserverSize };\n","import { freeze } from './utils/freeze';\nvar DOMRectReadOnly = (function () {\n    function DOMRectReadOnly(x, y, width, height) {\n        this.x = x;\n        this.y = y;\n        this.width = width;\n        this.height = height;\n        this.top = this.y;\n        this.left = this.x;\n        this.bottom = this.top + this.height;\n        this.right = this.left + this.width;\n        return freeze(this);\n    }\n    DOMRectReadOnly.prototype.toJSON = function () {\n        var _a = this, x = _a.x, y = _a.y, top = _a.top, right = _a.right, bottom = _a.bottom, left = _a.left, width = _a.width, height = _a.height;\n        return { x: x, y: y, top: top, right: right, bottom: bottom, left: left, width: width, height: height };\n    };\n    DOMRectReadOnly.fromRect = function (rectangle) {\n        return new DOMRectReadOnly(rectangle.x, rectangle.y, rectangle.width, rectangle.height);\n    };\n    return DOMRectReadOnly;\n}());\nexport { DOMRectReadOnly };\n","var isSVG = function (target) { return target instanceof SVGElement && 'getBBox' in target; };\nvar isHidden = function (target) {\n    if (isSVG(target)) {\n        var _a = target.getBBox(), width = _a.width, height = _a.height;\n        return !width && !height;\n    }\n    var _b = target, offsetWidth = _b.offsetWidth, offsetHeight = _b.offsetHeight;\n    return !(offsetWidth || offsetHeight || target.getClientRects().length);\n};\nvar isElement = function (obj) {\n    var _a;\n    if (obj instanceof Element) {\n        return true;\n    }\n    var scope = (_a = obj === null || obj === void 0 ? void 0 : obj.ownerDocument) === null || _a === void 0 ? void 0 : _a.defaultView;\n    return !!(scope && obj instanceof scope.Element);\n};\nvar isReplacedElement = function (target) {\n    switch (target.tagName) {\n        case 'INPUT':\n            if (target.type !== 'image') {\n                break;\n            }\n        case 'VIDEO':\n        case 'AUDIO':\n        case 'EMBED':\n        case 'OBJECT':\n        case 'CANVAS':\n        case 'IFRAME':\n        case 'IMG':\n            return true;\n    }\n    return false;\n};\nexport { isSVG, isHidden, isElement, isReplacedElement };\n","export var global = typeof window !== 'undefined' ? window : {};\n","import { ResizeObserverBoxOptions } from '../ResizeObserverBoxOptions';\nimport { ResizeObserverSize } from '../ResizeObserverSize';\nimport { DOMRectReadOnly } from '../DOMRectReadOnly';\nimport { isSVG, isHidden } from '../utils/element';\nimport { freeze } from '../utils/freeze';\nimport { global } from '../utils/global';\nvar cache = new WeakMap();\nvar scrollRegexp = /auto|scroll/;\nvar verticalRegexp = /^tb|vertical/;\nvar IE = (/msie|trident/i).test(global.navigator && global.navigator.userAgent);\nvar parseDimension = function (pixel) { return parseFloat(pixel || '0'); };\nvar size = function (inlineSize, blockSize, switchSizes) {\n    if (inlineSize === void 0) { inlineSize = 0; }\n    if (blockSize === void 0) { blockSize = 0; }\n    if (switchSizes === void 0) { switchSizes = false; }\n    return new ResizeObserverSize((switchSizes ? blockSize : inlineSize) || 0, (switchSizes ? inlineSize : blockSize) || 0);\n};\nvar zeroBoxes = freeze({\n    devicePixelContentBoxSize: size(),\n    borderBoxSize: size(),\n    contentBoxSize: size(),\n    contentRect: new DOMRectReadOnly(0, 0, 0, 0)\n});\nvar calculateBoxSizes = function (target, forceRecalculation) {\n    if (forceRecalculation === void 0) { forceRecalculation = false; }\n    if (cache.has(target) && !forceRecalculation) {\n        return cache.get(target);\n    }\n    if (isHidden(target)) {\n        cache.set(target, zeroBoxes);\n        return zeroBoxes;\n    }\n    var cs = getComputedStyle(target);\n    var svg = isSVG(target) && target.ownerSVGElement && target.getBBox();\n    var removePadding = !IE && cs.boxSizing === 'border-box';\n    var switchSizes = verticalRegexp.test(cs.writingMode || '');\n    var canScrollVertically = !svg && scrollRegexp.test(cs.overflowY || '');\n    var canScrollHorizontally = !svg && scrollRegexp.test(cs.overflowX || '');\n    var paddingTop = svg ? 0 : parseDimension(cs.paddingTop);\n    var paddingRight = svg ? 0 : parseDimension(cs.paddingRight);\n    var paddingBottom = svg ? 0 : parseDimension(cs.paddingBottom);\n    var paddingLeft = svg ? 0 : parseDimension(cs.paddingLeft);\n    var borderTop = svg ? 0 : parseDimension(cs.borderTopWidth);\n    var borderRight = svg ? 0 : parseDimension(cs.borderRightWidth);\n    var borderBottom = svg ? 0 : parseDimension(cs.borderBottomWidth);\n    var borderLeft = svg ? 0 : parseDimension(cs.borderLeftWidth);\n    var horizontalPadding = paddingLeft + paddingRight;\n    var verticalPadding = paddingTop + paddingBottom;\n    var horizontalBorderArea = borderLeft + borderRight;\n    var verticalBorderArea = borderTop + borderBottom;\n    var horizontalScrollbarThickness = !canScrollHorizontally ? 0 : target.offsetHeight - verticalBorderArea - target.clientHeight;\n    var verticalScrollbarThickness = !canScrollVertically ? 0 : target.offsetWidth - horizontalBorderArea - target.clientWidth;\n    var widthReduction = removePadding ? horizontalPadding + horizontalBorderArea : 0;\n    var heightReduction = removePadding ? verticalPadding + verticalBorderArea : 0;\n    var contentWidth = svg ? svg.width : parseDimension(cs.width) - widthReduction - verticalScrollbarThickness;\n    var contentHeight = svg ? svg.height : parseDimension(cs.height) - heightReduction - horizontalScrollbarThickness;\n    var borderBoxWidth = contentWidth + horizontalPadding + verticalScrollbarThickness + horizontalBorderArea;\n    var borderBoxHeight = contentHeight + verticalPadding + horizontalScrollbarThickness + verticalBorderArea;\n    var boxes = freeze({\n        devicePixelContentBoxSize: size(Math.round(contentWidth * devicePixelRatio), Math.round(contentHeight * devicePixelRatio), switchSizes),\n        borderBoxSize: size(borderBoxWidth, borderBoxHeight, switchSizes),\n        contentBoxSize: size(contentWidth, contentHeight, switchSizes),\n        contentRect: new DOMRectReadOnly(paddingLeft, paddingTop, contentWidth, contentHeight)\n    });\n    cache.set(target, boxes);\n    return boxes;\n};\nvar calculateBoxSize = function (target, observedBox, forceRecalculation) {\n    var _a = calculateBoxSizes(target, forceRecalculation), borderBoxSize = _a.borderBoxSize, contentBoxSize = _a.contentBoxSize, devicePixelContentBoxSize = _a.devicePixelContentBoxSize;\n    switch (observedBox) {\n        case ResizeObserverBoxOptions.DEVICE_PIXEL_CONTENT_BOX:\n            return devicePixelContentBoxSize;\n        case ResizeObserverBoxOptions.BORDER_BOX:\n            return borderBoxSize;\n        default:\n            return contentBoxSize;\n    }\n};\nexport { calculateBoxSize, calculateBoxSizes };\n","import { calculateBoxSizes } from './algorithms/calculateBoxSize';\nimport { freeze } from './utils/freeze';\nvar ResizeObserverEntry = (function () {\n    function ResizeObserverEntry(target) {\n        var boxes = calculateBoxSizes(target);\n        this.target = target;\n        this.contentRect = boxes.contentRect;\n        this.borderBoxSize = freeze([boxes.borderBoxSize]);\n        this.contentBoxSize = freeze([boxes.contentBoxSize]);\n        this.devicePixelContentBoxSize = freeze([boxes.devicePixelContentBoxSize]);\n    }\n    return ResizeObserverEntry;\n}());\nexport { ResizeObserverEntry };\n","import { isHidden } from '../utils/element';\nvar calculateDepthForNode = function (node) {\n    if (isHidden(node)) {\n        return Infinity;\n    }\n    var depth = 0;\n    var parent = node.parentNode;\n    while (parent) {\n        depth += 1;\n        parent = parent.parentNode;\n    }\n    return depth;\n};\nexport { calculateDepthForNode };\n","import { resizeObservers } from '../utils/resizeObservers';\nimport { ResizeObserverEntry } from '../ResizeObserverEntry';\nimport { calculateDepthForNode } from './calculateDepthForNode';\nimport { calculateBoxSize } from './calculateBoxSize';\nvar broadcastActiveObservations = function () {\n    var shallowestDepth = Infinity;\n    var callbacks = [];\n    resizeObservers.forEach(function processObserver(ro) {\n        if (ro.activeTargets.length === 0) {\n            return;\n        }\n        var entries = [];\n        ro.activeTargets.forEach(function processTarget(ot) {\n            var entry = new ResizeObserverEntry(ot.target);\n            var targetDepth = calculateDepthForNode(ot.target);\n            entries.push(entry);\n            ot.lastReportedSize = calculateBoxSize(ot.target, ot.observedBox);\n            if (targetDepth < shallowestDepth) {\n                shallowestDepth = targetDepth;\n            }\n        });\n        callbacks.push(function resizeObserverCallback() {\n            ro.callback.call(ro.observer, entries, ro.observer);\n        });\n        ro.activeTargets.splice(0, ro.activeTargets.length);\n    });\n    for (var _i = 0, callbacks_1 = callbacks; _i < callbacks_1.length; _i++) {\n        var callback = callbacks_1[_i];\n        callback();\n    }\n    return shallowestDepth;\n};\nexport { broadcastActiveObservations };\n","import { resizeObservers } from '../utils/resizeObservers';\nimport { calculateDepthForNode } from './calculateDepthForNode';\nvar gatherActiveObservationsAtDepth = function (depth) {\n    resizeObservers.forEach(function processObserver(ro) {\n        ro.activeTargets.splice(0, ro.activeTargets.length);\n        ro.skippedTargets.splice(0, ro.skippedTargets.length);\n        ro.observationTargets.forEach(function processTarget(ot) {\n            if (ot.isActive()) {\n                if (calculateDepthForNode(ot.target) > depth) {\n                    ro.activeTargets.push(ot);\n                }\n                else {\n                    ro.skippedTargets.push(ot);\n                }\n            }\n        });\n    });\n};\nexport { gatherActiveObservationsAtDepth };\n","import { hasActiveObservations } from '../algorithms/hasActiveObservations';\nimport { hasSkippedObservations } from '../algorithms/hasSkippedObservations';\nimport { deliverResizeLoopError } from '../algorithms/deliverResizeLoopError';\nimport { broadcastActiveObservations } from '../algorithms/broadcastActiveObservations';\nimport { gatherActiveObservationsAtDepth } from '../algorithms/gatherActiveObservationsAtDepth';\nvar process = function () {\n    var depth = 0;\n    gatherActiveObservationsAtDepth(depth);\n    while (hasActiveObservations()) {\n        depth = broadcastActiveObservations();\n        gatherActiveObservationsAtDepth(depth);\n    }\n    if (hasSkippedObservations()) {\n        deliverResizeLoopError();\n    }\n    return depth > 0;\n};\nexport { process };\n","import { resizeObservers } from '../utils/resizeObservers';\nvar hasActiveObservations = function () {\n    return resizeObservers.some(function (ro) { return ro.activeTargets.length > 0; });\n};\nexport { hasActiveObservations };\n","import { resizeObservers } from '../utils/resizeObservers';\nvar hasSkippedObservations = function () {\n    return resizeObservers.some(function (ro) { return ro.skippedTargets.length > 0; });\n};\nexport { hasSkippedObservations };\n","import { process } from './process';\nimport { global } from './global';\nimport { queueResizeObserver } from './queueResizeObserver';\nvar watching = 0;\nvar isWatching = function () { return !!watching; };\nvar CATCH_PERIOD = 250;\nvar observerConfig = { attributes: true, characterData: true, childList: true, subtree: true };\nvar events = [\n    'resize',\n    'load',\n    'transitionend',\n    'animationend',\n    'animationstart',\n    'animationiteration',\n    'keyup',\n    'keydown',\n    'mouseup',\n    'mousedown',\n    'mouseover',\n    'mouseout',\n    'blur',\n    'focus'\n];\nvar time = function (timeout) {\n    if (timeout === void 0) { timeout = 0; }\n    return Date.now() + timeout;\n};\nvar scheduled = false;\nvar Scheduler = (function () {\n    function Scheduler() {\n        var _this = this;\n        this.stopped = true;\n        this.listener = function () { return _this.schedule(); };\n    }\n    Scheduler.prototype.run = function (timeout) {\n        var _this = this;\n        if (timeout === void 0) { timeout = CATCH_PERIOD; }\n        if (scheduled) {\n            return;\n        }\n        scheduled = true;\n        var until = time(timeout);\n        queueResizeObserver(function () {\n            var elementsHaveResized = false;\n            try {\n                elementsHaveResized = process();\n            }\n            finally {\n                scheduled = false;\n                timeout = until - time();\n                if (!isWatching()) {\n                    return;\n                }\n                if (elementsHaveResized) {\n                    _this.run(1000);\n                }\n                else if (timeout > 0) {\n                    _this.run(timeout);\n                }\n                else {\n                    _this.start();\n                }\n            }\n        });\n    };\n    Scheduler.prototype.schedule = function () {\n        this.stop();\n        this.run();\n    };\n    Scheduler.prototype.observe = function () {\n        var _this = this;\n        var cb = function () { return _this.observer && _this.observer.observe(document.body, observerConfig); };\n        document.body ? cb() : global.addEventListener('DOMContentLoaded', cb);\n    };\n    Scheduler.prototype.start = function () {\n        var _this = this;\n        if (this.stopped) {\n            this.stopped = false;\n            this.observer = new MutationObserver(this.listener);\n            this.observe();\n            events.forEach(function (name) { return global.addEventListener(name, _this.listener, true); });\n        }\n    };\n    Scheduler.prototype.stop = function () {\n        var _this = this;\n        if (!this.stopped) {\n            this.observer && this.observer.disconnect();\n            events.forEach(function (name) { return global.removeEventListener(name, _this.listener, true); });\n            this.stopped = true;\n        }\n    };\n    return Scheduler;\n}());\nvar scheduler = new Scheduler();\nvar updateCount = function (n) {\n    !watching && n > 0 && scheduler.start();\n    watching += n;\n    !watching && scheduler.stop();\n};\nexport { scheduler, updateCount };\n","import { queueMicroTask } from './queueMicroTask';\nvar queueResizeObserver = function (cb) {\n    queueMicroTask(function ResizeObserver() {\n        requestAnimationFrame(cb);\n    });\n};\nexport { queueResizeObserver };\n","import { ResizeObserverBoxOptions } from './ResizeObserverBoxOptions';\nimport { calculateBoxSize } from './algorithms/calculateBoxSize';\nimport { isSVG, isReplacedElement } from './utils/element';\nvar skipNotifyOnElement = function (target) {\n    return !isSVG(target)\n        && !isReplacedElement(target)\n        && getComputedStyle(target).display === 'inline';\n};\nvar ResizeObservation = (function () {\n    function ResizeObservation(target, observedBox) {\n        this.target = target;\n        this.observedBox = observedBox || ResizeObserverBoxOptions.CONTENT_BOX;\n        this.lastReportedSize = {\n            inlineSize: 0,\n            blockSize: 0\n        };\n    }\n    ResizeObservation.prototype.isActive = function () {\n        var size = calculateBoxSize(this.target, this.observedBox, true);\n        if (skipNotifyOnElement(this.target)) {\n            this.lastReportedSize = size;\n        }\n        if (this.lastReportedSize.inlineSize !== size.inlineSize\n            || this.lastReportedSize.blockSize !== size.blockSize) {\n            return true;\n        }\n        return false;\n    };\n    return ResizeObservation;\n}());\nexport { ResizeObservation };\n","var ResizeObserverDetail = (function () {\n    function ResizeObserverDetail(resizeObserver, callback) {\n        this.activeTargets = [];\n        this.skippedTargets = [];\n        this.observationTargets = [];\n        this.observer = resizeObserver;\n        this.callback = callback;\n    }\n    return ResizeObserverDetail;\n}());\nexport { ResizeObserverDetail };\n","import { scheduler, updateCount } from './utils/scheduler';\nimport { ResizeObservation } from './ResizeObservation';\nimport { ResizeObserverDetail } from './ResizeObserverDetail';\nimport { resizeObservers } from './utils/resizeObservers';\nvar observerMap = new WeakMap();\nvar getObservationIndex = function (observationTargets, target) {\n    for (var i = 0; i < observationTargets.length; i += 1) {\n        if (observationTargets[i].target === target) {\n            return i;\n        }\n    }\n    return -1;\n};\nvar ResizeObserverController = (function () {\n    function ResizeObserverController() {\n    }\n    ResizeObserverController.connect = function (resizeObserver, callback) {\n        var detail = new ResizeObserverDetail(resizeObserver, callback);\n        observerMap.set(resizeObserver, detail);\n    };\n    ResizeObserverController.observe = function (resizeObserver, target, options) {\n        var detail = observerMap.get(resizeObserver);\n        var firstObservation = detail.observationTargets.length === 0;\n        if (getObservationIndex(detail.observationTargets, target) < 0) {\n            firstObservation && resizeObservers.push(detail);\n            detail.observationTargets.push(new ResizeObservation(target, options && options.box));\n            updateCount(1);\n            scheduler.schedule();\n        }\n    };\n    ResizeObserverController.unobserve = function (resizeObserver, target) {\n        var detail = observerMap.get(resizeObserver);\n        var index = getObservationIndex(detail.observationTargets, target);\n        var lastObservation = detail.observationTargets.length === 1;\n        if (index >= 0) {\n            lastObservation && resizeObservers.splice(resizeObservers.indexOf(detail), 1);\n            detail.observationTargets.splice(index, 1);\n            updateCount(-1);\n        }\n    };\n    ResizeObserverController.disconnect = function (resizeObserver) {\n        var _this = this;\n        var detail = observerMap.get(resizeObserver);\n        detail.observationTargets.slice().forEach(function (ot) { return _this.unobserve(resizeObserver, ot.target); });\n        detail.activeTargets.splice(0, detail.activeTargets.length);\n    };\n    return ResizeObserverController;\n}());\nexport { ResizeObserverController };\n","import { ResizeObserverController } from './ResizeObserverController';\nimport { isElement } from './utils/element';\nvar ResizeObserver = (function () {\n    function ResizeObserver(callback) {\n        if (arguments.length === 0) {\n            throw new TypeError(\"Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.\");\n        }\n        if (typeof callback !== 'function') {\n            throw new TypeError(\"Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.\");\n        }\n        ResizeObserverController.connect(this, callback);\n    }\n    ResizeObserver.prototype.observe = function (target, options) {\n        if (arguments.length === 0) {\n            throw new TypeError(\"Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.\");\n        }\n        if (!isElement(target)) {\n            throw new TypeError(\"Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element\");\n        }\n        ResizeObserverController.observe(this, target, options);\n    };\n    ResizeObserver.prototype.unobserve = function (target) {\n        if (arguments.length === 0) {\n            throw new TypeError(\"Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.\");\n        }\n        if (!isElement(target)) {\n            throw new TypeError(\"Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element\");\n        }\n        ResizeObserverController.unobserve(this, target);\n    };\n    ResizeObserver.prototype.disconnect = function () {\n        ResizeObserverController.disconnect(this);\n    };\n    ResizeObserver.toString = function () {\n        return 'function ResizeObserver () { [polyfill code] }';\n    };\n    return ResizeObserver;\n}());\nexport { ResizeObserver };\n","const allImagesLoaded = () =>\n  Promise.all(\n    Array.from(document.images)\n      .filter((img) => !img.complete)\n      .map(\n        (img) =>\n          new Promise((resolve) => {\n            img.onload = resolve;\n            img.onerror = resolve;\n          })\n      )\n  );\n\nexport default allImagesLoaded;\n","export const debouncedFunction = (\n  fn: CallableFunction,\n  debounceTimeMs = 500\n): CallableFunction => {\n  let debounceTimerId = -1;\n\n  return () => {\n    if (debounceTimerId) {\n      clearTimeout(debounceTimerId);\n    }\n\n    debounceTimerId = setTimeout(\n      () => fn(),\n      debounceTimeMs\n    ) as unknown as number;\n  };\n};\n","/*\n * Copyright 2021 Soul Machines Ltd. All Rights Reserved.\n */\n\nimport { ResizeObserver } from '@juggle/resize-observer';\nimport { Scene } from './Scene';\nimport { ContentAwarenessObjectModel } from './models';\nimport { UpdateContentAwarenessRequestBody } from './websocket-message/scene';\nimport allImagesLoaded from './utils/allImagesLoaded';\nimport { debouncedFunction } from './utils/debounce';\nimport { Logger, LogLevel } from './utils/Logger';\n\n/**\n * ContentAwareness class\n *\n * An instance of this class is used to enable CUE behaviors in the digital human.\n * This is achived by measuring tagged HTML elements and sending their coordinates back to the server\n *\n * See documentation on GitHub for further reference on how to use this API\n * https://github.com/soulmachines/smwebsdk/blob/cue-content-awareness-api/guide/content-awareness.md\n *\n * @public\n */\nexport class ContentAwareness {\n  // Data Attribute Strings\n  private readonly VIDEO_FRAME_STR = 'data-sm-video';\n  private readonly VIDEO_FRAME_STR_BRACKETED = `[${this.VIDEO_FRAME_STR}]`;\n  private readonly CONTENT_STR = 'data-sm-content';\n  private readonly CONTENT_STR_BRACKETED = `[${this.CONTENT_STR}]`;\n  private readonly CUE_ATTRIBUTES = [this.VIDEO_FRAME_STR, this.CONTENT_STR];\n  private readonly CUE_ATTRIBUTES_BRACKETED = [\n    this.VIDEO_FRAME_STR_BRACKETED,\n    this.CONTENT_STR_BRACKETED,\n  ].join();\n  private readonly RESIZE_OBSERVER_BOX_OPTIONS = 'border-box';\n\n  // Observers\n  private mutationObserver: MutationObserver;\n  public resizeObserver: ResizeObserver;\n\n  private callMeasure = false;\n\n  public contentCollection: Record<string, Element> = {};\n  public videoFrame: Element | null = null;\n\n  // Callbacks\n  public debouncedMeasure: CallableFunction;\n\n  constructor(\n    private scene: Scene,\n    public debounceTime = 300,\n    private logger = new Logger()\n  ) {\n    this.debouncedMeasure = debouncedFunction(\n      () => this.measureInternal(),\n      debounceTime\n    );\n\n    this.resizeObserver = new ResizeObserver(() => this.measureDebounced());\n    this.getInitialElements();\n    this.mutationObserver = new MutationObserver((mutations) =>\n      this.mutationCallback(mutations)\n    );\n    this.setupEventListeners();\n    this.observeMutations();\n    this.measureInternal();\n  }\n\n  /**\n   * Check if the content awareness logging is enabled.\n   *\n   * @returns Returns true if the content awareness logging is enabled otherwise false.\n   */\n  public isLoggingEnabled(): boolean {\n    return this.logger.isEnabled;\n  }\n\n  /**\n   * Enable/disable content awareness logging\n   * @param enable - set true to enable content awareness log, false to disable\n   */\n  public setLogging(enable: boolean) {\n    this.logger.enableLogging(enable);\n  }\n\n  /**\n   * Check minimal log level of content awareness.\n   *\n   * @returns Returns minimal log setting of content awareness, type is LogLevel.\n   */\n  public getMinLogLevel() {\n    return this.logger.getMinLogLevel();\n  }\n\n  /**\n   * Set minimal log level of  content awareness logging.\n   * @param level - use LogLevel type to set minimal log level of  content awareness logging\n   */\n  public setMinLogLevel(level: LogLevel) {\n    this.logger.setMinLogLevel(level);\n  }\n\n  public setupEventListeners() {\n    window.addEventListener('resize', () => this.measureDebounced());\n  }\n\n  /**\n   * Get initial elements, future elements will be added via mutation observer\n   */\n  private getInitialElements() {\n    const videoEl = document.querySelector(this.VIDEO_FRAME_STR_BRACKETED);\n    const contentElements = document.querySelectorAll(\n      this.CONTENT_STR_BRACKETED\n    );\n\n    this.trackVideoElement(videoEl);\n\n    Array.from(contentElements).map((element) =>\n      this.trackContentElement(element)\n    );\n  }\n\n  /**\n   * Start watching for changes in the DOM that are relevant to\n   * ContentAwareness object tracking.\n   * @returns The ContentAwareness MutationObserver used for all content\n   */\n  private observeMutations() {\n    const watchNode: Node = document.documentElement || document.body; // Target node of DOM to watch\n\n    this.mutationObserver.observe(watchNode, {\n      attributeFilter: this.CUE_ATTRIBUTES, // Restrict monitoring to these attributes.\n      attributeOldValue: true, // Stores old value\n      childList: true, // Trigger on addition / removal of child elements\n      subtree: true, // Monitor elements in child directories\n    });\n  }\n\n  /**\n   * Publicly accessible function to disconnect observers and event listeners\n   */\n  public disconnect(): void {\n    // Disconnect observers\n    this.mutationObserver.disconnect();\n    this.resizeObserver.disconnect();\n\n    // Remove event listeners\n    window.removeEventListener('resize', () => this.measureDebounced());\n\n    // Reset scene\n    this.scene.contentAwareness = undefined;\n  }\n\n  /**\n   * Publicly accessible function to reconnect observers and event listeners\n   */\n  public reconnect(): void {\n    // Restore the link between scene and ca\n    this.scene.contentAwareness = this;\n\n    this.observeMutations();\n\n    this.setupEventListeners();\n\n    this.measure();\n  }\n\n  /**\n   * Publicly accessible function to trigger measurement of CUE-relevant elements in the DOM\n   * and send an updateContentAwareness message\n   */\n  public measure(): void {\n    this.measureInternal();\n  }\n\n  public measureDebounced() {\n    this.debouncedMeasure();\n  }\n\n  /**\n   * measures data-sm-video and data-sm-content HTML Elements\n   *\n   * This is automatically called in simple scenarios but can be manually called\n   * if the dev knows an important element has changed\n   *\n   * See documentation on GitHub for further reference on how to use this API\n   * https://github.com/soulmachines/smwebsdk/blob/cue-content-awareness-api/guide/content-awareness.md\n   *\n   * Console logs the sent message on success or an error on failure\n   */\n  private measureInternal(): void {\n    if (!this.scene.isConnected()) {\n      this.logger.log(\n        'error',\n        'ContentAwareness: Scene does not exist or is not connected yet'\n      );\n\n      return;\n    }\n\n    const windowSize = this.measureWindow();\n    const videoFrame = this.measureVideoFrame();\n    const contentCollection = this.measureContent();\n\n    if (windowSize && videoFrame && contentCollection) {\n      const contentAwarenessMessage = this.buildUpdateContentAwarenessRequest(\n        windowSize.innerWidth,\n        windowSize.innerHeight,\n        videoFrame,\n        contentCollection\n      );\n\n      this.scene.sendRequest('updateContentAwareness', contentAwarenessMessage);\n    }\n  }\n\n  /**\n   * measure elements tagged with data-videoFrame\n   * @returns a ContentAwarenessObjectModel filled with\n   * videoFrame coordinates on success. returns null on failure\n   */\n  private measureVideoFrame(): ContentAwarenessObjectModel | null {\n    if (!this.videoFrame) {\n      this.logger.log(\n        'warn',\n        'ContentAwareness: Unable to find a video element'\n      );\n      return null;\n    }\n\n    const videoRect = this.videoFrame.getBoundingClientRect();\n\n    if (this.invalidDimensions(videoRect)) {\n      this.logger.log(\n        'warn',\n        'ContentAwareness: Video has a zero width and height'\n      );\n      return null;\n    }\n\n    return {\n      x1: Math.round(videoRect.left),\n      x2: Math.round(videoRect.right),\n      y1: Math.round(videoRect.top),\n      y2: Math.round(videoRect.bottom),\n    };\n  }\n\n  /**\n   * measure elements tagged with data-content\n   * @returns a ContentAwarenessObjectModel array filled with the coordinates and\n   * ids of content tagged with the data-sm-content attribute\n   */\n  private measureContent() {\n    const validContent: ContentAwarenessObjectModel[] = [];\n\n    Object.keys(this.contentCollection).map((key) => {\n      const contentElement = this.contentCollection[key];\n      const contentRect = contentElement.getBoundingClientRect();\n\n      if (this.invalidDimensions(contentRect)) {\n        this.logger.log(\n          'warn',\n          `ContentAwareness: Element '${key}' has a zero width and height`\n        );\n      }\n\n      if (this.invalidContent(contentRect)) {\n        this.logger.log(\n          'warn',\n          `ContentAwareness: Element '${key}' is not being tracked`\n        );\n        // Remove id from content collection but keep observers incase it changes\n        delete this.contentCollection[key];\n        return;\n      }\n\n      validContent.push({\n        id: key,\n        x1: Math.round(contentRect.left),\n        x2: Math.round(contentRect.right),\n        y1: Math.round(contentRect.top),\n        y2: Math.round(contentRect.bottom),\n      });\n    });\n\n    return validContent;\n  }\n\n  /**\n   * Preliminary indication of if content dimensions are valid or not.\n   * Checks if the length and height are zero\n   * @param contentRect - the DOMRect to check\n   * @returns a bool indicating validity\n   */\n  private invalidDimensions(contentRect: DOMRect): boolean {\n    return contentRect.width === 0 && contentRect.height === 0;\n  }\n\n  /**\n   * Preliminary indication of if content is valid or not.\n   * Checks if the coordinates are non zero\n   * @param contentRect - the DOMRect to check\n   * @returns a bool indicating validity\n   */\n  private invalidContent(contentRect: DOMRect): boolean {\n    return (\n      contentRect.top === 0 &&\n      contentRect.bottom === 0 &&\n      contentRect.right === 0 &&\n      contentRect.left === 0\n    );\n  }\n\n  /**\n   * measure the browser window\n   * @returns an object containing the window height (innerHeight) and window width (innerWidth)\n   */\n  private measureWindow(): { innerHeight: number; innerWidth: number } {\n    return {\n      innerHeight: Math.round(window.innerHeight),\n      innerWidth: Math.round(window.innerWidth),\n    };\n  }\n\n  /**\n   * Builds the required UpdateContentAwareness message that gets sent to the server\n   *\n   * @param viewWidth - the width of the browser window\n   * @param viewHeight - the height of the browser window\n   * @param videoFrame - an object containing the coordinates of the video element in which the persona exists\n   * @param content - an array of objects containing the coordinates of the content elements the persona should be aware of\n   * @returns - UpdateContentAwarenessRequestBody the message body to send\n   *\n   * The return value from this function should be passed to\n   * scene.sendRequest('updateContentAwareness', body)\n   */\n  public buildUpdateContentAwarenessRequest(\n    viewWidth: number,\n    viewHeight: number,\n    videoFrame: ContentAwarenessObjectModel,\n    content: Array<ContentAwarenessObjectModel>\n  ): UpdateContentAwarenessRequestBody {\n    return {\n      viewWidth,\n      viewHeight,\n      videoFrame,\n      content,\n    };\n  }\n\n  private trackVideoElement(element: Element | null) {\n    if (!element) {\n      return;\n    }\n    if (this.videoFrame) {\n      this.logger.log(\n        'warn',\n        'ContentAwareness: Already observing a video element, switching to new video element'\n      );\n\n      this.untrackVideoElement(this.videoFrame);\n    }\n\n    this.videoFrame = element;\n    this.resizeObserver.observe(this.videoFrame, {\n      box: this.RESIZE_OBSERVER_BOX_OPTIONS,\n    });\n  }\n\n  private trackContentElement(element: Element): boolean {\n    const id = element.getAttribute(this.CONTENT_STR);\n    if (id) {\n      this.contentCollection[id] = element;\n      this.resizeObserver.observe(element, {\n        box: this.RESIZE_OBSERVER_BOX_OPTIONS,\n      });\n      return true;\n    }\n    return false;\n  }\n\n  private untrackContentElement(element: Element) {\n    const id = element.getAttribute(this.CONTENT_STR) as string;\n    const trackedElement = this.contentCollection[id];\n\n    // only untrack the element if the element we have stored\n    // against that id is the same one being requested for removal.\n    // this allows for showing/hiding of elements that use the same id.\n    if (element === trackedElement) {\n      delete this.contentCollection[id];\n      this.resizeObserver.unobserve(element);\n    }\n  }\n\n  private untrackVideoElement(element: Element) {\n    // Only clear the videoFrame element if its the same as the currently track video element.\n    // A mismatch can occur when adding/removing different video elements. If a new video element appears we'll switch and track that.\n    // If the remove event occurs after the switch we'll ignore it, as we don't want to untrack the newly added element\n    if (element === this.videoFrame) {\n      this.videoFrame = null;\n    }\n\n    // Always unobserve the removed element\n    this.resizeObserver.unobserve(element);\n  }\n\n  /**\n   * Takes an array of MutationRecords and measures the ones marked with content awareness attributes\n   * @param mutations - an array of MutationRecords to check and measure\n   */\n  public mutationCallback(mutations: readonly MutationRecord[]): void {\n    let imagesAdded = false;\n    this.callMeasure = false; // reset callMeasure\n\n    for (let i = 0; i < mutations.length; ++i) {\n      switch (mutations[i].type) {\n        case 'childList': {\n          if (mutations[i].target.nodeType !== Node.ELEMENT_NODE) {\n            break;\n          }\n\n          this.untrackRemovedNodeWithCUE(mutations[i].removedNodes); // Unobserve and stop tracking removed elements\n          this.trackAddedNodeWithCUE(mutations[i].addedNodes); // Start tracking elements added elements\n\n          for (let j = 0; j < mutations[i].addedNodes.length; j++) {\n            try {\n              const element = mutations[i].addedNodes[j] as Element;\n\n              if (!element.hasAttribute) {\n                // node is not an element, do not continue processing it\n                continue;\n              }\n\n              const isImage = element.tagName === 'IMG';\n              const containsImages = !!element.querySelector('img');\n\n              imagesAdded = isImage || containsImages;\n              if (imagesAdded) {\n                break;\n              }\n            } catch (err) {\n              this.logger.log(\n                'warn',\n                'ContentAwareness: Failed to track non-element node',\n                mutations[i].addedNodes[j]\n              );\n            }\n          }\n          break;\n        }\n        case 'attributes': {\n          if (mutations[i].target.nodeType !== Node.ELEMENT_NODE) {\n            break;\n          }\n\n          try {\n            const element = mutations[i].target as Element;\n            const attr = mutations[i].attributeName as string;\n\n            if (attr === this.VIDEO_FRAME_STR) {\n              if (element.hasAttribute(attr)) {\n                this.trackVideoElement(element);\n                this.callMeasure = true;\n              } else if (this.videoFrame) {\n                this.untrackVideoElement(element);\n              }\n            } else if (attr === this.CONTENT_STR) {\n              const newValue = element.getAttribute(attr) as string;\n              const oldValue = mutations[i].oldValue as string;\n\n              if (oldValue) {\n                // data-sm-content attribute was changed and must be removed\n                this.resizeObserver.unobserve(this.contentCollection[oldValue]);\n                delete this.contentCollection[oldValue];\n              }\n\n              if (newValue) {\n                // data-sm-content attribute value was changed/added and now must be added to the list\n                this.contentCollection[newValue] = element;\n                this.resizeObserver.observe(element, {\n                  box: this.RESIZE_OBSERVER_BOX_OPTIONS,\n                });\n              }\n\n              this.callMeasure = true;\n            }\n\n            break;\n          } catch (err) {\n            this.logger.log(\n              'warn',\n              'ContentAwareness: Failed to track non-element node',\n              mutations[i].target\n            );\n          }\n        }\n      }\n    }\n\n    if (this.callMeasure) {\n      if (imagesAdded) {\n        // Wait for all images to be loaded then remeasure\n        allImagesLoaded().then(() => {\n          this.measureDebounced();\n        });\n      } else {\n        this.measureDebounced();\n      }\n    }\n  }\n\n  private trackAddedNodeWithCUE(mutations: NodeList): void {\n    mutations.forEach((node) => {\n      try {\n        const element = node as Element;\n\n        if (!element.hasAttribute) {\n          // node is not an element, do not continue processing it\n          return;\n        }\n\n        // check top level node for cue attributes\n        if (element.hasAttribute(this.VIDEO_FRAME_STR)) {\n          this.trackVideoElement(element);\n          this.callMeasure = true;\n        } else if (element.hasAttribute(this.CONTENT_STR)) {\n          this.callMeasure = this.trackContentElement(element);\n        }\n\n        // check child nodes for cue attributes\n        if (element.querySelector(this.CUE_ATTRIBUTES_BRACKETED) !== null) {\n          element\n            .querySelectorAll(this.CUE_ATTRIBUTES_BRACKETED)\n            .forEach((childElement) => {\n              if (childElement.hasAttribute(this.VIDEO_FRAME_STR)) {\n                this.trackVideoElement(childElement);\n                this.callMeasure = true;\n              } else if (childElement.hasAttribute(this.CONTENT_STR)) {\n                this.callMeasure = this.trackContentElement(childElement);\n              }\n            });\n        }\n      } catch (err) {\n        this.logger.log(\n          'warn',\n          'ContentAwareness: Failed to track non-element node',\n          node\n        );\n      }\n    });\n  }\n\n  private untrackRemovedNodeWithCUE(mutations: NodeList): void {\n    mutations.forEach((node) => {\n      try {\n        const element = node as Element;\n\n        if (!element.hasAttribute) {\n          // node is not an element, do not continue processing it\n          return;\n        }\n\n        if (element.hasAttribute(this.VIDEO_FRAME_STR)) {\n          this.untrackVideoElement(element);\n        } else if (element.hasAttribute(this.CONTENT_STR)) {\n          this.untrackContentElement(element);\n          this.callMeasure = true;\n        }\n\n        // check child nodes for cue attributes\n        if (element.querySelector(this.CUE_ATTRIBUTES_BRACKETED) !== null) {\n          element\n            .querySelectorAll(this.CUE_ATTRIBUTES_BRACKETED)\n            .forEach((childElement) => {\n              if (childElement.hasAttribute(this.VIDEO_FRAME_STR)) {\n                this.untrackVideoElement(childElement);\n              } else if (childElement.hasAttribute(this.CONTENT_STR)) {\n                this.untrackContentElement(childElement);\n                this.callMeasure = true;\n              }\n            });\n        }\n      } catch (err) {\n        this.logger.log(\n          'warn',\n          'ContentAwareness: Failed to track non-element node',\n          node\n        );\n      }\n    });\n  }\n}\n","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n// Updates to this file should also be replicated to @opentelemetry/api-metrics and\n// @opentelemetry/core too.\n/**\n * - globalThis (New standard)\n * - self (Will return the current window instance for supported browsers)\n * - window (fallback for older browser implementations)\n * - global (NodeJS implementation)\n * - <object> (When all else fails)\n */\n/** only globals that common to node and browsers are allowed */\n// eslint-disable-next-line node/no-unsupported-features/es-builtins, no-undef\nexport var _globalThis = typeof globalThis === 'object' ? globalThis :\n    typeof self === 'object' ? self :\n        typeof window === 'object' ? window :\n            typeof global === 'object' ? global :\n                {};\n//# sourceMappingURL=globalThis.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n// this is autogenerated file, see scripts/version-update.js\nexport var VERSION = '1.2.0';\n//# sourceMappingURL=version.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { VERSION } from '../version';\nvar re = /^(\\d+)\\.(\\d+)\\.(\\d+)(-(.+))?$/;\n/**\n * Create a function to test an API version to see if it is compatible with the provided ownVersion.\n *\n * The returned function has the following semantics:\n * - Exact match is always compatible\n * - Major versions must match exactly\n *    - 1.x package cannot use global 2.x package\n *    - 2.x package cannot use global 1.x package\n * - The minor version of the API module requesting access to the global API must be less than or equal to the minor version of this API\n *    - 1.3 package may use 1.4 global because the later global contains all functions 1.3 expects\n *    - 1.4 package may NOT use 1.3 global because it may try to call functions which don't exist on 1.3\n * - If the major version is 0, the minor version is treated as the major and the patch is treated as the minor\n * - Patch and build tag differences are not considered at this time\n *\n * @param ownVersion version which should be checked against\n */\nexport function _makeCompatibilityCheck(ownVersion) {\n    var acceptedVersions = new Set([ownVersion]);\n    var rejectedVersions = new Set();\n    var myVersionMatch = ownVersion.match(re);\n    if (!myVersionMatch) {\n        // we cannot guarantee compatibility so we always return noop\n        return function () { return false; };\n    }\n    var ownVersionParsed = {\n        major: +myVersionMatch[1],\n        minor: +myVersionMatch[2],\n        patch: +myVersionMatch[3],\n        prerelease: myVersionMatch[4],\n    };\n    // if ownVersion has a prerelease tag, versions must match exactly\n    if (ownVersionParsed.prerelease != null) {\n        return function isExactmatch(globalVersion) {\n            return globalVersion === ownVersion;\n        };\n    }\n    function _reject(v) {\n        rejectedVersions.add(v);\n        return false;\n    }\n    function _accept(v) {\n        acceptedVersions.add(v);\n        return true;\n    }\n    return function isCompatible(globalVersion) {\n        if (acceptedVersions.has(globalVersion)) {\n            return true;\n        }\n        if (rejectedVersions.has(globalVersion)) {\n            return false;\n        }\n        var globalVersionMatch = globalVersion.match(re);\n        if (!globalVersionMatch) {\n            // cannot parse other version\n            // we cannot guarantee compatibility so we always noop\n            return _reject(globalVersion);\n        }\n        var globalVersionParsed = {\n            major: +globalVersionMatch[1],\n            minor: +globalVersionMatch[2],\n            patch: +globalVersionMatch[3],\n            prerelease: globalVersionMatch[4],\n        };\n        // if globalVersion has a prerelease tag, versions must match exactly\n        if (globalVersionParsed.prerelease != null) {\n            return _reject(globalVersion);\n        }\n        // major versions must match\n        if (ownVersionParsed.major !== globalVersionParsed.major) {\n            return _reject(globalVersion);\n        }\n        if (ownVersionParsed.major === 0) {\n            if (ownVersionParsed.minor === globalVersionParsed.minor &&\n                ownVersionParsed.patch <= globalVersionParsed.patch) {\n                return _accept(globalVersion);\n            }\n            return _reject(globalVersion);\n        }\n        if (ownVersionParsed.minor <= globalVersionParsed.minor) {\n            return _accept(globalVersion);\n        }\n        return _reject(globalVersion);\n    };\n}\n/**\n * Test an API version to see if it is compatible with this API.\n *\n * - Exact match is always compatible\n * - Major versions must match exactly\n *    - 1.x package cannot use global 2.x package\n *    - 2.x package cannot use global 1.x package\n * - The minor version of the API module requesting access to the global API must be less than or equal to the minor version of this API\n *    - 1.3 package may use 1.4 global because the later global contains all functions 1.3 expects\n *    - 1.4 package may NOT use 1.3 global because it may try to call functions which don't exist on 1.3\n * - If the major version is 0, the minor version is treated as the major and the patch is treated as the minor\n * - Patch and build tag differences are not considered at this time\n *\n * @param version version of the API requesting an instance of the global API\n */\nexport var isCompatible = _makeCompatibilityCheck(VERSION);\n//# sourceMappingURL=semver.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { _globalThis } from '../platform';\nimport { VERSION } from '../version';\nimport { isCompatible } from './semver';\nvar major = VERSION.split('.')[0];\nvar GLOBAL_OPENTELEMETRY_API_KEY = Symbol.for(\"opentelemetry.js.api.\" + major);\nvar _global = _globalThis;\nexport function registerGlobal(type, instance, diag, allowOverride) {\n    var _a;\n    if (allowOverride === void 0) { allowOverride = false; }\n    var api = (_global[GLOBAL_OPENTELEMETRY_API_KEY] = (_a = _global[GLOBAL_OPENTELEMETRY_API_KEY]) !== null && _a !== void 0 ? _a : {\n        version: VERSION,\n    });\n    if (!allowOverride && api[type]) {\n        // already registered an API of this type\n        var err = new Error(\"@opentelemetry/api: Attempted duplicate registration of API: \" + type);\n        diag.error(err.stack || err.message);\n        return false;\n    }\n    if (api.version !== VERSION) {\n        // All registered APIs must be of the same version exactly\n        var err = new Error('@opentelemetry/api: All API registration versions must match');\n        diag.error(err.stack || err.message);\n        return false;\n    }\n    api[type] = instance;\n    diag.debug(\"@opentelemetry/api: Registered a global for \" + type + \" v\" + VERSION + \".\");\n    return true;\n}\nexport function getGlobal(type) {\n    var _a, _b;\n    var globalVersion = (_a = _global[GLOBAL_OPENTELEMETRY_API_KEY]) === null || _a === void 0 ? void 0 : _a.version;\n    if (!globalVersion || !isCompatible(globalVersion)) {\n        return;\n    }\n    return (_b = _global[GLOBAL_OPENTELEMETRY_API_KEY]) === null || _b === void 0 ? void 0 : _b[type];\n}\nexport function unregisterGlobal(type, diag) {\n    diag.debug(\"@opentelemetry/api: Unregistering a global for \" + type + \" v\" + VERSION + \".\");\n    var api = _global[GLOBAL_OPENTELEMETRY_API_KEY];\n    if (api) {\n        delete api[type];\n    }\n}\n//# sourceMappingURL=global-utils.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { getGlobal } from '../internal/global-utils';\n/**\n * Component Logger which is meant to be used as part of any component which\n * will add automatically additional namespace in front of the log message.\n * It will then forward all message to global diag logger\n * @example\n * const cLogger = diag.createComponentLogger({ namespace: '@opentelemetry/instrumentation-http' });\n * cLogger.debug('test');\n * // @opentelemetry/instrumentation-http test\n */\nvar DiagComponentLogger = /** @class */ (function () {\n    function DiagComponentLogger(props) {\n        this._namespace = props.namespace || 'DiagComponentLogger';\n    }\n    DiagComponentLogger.prototype.debug = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return logProxy('debug', this._namespace, args);\n    };\n    DiagComponentLogger.prototype.error = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return logProxy('error', this._namespace, args);\n    };\n    DiagComponentLogger.prototype.info = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return logProxy('info', this._namespace, args);\n    };\n    DiagComponentLogger.prototype.warn = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return logProxy('warn', this._namespace, args);\n    };\n    DiagComponentLogger.prototype.verbose = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return logProxy('verbose', this._namespace, args);\n    };\n    return DiagComponentLogger;\n}());\nexport { DiagComponentLogger };\nfunction logProxy(funcName, namespace, args) {\n    var logger = getGlobal('diag');\n    // shortcut if logger not set\n    if (!logger) {\n        return;\n    }\n    args.unshift(namespace);\n    return logger[funcName].apply(logger, args);\n}\n//# sourceMappingURL=ComponentLogger.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * Defines the available internal logging levels for the diagnostic logger, the numeric values\n * of the levels are defined to match the original values from the initial LogLevel to avoid\n * compatibility/migration issues for any implementation that assume the numeric ordering.\n */\nexport var DiagLogLevel;\n(function (DiagLogLevel) {\n    /** Diagnostic Logging level setting to disable all logging (except and forced logs) */\n    DiagLogLevel[DiagLogLevel[\"NONE\"] = 0] = \"NONE\";\n    /** Identifies an error scenario */\n    DiagLogLevel[DiagLogLevel[\"ERROR\"] = 30] = \"ERROR\";\n    /** Identifies a warning scenario */\n    DiagLogLevel[DiagLogLevel[\"WARN\"] = 50] = \"WARN\";\n    /** General informational log message */\n    DiagLogLevel[DiagLogLevel[\"INFO\"] = 60] = \"INFO\";\n    /** General debug log message */\n    DiagLogLevel[DiagLogLevel[\"DEBUG\"] = 70] = \"DEBUG\";\n    /**\n     * Detailed trace level logging should only be used for development, should only be set\n     * in a development environment.\n     */\n    DiagLogLevel[DiagLogLevel[\"VERBOSE\"] = 80] = \"VERBOSE\";\n    /** Used to set the logging level to include all logging */\n    DiagLogLevel[DiagLogLevel[\"ALL\"] = 9999] = \"ALL\";\n})(DiagLogLevel || (DiagLogLevel = {}));\n//# sourceMappingURL=types.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { DiagComponentLogger } from '../diag/ComponentLogger';\nimport { createLogLevelDiagLogger } from '../diag/internal/logLevelLogger';\nimport { DiagLogLevel, } from '../diag/types';\nimport { getGlobal, registerGlobal, unregisterGlobal, } from '../internal/global-utils';\nvar API_NAME = 'diag';\n/**\n * Singleton object which represents the entry point to the OpenTelemetry internal\n * diagnostic API\n */\nvar DiagAPI = /** @class */ (function () {\n    /**\n     * Private internal constructor\n     * @private\n     */\n    function DiagAPI() {\n        function _logProxy(funcName) {\n            return function () {\n                var args = [];\n                for (var _i = 0; _i < arguments.length; _i++) {\n                    args[_i] = arguments[_i];\n                }\n                var logger = getGlobal('diag');\n                // shortcut if logger not set\n                if (!logger)\n                    return;\n                return logger[funcName].apply(logger, args);\n            };\n        }\n        // Using self local variable for minification purposes as 'this' cannot be minified\n        var self = this;\n        // DiagAPI specific functions\n        self.setLogger = function (logger, logLevel) {\n            var _a, _b;\n            if (logLevel === void 0) { logLevel = DiagLogLevel.INFO; }\n            if (logger === self) {\n                // There isn't much we can do here.\n                // Logging to the console might break the user application.\n                // Try to log to self. If a logger was previously registered it will receive the log.\n                var err = new Error('Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation');\n                self.error((_a = err.stack) !== null && _a !== void 0 ? _a : err.message);\n                return false;\n            }\n            var oldLogger = getGlobal('diag');\n            var newLogger = createLogLevelDiagLogger(logLevel, logger);\n            // There already is an logger registered. We'll let it know before overwriting it.\n            if (oldLogger) {\n                var stack = (_b = new Error().stack) !== null && _b !== void 0 ? _b : '<failed to generate stacktrace>';\n                oldLogger.warn(\"Current logger will be overwritten from \" + stack);\n                newLogger.warn(\"Current logger will overwrite one already registered from \" + stack);\n            }\n            return registerGlobal('diag', newLogger, self, true);\n        };\n        self.disable = function () {\n            unregisterGlobal(API_NAME, self);\n        };\n        self.createComponentLogger = function (options) {\n            return new DiagComponentLogger(options);\n        };\n        self.verbose = _logProxy('verbose');\n        self.debug = _logProxy('debug');\n        self.info = _logProxy('info');\n        self.warn = _logProxy('warn');\n        self.error = _logProxy('error');\n    }\n    /** Get the singleton instance of the DiagAPI API */\n    DiagAPI.instance = function () {\n        if (!this._instance) {\n            this._instance = new DiagAPI();\n        }\n        return this._instance;\n    };\n    return DiagAPI;\n}());\nexport { DiagAPI };\n//# sourceMappingURL=diag.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { DiagLogLevel } from '../types';\nexport function createLogLevelDiagLogger(maxLevel, logger) {\n    if (maxLevel < DiagLogLevel.NONE) {\n        maxLevel = DiagLogLevel.NONE;\n    }\n    else if (maxLevel > DiagLogLevel.ALL) {\n        maxLevel = DiagLogLevel.ALL;\n    }\n    // In case the logger is null or undefined\n    logger = logger || {};\n    function _filterFunc(funcName, theLevel) {\n        var theFunc = logger[funcName];\n        if (typeof theFunc === 'function' && maxLevel >= theLevel) {\n            return theFunc.bind(logger);\n        }\n        return function () { };\n    }\n    return {\n        error: _filterFunc('error', DiagLogLevel.ERROR),\n        warn: _filterFunc('warn', DiagLogLevel.WARN),\n        info: _filterFunc('info', DiagLogLevel.INFO),\n        debug: _filterFunc('debug', DiagLogLevel.DEBUG),\n        verbose: _filterFunc('verbose', DiagLogLevel.VERBOSE),\n    };\n}\n//# sourceMappingURL=logLevelLogger.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar BaggageImpl = /** @class */ (function () {\n    function BaggageImpl(entries) {\n        this._entries = entries ? new Map(entries) : new Map();\n    }\n    BaggageImpl.prototype.getEntry = function (key) {\n        var entry = this._entries.get(key);\n        if (!entry) {\n            return undefined;\n        }\n        return Object.assign({}, entry);\n    };\n    BaggageImpl.prototype.getAllEntries = function () {\n        return Array.from(this._entries.entries()).map(function (_a) {\n            var k = _a[0], v = _a[1];\n            return [k, v];\n        });\n    };\n    BaggageImpl.prototype.setEntry = function (key, entry) {\n        var newBaggage = new BaggageImpl(this._entries);\n        newBaggage._entries.set(key, entry);\n        return newBaggage;\n    };\n    BaggageImpl.prototype.removeEntry = function (key) {\n        var newBaggage = new BaggageImpl(this._entries);\n        newBaggage._entries.delete(key);\n        return newBaggage;\n    };\n    BaggageImpl.prototype.removeEntries = function () {\n        var keys = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            keys[_i] = arguments[_i];\n        }\n        var newBaggage = new BaggageImpl(this._entries);\n        for (var _a = 0, keys_1 = keys; _a < keys_1.length; _a++) {\n            var key = keys_1[_a];\n            newBaggage._entries.delete(key);\n        }\n        return newBaggage;\n    };\n    BaggageImpl.prototype.clear = function () {\n        return new BaggageImpl();\n    };\n    return BaggageImpl;\n}());\nexport { BaggageImpl };\n//# sourceMappingURL=baggage-impl.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * Symbol used to make BaggageEntryMetadata an opaque type\n */\nexport var baggageEntryMetadataSymbol = Symbol('BaggageEntryMetadata');\n//# sourceMappingURL=symbol.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { DiagAPI } from '../api/diag';\nimport { BaggageImpl } from './internal/baggage-impl';\nimport { baggageEntryMetadataSymbol } from './internal/symbol';\nvar diag = DiagAPI.instance();\n/**\n * Create a new Baggage with optional entries\n *\n * @param entries An array of baggage entries the new baggage should contain\n */\nexport function createBaggage(entries) {\n    if (entries === void 0) { entries = {}; }\n    return new BaggageImpl(new Map(Object.entries(entries)));\n}\n/**\n * Create a serializable BaggageEntryMetadata object from a string.\n *\n * @param str string metadata. Format is currently not defined by the spec and has no special meaning.\n *\n */\nexport function baggageEntryMetadataFromString(str) {\n    if (typeof str !== 'string') {\n        diag.error(\"Cannot create baggage metadata from unknown type: \" + typeof str);\n        str = '';\n    }\n    return {\n        __TYPE__: baggageEntryMetadataSymbol,\n        toString: function () {\n            return str;\n        },\n    };\n}\n//# sourceMappingURL=utils.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar consoleMap = [\n    { n: 'error', c: 'error' },\n    { n: 'warn', c: 'warn' },\n    { n: 'info', c: 'info' },\n    { n: 'debug', c: 'debug' },\n    { n: 'verbose', c: 'trace' },\n];\n/**\n * A simple Immutable Console based diagnostic logger which will output any messages to the Console.\n * If you want to limit the amount of logging to a specific level or lower use the\n * {@link createLogLevelDiagLogger}\n */\nvar DiagConsoleLogger = /** @class */ (function () {\n    function DiagConsoleLogger() {\n        function _consoleFunc(funcName) {\n            return function () {\n                var args = [];\n                for (var _i = 0; _i < arguments.length; _i++) {\n                    args[_i] = arguments[_i];\n                }\n                if (console) {\n                    // Some environments only expose the console when the F12 developer console is open\n                    // eslint-disable-next-line no-console\n                    var theFunc = console[funcName];\n                    if (typeof theFunc !== 'function') {\n                        // Not all environments support all functions\n                        // eslint-disable-next-line no-console\n                        theFunc = console.log;\n                    }\n                    // One last final check\n                    if (typeof theFunc === 'function') {\n                        return theFunc.apply(console, args);\n                    }\n                }\n            };\n        }\n        for (var i = 0; i < consoleMap.length; i++) {\n            this[consoleMap[i].n] = _consoleFunc(consoleMap[i].c);\n        }\n    }\n    return DiagConsoleLogger;\n}());\nexport { DiagConsoleLogger };\n//# sourceMappingURL=consoleLogger.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nexport var defaultTextMapGetter = {\n    get: function (carrier, key) {\n        if (carrier == null) {\n            return undefined;\n        }\n        return carrier[key];\n    },\n    keys: function (carrier) {\n        if (carrier == null) {\n            return [];\n        }\n        return Object.keys(carrier);\n    },\n};\nexport var defaultTextMapSetter = {\n    set: function (carrier, key, value) {\n        if (carrier == null) {\n            return;\n        }\n        carrier[key] = value;\n    },\n};\n//# sourceMappingURL=TextMapPropagator.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/** Get a key to uniquely identify a context value */\nexport function createContextKey(description) {\n    // The specification states that for the same input, multiple calls should\n    // return different keys. Due to the nature of the JS dependency management\n    // system, this creates problems where multiple versions of some package\n    // could hold different keys for the same property.\n    //\n    // Therefore, we use Symbol.for which returns the same key for the same input.\n    return Symbol.for(description);\n}\nvar BaseContext = /** @class */ (function () {\n    /**\n     * Construct a new context which inherits values from an optional parent context.\n     *\n     * @param parentContext a context from which to inherit values\n     */\n    function BaseContext(parentContext) {\n        // for minification\n        var self = this;\n        self._currentContext = parentContext ? new Map(parentContext) : new Map();\n        self.getValue = function (key) { return self._currentContext.get(key); };\n        self.setValue = function (key, value) {\n            var context = new BaseContext(self._currentContext);\n            context._currentContext.set(key, value);\n            return context;\n        };\n        self.deleteValue = function (key) {\n            var context = new BaseContext(self._currentContext);\n            context._currentContext.delete(key);\n            return context;\n        };\n    }\n    return BaseContext;\n}());\n/** The root context is used as the default parent context when there is no active context */\nexport var ROOT_CONTEXT = new BaseContext();\n//# sourceMappingURL=context.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nexport var TraceFlags;\n(function (TraceFlags) {\n    /** Represents no flag set. */\n    TraceFlags[TraceFlags[\"NONE\"] = 0] = \"NONE\";\n    /** Bit to represent whether trace is sampled in trace flags. */\n    TraceFlags[TraceFlags[\"SAMPLED\"] = 1] = \"SAMPLED\";\n})(TraceFlags || (TraceFlags = {}));\n//# sourceMappingURL=trace_flags.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __spreadArray = (this && this.__spreadArray) || function (to, from) {\n    for (var i = 0, il = from.length, j = to.length; i < il; i++, j++)\n        to[j] = from[i];\n    return to;\n};\nimport { ROOT_CONTEXT } from './context';\nvar NoopContextManager = /** @class */ (function () {\n    function NoopContextManager() {\n    }\n    NoopContextManager.prototype.active = function () {\n        return ROOT_CONTEXT;\n    };\n    NoopContextManager.prototype.with = function (_context, fn, thisArg) {\n        var args = [];\n        for (var _i = 3; _i < arguments.length; _i++) {\n            args[_i - 3] = arguments[_i];\n        }\n        return fn.call.apply(fn, __spreadArray([thisArg], args));\n    };\n    NoopContextManager.prototype.bind = function (_context, target) {\n        return target;\n    };\n    NoopContextManager.prototype.enable = function () {\n        return this;\n    };\n    NoopContextManager.prototype.disable = function () {\n        return this;\n    };\n    return NoopContextManager;\n}());\nexport { NoopContextManager };\n//# sourceMappingURL=NoopContextManager.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __spreadArray = (this && this.__spreadArray) || function (to, from) {\n    for (var i = 0, il = from.length, j = to.length; i < il; i++, j++)\n        to[j] = from[i];\n    return to;\n};\nimport { NoopContextManager } from '../context/NoopContextManager';\nimport { getGlobal, registerGlobal, unregisterGlobal, } from '../internal/global-utils';\nimport { DiagAPI } from './diag';\nvar API_NAME = 'context';\nvar NOOP_CONTEXT_MANAGER = new NoopContextManager();\n/**\n * Singleton object which represents the entry point to the OpenTelemetry Context API\n */\nvar ContextAPI = /** @class */ (function () {\n    /** Empty private constructor prevents end users from constructing a new instance of the API */\n    function ContextAPI() {\n    }\n    /** Get the singleton instance of the Context API */\n    ContextAPI.getInstance = function () {\n        if (!this._instance) {\n            this._instance = new ContextAPI();\n        }\n        return this._instance;\n    };\n    /**\n     * Set the current context manager.\n     *\n     * @returns true if the context manager was successfully registered, else false\n     */\n    ContextAPI.prototype.setGlobalContextManager = function (contextManager) {\n        return registerGlobal(API_NAME, contextManager, DiagAPI.instance());\n    };\n    /**\n     * Get the currently active context\n     */\n    ContextAPI.prototype.active = function () {\n        return this._getContextManager().active();\n    };\n    /**\n     * Execute a function with an active context\n     *\n     * @param context context to be active during function execution\n     * @param fn function to execute in a context\n     * @param thisArg optional receiver to be used for calling fn\n     * @param args optional arguments forwarded to fn\n     */\n    ContextAPI.prototype.with = function (context, fn, thisArg) {\n        var _a;\n        var args = [];\n        for (var _i = 3; _i < arguments.length; _i++) {\n            args[_i - 3] = arguments[_i];\n        }\n        return (_a = this._getContextManager()).with.apply(_a, __spreadArray([context, fn, thisArg], args));\n    };\n    /**\n     * Bind a context to a target function or event emitter\n     *\n     * @param context context to bind to the event emitter or function. Defaults to the currently active context\n     * @param target function or event emitter to bind\n     */\n    ContextAPI.prototype.bind = function (context, target) {\n        return this._getContextManager().bind(context, target);\n    };\n    ContextAPI.prototype._getContextManager = function () {\n        return getGlobal(API_NAME) || NOOP_CONTEXT_MANAGER;\n    };\n    /** Disable and remove the global context manager */\n    ContextAPI.prototype.disable = function () {\n        this._getContextManager().disable();\n        unregisterGlobal(API_NAME, DiagAPI.instance());\n    };\n    return ContextAPI;\n}());\nexport { ContextAPI };\n//# sourceMappingURL=context.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { TraceFlags } from './trace_flags';\nexport var INVALID_SPANID = '0000000000000000';\nexport var INVALID_TRACEID = '00000000000000000000000000000000';\nexport var INVALID_SPAN_CONTEXT = {\n    traceId: INVALID_TRACEID,\n    spanId: INVALID_SPANID,\n    traceFlags: TraceFlags.NONE,\n};\n//# sourceMappingURL=invalid-span-constants.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { INVALID_SPAN_CONTEXT } from './invalid-span-constants';\n/**\n * The NonRecordingSpan is the default {@link Span} that is used when no Span\n * implementation is available. All operations are no-op including context\n * propagation.\n */\nvar NonRecordingSpan = /** @class */ (function () {\n    function NonRecordingSpan(_spanContext) {\n        if (_spanContext === void 0) { _spanContext = INVALID_SPAN_CONTEXT; }\n        this._spanContext = _spanContext;\n    }\n    // Returns a SpanContext.\n    NonRecordingSpan.prototype.spanContext = function () {\n        return this._spanContext;\n    };\n    // By default does nothing\n    NonRecordingSpan.prototype.setAttribute = function (_key, _value) {\n        return this;\n    };\n    // By default does nothing\n    NonRecordingSpan.prototype.setAttributes = function (_attributes) {\n        return this;\n    };\n    // By default does nothing\n    NonRecordingSpan.prototype.addEvent = function (_name, _attributes) {\n        return this;\n    };\n    // By default does nothing\n    NonRecordingSpan.prototype.setStatus = function (_status) {\n        return this;\n    };\n    // By default does nothing\n    NonRecordingSpan.prototype.updateName = function (_name) {\n        return this;\n    };\n    // By default does nothing\n    NonRecordingSpan.prototype.end = function (_endTime) { };\n    // isRecording always returns false for NonRecordingSpan.\n    NonRecordingSpan.prototype.isRecording = function () {\n        return false;\n    };\n    // By default does nothing\n    NonRecordingSpan.prototype.recordException = function (_exception, _time) { };\n    return NonRecordingSpan;\n}());\nexport { NonRecordingSpan };\n//# sourceMappingURL=NonRecordingSpan.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { createContextKey } from '../context/context';\nimport { NonRecordingSpan } from './NonRecordingSpan';\nimport { ContextAPI } from '../api/context';\n/**\n * span key\n */\nvar SPAN_KEY = createContextKey('OpenTelemetry Context Key SPAN');\n/**\n * Return the span if one exists\n *\n * @param context context to get span from\n */\nexport function getSpan(context) {\n    return context.getValue(SPAN_KEY) || undefined;\n}\n/**\n * Gets the span from the current context, if one exists.\n */\nexport function getActiveSpan() {\n    return getSpan(ContextAPI.getInstance().active());\n}\n/**\n * Set the span on a context\n *\n * @param context context to use as parent\n * @param span span to set active\n */\nexport function setSpan(context, span) {\n    return context.setValue(SPAN_KEY, span);\n}\n/**\n * Remove current span stored in the context\n *\n * @param context context to delete span from\n */\nexport function deleteSpan(context) {\n    return context.deleteValue(SPAN_KEY);\n}\n/**\n * Wrap span context in a NoopSpan and set as span in a new\n * context\n *\n * @param context context to set active span on\n * @param spanContext span context to be wrapped\n */\nexport function setSpanContext(context, spanContext) {\n    return setSpan(context, new NonRecordingSpan(spanContext));\n}\n/**\n * Get the span context of the span if it exists.\n *\n * @param context context to get values from\n */\nexport function getSpanContext(context) {\n    var _a;\n    return (_a = getSpan(context)) === null || _a === void 0 ? void 0 : _a.spanContext();\n}\n//# sourceMappingURL=context-utils.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { INVALID_SPANID, INVALID_TRACEID } from './invalid-span-constants';\nimport { NonRecordingSpan } from './NonRecordingSpan';\nvar VALID_TRACEID_REGEX = /^([0-9a-f]{32})$/i;\nvar VALID_SPANID_REGEX = /^[0-9a-f]{16}$/i;\nexport function isValidTraceId(traceId) {\n    return VALID_TRACEID_REGEX.test(traceId) && traceId !== INVALID_TRACEID;\n}\nexport function isValidSpanId(spanId) {\n    return VALID_SPANID_REGEX.test(spanId) && spanId !== INVALID_SPANID;\n}\n/**\n * Returns true if this {@link SpanContext} is valid.\n * @return true if this {@link SpanContext} is valid.\n */\nexport function isSpanContextValid(spanContext) {\n    return (isValidTraceId(spanContext.traceId) && isValidSpanId(spanContext.spanId));\n}\n/**\n * Wrap the given {@link SpanContext} in a new non-recording {@link Span}\n *\n * @param spanContext span context to be wrapped\n * @returns a new non-recording {@link Span} with the provided context\n */\nexport function wrapSpanContext(spanContext) {\n    return new NonRecordingSpan(spanContext);\n}\n//# sourceMappingURL=spancontext-utils.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { ContextAPI } from '../api/context';\nimport { getSpanContext, setSpan } from '../trace/context-utils';\nimport { NonRecordingSpan } from './NonRecordingSpan';\nimport { isSpanContextValid } from './spancontext-utils';\nvar context = ContextAPI.getInstance();\n/**\n * No-op implementations of {@link Tracer}.\n */\nvar NoopTracer = /** @class */ (function () {\n    function NoopTracer() {\n    }\n    // startSpan starts a noop span.\n    NoopTracer.prototype.startSpan = function (name, options, context) {\n        var root = Boolean(options === null || options === void 0 ? void 0 : options.root);\n        if (root) {\n            return new NonRecordingSpan();\n        }\n        var parentFromContext = context && getSpanContext(context);\n        if (isSpanContext(parentFromContext) &&\n            isSpanContextValid(parentFromContext)) {\n            return new NonRecordingSpan(parentFromContext);\n        }\n        else {\n            return new NonRecordingSpan();\n        }\n    };\n    NoopTracer.prototype.startActiveSpan = function (name, arg2, arg3, arg4) {\n        var opts;\n        var ctx;\n        var fn;\n        if (arguments.length < 2) {\n            return;\n        }\n        else if (arguments.length === 2) {\n            fn = arg2;\n        }\n        else if (arguments.length === 3) {\n            opts = arg2;\n            fn = arg3;\n        }\n        else {\n            opts = arg2;\n            ctx = arg3;\n            fn = arg4;\n        }\n        var parentContext = ctx !== null && ctx !== void 0 ? ctx : context.active();\n        var span = this.startSpan(name, opts, parentContext);\n        var contextWithSpanSet = setSpan(parentContext, span);\n        return context.with(contextWithSpanSet, fn, undefined, span);\n    };\n    return NoopTracer;\n}());\nexport { NoopTracer };\nfunction isSpanContext(spanContext) {\n    return (typeof spanContext === 'object' &&\n        typeof spanContext['spanId'] === 'string' &&\n        typeof spanContext['traceId'] === 'string' &&\n        typeof spanContext['traceFlags'] === 'number');\n}\n//# sourceMappingURL=NoopTracer.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { NoopTracer } from './NoopTracer';\nvar NOOP_TRACER = new NoopTracer();\n/**\n * Proxy tracer provided by the proxy tracer provider\n */\nvar ProxyTracer = /** @class */ (function () {\n    function ProxyTracer(_provider, name, version, options) {\n        this._provider = _provider;\n        this.name = name;\n        this.version = version;\n        this.options = options;\n    }\n    ProxyTracer.prototype.startSpan = function (name, options, context) {\n        return this._getTracer().startSpan(name, options, context);\n    };\n    ProxyTracer.prototype.startActiveSpan = function (_name, _options, _context, _fn) {\n        var tracer = this._getTracer();\n        return Reflect.apply(tracer.startActiveSpan, tracer, arguments);\n    };\n    /**\n     * Try to get a tracer from the proxy tracer provider.\n     * If the proxy tracer provider has no delegate, return a noop tracer.\n     */\n    ProxyTracer.prototype._getTracer = function () {\n        if (this._delegate) {\n            return this._delegate;\n        }\n        var tracer = this._provider.getDelegateTracer(this.name, this.version, this.options);\n        if (!tracer) {\n            return NOOP_TRACER;\n        }\n        this._delegate = tracer;\n        return this._delegate;\n    };\n    return ProxyTracer;\n}());\nexport { ProxyTracer };\n//# sourceMappingURL=ProxyTracer.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @deprecated use the one declared in @opentelemetry/sdk-trace-base instead.\n * A sampling decision that determines how a {@link Span} will be recorded\n * and collected.\n */\nexport var SamplingDecision;\n(function (SamplingDecision) {\n    /**\n     * `Span.isRecording() === false`, span will not be recorded and all events\n     * and attributes will be dropped.\n     */\n    SamplingDecision[SamplingDecision[\"NOT_RECORD\"] = 0] = \"NOT_RECORD\";\n    /**\n     * `Span.isRecording() === true`, but `Sampled` flag in {@link TraceFlags}\n     * MUST NOT be set.\n     */\n    SamplingDecision[SamplingDecision[\"RECORD\"] = 1] = \"RECORD\";\n    /**\n     * `Span.isRecording() === true` AND `Sampled` flag in {@link TraceFlags}\n     * MUST be set.\n     */\n    SamplingDecision[SamplingDecision[\"RECORD_AND_SAMPLED\"] = 2] = \"RECORD_AND_SAMPLED\";\n})(SamplingDecision || (SamplingDecision = {}));\n//# sourceMappingURL=SamplingResult.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nexport var SpanKind;\n(function (SpanKind) {\n    /** Default value. Indicates that the span is used internally. */\n    SpanKind[SpanKind[\"INTERNAL\"] = 0] = \"INTERNAL\";\n    /**\n     * Indicates that the span covers server-side handling of an RPC or other\n     * remote request.\n     */\n    SpanKind[SpanKind[\"SERVER\"] = 1] = \"SERVER\";\n    /**\n     * Indicates that the span covers the client-side wrapper around an RPC or\n     * other remote request.\n     */\n    SpanKind[SpanKind[\"CLIENT\"] = 2] = \"CLIENT\";\n    /**\n     * Indicates that the span describes producer sending a message to a\n     * broker. Unlike client and server, there is no direct critical path latency\n     * relationship between producer and consumer spans.\n     */\n    SpanKind[SpanKind[\"PRODUCER\"] = 3] = \"PRODUCER\";\n    /**\n     * Indicates that the span describes consumer receiving a message from a\n     * broker. Unlike client and server, there is no direct critical path latency\n     * relationship between producer and consumer spans.\n     */\n    SpanKind[SpanKind[\"CONSUMER\"] = 4] = \"CONSUMER\";\n})(SpanKind || (SpanKind = {}));\n//# sourceMappingURL=span_kind.js.map","/**\n * An enumeration of status codes.\n */\nexport var SpanStatusCode;\n(function (SpanStatusCode) {\n    /**\n     * The default status.\n     */\n    SpanStatusCode[SpanStatusCode[\"UNSET\"] = 0] = \"UNSET\";\n    /**\n     * The operation has been validated by an Application developer or\n     * Operator to have completed successfully.\n     */\n    SpanStatusCode[SpanStatusCode[\"OK\"] = 1] = \"OK\";\n    /**\n     * The operation contains an error.\n     */\n    SpanStatusCode[SpanStatusCode[\"ERROR\"] = 2] = \"ERROR\";\n})(SpanStatusCode || (SpanStatusCode = {}));\n//# sourceMappingURL=status.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { ProxyTracer } from './ProxyTracer';\nimport { NoopTracerProvider } from './NoopTracerProvider';\nvar NOOP_TRACER_PROVIDER = new NoopTracerProvider();\n/**\n * Tracer provider which provides {@link ProxyTracer}s.\n *\n * Before a delegate is set, tracers provided are NoOp.\n *   When a delegate is set, traces are provided from the delegate.\n *   When a delegate is set after tracers have already been provided,\n *   all tracers already provided will use the provided delegate implementation.\n */\nvar ProxyTracerProvider = /** @class */ (function () {\n    function ProxyTracerProvider() {\n    }\n    /**\n     * Get a {@link ProxyTracer}\n     */\n    ProxyTracerProvider.prototype.getTracer = function (name, version, options) {\n        var _a;\n        return ((_a = this.getDelegateTracer(name, version, options)) !== null && _a !== void 0 ? _a : new ProxyTracer(this, name, version, options));\n    };\n    ProxyTracerProvider.prototype.getDelegate = function () {\n        var _a;\n        return (_a = this._delegate) !== null && _a !== void 0 ? _a : NOOP_TRACER_PROVIDER;\n    };\n    /**\n     * Set the delegate tracer provider\n     */\n    ProxyTracerProvider.prototype.setDelegate = function (delegate) {\n        this._delegate = delegate;\n    };\n    ProxyTracerProvider.prototype.getDelegateTracer = function (name, version, options) {\n        var _a;\n        return (_a = this._delegate) === null || _a === void 0 ? void 0 : _a.getTracer(name, version, options);\n    };\n    return ProxyTracerProvider;\n}());\nexport { ProxyTracerProvider };\n//# sourceMappingURL=ProxyTracerProvider.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { NoopTracer } from './NoopTracer';\n/**\n * An implementation of the {@link TracerProvider} which returns an impotent\n * Tracer for all calls to `getTracer`.\n *\n * All operations are no-op.\n */\nvar NoopTracerProvider = /** @class */ (function () {\n    function NoopTracerProvider() {\n    }\n    NoopTracerProvider.prototype.getTracer = function (_name, _version, _options) {\n        return new NoopTracer();\n    };\n    return NoopTracerProvider;\n}());\nexport { NoopTracerProvider };\n//# sourceMappingURL=NoopTracerProvider.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar VALID_KEY_CHAR_RANGE = '[_0-9a-z-*/]';\nvar VALID_KEY = \"[a-z]\" + VALID_KEY_CHAR_RANGE + \"{0,255}\";\nvar VALID_VENDOR_KEY = \"[a-z0-9]\" + VALID_KEY_CHAR_RANGE + \"{0,240}@[a-z]\" + VALID_KEY_CHAR_RANGE + \"{0,13}\";\nvar VALID_KEY_REGEX = new RegExp(\"^(?:\" + VALID_KEY + \"|\" + VALID_VENDOR_KEY + \")$\");\nvar VALID_VALUE_BASE_REGEX = /^[ -~]{0,255}[!-~]$/;\nvar INVALID_VALUE_COMMA_EQUAL_REGEX = /,|=/;\n/**\n * Key is opaque string up to 256 characters printable. It MUST begin with a\n * lowercase letter, and can only contain lowercase letters a-z, digits 0-9,\n * underscores _, dashes -, asterisks *, and forward slashes /.\n * For multi-tenant vendor scenarios, an at sign (@) can be used to prefix the\n * vendor name. Vendors SHOULD set the tenant ID at the beginning of the key.\n * see https://www.w3.org/TR/trace-context/#key\n */\nexport function validateKey(key) {\n    return VALID_KEY_REGEX.test(key);\n}\n/**\n * Value is opaque string up to 256 characters printable ASCII RFC0020\n * characters (i.e., the range 0x20 to 0x7E) except comma , and =.\n */\nexport function validateValue(value) {\n    return (VALID_VALUE_BASE_REGEX.test(value) &&\n        !INVALID_VALUE_COMMA_EQUAL_REGEX.test(value));\n}\n//# sourceMappingURL=tracestate-validators.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { validateKey, validateValue } from './tracestate-validators';\nvar MAX_TRACE_STATE_ITEMS = 32;\nvar MAX_TRACE_STATE_LEN = 512;\nvar LIST_MEMBERS_SEPARATOR = ',';\nvar LIST_MEMBER_KEY_VALUE_SPLITTER = '=';\n/**\n * TraceState must be a class and not a simple object type because of the spec\n * requirement (https://www.w3.org/TR/trace-context/#tracestate-field).\n *\n * Here is the list of allowed mutations:\n * - New key-value pair should be added into the beginning of the list\n * - The value of any key can be updated. Modified keys MUST be moved to the\n * beginning of the list.\n */\nvar TraceStateImpl = /** @class */ (function () {\n    function TraceStateImpl(rawTraceState) {\n        this._internalState = new Map();\n        if (rawTraceState)\n            this._parse(rawTraceState);\n    }\n    TraceStateImpl.prototype.set = function (key, value) {\n        // TODO: Benchmark the different approaches(map vs list) and\n        // use the faster one.\n        var traceState = this._clone();\n        if (traceState._internalState.has(key)) {\n            traceState._internalState.delete(key);\n        }\n        traceState._internalState.set(key, value);\n        return traceState;\n    };\n    TraceStateImpl.prototype.unset = function (key) {\n        var traceState = this._clone();\n        traceState._internalState.delete(key);\n        return traceState;\n    };\n    TraceStateImpl.prototype.get = function (key) {\n        return this._internalState.get(key);\n    };\n    TraceStateImpl.prototype.serialize = function () {\n        var _this = this;\n        return this._keys()\n            .reduce(function (agg, key) {\n            agg.push(key + LIST_MEMBER_KEY_VALUE_SPLITTER + _this.get(key));\n            return agg;\n        }, [])\n            .join(LIST_MEMBERS_SEPARATOR);\n    };\n    TraceStateImpl.prototype._parse = function (rawTraceState) {\n        if (rawTraceState.length > MAX_TRACE_STATE_LEN)\n            return;\n        this._internalState = rawTraceState\n            .split(LIST_MEMBERS_SEPARATOR)\n            .reverse() // Store in reverse so new keys (.set(...)) will be placed at the beginning\n            .reduce(function (agg, part) {\n            var listMember = part.trim(); // Optional Whitespace (OWS) handling\n            var i = listMember.indexOf(LIST_MEMBER_KEY_VALUE_SPLITTER);\n            if (i !== -1) {\n                var key = listMember.slice(0, i);\n                var value = listMember.slice(i + 1, part.length);\n                if (validateKey(key) && validateValue(value)) {\n                    agg.set(key, value);\n                }\n                else {\n                    // TODO: Consider to add warning log\n                }\n            }\n            return agg;\n        }, new Map());\n        // Because of the reverse() requirement, trunc must be done after map is created\n        if (this._internalState.size > MAX_TRACE_STATE_ITEMS) {\n            this._internalState = new Map(Array.from(this._internalState.entries())\n                .reverse() // Use reverse same as original tracestate parse chain\n                .slice(0, MAX_TRACE_STATE_ITEMS));\n        }\n    };\n    TraceStateImpl.prototype._keys = function () {\n        return Array.from(this._internalState.keys()).reverse();\n    };\n    TraceStateImpl.prototype._clone = function () {\n        var traceState = new TraceStateImpl();\n        traceState._internalState = new Map(this._internalState);\n        return traceState;\n    };\n    return TraceStateImpl;\n}());\nexport { TraceStateImpl };\n//# sourceMappingURL=tracestate-impl.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { getGlobal, registerGlobal, unregisterGlobal, } from '../internal/global-utils';\nimport { ProxyTracerProvider } from '../trace/ProxyTracerProvider';\nimport { isSpanContextValid, wrapSpanContext, } from '../trace/spancontext-utils';\nimport { deleteSpan, getActiveSpan, getSpan, getSpanContext, setSpan, setSpanContext, } from '../trace/context-utils';\nimport { DiagAPI } from './diag';\nvar API_NAME = 'trace';\n/**\n * Singleton object which represents the entry point to the OpenTelemetry Tracing API\n */\nvar TraceAPI = /** @class */ (function () {\n    /** Empty private constructor prevents end users from constructing a new instance of the API */\n    function TraceAPI() {\n        this._proxyTracerProvider = new ProxyTracerProvider();\n        this.wrapSpanContext = wrapSpanContext;\n        this.isSpanContextValid = isSpanContextValid;\n        this.deleteSpan = deleteSpan;\n        this.getSpan = getSpan;\n        this.getActiveSpan = getActiveSpan;\n        this.getSpanContext = getSpanContext;\n        this.setSpan = setSpan;\n        this.setSpanContext = setSpanContext;\n    }\n    /** Get the singleton instance of the Trace API */\n    TraceAPI.getInstance = function () {\n        if (!this._instance) {\n            this._instance = new TraceAPI();\n        }\n        return this._instance;\n    };\n    /**\n     * Set the current global tracer.\n     *\n     * @returns true if the tracer provider was successfully registered, else false\n     */\n    TraceAPI.prototype.setGlobalTracerProvider = function (provider) {\n        var success = registerGlobal(API_NAME, this._proxyTracerProvider, DiagAPI.instance());\n        if (success) {\n            this._proxyTracerProvider.setDelegate(provider);\n        }\n        return success;\n    };\n    /**\n     * Returns the global tracer provider.\n     */\n    TraceAPI.prototype.getTracerProvider = function () {\n        return getGlobal(API_NAME) || this._proxyTracerProvider;\n    };\n    /**\n     * Returns a tracer from the global tracer provider.\n     */\n    TraceAPI.prototype.getTracer = function (name, version) {\n        return this.getTracerProvider().getTracer(name, version);\n    };\n    /** Remove the global tracer provider */\n    TraceAPI.prototype.disable = function () {\n        unregisterGlobal(API_NAME, DiagAPI.instance());\n        this._proxyTracerProvider = new ProxyTracerProvider();\n    };\n    return TraceAPI;\n}());\nexport { TraceAPI };\n//# sourceMappingURL=trace.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * No-op implementations of {@link TextMapPropagator}.\n */\nvar NoopTextMapPropagator = /** @class */ (function () {\n    function NoopTextMapPropagator() {\n    }\n    /** Noop inject function does nothing */\n    NoopTextMapPropagator.prototype.inject = function (_context, _carrier) { };\n    /** Noop extract function does nothing and returns the input context */\n    NoopTextMapPropagator.prototype.extract = function (context, _carrier) {\n        return context;\n    };\n    NoopTextMapPropagator.prototype.fields = function () {\n        return [];\n    };\n    return NoopTextMapPropagator;\n}());\nexport { NoopTextMapPropagator };\n//# sourceMappingURL=NoopTextMapPropagator.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { createContextKey } from '../context/context';\n/**\n * Baggage key\n */\nvar BAGGAGE_KEY = createContextKey('OpenTelemetry Baggage Key');\n/**\n * Retrieve the current baggage from the given context\n *\n * @param {Context} Context that manage all context values\n * @returns {Baggage} Extracted baggage from the context\n */\nexport function getBaggage(context) {\n    return context.getValue(BAGGAGE_KEY) || undefined;\n}\n/**\n * Store a baggage in the given context\n *\n * @param {Context} Context that manage all context values\n * @param {Baggage} baggage that will be set in the actual context\n */\nexport function setBaggage(context, baggage) {\n    return context.setValue(BAGGAGE_KEY, baggage);\n}\n/**\n * Delete the baggage stored in the given context\n *\n * @param {Context} Context that manage all context values\n */\nexport function deleteBaggage(context) {\n    return context.deleteValue(BAGGAGE_KEY);\n}\n//# sourceMappingURL=context-helpers.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { getGlobal, registerGlobal, unregisterGlobal, } from '../internal/global-utils';\nimport { NoopTextMapPropagator } from '../propagation/NoopTextMapPropagator';\nimport { defaultTextMapGetter, defaultTextMapSetter, } from '../propagation/TextMapPropagator';\nimport { getBaggage, setBaggage, deleteBaggage, } from '../baggage/context-helpers';\nimport { createBaggage } from '../baggage/utils';\nimport { DiagAPI } from './diag';\nvar API_NAME = 'propagation';\nvar NOOP_TEXT_MAP_PROPAGATOR = new NoopTextMapPropagator();\n/**\n * Singleton object which represents the entry point to the OpenTelemetry Propagation API\n */\nvar PropagationAPI = /** @class */ (function () {\n    /** Empty private constructor prevents end users from constructing a new instance of the API */\n    function PropagationAPI() {\n        this.createBaggage = createBaggage;\n        this.getBaggage = getBaggage;\n        this.setBaggage = setBaggage;\n        this.deleteBaggage = deleteBaggage;\n    }\n    /** Get the singleton instance of the Propagator API */\n    PropagationAPI.getInstance = function () {\n        if (!this._instance) {\n            this._instance = new PropagationAPI();\n        }\n        return this._instance;\n    };\n    /**\n     * Set the current propagator.\n     *\n     * @returns true if the propagator was successfully registered, else false\n     */\n    PropagationAPI.prototype.setGlobalPropagator = function (propagator) {\n        return registerGlobal(API_NAME, propagator, DiagAPI.instance());\n    };\n    /**\n     * Inject context into a carrier to be propagated inter-process\n     *\n     * @param context Context carrying tracing data to inject\n     * @param carrier carrier to inject context into\n     * @param setter Function used to set values on the carrier\n     */\n    PropagationAPI.prototype.inject = function (context, carrier, setter) {\n        if (setter === void 0) { setter = defaultTextMapSetter; }\n        return this._getGlobalPropagator().inject(context, carrier, setter);\n    };\n    /**\n     * Extract context from a carrier\n     *\n     * @param context Context which the newly created context will inherit from\n     * @param carrier Carrier to extract context from\n     * @param getter Function used to extract keys from a carrier\n     */\n    PropagationAPI.prototype.extract = function (context, carrier, getter) {\n        if (getter === void 0) { getter = defaultTextMapGetter; }\n        return this._getGlobalPropagator().extract(context, carrier, getter);\n    };\n    /**\n     * Return a list of all fields which may be used by the propagator.\n     */\n    PropagationAPI.prototype.fields = function () {\n        return this._getGlobalPropagator().fields();\n    };\n    /** Remove the global propagator */\n    PropagationAPI.prototype.disable = function () {\n        unregisterGlobal(API_NAME, DiagAPI.instance());\n    };\n    PropagationAPI.prototype._getGlobalPropagator = function () {\n        return getGlobal(API_NAME) || NOOP_TEXT_MAP_PROPAGATOR;\n    };\n    return PropagationAPI;\n}());\nexport { PropagationAPI };\n//# sourceMappingURL=propagation.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nexport * from './baggage/types';\nexport { baggageEntryMetadataFromString } from './baggage/utils';\nexport * from './common/Exception';\nexport * from './common/Time';\nexport * from './common/Attributes';\nexport * from './diag';\nexport * from './propagation/TextMapPropagator';\nexport * from './trace/attributes';\nexport * from './trace/link';\nexport * from './trace/ProxyTracer';\nexport * from './trace/ProxyTracerProvider';\nexport * from './trace/Sampler';\nexport * from './trace/SamplingResult';\nexport * from './trace/span_context';\nexport * from './trace/span_kind';\nexport * from './trace/span';\nexport * from './trace/SpanOptions';\nexport * from './trace/status';\nexport * from './trace/trace_flags';\nexport * from './trace/trace_state';\nexport { createTraceState } from './trace/internal/utils';\nexport * from './trace/tracer_provider';\nexport * from './trace/tracer';\nexport * from './trace/tracer_options';\nexport { isSpanContextValid, isValidTraceId, isValidSpanId, } from './trace/spancontext-utils';\nexport { INVALID_SPANID, INVALID_TRACEID, INVALID_SPAN_CONTEXT, } from './trace/invalid-span-constants';\nexport * from './context/context';\nexport * from './context/types';\nimport { ContextAPI } from './api/context';\n/** Entrypoint for context API */\nexport var context = ContextAPI.getInstance();\nimport { TraceAPI } from './api/trace';\n/** Entrypoint for trace API */\nexport var trace = TraceAPI.getInstance();\nimport { PropagationAPI } from './api/propagation';\n/** Entrypoint for propagation API */\nexport var propagation = PropagationAPI.getInstance();\nimport { DiagAPI } from './api/diag';\n/**\n * Entrypoint for Diag API.\n * Defines Diagnostic handler used for internal diagnostic logging operations.\n * The default provides a Noop DiagLogger implementation which may be changed via the\n * diag.setLogger(logger: DiagLogger) function.\n */\nexport var diag = DiagAPI.instance();\nexport default {\n    trace: trace,\n    context: context,\n    propagation: propagation,\n    diag: diag,\n};\n//# sourceMappingURL=index.js.map","import { MediaDeviceOptions, UserMedia } from '../types/scene';\n\nconst convertToUserMedia = (\n  options: MediaDeviceOptions | undefined,\n  fallbackValue: UserMedia = UserMedia.None\n) => {\n  if (!options) {\n    return fallbackValue;\n  }\n\n  if (options.camera && options.microphone) {\n    return UserMedia.MicrophoneAndCamera;\n  } else if (options.camera) {\n    return UserMedia.Camera;\n  } else if (options.microphone) {\n    return UserMedia.Microphone;\n  } else {\n    return UserMedia.None;\n  }\n};\n\nexport default convertToUserMedia;\n","/**\n * Replace \"wss://\" at the front of the URL with \"https://\".\n * @param uri the uri to convert\n * @returns the converted uri\n */\nexport function convertWssToHttps(uri: string) {\n  return uri.replace(/^wss:\\/\\//, 'https://');\n}\n\n/**\n * Removes the path and search parameters from the url.\n * @param url - The url to be sanitized.\n * @returns The sanitized url.\n */\nexport function getUrlHost(url: string): string | undefined {\n  try {\n    if (!url) {\n      return undefined;\n    }\n    const outUrl = new URL(url);\n    // remove path and query params\n    outUrl.pathname = '';\n    outUrl.search = '';\n    return outUrl.toString();\n  } catch (e) {\n    return undefined;\n  }\n}\n","/**\n * @public\n */\nexport enum ConversationStateTypes {\n  dpSpeaking = 'dpSpeaking',\n  userSpeaking = 'userSpeaking',\n  dpProcessing = 'dpProcessing',\n  idle = 'idle',\n}\n","/**\n * @module smwebsdk\n */\n\nimport { ConversationStateTypes } from './enums/ConversationStateTypes';\nimport { SmEvent } from './SmEvent';\nimport { SpeechState } from './websocket-message/enums/SpeechState';\nimport { RecognizeResultsResponseBody } from './websocket-message/scene';\nimport { StateResponseBody } from './websocket-message/scene/response-body/StateResponseBody';\nimport { Logger } from './utils/Logger';\n\n/**\n * Determines and stores Conversation State.\n *\n * @public\n */\nexport class ConversationState {\n  private _conversationState: ConversationStateTypes =\n    ConversationStateTypes.idle;\n  private _userActive = false;\n  private _onConversationStateUpdated: SmEvent;\n\n  constructor(private logger = new Logger()) {\n    this._onConversationStateUpdated = new SmEvent();\n  }\n  public processStateMessage(responseBody: StateResponseBody) {\n    if (\n      responseBody &&\n      responseBody.persona &&\n      Object.keys(responseBody.persona).length > 0\n    ) {\n      const dpId: string = Object.keys(responseBody.persona)[0];\n      if (!this._userActive && responseBody.persona[dpId].speechState) {\n        const messageSpeechState: SpeechState = responseBody.persona[dpId]\n          .speechState as SpeechState;\n        if (messageSpeechState === SpeechState.Idle) {\n          this.setSpeechState(ConversationStateTypes.idle);\n        } else if (messageSpeechState === SpeechState.Speaking) {\n          this.setSpeechState(ConversationStateTypes.dpSpeaking);\n        }\n      }\n    }\n  }\n\n  public processRecognizeResultsMessage(\n    responseBody: RecognizeResultsResponseBody\n  ) {\n    this._userActive = true;\n    const isErrorMessage = responseBody.status !== 0;\n    const isFinal =\n      responseBody.results &&\n      responseBody.results.some((result) => result.final);\n    if (isErrorMessage) {\n      const errorMessage =\n        typeof responseBody.errorMessage !== 'undefined'\n          ? responseBody.errorMessage\n          : 'recognizeResults sent back a message with non-zero status but no error message.';\n      this.logger.log('error', errorMessage);\n    } else if (isFinal) {\n      this.setSpeechState(ConversationStateTypes.dpProcessing);\n    } else {\n      this.setSpeechState(ConversationStateTypes.userSpeaking);\n    }\n    this._userActive = false;\n  }\n\n  private setSpeechState(speechState: ConversationStateTypes) {\n    if (this._conversationState !== speechState) {\n      this._conversationState = speechState;\n      this._onConversationStateUpdated.call(this._conversationState);\n    }\n  }\n\n  public getSpeechState(): ConversationStateTypes {\n    return this._conversationState;\n  }\n\n  public get onConversationStateUpdated(): SmEvent {\n    return this._onConversationStateUpdated;\n  }\n\n  public reset() {\n    this._userActive = false;\n    this._conversationState = ConversationStateTypes.idle;\n    this._onConversationStateUpdated.call(this._conversationState);\n  }\n}\n","import { ContentCard, ContentCardFormattedData } from './models/Conversation';\nimport { ConversationResultResponseBody } from './websocket-message/scene';\n\n/**\n * Formats content card data in a consistent structure\n *\n * @public\n */\nexport class ContentCardFormatter {\n  /**\n   * Format different NLP content cards into a consistent structure\n   */\n  format(body: ConversationResultResponseBody): ContentCardFormattedData[] {\n    const fullfillments =\n      body.provider.meta.dialogflow?.queryResult.fulfillmentMessages;\n\n    const data = fullfillments?.find((fullfillment) =>\n      Boolean(fullfillment?.payload)\n    );\n    if (data) {\n      return this.formatLegacyDialogflow(data);\n    }\n    return this.formatContextData(body.output.context);\n  }\n\n  private formatLegacyDialogflow(data: {\n    payload: { soulmachines: Record<string, ContentCard> };\n  }) {\n    const payload = data.payload.soulmachines;\n    return Object.keys(payload).map((id) => {\n      return {\n        id,\n        data: {\n          id,\n          ...this.formatCardData(payload[id]),\n        },\n      };\n    });\n  }\n\n  private formatContextData(data: Record<string, string | unknown>) {\n    return this.allowedIds(data).map((id) => {\n      const cardId = id.replace('public-', '');\n\n      return {\n        id: cardId,\n        data: {\n          id: cardId,\n          ...this.formatCardData(data[id]),\n        },\n      };\n    });\n  }\n\n  private allowedIds<T>(values: Record<string, T>) {\n    return Object.keys(values)\n      .filter((k) => /public-/.test(k) === true)\n      .filter((k: string) => /\\.original/gm.test(k) === false);\n  }\n\n  // Data should be JSON or a ContentCard, however, we can attempt to parse\n  // unknown values as JSON.\n  private formatCardData(data: ContentCard | string | unknown) {\n    const parsedData = typeof data === 'string' ? JSON.parse(data) : data;\n    const { component, type, ...rest } = parsedData;\n\n    return {\n      type: type ? type : component,\n      ...rest,\n    };\n  }\n}\n","import { ContentCardRawData } from './models/Conversation';\nimport { SmEvent } from './SmEvent';\nimport { Logger } from './utils/Logger';\nimport {\n  ConversationResultResponseBody,\n  RecognizeResultsResponseBody,\n  SpeechMarkerResponseBody,\n  StateResponseBody,\n} from './websocket-message/scene';\nimport { SpeechMarkerName } from './websocket-message/scene/response-body/SpeechMarker';\nimport { ConversationState } from './ConversationState';\nimport { ContentCardFormatter } from './ContentCardFormatter';\n\n/**\n * Stores content cards and conversation state\n *\n * @public\n */\nexport class Conversation {\n  public cardData: Map<string, ContentCardRawData>;\n  public activeCardIds: Set<string>;\n  private _onCardChanged: SmEvent = new SmEvent();\n  private _autoClearCards = false;\n\n  constructor(\n    private logger = new Logger(),\n    private conversationState = new ConversationState(),\n    private contentCardFormatter = new ContentCardFormatter()\n  ) {\n    this.cardData = new Map();\n    this.activeCardIds = new Set();\n  }\n\n  public processStateMessage(message: StateResponseBody) {\n    this.conversationState.processStateMessage(message);\n  }\n\n  public processRecognizeResultsMessage(message: RecognizeResultsResponseBody) {\n    this.conversationState.processRecognizeResultsMessage(message);\n  }\n\n  /**\n   * A callback function which fires when conversation state changes\n   */\n  public get onConversationStateUpdated() {\n    return this.conversationState.onConversationStateUpdated;\n  }\n\n  /**\n   * Automatically clear active content cards each conversation turn\n   */\n  public set autoClearCards(enabled: boolean) {\n    this._autoClearCards = enabled;\n  }\n\n  /**\n   * A callback function which fires when active cards are changed\n   */\n  public get onCardChanged(): SmEvent {\n    return this._onCardChanged;\n  }\n\n  get activeCards(): ContentCardRawData[] {\n    const activeCardInfo: ContentCardRawData[] = [];\n    this.activeCardIds.forEach((id) => {\n      const data = this.cardData.get(id);\n      if (data) {\n        activeCardInfo.push(data);\n      } else {\n        this.logger.log('error', `card data for ${id} does not exist`);\n      }\n    });\n\n    return activeCardInfo;\n  }\n\n  /**\n   * Handles speech marker messages and updates the active card state\n   */\n  public onSpeechMarker(messageBody: SpeechMarkerResponseBody): void {\n    const cardIds = messageBody.arguments;\n    if (messageBody.name === SpeechMarkerName.Showcards) {\n      this.addActiveCardIds(cardIds);\n    } else if (messageBody.name === SpeechMarkerName.Hidecards) {\n      this.removeActiveCards(cardIds);\n    }\n    if (\n      // Hide all cards when arg list is empty and hidecards message is received\n      cardIds.length === 0 &&\n      messageBody.name === SpeechMarkerName.Hidecards\n    ) {\n      this.clearActiveCards();\n    }\n  }\n\n  /**\n   * Stores content card data contained in conversation result messages\n   */\n  public onConversationResult(\n    messageBody: ConversationResultResponseBody\n  ): void {\n    const cards = this.contentCardFormatter.format(messageBody);\n\n    if (this._autoClearCards) {\n      this.clearActiveCards();\n    }\n\n    cards.map(({ id, data }) => {\n      this.cardData.set(id, data);\n    });\n  }\n\n  /**\n   * Clears active card ids and data. Emits a card changed event\n   */\n  public reset() {\n    this.clearActiveCards();\n    this.cardData.clear();\n    this.conversationState.reset();\n  }\n\n  /**\n   * Clears active card ids. Emits a card changed event\n   */\n  public clearActiveCards() {\n    this.activeCardIds.clear();\n    this.onCardChanged.call(this.activeCards);\n  }\n\n  private addActiveCardIds(cardIds: string[]) {\n    this.activeCardIds = new Set([...this.activeCardIds, ...cardIds]);\n    this.onCardChanged.call(this.activeCards);\n  }\n\n  private removeActiveCards(cardIds: string[]) {\n    cardIds.forEach((cardId) => this.activeCardIds.delete(cardId));\n    this.onCardChanged.call(this.activeCards);\n  }\n}\n","import { Scene } from './Scene';\nimport { NLPIntent } from './types/scene';\nimport { ConversationSendRequestBody } from './websocket-message/scene';\n\nexport class MetadataSender {\n  private _previousUrl = window.location.href;\n  private _observer: MutationObserver;\n\n  constructor(private scene: Scene) {\n    this._observer = new MutationObserver(() => this.observeDocumentChanges());\n  }\n\n  public observeUrlChanges() {\n    this._observer.observe(document, { subtree: true, childList: true });\n  }\n\n  public disconnect() {\n    this._observer.disconnect();\n  }\n\n  public send() {\n    const conversationVariables: ConversationSendRequestBody = {\n      personaId: this.scene.currentPersonaId,\n      text: NLPIntent.PAGE_METADATA,\n      variables: {\n        pageUrl: window.location.href.split('?')[0],\n      },\n      optionalArgs: {},\n    };\n\n    this.scene.sendRequest('conversationSend', conversationVariables);\n  }\n\n  private observeDocumentChanges() {\n    if (window.location.href !== this._previousUrl) {\n      // Update url to current one\n      this._previousUrl = window.location.href;\n      // Send event\n      this.send();\n    }\n  }\n}\n","/**\n * @module smwebsdk\n */\n\nimport {\n  ConnectionStateData,\n  ConnectionStateTypes,\n} from './enums/ConnectionStateTypes';\nimport { SmEvent } from './SmEvent';\n\nconst TOTAL_CONNECTION_STEPS = Object.keys(ConnectionStateTypes).length;\n\n/**\n * Determines and stores Connection State.\n *\n * @public\n */\nexport class ConnectionState {\n  private _connectionState: ConnectionStateData = {\n    name: ConnectionStateTypes.Disconnected,\n    totalSteps: TOTAL_CONNECTION_STEPS,\n    currentStep: 0,\n    percentageLoaded: 0,\n  };\n\n  private _onConnectionStateUpdated: SmEvent;\n\n  constructor() {\n    this._onConnectionStateUpdated = new SmEvent();\n  }\n\n  public setConnectionState(connectionStateType: ConnectionStateTypes) {\n    // Return if state has not changed\n    if (this._connectionState.name === connectionStateType) {\n      return;\n    }\n\n    const currentStep =\n      Object.keys(ConnectionStateTypes).indexOf(connectionStateType);\n\n    const data: ConnectionStateData = {\n      name: connectionStateType,\n      currentStep: currentStep,\n      totalSteps: TOTAL_CONNECTION_STEPS,\n      percentageLoaded: (100 / (TOTAL_CONNECTION_STEPS - 1)) * currentStep,\n    };\n\n    this._connectionState = data;\n    this._onConnectionStateUpdated.call(data);\n  }\n\n  public getConnectionState(): ConnectionStateData {\n    return this._connectionState;\n  }\n\n  public get onConnectionStateUpdated(): SmEvent {\n    return this._onConnectionStateUpdated;\n  }\n\n  public reset() {\n    this.setConnectionState(ConnectionStateTypes.Disconnected);\n  }\n}\n","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n// DO NOT EDIT, this is an Auto-generated file from scripts/semconv/templates//templates/SemanticAttributes.ts.j2\nexport var SemanticResourceAttributes = {\n    /**\n    * Name of the cloud provider.\n    */\n    CLOUD_PROVIDER: 'cloud.provider',\n    /**\n    * The cloud account ID the resource is assigned to.\n    */\n    CLOUD_ACCOUNT_ID: 'cloud.account.id',\n    /**\n    * The geographical region the resource is running. Refer to your provider&#39;s docs to see the available regions, for example [Alibaba Cloud regions](https://www.alibabacloud.com/help/doc-detail/40654.htm), [AWS regions](https://aws.amazon.com/about-aws/global-infrastructure/regions_az/), [Azure regions](https://azure.microsoft.com/en-us/global-infrastructure/geographies/), or [Google Cloud regions](https://cloud.google.com/about/locations).\n    */\n    CLOUD_REGION: 'cloud.region',\n    /**\n    * Cloud regions often have multiple, isolated locations known as zones to increase availability. Availability zone represents the zone where the resource is running.\n    *\n    * Note: Availability zones are called &#34;zones&#34; on Alibaba Cloud and Google Cloud.\n    */\n    CLOUD_AVAILABILITY_ZONE: 'cloud.availability_zone',\n    /**\n    * The cloud platform in use.\n    *\n    * Note: The prefix of the service SHOULD match the one specified in `cloud.provider`.\n    */\n    CLOUD_PLATFORM: 'cloud.platform',\n    /**\n    * The Amazon Resource Name (ARN) of an [ECS container instance](https://docs.aws.amazon.com/AmazonECS/latest/developerguide/ECS_instances.html).\n    */\n    AWS_ECS_CONTAINER_ARN: 'aws.ecs.container.arn',\n    /**\n    * The ARN of an [ECS cluster](https://docs.aws.amazon.com/AmazonECS/latest/developerguide/clusters.html).\n    */\n    AWS_ECS_CLUSTER_ARN: 'aws.ecs.cluster.arn',\n    /**\n    * The [launch type](https://docs.aws.amazon.com/AmazonECS/latest/developerguide/launch_types.html) for an ECS task.\n    */\n    AWS_ECS_LAUNCHTYPE: 'aws.ecs.launchtype',\n    /**\n    * The ARN of an [ECS task definition](https://docs.aws.amazon.com/AmazonECS/latest/developerguide/task_definitions.html).\n    */\n    AWS_ECS_TASK_ARN: 'aws.ecs.task.arn',\n    /**\n    * The task definition family this task definition is a member of.\n    */\n    AWS_ECS_TASK_FAMILY: 'aws.ecs.task.family',\n    /**\n    * The revision for this task definition.\n    */\n    AWS_ECS_TASK_REVISION: 'aws.ecs.task.revision',\n    /**\n    * The ARN of an EKS cluster.\n    */\n    AWS_EKS_CLUSTER_ARN: 'aws.eks.cluster.arn',\n    /**\n    * The name(s) of the AWS log group(s) an application is writing to.\n    *\n    * Note: Multiple log groups must be supported for cases like multi-container applications, where a single application has sidecar containers, and each write to their own log group.\n    */\n    AWS_LOG_GROUP_NAMES: 'aws.log.group.names',\n    /**\n    * The Amazon Resource Name(s) (ARN) of the AWS log group(s).\n    *\n    * Note: See the [log group ARN format documentation](https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/iam-access-control-overview-cwl.html#CWL_ARN_Format).\n    */\n    AWS_LOG_GROUP_ARNS: 'aws.log.group.arns',\n    /**\n    * The name(s) of the AWS log stream(s) an application is writing to.\n    */\n    AWS_LOG_STREAM_NAMES: 'aws.log.stream.names',\n    /**\n    * The ARN(s) of the AWS log stream(s).\n    *\n    * Note: See the [log stream ARN format documentation](https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/iam-access-control-overview-cwl.html#CWL_ARN_Format). One log group can contain several log streams, so these ARNs necessarily identify both a log group and a log stream.\n    */\n    AWS_LOG_STREAM_ARNS: 'aws.log.stream.arns',\n    /**\n    * Container name.\n    */\n    CONTAINER_NAME: 'container.name',\n    /**\n    * Container ID. Usually a UUID, as for example used to [identify Docker containers](https://docs.docker.com/engine/reference/run/#container-identification). The UUID might be abbreviated.\n    */\n    CONTAINER_ID: 'container.id',\n    /**\n    * The container runtime managing this container.\n    */\n    CONTAINER_RUNTIME: 'container.runtime',\n    /**\n    * Name of the image the container was built on.\n    */\n    CONTAINER_IMAGE_NAME: 'container.image.name',\n    /**\n    * Container image tag.\n    */\n    CONTAINER_IMAGE_TAG: 'container.image.tag',\n    /**\n    * Name of the [deployment environment](https://en.wikipedia.org/wiki/Deployment_environment) (aka deployment tier).\n    */\n    DEPLOYMENT_ENVIRONMENT: 'deployment.environment',\n    /**\n    * A unique identifier representing the device.\n    *\n    * Note: The device identifier MUST only be defined using the values outlined below. This value is not an advertising identifier and MUST NOT be used as such. On iOS (Swift or Objective-C), this value MUST be equal to the [vendor identifier](https://developer.apple.com/documentation/uikit/uidevice/1620059-identifierforvendor). On Android (Java or Kotlin), this value MUST be equal to the Firebase Installation ID or a globally unique UUID which is persisted across sessions in your application. More information can be found [here](https://developer.android.com/training/articles/user-data-ids) on best practices and exact implementation details. Caution should be taken when storing personal data or anything which can identify a user. GDPR and data protection laws may apply, ensure you do your own due diligence.\n    */\n    DEVICE_ID: 'device.id',\n    /**\n    * The model identifier for the device.\n    *\n    * Note: It&#39;s recommended this value represents a machine readable version of the model identifier rather than the market or consumer-friendly name of the device.\n    */\n    DEVICE_MODEL_IDENTIFIER: 'device.model.identifier',\n    /**\n    * The marketing name for the device model.\n    *\n    * Note: It&#39;s recommended this value represents a human readable version of the device model rather than a machine readable alternative.\n    */\n    DEVICE_MODEL_NAME: 'device.model.name',\n    /**\n    * The name of the single function that this runtime instance executes.\n    *\n    * Note: This is the name of the function as configured/deployed on the FaaS platform and is usually different from the name of the callback function (which may be stored in the [`code.namespace`/`code.function`](../../trace/semantic_conventions/span-general.md#source-code-attributes) span attributes).\n    */\n    FAAS_NAME: 'faas.name',\n    /**\n    * The unique ID of the single function that this runtime instance executes.\n    *\n    * Note: Depending on the cloud provider, use:\n  \n  * **AWS Lambda:** The function [ARN](https://docs.aws.amazon.com/general/latest/gr/aws-arns-and-namespaces.html).\n  Take care not to use the &#34;invoked ARN&#34; directly but replace any\n  [alias suffix](https://docs.aws.amazon.com/lambda/latest/dg/configuration-aliases.html) with the resolved function version, as the same runtime instance may be invokable with multiple\n  different aliases.\n  * **GCP:** The [URI of the resource](https://cloud.google.com/iam/docs/full-resource-names)\n  * **Azure:** The [Fully Qualified Resource ID](https://docs.microsoft.com/en-us/rest/api/resources/resources/get-by-id).\n  \n  On some providers, it may not be possible to determine the full ID at startup,\n  which is why this field cannot be made required. For example, on AWS the account ID\n  part of the ARN is not available without calling another AWS API\n  which may be deemed too slow for a short-running lambda function.\n  As an alternative, consider setting `faas.id` as a span attribute instead.\n    */\n    FAAS_ID: 'faas.id',\n    /**\n    * The immutable version of the function being executed.\n    *\n    * Note: Depending on the cloud provider and platform, use:\n  \n  * **AWS Lambda:** The [function version](https://docs.aws.amazon.com/lambda/latest/dg/configuration-versions.html)\n    (an integer represented as a decimal string).\n  * **Google Cloud Run:** The [revision](https://cloud.google.com/run/docs/managing/revisions)\n    (i.e., the function name plus the revision suffix).\n  * **Google Cloud Functions:** The value of the\n    [`K_REVISION` environment variable](https://cloud.google.com/functions/docs/env-var#runtime_environment_variables_set_automatically).\n  * **Azure Functions:** Not applicable. Do not set this attribute.\n    */\n    FAAS_VERSION: 'faas.version',\n    /**\n    * The execution environment ID as a string, that will be potentially reused for other invocations to the same function/function version.\n    *\n    * Note: * **AWS Lambda:** Use the (full) log stream name.\n    */\n    FAAS_INSTANCE: 'faas.instance',\n    /**\n    * The amount of memory available to the serverless function in MiB.\n    *\n    * Note: It&#39;s recommended to set this attribute since e.g. too little memory can easily stop a Java AWS Lambda function from working correctly. On AWS Lambda, the environment variable `AWS_LAMBDA_FUNCTION_MEMORY_SIZE` provides this information.\n    */\n    FAAS_MAX_MEMORY: 'faas.max_memory',\n    /**\n    * Unique host ID. For Cloud, this must be the instance_id assigned by the cloud provider.\n    */\n    HOST_ID: 'host.id',\n    /**\n    * Name of the host. On Unix systems, it may contain what the hostname command returns, or the fully qualified hostname, or another name specified by the user.\n    */\n    HOST_NAME: 'host.name',\n    /**\n    * Type of host. For Cloud, this must be the machine type.\n    */\n    HOST_TYPE: 'host.type',\n    /**\n    * The CPU architecture the host system is running on.\n    */\n    HOST_ARCH: 'host.arch',\n    /**\n    * Name of the VM image or OS install the host was instantiated from.\n    */\n    HOST_IMAGE_NAME: 'host.image.name',\n    /**\n    * VM image ID. For Cloud, this value is from the provider.\n    */\n    HOST_IMAGE_ID: 'host.image.id',\n    /**\n    * The version string of the VM image as defined in [Version SpanAttributes](README.md#version-attributes).\n    */\n    HOST_IMAGE_VERSION: 'host.image.version',\n    /**\n    * The name of the cluster.\n    */\n    K8S_CLUSTER_NAME: 'k8s.cluster.name',\n    /**\n    * The name of the Node.\n    */\n    K8S_NODE_NAME: 'k8s.node.name',\n    /**\n    * The UID of the Node.\n    */\n    K8S_NODE_UID: 'k8s.node.uid',\n    /**\n    * The name of the namespace that the pod is running in.\n    */\n    K8S_NAMESPACE_NAME: 'k8s.namespace.name',\n    /**\n    * The UID of the Pod.\n    */\n    K8S_POD_UID: 'k8s.pod.uid',\n    /**\n    * The name of the Pod.\n    */\n    K8S_POD_NAME: 'k8s.pod.name',\n    /**\n    * The name of the Container in a Pod template.\n    */\n    K8S_CONTAINER_NAME: 'k8s.container.name',\n    /**\n    * The UID of the ReplicaSet.\n    */\n    K8S_REPLICASET_UID: 'k8s.replicaset.uid',\n    /**\n    * The name of the ReplicaSet.\n    */\n    K8S_REPLICASET_NAME: 'k8s.replicaset.name',\n    /**\n    * The UID of the Deployment.\n    */\n    K8S_DEPLOYMENT_UID: 'k8s.deployment.uid',\n    /**\n    * The name of the Deployment.\n    */\n    K8S_DEPLOYMENT_NAME: 'k8s.deployment.name',\n    /**\n    * The UID of the StatefulSet.\n    */\n    K8S_STATEFULSET_UID: 'k8s.statefulset.uid',\n    /**\n    * The name of the StatefulSet.\n    */\n    K8S_STATEFULSET_NAME: 'k8s.statefulset.name',\n    /**\n    * The UID of the DaemonSet.\n    */\n    K8S_DAEMONSET_UID: 'k8s.daemonset.uid',\n    /**\n    * The name of the DaemonSet.\n    */\n    K8S_DAEMONSET_NAME: 'k8s.daemonset.name',\n    /**\n    * The UID of the Job.\n    */\n    K8S_JOB_UID: 'k8s.job.uid',\n    /**\n    * The name of the Job.\n    */\n    K8S_JOB_NAME: 'k8s.job.name',\n    /**\n    * The UID of the CronJob.\n    */\n    K8S_CRONJOB_UID: 'k8s.cronjob.uid',\n    /**\n    * The name of the CronJob.\n    */\n    K8S_CRONJOB_NAME: 'k8s.cronjob.name',\n    /**\n    * The operating system type.\n    */\n    OS_TYPE: 'os.type',\n    /**\n    * Human readable (not intended to be parsed) OS version information, like e.g. reported by `ver` or `lsb_release -a` commands.\n    */\n    OS_DESCRIPTION: 'os.description',\n    /**\n    * Human readable operating system name.\n    */\n    OS_NAME: 'os.name',\n    /**\n    * The version string of the operating system as defined in [Version SpanAttributes](../../resource/semantic_conventions/README.md#version-attributes).\n    */\n    OS_VERSION: 'os.version',\n    /**\n    * Process identifier (PID).\n    */\n    PROCESS_PID: 'process.pid',\n    /**\n    * The name of the process executable. On Linux based systems, can be set to the `Name` in `proc/[pid]/status`. On Windows, can be set to the base name of `GetProcessImageFileNameW`.\n    */\n    PROCESS_EXECUTABLE_NAME: 'process.executable.name',\n    /**\n    * The full path to the process executable. On Linux based systems, can be set to the target of `proc/[pid]/exe`. On Windows, can be set to the result of `GetProcessImageFileNameW`.\n    */\n    PROCESS_EXECUTABLE_PATH: 'process.executable.path',\n    /**\n    * The command used to launch the process (i.e. the command name). On Linux based systems, can be set to the zeroth string in `proc/[pid]/cmdline`. On Windows, can be set to the first parameter extracted from `GetCommandLineW`.\n    */\n    PROCESS_COMMAND: 'process.command',\n    /**\n    * The full command used to launch the process as a single string representing the full command. On Windows, can be set to the result of `GetCommandLineW`. Do not set this if you have to assemble it just for monitoring; use `process.command_args` instead.\n    */\n    PROCESS_COMMAND_LINE: 'process.command_line',\n    /**\n    * All the command arguments (including the command/executable itself) as received by the process. On Linux-based systems (and some other Unixoid systems supporting procfs), can be set according to the list of null-delimited strings extracted from `proc/[pid]/cmdline`. For libc-based executables, this would be the full argv vector passed to `main`.\n    */\n    PROCESS_COMMAND_ARGS: 'process.command_args',\n    /**\n    * The username of the user that owns the process.\n    */\n    PROCESS_OWNER: 'process.owner',\n    /**\n    * The name of the runtime of this process. For compiled native binaries, this SHOULD be the name of the compiler.\n    */\n    PROCESS_RUNTIME_NAME: 'process.runtime.name',\n    /**\n    * The version of the runtime of this process, as returned by the runtime without modification.\n    */\n    PROCESS_RUNTIME_VERSION: 'process.runtime.version',\n    /**\n    * An additional description about the runtime of the process, for example a specific vendor customization of the runtime environment.\n    */\n    PROCESS_RUNTIME_DESCRIPTION: 'process.runtime.description',\n    /**\n    * Logical name of the service.\n    *\n    * Note: MUST be the same for all instances of horizontally scaled services. If the value was not specified, SDKs MUST fallback to `unknown_service:` concatenated with [`process.executable.name`](process.md#process), e.g. `unknown_service:bash`. If `process.executable.name` is not available, the value MUST be set to `unknown_service`.\n    */\n    SERVICE_NAME: 'service.name',\n    /**\n    * A namespace for `service.name`.\n    *\n    * Note: A string value having a meaning that helps to distinguish a group of services, for example the team name that owns a group of services. `service.name` is expected to be unique within the same namespace. If `service.namespace` is not specified in the Resource then `service.name` is expected to be unique for all services that have no explicit namespace defined (so the empty/unspecified namespace is simply one more valid namespace). Zero-length namespace string is assumed equal to unspecified namespace.\n    */\n    SERVICE_NAMESPACE: 'service.namespace',\n    /**\n    * The string ID of the service instance.\n    *\n    * Note: MUST be unique for each instance of the same `service.namespace,service.name` pair (in other words `service.namespace,service.name,service.instance.id` triplet MUST be globally unique). The ID helps to distinguish instances of the same service that exist at the same time (e.g. instances of a horizontally scaled service). It is preferable for the ID to be persistent and stay the same for the lifetime of the service instance, however it is acceptable that the ID is ephemeral and changes during important lifetime events for the service (e.g. service restarts). If the service has no inherent unique ID that can be used as the value of this attribute it is recommended to generate a random Version 1 or Version 4 RFC 4122 UUID (services aiming for reproducible UUIDs may also use Version 5, see RFC 4122 for more recommendations).\n    */\n    SERVICE_INSTANCE_ID: 'service.instance.id',\n    /**\n    * The version string of the service API or implementation.\n    */\n    SERVICE_VERSION: 'service.version',\n    /**\n    * The name of the telemetry SDK as defined above.\n    */\n    TELEMETRY_SDK_NAME: 'telemetry.sdk.name',\n    /**\n    * The language of the telemetry SDK.\n    */\n    TELEMETRY_SDK_LANGUAGE: 'telemetry.sdk.language',\n    /**\n    * The version string of the telemetry SDK.\n    */\n    TELEMETRY_SDK_VERSION: 'telemetry.sdk.version',\n    /**\n    * The version string of the auto instrumentation agent, if used.\n    */\n    TELEMETRY_AUTO_VERSION: 'telemetry.auto.version',\n    /**\n    * The name of the web engine.\n    */\n    WEBENGINE_NAME: 'webengine.name',\n    /**\n    * The version of the web engine.\n    */\n    WEBENGINE_VERSION: 'webengine.version',\n    /**\n    * Additional description of the web engine (e.g. detailed version and edition information).\n    */\n    WEBENGINE_DESCRIPTION: 'webengine.description',\n};\nexport var CloudProviderValues = {\n    /** Alibaba Cloud. */\n    ALIBABA_CLOUD: 'alibaba_cloud',\n    /** Amazon Web Services. */\n    AWS: 'aws',\n    /** Microsoft Azure. */\n    AZURE: 'azure',\n    /** Google Cloud Platform. */\n    GCP: 'gcp',\n};\nexport var CloudPlatformValues = {\n    /** Alibaba Cloud Elastic Compute Service. */\n    ALIBABA_CLOUD_ECS: 'alibaba_cloud_ecs',\n    /** Alibaba Cloud Function Compute. */\n    ALIBABA_CLOUD_FC: 'alibaba_cloud_fc',\n    /** AWS Elastic Compute Cloud. */\n    AWS_EC2: 'aws_ec2',\n    /** AWS Elastic Container Service. */\n    AWS_ECS: 'aws_ecs',\n    /** AWS Elastic Kubernetes Service. */\n    AWS_EKS: 'aws_eks',\n    /** AWS Lambda. */\n    AWS_LAMBDA: 'aws_lambda',\n    /** AWS Elastic Beanstalk. */\n    AWS_ELASTIC_BEANSTALK: 'aws_elastic_beanstalk',\n    /** Azure Virtual Machines. */\n    AZURE_VM: 'azure_vm',\n    /** Azure Container Instances. */\n    AZURE_CONTAINER_INSTANCES: 'azure_container_instances',\n    /** Azure Kubernetes Service. */\n    AZURE_AKS: 'azure_aks',\n    /** Azure Functions. */\n    AZURE_FUNCTIONS: 'azure_functions',\n    /** Azure App Service. */\n    AZURE_APP_SERVICE: 'azure_app_service',\n    /** Google Cloud Compute Engine (GCE). */\n    GCP_COMPUTE_ENGINE: 'gcp_compute_engine',\n    /** Google Cloud Run. */\n    GCP_CLOUD_RUN: 'gcp_cloud_run',\n    /** Google Cloud Kubernetes Engine (GKE). */\n    GCP_KUBERNETES_ENGINE: 'gcp_kubernetes_engine',\n    /** Google Cloud Functions (GCF). */\n    GCP_CLOUD_FUNCTIONS: 'gcp_cloud_functions',\n    /** Google Cloud App Engine (GAE). */\n    GCP_APP_ENGINE: 'gcp_app_engine',\n};\nexport var AwsEcsLaunchtypeValues = {\n    /** ec2. */\n    EC2: 'ec2',\n    /** fargate. */\n    FARGATE: 'fargate',\n};\nexport var HostArchValues = {\n    /** AMD64. */\n    AMD64: 'amd64',\n    /** ARM32. */\n    ARM32: 'arm32',\n    /** ARM64. */\n    ARM64: 'arm64',\n    /** Itanium. */\n    IA64: 'ia64',\n    /** 32-bit PowerPC. */\n    PPC32: 'ppc32',\n    /** 64-bit PowerPC. */\n    PPC64: 'ppc64',\n    /** 32-bit x86. */\n    X86: 'x86',\n};\nexport var OsTypeValues = {\n    /** Microsoft Windows. */\n    WINDOWS: 'windows',\n    /** Linux. */\n    LINUX: 'linux',\n    /** Apple Darwin. */\n    DARWIN: 'darwin',\n    /** FreeBSD. */\n    FREEBSD: 'freebsd',\n    /** NetBSD. */\n    NETBSD: 'netbsd',\n    /** OpenBSD. */\n    OPENBSD: 'openbsd',\n    /** DragonFly BSD. */\n    DRAGONFLYBSD: 'dragonflybsd',\n    /** HP-UX (Hewlett Packard Unix). */\n    HPUX: 'hpux',\n    /** AIX (Advanced Interactive eXecutive). */\n    AIX: 'aix',\n    /** Oracle Solaris. */\n    SOLARIS: 'solaris',\n    /** IBM z/OS. */\n    Z_OS: 'z_os',\n};\nexport var TelemetrySdkLanguageValues = {\n    /** cpp. */\n    CPP: 'cpp',\n    /** dotnet. */\n    DOTNET: 'dotnet',\n    /** erlang. */\n    ERLANG: 'erlang',\n    /** go. */\n    GO: 'go',\n    /** java. */\n    JAVA: 'java',\n    /** nodejs. */\n    NODEJS: 'nodejs',\n    /** php. */\n    PHP: 'php',\n    /** python. */\n    PYTHON: 'python',\n    /** ruby. */\n    RUBY: 'ruby',\n    /** webjs. */\n    WEBJS: 'webjs',\n};\n//# sourceMappingURL=SemanticResourceAttributes.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { createContextKey } from '@opentelemetry/api';\nvar SUPPRESS_TRACING_KEY = createContextKey('OpenTelemetry SDK Context Key SUPPRESS_TRACING');\nexport function suppressTracing(context) {\n    return context.setValue(SUPPRESS_TRACING_KEY, true);\n}\nexport function unsuppressTracing(context) {\n    return context.deleteValue(SUPPRESS_TRACING_KEY);\n}\nexport function isTracingSuppressed(context) {\n    return context.getValue(SUPPRESS_TRACING_KEY) === true;\n}\n//# sourceMappingURL=suppress-tracing.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nexport var BAGGAGE_KEY_PAIR_SEPARATOR = '=';\nexport var BAGGAGE_PROPERTIES_SEPARATOR = ';';\nexport var BAGGAGE_ITEMS_SEPARATOR = ',';\n// Name of the http header used to propagate the baggage\nexport var BAGGAGE_HEADER = 'baggage';\n// Maximum number of name-value pairs allowed by w3c spec\nexport var BAGGAGE_MAX_NAME_VALUE_PAIRS = 180;\n// Maximum number of bytes per a single name-value pair allowed by w3c spec\nexport var BAGGAGE_MAX_PER_NAME_VALUE_PAIRS = 4096;\n// Maximum total length of all name-value pairs allowed by w3c spec\nexport var BAGGAGE_MAX_TOTAL_LENGTH = 8192;\n//# sourceMappingURL=constants.js.map","var __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\n/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { baggageEntryMetadataFromString } from '@opentelemetry/api';\nimport { BAGGAGE_ITEMS_SEPARATOR, BAGGAGE_PROPERTIES_SEPARATOR, BAGGAGE_KEY_PAIR_SEPARATOR, BAGGAGE_MAX_TOTAL_LENGTH, } from './constants';\nexport function serializeKeyPairs(keyPairs) {\n    return keyPairs.reduce(function (hValue, current) {\n        var value = \"\" + hValue + (hValue !== '' ? BAGGAGE_ITEMS_SEPARATOR : '') + current;\n        return value.length > BAGGAGE_MAX_TOTAL_LENGTH ? hValue : value;\n    }, '');\n}\nexport function getKeyPairs(baggage) {\n    return baggage.getAllEntries().map(function (_a) {\n        var _b = __read(_a, 2), key = _b[0], value = _b[1];\n        var entry = encodeURIComponent(key) + \"=\" + encodeURIComponent(value.value);\n        // include opaque metadata if provided\n        // NOTE: we intentionally don't URI-encode the metadata - that responsibility falls on the metadata implementation\n        if (value.metadata !== undefined) {\n            entry += BAGGAGE_PROPERTIES_SEPARATOR + value.metadata.toString();\n        }\n        return entry;\n    });\n}\nexport function parsePairKeyValue(entry) {\n    var valueProps = entry.split(BAGGAGE_PROPERTIES_SEPARATOR);\n    if (valueProps.length <= 0)\n        return;\n    var keyPairPart = valueProps.shift();\n    if (!keyPairPart)\n        return;\n    var keyPair = keyPairPart.split(BAGGAGE_KEY_PAIR_SEPARATOR);\n    if (keyPair.length !== 2)\n        return;\n    var key = decodeURIComponent(keyPair[0].trim());\n    var value = decodeURIComponent(keyPair[1].trim());\n    var metadata;\n    if (valueProps.length > 0) {\n        metadata = baggageEntryMetadataFromString(valueProps.join(BAGGAGE_PROPERTIES_SEPARATOR));\n    }\n    return { key: key, value: value, metadata: metadata };\n}\n/**\n * Parse a string serialized in the baggage HTTP Format (without metadata):\n * https://github.com/w3c/baggage/blob/master/baggage/HTTP_HEADER_FORMAT.md\n */\nexport function parseKeyPairsIntoRecord(value) {\n    if (typeof value !== 'string' || value.length === 0)\n        return {};\n    return value\n        .split(BAGGAGE_ITEMS_SEPARATOR)\n        .map(function (entry) {\n        return parsePairKeyValue(entry);\n    })\n        .filter(function (keyPair) { return keyPair !== undefined && keyPair.value.length > 0; })\n        .reduce(function (headers, keyPair) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        headers[keyPair.key] = keyPair.value;\n        return headers;\n    }, {});\n}\n//# sourceMappingURL=utils.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { propagation, } from '@opentelemetry/api';\nimport { isTracingSuppressed } from '../../trace/suppress-tracing';\nimport { BAGGAGE_HEADER, BAGGAGE_ITEMS_SEPARATOR, BAGGAGE_MAX_NAME_VALUE_PAIRS, BAGGAGE_MAX_PER_NAME_VALUE_PAIRS } from '../constants';\nimport { getKeyPairs, parsePairKeyValue, serializeKeyPairs } from '../utils';\n/**\n * Propagates {@link Baggage} through Context format propagation.\n *\n * Based on the Baggage specification:\n * https://w3c.github.io/baggage/\n */\nvar W3CBaggagePropagator = /** @class */ (function () {\n    function W3CBaggagePropagator() {\n    }\n    W3CBaggagePropagator.prototype.inject = function (context, carrier, setter) {\n        var baggage = propagation.getBaggage(context);\n        if (!baggage || isTracingSuppressed(context))\n            return;\n        var keyPairs = getKeyPairs(baggage)\n            .filter(function (pair) {\n            return pair.length <= BAGGAGE_MAX_PER_NAME_VALUE_PAIRS;\n        })\n            .slice(0, BAGGAGE_MAX_NAME_VALUE_PAIRS);\n        var headerValue = serializeKeyPairs(keyPairs);\n        if (headerValue.length > 0) {\n            setter.set(carrier, BAGGAGE_HEADER, headerValue);\n        }\n    };\n    W3CBaggagePropagator.prototype.extract = function (context, carrier, getter) {\n        var headerValue = getter.get(carrier, BAGGAGE_HEADER);\n        var baggageString = Array.isArray(headerValue) ? headerValue.join(BAGGAGE_ITEMS_SEPARATOR) : headerValue;\n        if (!baggageString)\n            return context;\n        var baggage = {};\n        if (baggageString.length === 0) {\n            return context;\n        }\n        var pairs = baggageString.split(BAGGAGE_ITEMS_SEPARATOR);\n        pairs.forEach(function (entry) {\n            var keyPair = parsePairKeyValue(entry);\n            if (keyPair) {\n                var baggageEntry = { value: keyPair.value };\n                if (keyPair.metadata) {\n                    baggageEntry.metadata = keyPair.metadata;\n                }\n                baggage[keyPair.key] = baggageEntry;\n            }\n        });\n        if (Object.entries(baggage).length === 0) {\n            return context;\n        }\n        return propagation.setBaggage(context, propagation.createBaggage(baggage));\n    };\n    W3CBaggagePropagator.prototype.fields = function () {\n        return [BAGGAGE_HEADER];\n    };\n    return W3CBaggagePropagator;\n}());\nexport { W3CBaggagePropagator };\n//# sourceMappingURL=W3CBaggagePropagator.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * A utility for returning wall times anchored to a given point in time. Wall time measurements will\n * not be taken from the system, but instead are computed by adding a monotonic clock time\n * to the anchor point.\n *\n * This is needed because the system time can change and result in unexpected situations like\n * spans ending before they are started. Creating an anchored clock for each local root span\n * ensures that span timings and durations are accurate while preventing span times from drifting\n * too far from the system clock.\n *\n * Only creating an anchored clock once per local trace ensures span times are correct relative\n * to each other. For example, a child span will never have a start time before its parent even\n * if the system clock is corrected during the local trace.\n *\n * Heavily inspired by the OTel Java anchored clock\n * https://github.com/open-telemetry/opentelemetry-java/blob/main/sdk/trace/src/main/java/io/opentelemetry/sdk/trace/AnchoredClock.java\n */\nvar AnchoredClock = /** @class */ (function () {\n    /**\n     * Create a new AnchoredClock anchored to the current time returned by systemClock.\n     *\n     * @param systemClock should be a clock that returns the number of milliseconds since January 1 1970 such as Date\n     * @param monotonicClock should be a clock that counts milliseconds monotonically such as window.performance or perf_hooks.performance\n     */\n    function AnchoredClock(systemClock, monotonicClock) {\n        this._monotonicClock = monotonicClock;\n        this._epochMillis = systemClock.now();\n        this._performanceMillis = monotonicClock.now();\n    }\n    /**\n     * Returns the current time by adding the number of milliseconds since the\n     * AnchoredClock was created to the creation epoch time\n     */\n    AnchoredClock.prototype.now = function () {\n        var delta = this._monotonicClock.now() - this._performanceMillis;\n        return this._epochMillis + delta;\n    };\n    return AnchoredClock;\n}());\nexport { AnchoredClock };\n//# sourceMappingURL=anchored-clock.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { loggingErrorHandler } from './logging-error-handler';\n/** The global error handler delegate */\nvar delegateHandler = loggingErrorHandler();\n/**\n * Set the global error handler\n * @param {ErrorHandler} handler\n */\nexport function setGlobalErrorHandler(handler) {\n    delegateHandler = handler;\n}\n/**\n * Return the global error handler\n * @param {Exception} ex\n */\nexport function globalErrorHandler(ex) {\n    try {\n        delegateHandler(ex);\n    }\n    catch (_a) { } // eslint-disable-line no-empty\n}\n//# sourceMappingURL=global-error-handler.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nexport var TracesSamplerValues;\n(function (TracesSamplerValues) {\n    TracesSamplerValues[\"AlwaysOff\"] = \"always_off\";\n    TracesSamplerValues[\"AlwaysOn\"] = \"always_on\";\n    TracesSamplerValues[\"ParentBasedAlwaysOff\"] = \"parentbased_always_off\";\n    TracesSamplerValues[\"ParentBasedAlwaysOn\"] = \"parentbased_always_on\";\n    TracesSamplerValues[\"ParentBasedTraceIdRatio\"] = \"parentbased_traceidratio\";\n    TracesSamplerValues[\"TraceIdRatio\"] = \"traceidratio\";\n})(TracesSamplerValues || (TracesSamplerValues = {}));\n//# sourceMappingURL=sampling.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { diag } from '@opentelemetry/api';\n/**\n * Returns a function that logs an error using the provided logger, or a\n * console logger if one was not provided.\n */\nexport function loggingErrorHandler() {\n    return function (ex) {\n        diag.error(stringifyException(ex));\n    };\n}\n/**\n * Converts an exception into a string representation\n * @param {Exception} ex\n */\nfunction stringifyException(ex) {\n    if (typeof ex === 'string') {\n        return ex;\n    }\n    else {\n        return JSON.stringify(flattenException(ex));\n    }\n}\n/**\n * Flattens an exception into key-value pairs by traversing the prototype chain\n * and coercing values to strings. Duplicate properties will not be overwritten;\n * the first insert wins.\n */\nfunction flattenException(ex) {\n    var result = {};\n    var current = ex;\n    while (current !== null) {\n        Object.getOwnPropertyNames(current).forEach(function (propertyName) {\n            if (result[propertyName])\n                return;\n            var value = current[propertyName];\n            if (value) {\n                result[propertyName] = String(value);\n            }\n        });\n        current = Object.getPrototypeOf(current);\n    }\n    return result;\n}\n//# sourceMappingURL=logging-error-handler.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n// Updates to this file should also be replicated to @opentelemetry/api and\n// @opentelemetry/api-metrics too.\n/**\n * - globalThis (New standard)\n * - self (Will return the current window instance for supported browsers)\n * - window (fallback for older browser implementations)\n * - global (NodeJS implementation)\n * - <object> (When all else fails)\n */\n/** only globals that common to node and browsers are allowed */\n// eslint-disable-next-line node/no-unsupported-features/es-builtins, no-undef\nexport var _globalThis = typeof globalThis === 'object' ? globalThis :\n    typeof self === 'object' ? self :\n        typeof window === 'object' ? window :\n            typeof global === 'object' ? global :\n                {};\n//# sourceMappingURL=globalThis.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { DiagLogLevel } from '@opentelemetry/api';\nimport { TracesSamplerValues } from './sampling';\nimport { _globalThis } from '../platform/browser/globalThis';\nvar DEFAULT_LIST_SEPARATOR = ',';\n/**\n * Environment interface to define all names\n */\nvar ENVIRONMENT_NUMBERS_KEYS = [\n    'OTEL_BSP_EXPORT_TIMEOUT',\n    'OTEL_BSP_MAX_EXPORT_BATCH_SIZE',\n    'OTEL_BSP_MAX_QUEUE_SIZE',\n    'OTEL_BSP_SCHEDULE_DELAY',\n    'OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT',\n    'OTEL_ATTRIBUTE_COUNT_LIMIT',\n    'OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT',\n    'OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT',\n    'OTEL_SPAN_EVENT_COUNT_LIMIT',\n    'OTEL_SPAN_LINK_COUNT_LIMIT',\n    'OTEL_EXPORTER_OTLP_TIMEOUT',\n    'OTEL_EXPORTER_OTLP_TRACES_TIMEOUT',\n    'OTEL_EXPORTER_OTLP_METRICS_TIMEOUT',\n    'OTEL_EXPORTER_JAEGER_AGENT_PORT',\n];\nfunction isEnvVarANumber(key) {\n    return (ENVIRONMENT_NUMBERS_KEYS.indexOf(key) > -1);\n}\nvar ENVIRONMENT_LISTS_KEYS = [\n    'OTEL_NO_PATCH_MODULES',\n    'OTEL_PROPAGATORS',\n];\nfunction isEnvVarAList(key) {\n    return ENVIRONMENT_LISTS_KEYS.indexOf(key) > -1;\n}\nexport var DEFAULT_ATTRIBUTE_VALUE_LENGTH_LIMIT = Infinity;\nexport var DEFAULT_ATTRIBUTE_COUNT_LIMIT = 128;\n/**\n * Default environment variables\n */\nexport var DEFAULT_ENVIRONMENT = {\n    CONTAINER_NAME: '',\n    ECS_CONTAINER_METADATA_URI_V4: '',\n    ECS_CONTAINER_METADATA_URI: '',\n    HOSTNAME: '',\n    KUBERNETES_SERVICE_HOST: '',\n    NAMESPACE: '',\n    OTEL_BSP_EXPORT_TIMEOUT: 30000,\n    OTEL_BSP_MAX_EXPORT_BATCH_SIZE: 512,\n    OTEL_BSP_MAX_QUEUE_SIZE: 2048,\n    OTEL_BSP_SCHEDULE_DELAY: 5000,\n    OTEL_EXPORTER_JAEGER_AGENT_HOST: '',\n    OTEL_EXPORTER_JAEGER_AGENT_PORT: 6832,\n    OTEL_EXPORTER_JAEGER_ENDPOINT: '',\n    OTEL_EXPORTER_JAEGER_PASSWORD: '',\n    OTEL_EXPORTER_JAEGER_USER: '',\n    OTEL_EXPORTER_OTLP_ENDPOINT: '',\n    OTEL_EXPORTER_OTLP_TRACES_ENDPOINT: '',\n    OTEL_EXPORTER_OTLP_METRICS_ENDPOINT: '',\n    OTEL_EXPORTER_OTLP_HEADERS: '',\n    OTEL_EXPORTER_OTLP_TRACES_HEADERS: '',\n    OTEL_EXPORTER_OTLP_METRICS_HEADERS: '',\n    OTEL_EXPORTER_OTLP_TIMEOUT: 10000,\n    OTEL_EXPORTER_OTLP_TRACES_TIMEOUT: 10000,\n    OTEL_EXPORTER_OTLP_METRICS_TIMEOUT: 10000,\n    OTEL_EXPORTER_ZIPKIN_ENDPOINT: 'http://localhost:9411/api/v2/spans',\n    OTEL_LOG_LEVEL: DiagLogLevel.INFO,\n    OTEL_NO_PATCH_MODULES: [],\n    OTEL_PROPAGATORS: ['tracecontext', 'baggage'],\n    OTEL_RESOURCE_ATTRIBUTES: '',\n    OTEL_SERVICE_NAME: '',\n    OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT: DEFAULT_ATTRIBUTE_VALUE_LENGTH_LIMIT,\n    OTEL_ATTRIBUTE_COUNT_LIMIT: DEFAULT_ATTRIBUTE_COUNT_LIMIT,\n    OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT: DEFAULT_ATTRIBUTE_VALUE_LENGTH_LIMIT,\n    OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT: DEFAULT_ATTRIBUTE_COUNT_LIMIT,\n    OTEL_SPAN_EVENT_COUNT_LIMIT: 128,\n    OTEL_SPAN_LINK_COUNT_LIMIT: 128,\n    OTEL_TRACES_EXPORTER: 'none',\n    OTEL_TRACES_SAMPLER: TracesSamplerValues.ParentBasedAlwaysOn,\n    OTEL_TRACES_SAMPLER_ARG: '',\n    OTEL_EXPORTER_OTLP_INSECURE: '',\n    OTEL_EXPORTER_OTLP_TRACES_INSECURE: '',\n    OTEL_EXPORTER_OTLP_METRICS_INSECURE: '',\n    OTEL_EXPORTER_OTLP_CERTIFICATE: '',\n    OTEL_EXPORTER_OTLP_TRACES_CERTIFICATE: '',\n    OTEL_EXPORTER_OTLP_METRICS_CERTIFICATE: '',\n    OTEL_EXPORTER_OTLP_COMPRESSION: '',\n    OTEL_EXPORTER_OTLP_TRACES_COMPRESSION: '',\n    OTEL_EXPORTER_OTLP_METRICS_COMPRESSION: '',\n    OTEL_EXPORTER_OTLP_CLIENT_KEY: '',\n    OTEL_EXPORTER_OTLP_TRACES_CLIENT_KEY: '',\n    OTEL_EXPORTER_OTLP_METRICS_CLIENT_KEY: '',\n    OTEL_EXPORTER_OTLP_CLIENT_CERTIFICATE: '',\n    OTEL_EXPORTER_OTLP_TRACES_CLIENT_CERTIFICATE: '',\n    OTEL_EXPORTER_OTLP_METRICS_CLIENT_CERTIFICATE: ''\n};\n/**\n * Parses a variable as number with number validation\n * @param name\n * @param environment\n * @param values\n * @param min\n * @param max\n */\nfunction parseNumber(name, environment, values, min, max) {\n    if (min === void 0) { min = -Infinity; }\n    if (max === void 0) { max = Infinity; }\n    if (typeof values[name] !== 'undefined') {\n        var value = Number(values[name]);\n        if (!isNaN(value)) {\n            if (value < min) {\n                environment[name] = min;\n            }\n            else if (value > max) {\n                environment[name] = max;\n            }\n            else {\n                environment[name] = value;\n            }\n        }\n    }\n}\n/**\n * Parses list-like strings from input into output.\n * @param name\n * @param environment\n * @param values\n * @param separator\n */\nfunction parseStringList(name, output, input, separator) {\n    if (separator === void 0) { separator = DEFAULT_LIST_SEPARATOR; }\n    var givenValue = input[name];\n    if (typeof givenValue === 'string') {\n        output[name] = givenValue.split(separator).map(function (v) { return v.trim(); });\n    }\n}\n// The support string -> DiagLogLevel mappings\nvar logLevelMap = {\n    ALL: DiagLogLevel.ALL,\n    VERBOSE: DiagLogLevel.VERBOSE,\n    DEBUG: DiagLogLevel.DEBUG,\n    INFO: DiagLogLevel.INFO,\n    WARN: DiagLogLevel.WARN,\n    ERROR: DiagLogLevel.ERROR,\n    NONE: DiagLogLevel.NONE,\n};\n/**\n * Environmentally sets log level if valid log level string is provided\n * @param key\n * @param environment\n * @param values\n */\nfunction setLogLevelFromEnv(key, environment, values) {\n    var value = values[key];\n    if (typeof value === 'string') {\n        var theLevel = logLevelMap[value.toUpperCase()];\n        if (theLevel != null) {\n            environment[key] = theLevel;\n        }\n    }\n}\n/**\n * Parses environment values\n * @param values\n */\nexport function parseEnvironment(values) {\n    var environment = {};\n    for (var env in DEFAULT_ENVIRONMENT) {\n        var key = env;\n        switch (key) {\n            case 'OTEL_LOG_LEVEL':\n                setLogLevelFromEnv(key, environment, values);\n                break;\n            default:\n                if (isEnvVarANumber(key)) {\n                    parseNumber(key, environment, values);\n                }\n                else if (isEnvVarAList(key)) {\n                    parseStringList(key, environment, values);\n                }\n                else {\n                    var value = values[key];\n                    if (typeof value !== 'undefined' && value !== null) {\n                        environment[key] = String(value);\n                    }\n                }\n        }\n    }\n    return environment;\n}\n/**\n * Get environment in node or browser without\n * populating default values.\n */\nexport function getEnvWithoutDefaults() {\n    return typeof process !== 'undefined' ?\n        parseEnvironment(process.env) :\n        parseEnvironment(_globalThis);\n}\n//# sourceMappingURL=environment.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { DEFAULT_ENVIRONMENT, parseEnvironment, } from '../../utils/environment';\nimport { _globalThis } from './globalThis';\n/**\n * Gets the environment variables\n */\nexport function getEnv() {\n    var globalEnv = parseEnvironment(_globalThis);\n    return Object.assign({}, DEFAULT_ENVIRONMENT, globalEnv);\n}\n//# sourceMappingURL=environment.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nexport function hexToBase64(hexStr) {\n    var hexStrLen = hexStr.length;\n    var hexAsciiCharsStr = '';\n    for (var i = 0; i < hexStrLen; i += 2) {\n        var hexPair = hexStr.substring(i, i + 2);\n        var hexVal = parseInt(hexPair, 16);\n        hexAsciiCharsStr += String.fromCharCode(hexVal);\n    }\n    return btoa(hexAsciiCharsStr);\n}\n//# sourceMappingURL=hex-to-base64.js.map","var SPAN_ID_BYTES = 8;\nvar TRACE_ID_BYTES = 16;\n/**\n * @deprecated Use the one defined in @opentelemetry/sdk-trace-base instead.\n */\nvar RandomIdGenerator = /** @class */ (function () {\n    function RandomIdGenerator() {\n        /**\n         * Returns a random 16-byte trace ID formatted/encoded as a 32 lowercase hex\n         * characters corresponding to 128 bits.\n         */\n        this.generateTraceId = getIdGenerator(TRACE_ID_BYTES);\n        /**\n         * Returns a random 8-byte span ID formatted/encoded as a 16 lowercase hex\n         * characters corresponding to 64 bits.\n         */\n        this.generateSpanId = getIdGenerator(SPAN_ID_BYTES);\n    }\n    return RandomIdGenerator;\n}());\nexport { RandomIdGenerator };\nvar SHARED_CHAR_CODES_ARRAY = Array(32);\nfunction getIdGenerator(bytes) {\n    return function generateId() {\n        for (var i = 0; i < bytes * 2; i++) {\n            SHARED_CHAR_CODES_ARRAY[i] = Math.floor(Math.random() * 16) + 48;\n            // valid hex characters in the range 48-57 and 97-102\n            if (SHARED_CHAR_CODES_ARRAY[i] >= 58) {\n                SHARED_CHAR_CODES_ARRAY[i] += 39;\n            }\n        }\n        return String.fromCharCode.apply(null, SHARED_CHAR_CODES_ARRAY.slice(0, bytes * 2));\n    };\n}\n//# sourceMappingURL=RandomIdGenerator.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nexport var otperformance = performance;\n//# sourceMappingURL=performance.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar _a;\nimport { VERSION } from '../../version';\nimport { TelemetrySdkLanguageValues, SemanticResourceAttributes, } from '@opentelemetry/semantic-conventions';\n/** Constants describing the SDK in use */\nexport var SDK_INFO = (_a = {},\n    _a[SemanticResourceAttributes.TELEMETRY_SDK_NAME] = 'opentelemetry',\n    _a[SemanticResourceAttributes.PROCESS_RUNTIME_NAME] = 'browser',\n    _a[SemanticResourceAttributes.TELEMETRY_SDK_LANGUAGE] = TelemetrySdkLanguageValues.WEBJS,\n    _a[SemanticResourceAttributes.TELEMETRY_SDK_VERSION] = VERSION,\n    _a);\n//# sourceMappingURL=sdk-info.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n// DO NOT EDIT, this is an Auto-generated file from scripts/semconv/templates//templates/SemanticAttributes.ts.j2\nexport var SemanticResourceAttributes = {\n    /**\n    * Name of the cloud provider.\n    */\n    CLOUD_PROVIDER: 'cloud.provider',\n    /**\n    * The cloud account ID the resource is assigned to.\n    */\n    CLOUD_ACCOUNT_ID: 'cloud.account.id',\n    /**\n    * The geographical region the resource is running. Refer to your provider&#39;s docs to see the available regions, for example [Alibaba Cloud regions](https://www.alibabacloud.com/help/doc-detail/40654.htm), [AWS regions](https://aws.amazon.com/about-aws/global-infrastructure/regions_az/), [Azure regions](https://azure.microsoft.com/en-us/global-infrastructure/geographies/), or [Google Cloud regions](https://cloud.google.com/about/locations).\n    */\n    CLOUD_REGION: 'cloud.region',\n    /**\n    * Cloud regions often have multiple, isolated locations known as zones to increase availability. Availability zone represents the zone where the resource is running.\n    *\n    * Note: Availability zones are called &#34;zones&#34; on Alibaba Cloud and Google Cloud.\n    */\n    CLOUD_AVAILABILITY_ZONE: 'cloud.availability_zone',\n    /**\n    * The cloud platform in use.\n    *\n    * Note: The prefix of the service SHOULD match the one specified in `cloud.provider`.\n    */\n    CLOUD_PLATFORM: 'cloud.platform',\n    /**\n    * The Amazon Resource Name (ARN) of an [ECS container instance](https://docs.aws.amazon.com/AmazonECS/latest/developerguide/ECS_instances.html).\n    */\n    AWS_ECS_CONTAINER_ARN: 'aws.ecs.container.arn',\n    /**\n    * The ARN of an [ECS cluster](https://docs.aws.amazon.com/AmazonECS/latest/developerguide/clusters.html).\n    */\n    AWS_ECS_CLUSTER_ARN: 'aws.ecs.cluster.arn',\n    /**\n    * The [launch type](https://docs.aws.amazon.com/AmazonECS/latest/developerguide/launch_types.html) for an ECS task.\n    */\n    AWS_ECS_LAUNCHTYPE: 'aws.ecs.launchtype',\n    /**\n    * The ARN of an [ECS task definition](https://docs.aws.amazon.com/AmazonECS/latest/developerguide/task_definitions.html).\n    */\n    AWS_ECS_TASK_ARN: 'aws.ecs.task.arn',\n    /**\n    * The task definition family this task definition is a member of.\n    */\n    AWS_ECS_TASK_FAMILY: 'aws.ecs.task.family',\n    /**\n    * The revision for this task definition.\n    */\n    AWS_ECS_TASK_REVISION: 'aws.ecs.task.revision',\n    /**\n    * The ARN of an EKS cluster.\n    */\n    AWS_EKS_CLUSTER_ARN: 'aws.eks.cluster.arn',\n    /**\n    * The name(s) of the AWS log group(s) an application is writing to.\n    *\n    * Note: Multiple log groups must be supported for cases like multi-container applications, where a single application has sidecar containers, and each write to their own log group.\n    */\n    AWS_LOG_GROUP_NAMES: 'aws.log.group.names',\n    /**\n    * The Amazon Resource Name(s) (ARN) of the AWS log group(s).\n    *\n    * Note: See the [log group ARN format documentation](https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/iam-access-control-overview-cwl.html#CWL_ARN_Format).\n    */\n    AWS_LOG_GROUP_ARNS: 'aws.log.group.arns',\n    /**\n    * The name(s) of the AWS log stream(s) an application is writing to.\n    */\n    AWS_LOG_STREAM_NAMES: 'aws.log.stream.names',\n    /**\n    * The ARN(s) of the AWS log stream(s).\n    *\n    * Note: See the [log stream ARN format documentation](https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/iam-access-control-overview-cwl.html#CWL_ARN_Format). One log group can contain several log streams, so these ARNs necessarily identify both a log group and a log stream.\n    */\n    AWS_LOG_STREAM_ARNS: 'aws.log.stream.arns',\n    /**\n    * Container name.\n    */\n    CONTAINER_NAME: 'container.name',\n    /**\n    * Container ID. Usually a UUID, as for example used to [identify Docker containers](https://docs.docker.com/engine/reference/run/#container-identification). The UUID might be abbreviated.\n    */\n    CONTAINER_ID: 'container.id',\n    /**\n    * The container runtime managing this container.\n    */\n    CONTAINER_RUNTIME: 'container.runtime',\n    /**\n    * Name of the image the container was built on.\n    */\n    CONTAINER_IMAGE_NAME: 'container.image.name',\n    /**\n    * Container image tag.\n    */\n    CONTAINER_IMAGE_TAG: 'container.image.tag',\n    /**\n    * Name of the [deployment environment](https://en.wikipedia.org/wiki/Deployment_environment) (aka deployment tier).\n    */\n    DEPLOYMENT_ENVIRONMENT: 'deployment.environment',\n    /**\n    * A unique identifier representing the device.\n    *\n    * Note: The device identifier MUST only be defined using the values outlined below. This value is not an advertising identifier and MUST NOT be used as such. On iOS (Swift or Objective-C), this value MUST be equal to the [vendor identifier](https://developer.apple.com/documentation/uikit/uidevice/1620059-identifierforvendor). On Android (Java or Kotlin), this value MUST be equal to the Firebase Installation ID or a globally unique UUID which is persisted across sessions in your application. More information can be found [here](https://developer.android.com/training/articles/user-data-ids) on best practices and exact implementation details. Caution should be taken when storing personal data or anything which can identify a user. GDPR and data protection laws may apply, ensure you do your own due diligence.\n    */\n    DEVICE_ID: 'device.id',\n    /**\n    * The model identifier for the device.\n    *\n    * Note: It&#39;s recommended this value represents a machine readable version of the model identifier rather than the market or consumer-friendly name of the device.\n    */\n    DEVICE_MODEL_IDENTIFIER: 'device.model.identifier',\n    /**\n    * The marketing name for the device model.\n    *\n    * Note: It&#39;s recommended this value represents a human readable version of the device model rather than a machine readable alternative.\n    */\n    DEVICE_MODEL_NAME: 'device.model.name',\n    /**\n    * The name of the single function that this runtime instance executes.\n    *\n    * Note: This is the name of the function as configured/deployed on the FaaS platform and is usually different from the name of the callback function (which may be stored in the [`code.namespace`/`code.function`](../../trace/semantic_conventions/span-general.md#source-code-attributes) span attributes).\n    */\n    FAAS_NAME: 'faas.name',\n    /**\n    * The unique ID of the single function that this runtime instance executes.\n    *\n    * Note: Depending on the cloud provider, use:\n  \n  * **AWS Lambda:** The function [ARN](https://docs.aws.amazon.com/general/latest/gr/aws-arns-and-namespaces.html).\n  Take care not to use the &#34;invoked ARN&#34; directly but replace any\n  [alias suffix](https://docs.aws.amazon.com/lambda/latest/dg/configuration-aliases.html) with the resolved function version, as the same runtime instance may be invokable with multiple\n  different aliases.\n  * **GCP:** The [URI of the resource](https://cloud.google.com/iam/docs/full-resource-names)\n  * **Azure:** The [Fully Qualified Resource ID](https://docs.microsoft.com/en-us/rest/api/resources/resources/get-by-id).\n  \n  On some providers, it may not be possible to determine the full ID at startup,\n  which is why this field cannot be made required. For example, on AWS the account ID\n  part of the ARN is not available without calling another AWS API\n  which may be deemed too slow for a short-running lambda function.\n  As an alternative, consider setting `faas.id` as a span attribute instead.\n    */\n    FAAS_ID: 'faas.id',\n    /**\n    * The immutable version of the function being executed.\n    *\n    * Note: Depending on the cloud provider and platform, use:\n  \n  * **AWS Lambda:** The [function version](https://docs.aws.amazon.com/lambda/latest/dg/configuration-versions.html)\n    (an integer represented as a decimal string).\n  * **Google Cloud Run:** The [revision](https://cloud.google.com/run/docs/managing/revisions)\n    (i.e., the function name plus the revision suffix).\n  * **Google Cloud Functions:** The value of the\n    [`K_REVISION` environment variable](https://cloud.google.com/functions/docs/env-var#runtime_environment_variables_set_automatically).\n  * **Azure Functions:** Not applicable. Do not set this attribute.\n    */\n    FAAS_VERSION: 'faas.version',\n    /**\n    * The execution environment ID as a string, that will be potentially reused for other invocations to the same function/function version.\n    *\n    * Note: * **AWS Lambda:** Use the (full) log stream name.\n    */\n    FAAS_INSTANCE: 'faas.instance',\n    /**\n    * The amount of memory available to the serverless function in MiB.\n    *\n    * Note: It&#39;s recommended to set this attribute since e.g. too little memory can easily stop a Java AWS Lambda function from working correctly. On AWS Lambda, the environment variable `AWS_LAMBDA_FUNCTION_MEMORY_SIZE` provides this information.\n    */\n    FAAS_MAX_MEMORY: 'faas.max_memory',\n    /**\n    * Unique host ID. For Cloud, this must be the instance_id assigned by the cloud provider.\n    */\n    HOST_ID: 'host.id',\n    /**\n    * Name of the host. On Unix systems, it may contain what the hostname command returns, or the fully qualified hostname, or another name specified by the user.\n    */\n    HOST_NAME: 'host.name',\n    /**\n    * Type of host. For Cloud, this must be the machine type.\n    */\n    HOST_TYPE: 'host.type',\n    /**\n    * The CPU architecture the host system is running on.\n    */\n    HOST_ARCH: 'host.arch',\n    /**\n    * Name of the VM image or OS install the host was instantiated from.\n    */\n    HOST_IMAGE_NAME: 'host.image.name',\n    /**\n    * VM image ID. For Cloud, this value is from the provider.\n    */\n    HOST_IMAGE_ID: 'host.image.id',\n    /**\n    * The version string of the VM image as defined in [Version SpanAttributes](README.md#version-attributes).\n    */\n    HOST_IMAGE_VERSION: 'host.image.version',\n    /**\n    * The name of the cluster.\n    */\n    K8S_CLUSTER_NAME: 'k8s.cluster.name',\n    /**\n    * The name of the Node.\n    */\n    K8S_NODE_NAME: 'k8s.node.name',\n    /**\n    * The UID of the Node.\n    */\n    K8S_NODE_UID: 'k8s.node.uid',\n    /**\n    * The name of the namespace that the pod is running in.\n    */\n    K8S_NAMESPACE_NAME: 'k8s.namespace.name',\n    /**\n    * The UID of the Pod.\n    */\n    K8S_POD_UID: 'k8s.pod.uid',\n    /**\n    * The name of the Pod.\n    */\n    K8S_POD_NAME: 'k8s.pod.name',\n    /**\n    * The name of the Container in a Pod template.\n    */\n    K8S_CONTAINER_NAME: 'k8s.container.name',\n    /**\n    * The UID of the ReplicaSet.\n    */\n    K8S_REPLICASET_UID: 'k8s.replicaset.uid',\n    /**\n    * The name of the ReplicaSet.\n    */\n    K8S_REPLICASET_NAME: 'k8s.replicaset.name',\n    /**\n    * The UID of the Deployment.\n    */\n    K8S_DEPLOYMENT_UID: 'k8s.deployment.uid',\n    /**\n    * The name of the Deployment.\n    */\n    K8S_DEPLOYMENT_NAME: 'k8s.deployment.name',\n    /**\n    * The UID of the StatefulSet.\n    */\n    K8S_STATEFULSET_UID: 'k8s.statefulset.uid',\n    /**\n    * The name of the StatefulSet.\n    */\n    K8S_STATEFULSET_NAME: 'k8s.statefulset.name',\n    /**\n    * The UID of the DaemonSet.\n    */\n    K8S_DAEMONSET_UID: 'k8s.daemonset.uid',\n    /**\n    * The name of the DaemonSet.\n    */\n    K8S_DAEMONSET_NAME: 'k8s.daemonset.name',\n    /**\n    * The UID of the Job.\n    */\n    K8S_JOB_UID: 'k8s.job.uid',\n    /**\n    * The name of the Job.\n    */\n    K8S_JOB_NAME: 'k8s.job.name',\n    /**\n    * The UID of the CronJob.\n    */\n    K8S_CRONJOB_UID: 'k8s.cronjob.uid',\n    /**\n    * The name of the CronJob.\n    */\n    K8S_CRONJOB_NAME: 'k8s.cronjob.name',\n    /**\n    * The operating system type.\n    */\n    OS_TYPE: 'os.type',\n    /**\n    * Human readable (not intended to be parsed) OS version information, like e.g. reported by `ver` or `lsb_release -a` commands.\n    */\n    OS_DESCRIPTION: 'os.description',\n    /**\n    * Human readable operating system name.\n    */\n    OS_NAME: 'os.name',\n    /**\n    * The version string of the operating system as defined in [Version SpanAttributes](../../resource/semantic_conventions/README.md#version-attributes).\n    */\n    OS_VERSION: 'os.version',\n    /**\n    * Process identifier (PID).\n    */\n    PROCESS_PID: 'process.pid',\n    /**\n    * The name of the process executable. On Linux based systems, can be set to the `Name` in `proc/[pid]/status`. On Windows, can be set to the base name of `GetProcessImageFileNameW`.\n    */\n    PROCESS_EXECUTABLE_NAME: 'process.executable.name',\n    /**\n    * The full path to the process executable. On Linux based systems, can be set to the target of `proc/[pid]/exe`. On Windows, can be set to the result of `GetProcessImageFileNameW`.\n    */\n    PROCESS_EXECUTABLE_PATH: 'process.executable.path',\n    /**\n    * The command used to launch the process (i.e. the command name). On Linux based systems, can be set to the zeroth string in `proc/[pid]/cmdline`. On Windows, can be set to the first parameter extracted from `GetCommandLineW`.\n    */\n    PROCESS_COMMAND: 'process.command',\n    /**\n    * The full command used to launch the process as a single string representing the full command. On Windows, can be set to the result of `GetCommandLineW`. Do not set this if you have to assemble it just for monitoring; use `process.command_args` instead.\n    */\n    PROCESS_COMMAND_LINE: 'process.command_line',\n    /**\n    * All the command arguments (including the command/executable itself) as received by the process. On Linux-based systems (and some other Unixoid systems supporting procfs), can be set according to the list of null-delimited strings extracted from `proc/[pid]/cmdline`. For libc-based executables, this would be the full argv vector passed to `main`.\n    */\n    PROCESS_COMMAND_ARGS: 'process.command_args',\n    /**\n    * The username of the user that owns the process.\n    */\n    PROCESS_OWNER: 'process.owner',\n    /**\n    * The name of the runtime of this process. For compiled native binaries, this SHOULD be the name of the compiler.\n    */\n    PROCESS_RUNTIME_NAME: 'process.runtime.name',\n    /**\n    * The version of the runtime of this process, as returned by the runtime without modification.\n    */\n    PROCESS_RUNTIME_VERSION: 'process.runtime.version',\n    /**\n    * An additional description about the runtime of the process, for example a specific vendor customization of the runtime environment.\n    */\n    PROCESS_RUNTIME_DESCRIPTION: 'process.runtime.description',\n    /**\n    * Logical name of the service.\n    *\n    * Note: MUST be the same for all instances of horizontally scaled services. If the value was not specified, SDKs MUST fallback to `unknown_service:` concatenated with [`process.executable.name`](process.md#process), e.g. `unknown_service:bash`. If `process.executable.name` is not available, the value MUST be set to `unknown_service`.\n    */\n    SERVICE_NAME: 'service.name',\n    /**\n    * A namespace for `service.name`.\n    *\n    * Note: A string value having a meaning that helps to distinguish a group of services, for example the team name that owns a group of services. `service.name` is expected to be unique within the same namespace. If `service.namespace` is not specified in the Resource then `service.name` is expected to be unique for all services that have no explicit namespace defined (so the empty/unspecified namespace is simply one more valid namespace). Zero-length namespace string is assumed equal to unspecified namespace.\n    */\n    SERVICE_NAMESPACE: 'service.namespace',\n    /**\n    * The string ID of the service instance.\n    *\n    * Note: MUST be unique for each instance of the same `service.namespace,service.name` pair (in other words `service.namespace,service.name,service.instance.id` triplet MUST be globally unique). The ID helps to distinguish instances of the same service that exist at the same time (e.g. instances of a horizontally scaled service). It is preferable for the ID to be persistent and stay the same for the lifetime of the service instance, however it is acceptable that the ID is ephemeral and changes during important lifetime events for the service (e.g. service restarts). If the service has no inherent unique ID that can be used as the value of this attribute it is recommended to generate a random Version 1 or Version 4 RFC 4122 UUID (services aiming for reproducible UUIDs may also use Version 5, see RFC 4122 for more recommendations).\n    */\n    SERVICE_INSTANCE_ID: 'service.instance.id',\n    /**\n    * The version string of the service API or implementation.\n    */\n    SERVICE_VERSION: 'service.version',\n    /**\n    * The name of the telemetry SDK as defined above.\n    */\n    TELEMETRY_SDK_NAME: 'telemetry.sdk.name',\n    /**\n    * The language of the telemetry SDK.\n    */\n    TELEMETRY_SDK_LANGUAGE: 'telemetry.sdk.language',\n    /**\n    * The version string of the telemetry SDK.\n    */\n    TELEMETRY_SDK_VERSION: 'telemetry.sdk.version',\n    /**\n    * The version string of the auto instrumentation agent, if used.\n    */\n    TELEMETRY_AUTO_VERSION: 'telemetry.auto.version',\n    /**\n    * The name of the web engine.\n    */\n    WEBENGINE_NAME: 'webengine.name',\n    /**\n    * The version of the web engine.\n    */\n    WEBENGINE_VERSION: 'webengine.version',\n    /**\n    * Additional description of the web engine (e.g. detailed version and edition information).\n    */\n    WEBENGINE_DESCRIPTION: 'webengine.description',\n};\nexport var CloudProviderValues = {\n    /** Alibaba Cloud. */\n    ALIBABA_CLOUD: 'alibaba_cloud',\n    /** Amazon Web Services. */\n    AWS: 'aws',\n    /** Microsoft Azure. */\n    AZURE: 'azure',\n    /** Google Cloud Platform. */\n    GCP: 'gcp',\n};\nexport var CloudPlatformValues = {\n    /** Alibaba Cloud Elastic Compute Service. */\n    ALIBABA_CLOUD_ECS: 'alibaba_cloud_ecs',\n    /** Alibaba Cloud Function Compute. */\n    ALIBABA_CLOUD_FC: 'alibaba_cloud_fc',\n    /** AWS Elastic Compute Cloud. */\n    AWS_EC2: 'aws_ec2',\n    /** AWS Elastic Container Service. */\n    AWS_ECS: 'aws_ecs',\n    /** AWS Elastic Kubernetes Service. */\n    AWS_EKS: 'aws_eks',\n    /** AWS Lambda. */\n    AWS_LAMBDA: 'aws_lambda',\n    /** AWS Elastic Beanstalk. */\n    AWS_ELASTIC_BEANSTALK: 'aws_elastic_beanstalk',\n    /** Azure Virtual Machines. */\n    AZURE_VM: 'azure_vm',\n    /** Azure Container Instances. */\n    AZURE_CONTAINER_INSTANCES: 'azure_container_instances',\n    /** Azure Kubernetes Service. */\n    AZURE_AKS: 'azure_aks',\n    /** Azure Functions. */\n    AZURE_FUNCTIONS: 'azure_functions',\n    /** Azure App Service. */\n    AZURE_APP_SERVICE: 'azure_app_service',\n    /** Google Cloud Compute Engine (GCE). */\n    GCP_COMPUTE_ENGINE: 'gcp_compute_engine',\n    /** Google Cloud Run. */\n    GCP_CLOUD_RUN: 'gcp_cloud_run',\n    /** Google Cloud Kubernetes Engine (GKE). */\n    GCP_KUBERNETES_ENGINE: 'gcp_kubernetes_engine',\n    /** Google Cloud Functions (GCF). */\n    GCP_CLOUD_FUNCTIONS: 'gcp_cloud_functions',\n    /** Google Cloud App Engine (GAE). */\n    GCP_APP_ENGINE: 'gcp_app_engine',\n};\nexport var AwsEcsLaunchtypeValues = {\n    /** ec2. */\n    EC2: 'ec2',\n    /** fargate. */\n    FARGATE: 'fargate',\n};\nexport var HostArchValues = {\n    /** AMD64. */\n    AMD64: 'amd64',\n    /** ARM32. */\n    ARM32: 'arm32',\n    /** ARM64. */\n    ARM64: 'arm64',\n    /** Itanium. */\n    IA64: 'ia64',\n    /** 32-bit PowerPC. */\n    PPC32: 'ppc32',\n    /** 64-bit PowerPC. */\n    PPC64: 'ppc64',\n    /** 32-bit x86. */\n    X86: 'x86',\n};\nexport var OsTypeValues = {\n    /** Microsoft Windows. */\n    WINDOWS: 'windows',\n    /** Linux. */\n    LINUX: 'linux',\n    /** Apple Darwin. */\n    DARWIN: 'darwin',\n    /** FreeBSD. */\n    FREEBSD: 'freebsd',\n    /** NetBSD. */\n    NETBSD: 'netbsd',\n    /** OpenBSD. */\n    OPENBSD: 'openbsd',\n    /** DragonFly BSD. */\n    DRAGONFLYBSD: 'dragonflybsd',\n    /** HP-UX (Hewlett Packard Unix). */\n    HPUX: 'hpux',\n    /** AIX (Advanced Interactive eXecutive). */\n    AIX: 'aix',\n    /** Oracle Solaris. */\n    SOLARIS: 'solaris',\n    /** IBM z/OS. */\n    Z_OS: 'z_os',\n};\nexport var TelemetrySdkLanguageValues = {\n    /** cpp. */\n    CPP: 'cpp',\n    /** dotnet. */\n    DOTNET: 'dotnet',\n    /** erlang. */\n    ERLANG: 'erlang',\n    /** go. */\n    GO: 'go',\n    /** java. */\n    JAVA: 'java',\n    /** nodejs. */\n    NODEJS: 'nodejs',\n    /** php. */\n    PHP: 'php',\n    /** python. */\n    PYTHON: 'python',\n    /** ruby. */\n    RUBY: 'ruby',\n    /** webjs. */\n    WEBJS: 'webjs',\n};\n//# sourceMappingURL=SemanticResourceAttributes.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n// this is autogenerated file, see scripts/version-update.js\nexport var VERSION = '1.7.0';\n//# sourceMappingURL=version.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { otperformance as performance } from '../platform';\nvar NANOSECOND_DIGITS = 9;\nvar SECOND_TO_NANOSECONDS = Math.pow(10, NANOSECOND_DIGITS);\n/**\n * Converts a number to HrTime, HrTime = [number, number].\n * The first number is UNIX Epoch time in seconds since 00:00:00 UTC on 1 January 1970.\n * The second number represents the partial second elapsed since Unix Epoch time represented by first number in nanoseconds.\n * For example, 2021-01-01T12:30:10.150Z in UNIX Epoch time in milliseconds is represented as 1609504210150.\n * numberToHrtime calculates the first number by converting and truncating the Epoch time in milliseconds to seconds:\n * HrTime[0] = Math.trunc(1609504210150 / 1000) = 1609504210.\n * numberToHrtime calculates the second number by converting the digits after the decimal point of the subtraction, (1609504210150 / 1000) - HrTime[0], to nanoseconds:\n * HrTime[1] = Number((1609504210.150 - HrTime[0]).toFixed(9)) * SECOND_TO_NANOSECONDS = 150000000.\n * This is represented in HrTime format as [1609504210, 150000000].\n * @param epochMillis\n */\nfunction numberToHrtime(epochMillis) {\n    var epochSeconds = epochMillis / 1000;\n    // Decimals only.\n    var seconds = Math.trunc(epochSeconds);\n    // Round sub-nanosecond accuracy to nanosecond.\n    var nanos = Number((epochSeconds - seconds).toFixed(NANOSECOND_DIGITS)) *\n        SECOND_TO_NANOSECONDS;\n    return [seconds, nanos];\n}\nfunction getTimeOrigin() {\n    var timeOrigin = performance.timeOrigin;\n    if (typeof timeOrigin !== 'number') {\n        var perf = performance;\n        timeOrigin = perf.timing && perf.timing.fetchStart;\n    }\n    return timeOrigin;\n}\n/**\n * Returns an hrtime calculated via performance component.\n * @param performanceNow\n */\nexport function hrTime(performanceNow) {\n    var timeOrigin = numberToHrtime(getTimeOrigin());\n    var now = numberToHrtime(typeof performanceNow === 'number' ? performanceNow : performance.now());\n    var seconds = timeOrigin[0] + now[0];\n    var nanos = timeOrigin[1] + now[1];\n    // Nanoseconds\n    if (nanos > SECOND_TO_NANOSECONDS) {\n        nanos -= SECOND_TO_NANOSECONDS;\n        seconds += 1;\n    }\n    return [seconds, nanos];\n}\n/**\n *\n * Converts a TimeInput to an HrTime, defaults to _hrtime().\n * @param time\n */\nexport function timeInputToHrTime(time) {\n    // process.hrtime\n    if (isTimeInputHrTime(time)) {\n        return time;\n    }\n    else if (typeof time === 'number') {\n        // Must be a performance.now() if it's smaller than process start time.\n        if (time < getTimeOrigin()) {\n            return hrTime(time);\n        }\n        else {\n            // epoch milliseconds or performance.timeOrigin\n            return numberToHrtime(time);\n        }\n    }\n    else if (time instanceof Date) {\n        return numberToHrtime(time.getTime());\n    }\n    else {\n        throw TypeError('Invalid input type');\n    }\n}\n/**\n * Returns a duration of two hrTime.\n * @param startTime\n * @param endTime\n */\nexport function hrTimeDuration(startTime, endTime) {\n    var seconds = endTime[0] - startTime[0];\n    var nanos = endTime[1] - startTime[1];\n    // overflow\n    if (nanos < 0) {\n        seconds -= 1;\n        // negate\n        nanos += SECOND_TO_NANOSECONDS;\n    }\n    return [seconds, nanos];\n}\n/**\n * Convert hrTime to timestamp, for example \"2019-05-14T17:00:00.000123456Z\"\n * @param time\n */\nexport function hrTimeToTimeStamp(time) {\n    var precision = NANOSECOND_DIGITS;\n    var tmp = \"\" + '0'.repeat(precision) + time[1] + \"Z\";\n    var nanoString = tmp.substr(tmp.length - precision - 1);\n    var date = new Date(time[0] * 1000).toISOString();\n    return date.replace('000Z', nanoString);\n}\n/**\n * Convert hrTime to nanoseconds.\n * @param time\n */\nexport function hrTimeToNanoseconds(time) {\n    return time[0] * SECOND_TO_NANOSECONDS + time[1];\n}\n/**\n * Convert hrTime to milliseconds.\n * @param time\n */\nexport function hrTimeToMilliseconds(time) {\n    return Math.round(time[0] * 1e3 + time[1] / 1e6);\n}\n/**\n * Convert hrTime to microseconds.\n * @param time\n */\nexport function hrTimeToMicroseconds(time) {\n    return Math.round(time[0] * 1e6 + time[1] / 1e3);\n}\n/**\n * check if time is HrTime\n * @param value\n */\nexport function isTimeInputHrTime(value) {\n    return (Array.isArray(value) &&\n        value.length === 2 &&\n        typeof value[0] === 'number' &&\n        typeof value[1] === 'number');\n}\n/**\n * check if input value is a correct types.TimeInput\n * @param value\n */\nexport function isTimeInput(value) {\n    return (isTimeInputHrTime(value) ||\n        typeof value === 'number' ||\n        value instanceof Date);\n}\n//# sourceMappingURL=time.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nexport var ExportResultCode;\n(function (ExportResultCode) {\n    ExportResultCode[ExportResultCode[\"SUCCESS\"] = 0] = \"SUCCESS\";\n    ExportResultCode[ExportResultCode[\"FAILED\"] = 1] = \"FAILED\";\n})(ExportResultCode || (ExportResultCode = {}));\n//# sourceMappingURL=ExportResult.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __values = (this && this.__values) || function(o) {\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n    if (m) return m.call(o);\n    if (o && typeof o.length === \"number\") return {\n        next: function () {\n            if (o && i >= o.length) o = void 0;\n            return { value: o && o[i++], done: !o };\n        }\n    };\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\nimport { diag, } from '@opentelemetry/api';\n/** Combines multiple propagators into a single propagator. */\nvar CompositePropagator = /** @class */ (function () {\n    /**\n     * Construct a composite propagator from a list of propagators.\n     *\n     * @param [config] Configuration object for composite propagator\n     */\n    function CompositePropagator(config) {\n        if (config === void 0) { config = {}; }\n        var _a;\n        this._propagators = (_a = config.propagators) !== null && _a !== void 0 ? _a : [];\n        this._fields = Array.from(new Set(this._propagators\n            // older propagators may not have fields function, null check to be sure\n            .map(function (p) { return (typeof p.fields === 'function' ? p.fields() : []); })\n            .reduce(function (x, y) { return x.concat(y); }, [])));\n    }\n    /**\n     * Run each of the configured propagators with the given context and carrier.\n     * Propagators are run in the order they are configured, so if multiple\n     * propagators write the same carrier key, the propagator later in the list\n     * will \"win\".\n     *\n     * @param context Context to inject\n     * @param carrier Carrier into which context will be injected\n     */\n    CompositePropagator.prototype.inject = function (context, carrier, setter) {\n        var e_1, _a;\n        try {\n            for (var _b = __values(this._propagators), _c = _b.next(); !_c.done; _c = _b.next()) {\n                var propagator = _c.value;\n                try {\n                    propagator.inject(context, carrier, setter);\n                }\n                catch (err) {\n                    diag.warn(\"Failed to inject with \" + propagator.constructor.name + \". Err: \" + err.message);\n                }\n            }\n        }\n        catch (e_1_1) { e_1 = { error: e_1_1 }; }\n        finally {\n            try {\n                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n            }\n            finally { if (e_1) throw e_1.error; }\n        }\n    };\n    /**\n     * Run each of the configured propagators with the given context and carrier.\n     * Propagators are run in the order they are configured, so if multiple\n     * propagators write the same context key, the propagator later in the list\n     * will \"win\".\n     *\n     * @param context Context to add values to\n     * @param carrier Carrier from which to extract context\n     */\n    CompositePropagator.prototype.extract = function (context, carrier, getter) {\n        return this._propagators.reduce(function (ctx, propagator) {\n            try {\n                return propagator.extract(ctx, carrier, getter);\n            }\n            catch (err) {\n                diag.warn(\"Failed to inject with \" + propagator.constructor.name + \". Err: \" + err.message);\n            }\n            return ctx;\n        }, context);\n    };\n    CompositePropagator.prototype.fields = function () {\n        // return a new array so our fields cannot be modified\n        return this._fields.slice();\n    };\n    return CompositePropagator;\n}());\nexport { CompositePropagator };\n//# sourceMappingURL=composite.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar VALID_KEY_CHAR_RANGE = '[_0-9a-z-*/]';\nvar VALID_KEY = \"[a-z]\" + VALID_KEY_CHAR_RANGE + \"{0,255}\";\nvar VALID_VENDOR_KEY = \"[a-z0-9]\" + VALID_KEY_CHAR_RANGE + \"{0,240}@[a-z]\" + VALID_KEY_CHAR_RANGE + \"{0,13}\";\nvar VALID_KEY_REGEX = new RegExp(\"^(?:\" + VALID_KEY + \"|\" + VALID_VENDOR_KEY + \")$\");\nvar VALID_VALUE_BASE_REGEX = /^[ -~]{0,255}[!-~]$/;\nvar INVALID_VALUE_COMMA_EQUAL_REGEX = /,|=/;\n/**\n * Key is opaque string up to 256 characters printable. It MUST begin with a\n * lowercase letter, and can only contain lowercase letters a-z, digits 0-9,\n * underscores _, dashes -, asterisks *, and forward slashes /.\n * For multi-tenant vendor scenarios, an at sign (@) can be used to prefix the\n * vendor name. Vendors SHOULD set the tenant ID at the beginning of the key.\n * see https://www.w3.org/TR/trace-context/#key\n */\nexport function validateKey(key) {\n    return VALID_KEY_REGEX.test(key);\n}\n/**\n * Value is opaque string up to 256 characters printable ASCII RFC0020\n * characters (i.e., the range 0x20 to 0x7E) except comma , and =.\n */\nexport function validateValue(value) {\n    return (VALID_VALUE_BASE_REGEX.test(value) &&\n        !INVALID_VALUE_COMMA_EQUAL_REGEX.test(value));\n}\n//# sourceMappingURL=validators.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { validateKey, validateValue } from '../internal/validators';\nvar MAX_TRACE_STATE_ITEMS = 32;\nvar MAX_TRACE_STATE_LEN = 512;\nvar LIST_MEMBERS_SEPARATOR = ',';\nvar LIST_MEMBER_KEY_VALUE_SPLITTER = '=';\n/**\n * TraceState must be a class and not a simple object type because of the spec\n * requirement (https://www.w3.org/TR/trace-context/#tracestate-field).\n *\n * Here is the list of allowed mutations:\n * - New key-value pair should be added into the beginning of the list\n * - The value of any key can be updated. Modified keys MUST be moved to the\n * beginning of the list.\n */\nvar TraceState = /** @class */ (function () {\n    function TraceState(rawTraceState) {\n        this._internalState = new Map();\n        if (rawTraceState)\n            this._parse(rawTraceState);\n    }\n    TraceState.prototype.set = function (key, value) {\n        // TODO: Benchmark the different approaches(map vs list) and\n        // use the faster one.\n        var traceState = this._clone();\n        if (traceState._internalState.has(key)) {\n            traceState._internalState.delete(key);\n        }\n        traceState._internalState.set(key, value);\n        return traceState;\n    };\n    TraceState.prototype.unset = function (key) {\n        var traceState = this._clone();\n        traceState._internalState.delete(key);\n        return traceState;\n    };\n    TraceState.prototype.get = function (key) {\n        return this._internalState.get(key);\n    };\n    TraceState.prototype.serialize = function () {\n        var _this = this;\n        return this._keys()\n            .reduce(function (agg, key) {\n            agg.push(key + LIST_MEMBER_KEY_VALUE_SPLITTER + _this.get(key));\n            return agg;\n        }, [])\n            .join(LIST_MEMBERS_SEPARATOR);\n    };\n    TraceState.prototype._parse = function (rawTraceState) {\n        if (rawTraceState.length > MAX_TRACE_STATE_LEN)\n            return;\n        this._internalState = rawTraceState\n            .split(LIST_MEMBERS_SEPARATOR)\n            .reverse() // Store in reverse so new keys (.set(...)) will be placed at the beginning\n            .reduce(function (agg, part) {\n            var listMember = part.trim(); // Optional Whitespace (OWS) handling\n            var i = listMember.indexOf(LIST_MEMBER_KEY_VALUE_SPLITTER);\n            if (i !== -1) {\n                var key = listMember.slice(0, i);\n                var value = listMember.slice(i + 1, part.length);\n                if (validateKey(key) && validateValue(value)) {\n                    agg.set(key, value);\n                }\n                else {\n                    // TODO: Consider to add warning log\n                }\n            }\n            return agg;\n        }, new Map());\n        // Because of the reverse() requirement, trunc must be done after map is created\n        if (this._internalState.size > MAX_TRACE_STATE_ITEMS) {\n            this._internalState = new Map(Array.from(this._internalState.entries())\n                .reverse() // Use reverse same as original tracestate parse chain\n                .slice(0, MAX_TRACE_STATE_ITEMS));\n        }\n    };\n    TraceState.prototype._keys = function () {\n        return Array.from(this._internalState.keys()).reverse();\n    };\n    TraceState.prototype._clone = function () {\n        var traceState = new TraceState();\n        traceState._internalState = new Map(this._internalState);\n        return traceState;\n    };\n    return TraceState;\n}());\nexport { TraceState };\n//# sourceMappingURL=TraceState.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { isSpanContextValid, trace, TraceFlags, } from '@opentelemetry/api';\nimport { isTracingSuppressed } from './suppress-tracing';\nimport { TraceState } from './TraceState';\nexport var TRACE_PARENT_HEADER = 'traceparent';\nexport var TRACE_STATE_HEADER = 'tracestate';\nvar VERSION = '00';\nvar VERSION_PART = '(?!ff)[\\\\da-f]{2}';\nvar TRACE_ID_PART = '(?![0]{32})[\\\\da-f]{32}';\nvar PARENT_ID_PART = '(?![0]{16})[\\\\da-f]{16}';\nvar FLAGS_PART = '[\\\\da-f]{2}';\nvar TRACE_PARENT_REGEX = new RegExp(\"^\\\\s?(\" + VERSION_PART + \")-(\" + TRACE_ID_PART + \")-(\" + PARENT_ID_PART + \")-(\" + FLAGS_PART + \")(-.*)?\\\\s?$\");\n/**\n * Parses information from the [traceparent] span tag and converts it into {@link SpanContext}\n * @param traceParent - A meta property that comes from server.\n *     It should be dynamically generated server side to have the server's request trace Id,\n *     a parent span Id that was set on the server's request span,\n *     and the trace flags to indicate the server's sampling decision\n *     (01 = sampled, 00 = not sampled).\n *     for example: '{version}-{traceId}-{spanId}-{sampleDecision}'\n *     For more information see {@link https://www.w3.org/TR/trace-context/}\n */\nexport function parseTraceParent(traceParent) {\n    var match = TRACE_PARENT_REGEX.exec(traceParent);\n    if (!match)\n        return null;\n    // According to the specification the implementation should be compatible\n    // with future versions. If there are more parts, we only reject it if it's using version 00\n    // See https://www.w3.org/TR/trace-context/#versioning-of-traceparent\n    if (match[1] === '00' && match[5])\n        return null;\n    return {\n        traceId: match[2],\n        spanId: match[3],\n        traceFlags: parseInt(match[4], 16),\n    };\n}\n/**\n * Propagates {@link SpanContext} through Trace Context format propagation.\n *\n * Based on the Trace Context specification:\n * https://www.w3.org/TR/trace-context/\n */\nvar W3CTraceContextPropagator = /** @class */ (function () {\n    function W3CTraceContextPropagator() {\n    }\n    W3CTraceContextPropagator.prototype.inject = function (context, carrier, setter) {\n        var spanContext = trace.getSpanContext(context);\n        if (!spanContext ||\n            isTracingSuppressed(context) ||\n            !isSpanContextValid(spanContext))\n            return;\n        var traceParent = VERSION + \"-\" + spanContext.traceId + \"-\" + spanContext.spanId + \"-0\" + Number(spanContext.traceFlags || TraceFlags.NONE).toString(16);\n        setter.set(carrier, TRACE_PARENT_HEADER, traceParent);\n        if (spanContext.traceState) {\n            setter.set(carrier, TRACE_STATE_HEADER, spanContext.traceState.serialize());\n        }\n    };\n    W3CTraceContextPropagator.prototype.extract = function (context, carrier, getter) {\n        var traceParentHeader = getter.get(carrier, TRACE_PARENT_HEADER);\n        if (!traceParentHeader)\n            return context;\n        var traceParent = Array.isArray(traceParentHeader)\n            ? traceParentHeader[0]\n            : traceParentHeader;\n        if (typeof traceParent !== 'string')\n            return context;\n        var spanContext = parseTraceParent(traceParent);\n        if (!spanContext)\n            return context;\n        spanContext.isRemote = true;\n        var traceStateHeader = getter.get(carrier, TRACE_STATE_HEADER);\n        if (traceStateHeader) {\n            // If more than one `tracestate` header is found, we merge them into a\n            // single header.\n            var state = Array.isArray(traceStateHeader)\n                ? traceStateHeader.join(',')\n                : traceStateHeader;\n            spanContext.traceState = new TraceState(typeof state === 'string' ? state : undefined);\n        }\n        return trace.setSpanContext(context, spanContext);\n    };\n    W3CTraceContextPropagator.prototype.fields = function () {\n        return [TRACE_PARENT_HEADER, TRACE_STATE_HEADER];\n    };\n    return W3CTraceContextPropagator;\n}());\nexport { W3CTraceContextPropagator };\n//# sourceMappingURL=W3CTraceContextPropagator.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { createContextKey } from '@opentelemetry/api';\nvar RPC_METADATA_KEY = createContextKey('OpenTelemetry SDK Context Key RPC_METADATA');\nexport var RPCType;\n(function (RPCType) {\n    RPCType[\"HTTP\"] = \"http\";\n})(RPCType || (RPCType = {}));\nexport function setRPCMetadata(context, meta) {\n    return context.setValue(RPC_METADATA_KEY, meta);\n}\nexport function deleteRPCMetadata(context) {\n    return context.deleteValue(RPC_METADATA_KEY);\n}\nexport function getRPCMetadata(context) {\n    return context.getValue(RPC_METADATA_KEY);\n}\n//# sourceMappingURL=rpc-metadata.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { SamplingDecision } from '@opentelemetry/api';\n/**\n * @deprecated Use the one defined in @opentelemetry/sdk-trace-base instead.\n * Sampler that samples no traces.\n */\nvar AlwaysOffSampler = /** @class */ (function () {\n    function AlwaysOffSampler() {\n    }\n    AlwaysOffSampler.prototype.shouldSample = function () {\n        return {\n            decision: SamplingDecision.NOT_RECORD,\n        };\n    };\n    AlwaysOffSampler.prototype.toString = function () {\n        return 'AlwaysOffSampler';\n    };\n    return AlwaysOffSampler;\n}());\nexport { AlwaysOffSampler };\n//# sourceMappingURL=AlwaysOffSampler.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { SamplingDecision } from '@opentelemetry/api';\n/**\n * @deprecated Use the one defined in @opentelemetry/sdk-trace-base instead.\n * Sampler that samples all traces.\n */\nvar AlwaysOnSampler = /** @class */ (function () {\n    function AlwaysOnSampler() {\n    }\n    AlwaysOnSampler.prototype.shouldSample = function () {\n        return {\n            decision: SamplingDecision.RECORD_AND_SAMPLED,\n        };\n    };\n    AlwaysOnSampler.prototype.toString = function () {\n        return 'AlwaysOnSampler';\n    };\n    return AlwaysOnSampler;\n}());\nexport { AlwaysOnSampler };\n//# sourceMappingURL=AlwaysOnSampler.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/**\n * based on lodash in order to support esm builds without esModuleInterop.\n * lodash is using MIT License.\n **/\nvar objectTag = '[object Object]';\nvar nullTag = '[object Null]';\nvar undefinedTag = '[object Undefined]';\nvar funcProto = Function.prototype;\nvar funcToString = funcProto.toString;\nvar objectCtorString = funcToString.call(Object);\nvar getPrototype = overArg(Object.getPrototypeOf, Object);\nvar objectProto = Object.prototype;\nvar hasOwnProperty = objectProto.hasOwnProperty;\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\nvar nativeObjectToString = objectProto.toString;\n/**\n * Creates a unary function that invokes `func` with its argument transformed.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} transform The argument transform.\n * @returns {Function} Returns the new function.\n */\nfunction overArg(func, transform) {\n    return function (arg) {\n        return func(transform(arg));\n    };\n}\n/**\n * Checks if `value` is a plain object, that is, an object created by the\n * `Object` constructor or one with a `[[Prototype]]` of `null`.\n *\n * @static\n * @memberOf _\n * @since 0.8.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a plain object, else `false`.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n * }\n *\n * _.isPlainObject(new Foo);\n * // => false\n *\n * _.isPlainObject([1, 2, 3]);\n * // => false\n *\n * _.isPlainObject({ 'x': 0, 'y': 0 });\n * // => true\n *\n * _.isPlainObject(Object.create(null));\n * // => true\n */\nexport function isPlainObject(value) {\n    if (!isObjectLike(value) || baseGetTag(value) !== objectTag) {\n        return false;\n    }\n    var proto = getPrototype(value);\n    if (proto === null) {\n        return true;\n    }\n    var Ctor = hasOwnProperty.call(proto, 'constructor') && proto.constructor;\n    return typeof Ctor == 'function' && Ctor instanceof Ctor &&\n        funcToString.call(Ctor) === objectCtorString;\n}\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n    return value != null && typeof value == 'object';\n}\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n    if (value == null) {\n        return value === undefined ? undefinedTag : nullTag;\n    }\n    return (symToStringTag && symToStringTag in Object(value))\n        ? getRawTag(value)\n        : objectToString(value);\n}\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n    var isOwn = hasOwnProperty.call(value, symToStringTag), tag = value[symToStringTag];\n    var unmasked = false;\n    try {\n        value[symToStringTag] = undefined;\n        unmasked = true;\n    }\n    catch (e) {\n        // silence\n    }\n    var result = nativeObjectToString.call(value);\n    if (unmasked) {\n        if (isOwn) {\n            value[symToStringTag] = tag;\n        }\n        else {\n            delete value[symToStringTag];\n        }\n    }\n    return result;\n}\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n    return nativeObjectToString.call(value);\n}\n//# sourceMappingURL=lodash.merge.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { isSpanContextValid, TraceFlags, trace, } from '@opentelemetry/api';\nimport { globalErrorHandler } from '../../common/global-error-handler';\nimport { AlwaysOffSampler } from './AlwaysOffSampler';\nimport { AlwaysOnSampler } from './AlwaysOnSampler';\n/**\n * @deprecated Use the one defined in @opentelemetry/sdk-trace-base instead.\n * A composite sampler that either respects the parent span's sampling decision\n * or delegates to `delegateSampler` for root spans.\n */\nvar ParentBasedSampler = /** @class */ (function () {\n    function ParentBasedSampler(config) {\n        var _a, _b, _c, _d;\n        this._root = config.root;\n        if (!this._root) {\n            globalErrorHandler(new Error('ParentBasedSampler must have a root sampler configured'));\n            this._root = new AlwaysOnSampler();\n        }\n        this._remoteParentSampled =\n            (_a = config.remoteParentSampled) !== null && _a !== void 0 ? _a : new AlwaysOnSampler();\n        this._remoteParentNotSampled =\n            (_b = config.remoteParentNotSampled) !== null && _b !== void 0 ? _b : new AlwaysOffSampler();\n        this._localParentSampled =\n            (_c = config.localParentSampled) !== null && _c !== void 0 ? _c : new AlwaysOnSampler();\n        this._localParentNotSampled =\n            (_d = config.localParentNotSampled) !== null && _d !== void 0 ? _d : new AlwaysOffSampler();\n    }\n    ParentBasedSampler.prototype.shouldSample = function (context, traceId, spanName, spanKind, attributes, links) {\n        var parentContext = trace.getSpanContext(context);\n        if (!parentContext || !isSpanContextValid(parentContext)) {\n            return this._root.shouldSample(context, traceId, spanName, spanKind, attributes, links);\n        }\n        if (parentContext.isRemote) {\n            if (parentContext.traceFlags & TraceFlags.SAMPLED) {\n                return this._remoteParentSampled.shouldSample(context, traceId, spanName, spanKind, attributes, links);\n            }\n            return this._remoteParentNotSampled.shouldSample(context, traceId, spanName, spanKind, attributes, links);\n        }\n        if (parentContext.traceFlags & TraceFlags.SAMPLED) {\n            return this._localParentSampled.shouldSample(context, traceId, spanName, spanKind, attributes, links);\n        }\n        return this._localParentNotSampled.shouldSample(context, traceId, spanName, spanKind, attributes, links);\n    };\n    ParentBasedSampler.prototype.toString = function () {\n        return \"ParentBased{root=\" + this._root.toString() + \", remoteParentSampled=\" + this._remoteParentSampled.toString() + \", remoteParentNotSampled=\" + this._remoteParentNotSampled.toString() + \", localParentSampled=\" + this._localParentSampled.toString() + \", localParentNotSampled=\" + this._localParentNotSampled.toString() + \"}\";\n    };\n    return ParentBasedSampler;\n}());\nexport { ParentBasedSampler };\n//# sourceMappingURL=ParentBasedSampler.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { SamplingDecision, isValidTraceId, } from '@opentelemetry/api';\n/**\n * @deprecated Use the one defined in @opentelemetry/sdk-trace-base instead.\n * Sampler that samples a given fraction of traces based of trace id deterministically.\n */\nvar TraceIdRatioBasedSampler = /** @class */ (function () {\n    function TraceIdRatioBasedSampler(_ratio) {\n        if (_ratio === void 0) { _ratio = 0; }\n        this._ratio = _ratio;\n        this._ratio = this._normalize(_ratio);\n        this._upperBound = Math.floor(this._ratio * 0xffffffff);\n    }\n    TraceIdRatioBasedSampler.prototype.shouldSample = function (context, traceId) {\n        return {\n            decision: isValidTraceId(traceId) && this._accumulate(traceId) < this._upperBound\n                ? SamplingDecision.RECORD_AND_SAMPLED\n                : SamplingDecision.NOT_RECORD,\n        };\n    };\n    TraceIdRatioBasedSampler.prototype.toString = function () {\n        return \"TraceIdRatioBased{\" + this._ratio + \"}\";\n    };\n    TraceIdRatioBasedSampler.prototype._normalize = function (ratio) {\n        if (typeof ratio !== 'number' || isNaN(ratio))\n            return 0;\n        return ratio >= 1 ? 1 : ratio <= 0 ? 0 : ratio;\n    };\n    TraceIdRatioBasedSampler.prototype._accumulate = function (traceId) {\n        var accumulation = 0;\n        for (var i = 0; i < traceId.length / 8; i++) {\n            var pos = i * 8;\n            var part = parseInt(traceId.slice(pos, pos + 8), 16);\n            accumulation = (accumulation ^ part) >>> 0;\n        }\n        return accumulation;\n    };\n    return TraceIdRatioBasedSampler;\n}());\nexport { TraceIdRatioBasedSampler };\n//# sourceMappingURL=TraceIdRatioBasedSampler.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar Deferred = /** @class */ (function () {\n    function Deferred() {\n        var _this = this;\n        this._promise = new Promise(function (resolve, reject) {\n            _this._resolve = resolve;\n            _this._reject = reject;\n        });\n    }\n    Object.defineProperty(Deferred.prototype, \"promise\", {\n        get: function () {\n            return this._promise;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Deferred.prototype.resolve = function (val) {\n        this._resolve(val);\n    };\n    Deferred.prototype.reject = function (err) {\n        this._reject(err);\n    };\n    return Deferred;\n}());\nexport { Deferred };\n//# sourceMappingURL=promise.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport { Deferred } from './promise';\n/**\n * Bind the callback and only invoke the callback once regardless how many times `BindOnceFuture.call` is invoked.\n */\nvar BindOnceFuture = /** @class */ (function () {\n    function BindOnceFuture(_callback, _that) {\n        this._callback = _callback;\n        this._that = _that;\n        this._isCalled = false;\n        this._deferred = new Deferred();\n    }\n    Object.defineProperty(BindOnceFuture.prototype, \"isCalled\", {\n        get: function () {\n            return this._isCalled;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(BindOnceFuture.prototype, \"promise\", {\n        get: function () {\n            return this._deferred.promise;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    BindOnceFuture.prototype.call = function () {\n        var _a;\n        var _this = this;\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (!this._isCalled) {\n            this._isCalled = true;\n            try {\n                Promise.resolve((_a = this._callback).call.apply(_a, __spreadArray([this._that], __read(args), false)))\n                    .then(function (val) { return _this._deferred.resolve(val); }, function (err) { return _this._deferred.reject(err); });\n            }\n            catch (err) {\n                this._deferred.reject(err);\n            }\n        }\n        return this._deferred.promise;\n    };\n    return BindOnceFuture;\n}());\nexport { BindOnceFuture };\n//# sourceMappingURL=callback.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport { Resource } from '../../Resource';\nimport { diag } from '@opentelemetry/api';\n/**\n * Runs all resource detectors and returns the results merged into a single\n * Resource.\n *\n * @param config Configuration for resource detection\n */\nexport var detectResources = function (config) {\n    if (config === void 0) { config = {}; }\n    return __awaiter(void 0, void 0, void 0, function () {\n        var internalConfig, resources;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    internalConfig = Object.assign(config);\n                    return [4 /*yield*/, Promise.all((internalConfig.detectors || []).map(function (d) { return __awaiter(void 0, void 0, void 0, function () {\n                            var resource, e_1;\n                            return __generator(this, function (_a) {\n                                switch (_a.label) {\n                                    case 0:\n                                        _a.trys.push([0, 2, , 3]);\n                                        return [4 /*yield*/, d.detect(internalConfig)];\n                                    case 1:\n                                        resource = _a.sent();\n                                        diag.debug(d.constructor.name + \" found resource.\", resource);\n                                        return [2 /*return*/, resource];\n                                    case 2:\n                                        e_1 = _a.sent();\n                                        diag.debug(d.constructor.name + \" failed: \" + e_1.message);\n                                        return [2 /*return*/, Resource.empty()];\n                                    case 3: return [2 /*return*/];\n                                }\n                            });\n                        }); }))];\n                case 1:\n                    resources = _a.sent();\n                    return [2 /*return*/, resources.reduce(function (acc, resource) { return acc.merge(resource); }, Resource.empty())];\n            }\n        });\n    });\n};\n//# sourceMappingURL=detect-resources.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nexport var TracesSamplerValues;\n(function (TracesSamplerValues) {\n    TracesSamplerValues[\"AlwaysOff\"] = \"always_off\";\n    TracesSamplerValues[\"AlwaysOn\"] = \"always_on\";\n    TracesSamplerValues[\"ParentBasedAlwaysOff\"] = \"parentbased_always_off\";\n    TracesSamplerValues[\"ParentBasedAlwaysOn\"] = \"parentbased_always_on\";\n    TracesSamplerValues[\"ParentBasedTraceIdRatio\"] = \"parentbased_traceidratio\";\n    TracesSamplerValues[\"TraceIdRatio\"] = \"traceidratio\";\n})(TracesSamplerValues || (TracesSamplerValues = {}));\n//# sourceMappingURL=sampling.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport { Resource } from '../Resource';\nvar NoopDetector = /** @class */ (function () {\n    function NoopDetector() {\n    }\n    NoopDetector.prototype.detect = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                return [2 /*return*/, new Resource({})];\n            });\n        });\n    };\n    return NoopDetector;\n}());\nexport { NoopDetector };\nexport var noopDetector = new NoopDetector();\n//# sourceMappingURL=NoopDetector.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { SemanticResourceAttributes } from '@opentelemetry/semantic-conventions';\nimport { SDK_INFO } from '@opentelemetry/core';\nimport { defaultServiceName } from './platform';\n/**\n * A Resource describes the entity for which a signals (metrics or trace) are\n * collected.\n */\nvar Resource = /** @class */ (function () {\n    function Resource(\n    /**\n     * A dictionary of attributes with string keys and values that provide\n     * information about the entity as numbers, strings or booleans\n     * TODO: Consider to add check/validation on attributes.\n     */\n    attributes) {\n        this.attributes = attributes;\n    }\n    /**\n     * Returns an empty Resource\n     */\n    Resource.empty = function () {\n        return Resource.EMPTY;\n    };\n    /**\n     * Returns a Resource that indentifies the SDK in use.\n     */\n    Resource.default = function () {\n        var _a;\n        return new Resource((_a = {},\n            _a[SemanticResourceAttributes.SERVICE_NAME] = defaultServiceName(),\n            _a[SemanticResourceAttributes.TELEMETRY_SDK_LANGUAGE] = SDK_INFO[SemanticResourceAttributes.TELEMETRY_SDK_LANGUAGE],\n            _a[SemanticResourceAttributes.TELEMETRY_SDK_NAME] = SDK_INFO[SemanticResourceAttributes.TELEMETRY_SDK_NAME],\n            _a[SemanticResourceAttributes.TELEMETRY_SDK_VERSION] = SDK_INFO[SemanticResourceAttributes.TELEMETRY_SDK_VERSION],\n            _a));\n    };\n    /**\n     * Returns a new, merged {@link Resource} by merging the current Resource\n     * with the other Resource. In case of a collision, other Resource takes\n     * precedence.\n     *\n     * @param other the Resource that will be merged with this.\n     * @returns the newly merged Resource.\n     */\n    Resource.prototype.merge = function (other) {\n        if (!other || !Object.keys(other.attributes).length)\n            return this;\n        // SpanAttributes from resource overwrite attributes from other resource.\n        var mergedAttributes = Object.assign({}, this.attributes, other.attributes);\n        return new Resource(mergedAttributes);\n    };\n    Resource.EMPTY = new Resource({});\n    return Resource;\n}());\nexport { Resource };\n//# sourceMappingURL=Resource.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nexport function defaultServiceName() {\n    return 'unknown_service';\n}\n//# sourceMappingURL=default-service-name.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport { diag } from '@opentelemetry/api';\nimport { SemanticResourceAttributes } from '@opentelemetry/semantic-conventions';\nimport { Resource } from '..';\n/**\n * BrowserDetector will be used to detect the resources related to browser.\n */\nvar BrowserDetector = /** @class */ (function () {\n    function BrowserDetector() {\n    }\n    BrowserDetector.prototype.detect = function (config) {\n        return __awaiter(this, void 0, void 0, function () {\n            var isBrowser, browserResource;\n            var _a;\n            return __generator(this, function (_b) {\n                isBrowser = typeof navigator !== 'undefined';\n                if (!isBrowser) {\n                    return [2 /*return*/, Resource.empty()];\n                }\n                browserResource = (_a = {},\n                    _a[SemanticResourceAttributes.PROCESS_RUNTIME_NAME] = 'browser',\n                    _a[SemanticResourceAttributes.PROCESS_RUNTIME_DESCRIPTION] = 'Web Browser',\n                    _a[SemanticResourceAttributes.PROCESS_RUNTIME_VERSION] = navigator.userAgent,\n                    _a);\n                return [2 /*return*/, this._getResourceAttributes(browserResource, config)];\n            });\n        });\n    };\n    /**\n     * Validates process resource attribute map from process variables\n     *\n     * @param browserResource The un-sanitized resource attributes from process as key/value pairs.\n     * @param config: Config\n     * @returns The sanitized resource attributes.\n     */\n    BrowserDetector.prototype._getResourceAttributes = function (browserResource, _config) {\n        if (browserResource[SemanticResourceAttributes.PROCESS_RUNTIME_VERSION] === '') {\n            diag.debug('BrowserDetector failed: Unable to find required browser resources. ');\n            return Resource.empty();\n        }\n        else {\n            return new Resource(__assign({}, browserResource));\n        }\n    };\n    return BrowserDetector;\n}());\nexport var browserDetector = new BrowserDetector();\n//# sourceMappingURL=BrowserDetector.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __values = (this && this.__values) || function(o) {\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n    if (m) return m.call(o);\n    if (o && typeof o.length === \"number\") return {\n        next: function () {\n            if (o && i >= o.length) o = void 0;\n            return { value: o && o[i++], done: !o };\n        }\n    };\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nimport { diag } from '@opentelemetry/api';\nimport { getEnv } from '@opentelemetry/core';\nimport { SemanticResourceAttributes } from '@opentelemetry/semantic-conventions';\nimport { Resource } from '../Resource';\n/**\n * EnvDetector can be used to detect the presence of and create a Resource\n * from the OTEL_RESOURCE_ATTRIBUTES environment variable.\n */\nvar EnvDetector = /** @class */ (function () {\n    function EnvDetector() {\n        // Type, attribute keys, and attribute values should not exceed 256 characters.\n        this._MAX_LENGTH = 255;\n        // OTEL_RESOURCE_ATTRIBUTES is a comma-separated list of attributes.\n        this._COMMA_SEPARATOR = ',';\n        // OTEL_RESOURCE_ATTRIBUTES contains key value pair separated by '='.\n        this._LABEL_KEY_VALUE_SPLITTER = '=';\n        this._ERROR_MESSAGE_INVALID_CHARS = 'should be a ASCII string with a length greater than 0 and not exceed ' +\n            this._MAX_LENGTH +\n            ' characters.';\n        this._ERROR_MESSAGE_INVALID_VALUE = 'should be a ASCII string with a length not exceed ' +\n            this._MAX_LENGTH +\n            ' characters.';\n    }\n    /**\n     * Returns a {@link Resource} populated with attributes from the\n     * OTEL_RESOURCE_ATTRIBUTES environment variable. Note this is an async\n     * function to conform to the Detector interface.\n     *\n     * @param config The resource detection config\n     */\n    EnvDetector.prototype.detect = function (_config) {\n        return __awaiter(this, void 0, void 0, function () {\n            var attributes, env, rawAttributes, serviceName, parsedAttributes;\n            return __generator(this, function (_a) {\n                attributes = {};\n                env = getEnv();\n                rawAttributes = env.OTEL_RESOURCE_ATTRIBUTES;\n                serviceName = env.OTEL_SERVICE_NAME;\n                if (rawAttributes) {\n                    try {\n                        parsedAttributes = this._parseResourceAttributes(rawAttributes);\n                        Object.assign(attributes, parsedAttributes);\n                    }\n                    catch (e) {\n                        diag.debug(\"EnvDetector failed: \" + e.message);\n                    }\n                }\n                if (serviceName) {\n                    attributes[SemanticResourceAttributes.SERVICE_NAME] = serviceName;\n                }\n                return [2 /*return*/, new Resource(attributes)];\n            });\n        });\n    };\n    /**\n     * Creates an attribute map from the OTEL_RESOURCE_ATTRIBUTES environment\n     * variable.\n     *\n     * OTEL_RESOURCE_ATTRIBUTES: A comma-separated list of attributes describing\n     * the source in more detail, e.g. “key1=val1,key2=val2”. Domain names and\n     * paths are accepted as attribute keys. Values may be quoted or unquoted in\n     * general. If a value contains whitespaces, =, or \" characters, it must\n     * always be quoted.\n     *\n     * @param rawEnvAttributes The resource attributes as a comma-seperated list\n     * of key/value pairs.\n     * @returns The sanitized resource attributes.\n     */\n    EnvDetector.prototype._parseResourceAttributes = function (rawEnvAttributes) {\n        var e_1, _a;\n        if (!rawEnvAttributes)\n            return {};\n        var attributes = {};\n        var rawAttributes = rawEnvAttributes.split(this._COMMA_SEPARATOR, -1);\n        try {\n            for (var rawAttributes_1 = __values(rawAttributes), rawAttributes_1_1 = rawAttributes_1.next(); !rawAttributes_1_1.done; rawAttributes_1_1 = rawAttributes_1.next()) {\n                var rawAttribute = rawAttributes_1_1.value;\n                var keyValuePair = rawAttribute.split(this._LABEL_KEY_VALUE_SPLITTER, -1);\n                if (keyValuePair.length !== 2) {\n                    continue;\n                }\n                var _b = __read(keyValuePair, 2), key = _b[0], value = _b[1];\n                // Leading and trailing whitespaces are trimmed.\n                key = key.trim();\n                value = value.trim().split('^\"|\"$').join('');\n                if (!this._isValidAndNotEmpty(key)) {\n                    throw new Error(\"Attribute key \" + this._ERROR_MESSAGE_INVALID_CHARS);\n                }\n                if (!this._isValid(value)) {\n                    throw new Error(\"Attribute value \" + this._ERROR_MESSAGE_INVALID_VALUE);\n                }\n                attributes[key] = value;\n            }\n        }\n        catch (e_1_1) { e_1 = { error: e_1_1 }; }\n        finally {\n            try {\n                if (rawAttributes_1_1 && !rawAttributes_1_1.done && (_a = rawAttributes_1.return)) _a.call(rawAttributes_1);\n            }\n            finally { if (e_1) throw e_1.error; }\n        }\n        return attributes;\n    };\n    /**\n     * Determines whether the given String is a valid printable ASCII string with\n     * a length not exceed _MAX_LENGTH characters.\n     *\n     * @param str The String to be validated.\n     * @returns Whether the String is valid.\n     */\n    EnvDetector.prototype._isValid = function (name) {\n        return name.length <= this._MAX_LENGTH && this._isPrintableString(name);\n    };\n    EnvDetector.prototype._isPrintableString = function (str) {\n        for (var i = 0; i < str.length; i++) {\n            var ch = str.charAt(i);\n            if (ch <= ' ' || ch >= '~') {\n                return false;\n            }\n        }\n        return true;\n    };\n    /**\n     * Determines whether the given String is a valid printable ASCII string with\n     * a length greater than 0 and not exceed _MAX_LENGTH characters.\n     *\n     * @param str The String to be validated.\n     * @returns Whether the String is valid and not empty.\n     */\n    EnvDetector.prototype._isValidAndNotEmpty = function (str) {\n        return str.length > 0 && this._isValid(str);\n    };\n    return EnvDetector;\n}());\nexport var envDetector = new EnvDetector();\n//# sourceMappingURL=EnvDetector.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport { diag } from '@opentelemetry/api';\nimport { SemanticResourceAttributes } from '@opentelemetry/semantic-conventions';\nimport { Resource } from '../Resource';\n/**\n * ProcessDetector will be used to detect the resources related current process running\n * and being instrumented from the NodeJS Process module.\n */\nvar ProcessDetector = /** @class */ (function () {\n    function ProcessDetector() {\n    }\n    ProcessDetector.prototype.detect = function (config) {\n        return __awaiter(this, void 0, void 0, function () {\n            var processResource;\n            var _a;\n            return __generator(this, function (_b) {\n                // Skip if not in Node.js environment.\n                if (typeof process !== 'object') {\n                    return [2 /*return*/, Resource.empty()];\n                }\n                processResource = (_a = {},\n                    _a[SemanticResourceAttributes.PROCESS_PID] = process.pid,\n                    _a[SemanticResourceAttributes.PROCESS_EXECUTABLE_NAME] = process.title || '',\n                    _a[SemanticResourceAttributes.PROCESS_COMMAND] = process.argv[1] || '',\n                    _a[SemanticResourceAttributes.PROCESS_COMMAND_LINE] = process.argv.join(' ') || '',\n                    _a[SemanticResourceAttributes.PROCESS_RUNTIME_VERSION] = process.versions.node,\n                    _a[SemanticResourceAttributes.PROCESS_RUNTIME_NAME] = 'nodejs',\n                    _a[SemanticResourceAttributes.PROCESS_RUNTIME_DESCRIPTION] = 'Node.js',\n                    _a);\n                return [2 /*return*/, this._getResourceAttributes(processResource, config)];\n            });\n        });\n    };\n    /**\n     * Validates process resource attribute map from process varaibls\n     *\n     * @param processResource The unsantized resource attributes from process as key/value pairs.\n     * @param config: Config\n     * @returns The sanitized resource attributes.\n     */\n    ProcessDetector.prototype._getResourceAttributes = function (processResource, _config) {\n        if (processResource[SemanticResourceAttributes.PROCESS_EXECUTABLE_NAME] ===\n            '' ||\n            processResource[SemanticResourceAttributes.PROCESS_EXECUTABLE_PATH] ===\n                '' ||\n            processResource[SemanticResourceAttributes.PROCESS_COMMAND] === '' ||\n            processResource[SemanticResourceAttributes.PROCESS_COMMAND_LINE] === '' ||\n            processResource[SemanticResourceAttributes.PROCESS_RUNTIME_VERSION] === '') {\n            diag.debug('ProcessDetector failed: Unable to find required process resources. ');\n            return Resource.empty();\n        }\n        else {\n            return new Resource(__assign({}, processResource));\n        }\n    };\n    return ProcessDetector;\n}());\nexport var processDetector = new ProcessDetector();\n//# sourceMappingURL=ProcessDetector.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n// DO NOT EDIT, this is an Auto-generated file from scripts/semconv/templates//templates/SemanticAttributes.ts.j2\nexport var SemanticResourceAttributes = {\n    /**\n     * Name of the cloud provider.\n     */\n    CLOUD_PROVIDER: 'cloud.provider',\n    /**\n     * The cloud account ID the resource is assigned to.\n     */\n    CLOUD_ACCOUNT_ID: 'cloud.account.id',\n    /**\n     * The geographical region the resource is running. Refer to your provider&#39;s docs to see the available regions, for example [Alibaba Cloud regions](https://www.alibabacloud.com/help/doc-detail/40654.htm), [AWS regions](https://aws.amazon.com/about-aws/global-infrastructure/regions_az/), [Azure regions](https://azure.microsoft.com/en-us/global-infrastructure/geographies/), or [Google Cloud regions](https://cloud.google.com/about/locations).\n     */\n    CLOUD_REGION: 'cloud.region',\n    /**\n     * Cloud regions often have multiple, isolated locations known as zones to increase availability. Availability zone represents the zone where the resource is running.\n     *\n     * Note: Availability zones are called &#34;zones&#34; on Alibaba Cloud and Google Cloud.\n     */\n    CLOUD_AVAILABILITY_ZONE: 'cloud.availability_zone',\n    /**\n     * The cloud platform in use.\n     *\n     * Note: The prefix of the service SHOULD match the one specified in `cloud.provider`.\n     */\n    CLOUD_PLATFORM: 'cloud.platform',\n    /**\n     * The Amazon Resource Name (ARN) of an [ECS container instance](https://docs.aws.amazon.com/AmazonECS/latest/developerguide/ECS_instances.html).\n     */\n    AWS_ECS_CONTAINER_ARN: 'aws.ecs.container.arn',\n    /**\n     * The ARN of an [ECS cluster](https://docs.aws.amazon.com/AmazonECS/latest/developerguide/clusters.html).\n     */\n    AWS_ECS_CLUSTER_ARN: 'aws.ecs.cluster.arn',\n    /**\n     * The [launch type](https://docs.aws.amazon.com/AmazonECS/latest/developerguide/launch_types.html) for an ECS task.\n     */\n    AWS_ECS_LAUNCHTYPE: 'aws.ecs.launchtype',\n    /**\n     * The ARN of an [ECS task definition](https://docs.aws.amazon.com/AmazonECS/latest/developerguide/task_definitions.html).\n     */\n    AWS_ECS_TASK_ARN: 'aws.ecs.task.arn',\n    /**\n     * The task definition family this task definition is a member of.\n     */\n    AWS_ECS_TASK_FAMILY: 'aws.ecs.task.family',\n    /**\n     * The revision for this task definition.\n     */\n    AWS_ECS_TASK_REVISION: 'aws.ecs.task.revision',\n    /**\n     * The ARN of an EKS cluster.\n     */\n    AWS_EKS_CLUSTER_ARN: 'aws.eks.cluster.arn',\n    /**\n     * The name(s) of the AWS log group(s) an application is writing to.\n     *\n     * Note: Multiple log groups must be supported for cases like multi-container applications, where a single application has sidecar containers, and each write to their own log group.\n     */\n    AWS_LOG_GROUP_NAMES: 'aws.log.group.names',\n    /**\n     * The Amazon Resource Name(s) (ARN) of the AWS log group(s).\n     *\n     * Note: See the [log group ARN format documentation](https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/iam-access-control-overview-cwl.html#CWL_ARN_Format).\n     */\n    AWS_LOG_GROUP_ARNS: 'aws.log.group.arns',\n    /**\n     * The name(s) of the AWS log stream(s) an application is writing to.\n     */\n    AWS_LOG_STREAM_NAMES: 'aws.log.stream.names',\n    /**\n     * The ARN(s) of the AWS log stream(s).\n     *\n     * Note: See the [log stream ARN format documentation](https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/iam-access-control-overview-cwl.html#CWL_ARN_Format). One log group can contain several log streams, so these ARNs necessarily identify both a log group and a log stream.\n     */\n    AWS_LOG_STREAM_ARNS: 'aws.log.stream.arns',\n    /**\n     * Container name.\n     */\n    CONTAINER_NAME: 'container.name',\n    /**\n     * Container ID. Usually a UUID, as for example used to [identify Docker containers](https://docs.docker.com/engine/reference/run/#container-identification). The UUID might be abbreviated.\n     */\n    CONTAINER_ID: 'container.id',\n    /**\n     * The container runtime managing this container.\n     */\n    CONTAINER_RUNTIME: 'container.runtime',\n    /**\n     * Name of the image the container was built on.\n     */\n    CONTAINER_IMAGE_NAME: 'container.image.name',\n    /**\n     * Container image tag.\n     */\n    CONTAINER_IMAGE_TAG: 'container.image.tag',\n    /**\n     * Name of the [deployment environment](https://en.wikipedia.org/wiki/Deployment_environment) (aka deployment tier).\n     */\n    DEPLOYMENT_ENVIRONMENT: 'deployment.environment',\n    /**\n     * A unique identifier representing the device.\n     *\n     * Note: The device identifier MUST only be defined using the values outlined below. This value is not an advertising identifier and MUST NOT be used as such. On iOS (Swift or Objective-C), this value MUST be equal to the [vendor identifier](https://developer.apple.com/documentation/uikit/uidevice/1620059-identifierforvendor). On Android (Java or Kotlin), this value MUST be equal to the Firebase Installation ID or a globally unique UUID which is persisted across sessions in your application. More information can be found [here](https://developer.android.com/training/articles/user-data-ids) on best practices and exact implementation details. Caution should be taken when storing personal data or anything which can identify a user. GDPR and data protection laws may apply, ensure you do your own due diligence.\n     */\n    DEVICE_ID: 'device.id',\n    /**\n     * The model identifier for the device.\n     *\n     * Note: It&#39;s recommended this value represents a machine readable version of the model identifier rather than the market or consumer-friendly name of the device.\n     */\n    DEVICE_MODEL_IDENTIFIER: 'device.model.identifier',\n    /**\n     * The marketing name for the device model.\n     *\n     * Note: It&#39;s recommended this value represents a human readable version of the device model rather than a machine readable alternative.\n     */\n    DEVICE_MODEL_NAME: 'device.model.name',\n    /**\n     * The name of the single function that this runtime instance executes.\n     *\n     * Note: This is the name of the function as configured/deployed on the FaaS platform and is usually different from the name of the callback function (which may be stored in the [`code.namespace`/`code.function`](../../trace/semantic_conventions/span-general.md#source-code-attributes) span attributes).\n     */\n    FAAS_NAME: 'faas.name',\n    /**\n    * The unique ID of the single function that this runtime instance executes.\n    *\n    * Note: Depending on the cloud provider, use:\n  \n  * **AWS Lambda:** The function [ARN](https://docs.aws.amazon.com/general/latest/gr/aws-arns-and-namespaces.html).\n  Take care not to use the &#34;invoked ARN&#34; directly but replace any\n  [alias suffix](https://docs.aws.amazon.com/lambda/latest/dg/configuration-aliases.html) with the resolved function version, as the same runtime instance may be invokable with multiple\n  different aliases.\n  * **GCP:** The [URI of the resource](https://cloud.google.com/iam/docs/full-resource-names)\n  * **Azure:** The [Fully Qualified Resource ID](https://docs.microsoft.com/en-us/rest/api/resources/resources/get-by-id).\n  \n  On some providers, it may not be possible to determine the full ID at startup,\n  which is why this field cannot be made required. For example, on AWS the account ID\n  part of the ARN is not available without calling another AWS API\n  which may be deemed too slow for a short-running lambda function.\n  As an alternative, consider setting `faas.id` as a span attribute instead.\n    */\n    FAAS_ID: 'faas.id',\n    /**\n    * The immutable version of the function being executed.\n    *\n    * Note: Depending on the cloud provider and platform, use:\n  \n  * **AWS Lambda:** The [function version](https://docs.aws.amazon.com/lambda/latest/dg/configuration-versions.html)\n    (an integer represented as a decimal string).\n  * **Google Cloud Run:** The [revision](https://cloud.google.com/run/docs/managing/revisions)\n    (i.e., the function name plus the revision suffix).\n  * **Google Cloud Functions:** The value of the\n    [`K_REVISION` environment variable](https://cloud.google.com/functions/docs/env-var#runtime_environment_variables_set_automatically).\n  * **Azure Functions:** Not applicable. Do not set this attribute.\n    */\n    FAAS_VERSION: 'faas.version',\n    /**\n     * The execution environment ID as a string, that will be potentially reused for other invocations to the same function/function version.\n     *\n     * Note: * **AWS Lambda:** Use the (full) log stream name.\n     */\n    FAAS_INSTANCE: 'faas.instance',\n    /**\n     * The amount of memory available to the serverless function in MiB.\n     *\n     * Note: It&#39;s recommended to set this attribute since e.g. too little memory can easily stop a Java AWS Lambda function from working correctly. On AWS Lambda, the environment variable `AWS_LAMBDA_FUNCTION_MEMORY_SIZE` provides this information.\n     */\n    FAAS_MAX_MEMORY: 'faas.max_memory',\n    /**\n     * Unique host ID. For Cloud, this must be the instance_id assigned by the cloud provider.\n     */\n    HOST_ID: 'host.id',\n    /**\n     * Name of the host. On Unix systems, it may contain what the hostname command returns, or the fully qualified hostname, or another name specified by the user.\n     */\n    HOST_NAME: 'host.name',\n    /**\n     * Type of host. For Cloud, this must be the machine type.\n     */\n    HOST_TYPE: 'host.type',\n    /**\n     * The CPU architecture the host system is running on.\n     */\n    HOST_ARCH: 'host.arch',\n    /**\n     * Name of the VM image or OS install the host was instantiated from.\n     */\n    HOST_IMAGE_NAME: 'host.image.name',\n    /**\n     * VM image ID. For Cloud, this value is from the provider.\n     */\n    HOST_IMAGE_ID: 'host.image.id',\n    /**\n     * The version string of the VM image as defined in [Version SpanAttributes](README.md#version-attributes).\n     */\n    HOST_IMAGE_VERSION: 'host.image.version',\n    /**\n     * The name of the cluster.\n     */\n    K8S_CLUSTER_NAME: 'k8s.cluster.name',\n    /**\n     * The name of the Node.\n     */\n    K8S_NODE_NAME: 'k8s.node.name',\n    /**\n     * The UID of the Node.\n     */\n    K8S_NODE_UID: 'k8s.node.uid',\n    /**\n     * The name of the namespace that the pod is running in.\n     */\n    K8S_NAMESPACE_NAME: 'k8s.namespace.name',\n    /**\n     * The UID of the Pod.\n     */\n    K8S_POD_UID: 'k8s.pod.uid',\n    /**\n     * The name of the Pod.\n     */\n    K8S_POD_NAME: 'k8s.pod.name',\n    /**\n     * The name of the Container in a Pod template.\n     */\n    K8S_CONTAINER_NAME: 'k8s.container.name',\n    /**\n     * The UID of the ReplicaSet.\n     */\n    K8S_REPLICASET_UID: 'k8s.replicaset.uid',\n    /**\n     * The name of the ReplicaSet.\n     */\n    K8S_REPLICASET_NAME: 'k8s.replicaset.name',\n    /**\n     * The UID of the Deployment.\n     */\n    K8S_DEPLOYMENT_UID: 'k8s.deployment.uid',\n    /**\n     * The name of the Deployment.\n     */\n    K8S_DEPLOYMENT_NAME: 'k8s.deployment.name',\n    /**\n     * The UID of the StatefulSet.\n     */\n    K8S_STATEFULSET_UID: 'k8s.statefulset.uid',\n    /**\n     * The name of the StatefulSet.\n     */\n    K8S_STATEFULSET_NAME: 'k8s.statefulset.name',\n    /**\n     * The UID of the DaemonSet.\n     */\n    K8S_DAEMONSET_UID: 'k8s.daemonset.uid',\n    /**\n     * The name of the DaemonSet.\n     */\n    K8S_DAEMONSET_NAME: 'k8s.daemonset.name',\n    /**\n     * The UID of the Job.\n     */\n    K8S_JOB_UID: 'k8s.job.uid',\n    /**\n     * The name of the Job.\n     */\n    K8S_JOB_NAME: 'k8s.job.name',\n    /**\n     * The UID of the CronJob.\n     */\n    K8S_CRONJOB_UID: 'k8s.cronjob.uid',\n    /**\n     * The name of the CronJob.\n     */\n    K8S_CRONJOB_NAME: 'k8s.cronjob.name',\n    /**\n     * The operating system type.\n     */\n    OS_TYPE: 'os.type',\n    /**\n     * Human readable (not intended to be parsed) OS version information, like e.g. reported by `ver` or `lsb_release -a` commands.\n     */\n    OS_DESCRIPTION: 'os.description',\n    /**\n     * Human readable operating system name.\n     */\n    OS_NAME: 'os.name',\n    /**\n     * The version string of the operating system as defined in [Version SpanAttributes](../../resource/semantic_conventions/README.md#version-attributes).\n     */\n    OS_VERSION: 'os.version',\n    /**\n     * Process identifier (PID).\n     */\n    PROCESS_PID: 'process.pid',\n    /**\n     * The name of the process executable. On Linux based systems, can be set to the `Name` in `proc/[pid]/status`. On Windows, can be set to the base name of `GetProcessImageFileNameW`.\n     */\n    PROCESS_EXECUTABLE_NAME: 'process.executable.name',\n    /**\n     * The full path to the process executable. On Linux based systems, can be set to the target of `proc/[pid]/exe`. On Windows, can be set to the result of `GetProcessImageFileNameW`.\n     */\n    PROCESS_EXECUTABLE_PATH: 'process.executable.path',\n    /**\n     * The command used to launch the process (i.e. the command name). On Linux based systems, can be set to the zeroth string in `proc/[pid]/cmdline`. On Windows, can be set to the first parameter extracted from `GetCommandLineW`.\n     */\n    PROCESS_COMMAND: 'process.command',\n    /**\n     * The full command used to launch the process as a single string representing the full command. On Windows, can be set to the result of `GetCommandLineW`. Do not set this if you have to assemble it just for monitoring; use `process.command_args` instead.\n     */\n    PROCESS_COMMAND_LINE: 'process.command_line',\n    /**\n     * All the command arguments (including the command/executable itself) as received by the process. On Linux-based systems (and some other Unixoid systems supporting procfs), can be set according to the list of null-delimited strings extracted from `proc/[pid]/cmdline`. For libc-based executables, this would be the full argv vector passed to `main`.\n     */\n    PROCESS_COMMAND_ARGS: 'process.command_args',\n    /**\n     * The username of the user that owns the process.\n     */\n    PROCESS_OWNER: 'process.owner',\n    /**\n     * The name of the runtime of this process. For compiled native binaries, this SHOULD be the name of the compiler.\n     */\n    PROCESS_RUNTIME_NAME: 'process.runtime.name',\n    /**\n     * The version of the runtime of this process, as returned by the runtime without modification.\n     */\n    PROCESS_RUNTIME_VERSION: 'process.runtime.version',\n    /**\n     * An additional description about the runtime of the process, for example a specific vendor customization of the runtime environment.\n     */\n    PROCESS_RUNTIME_DESCRIPTION: 'process.runtime.description',\n    /**\n     * Logical name of the service.\n     *\n     * Note: MUST be the same for all instances of horizontally scaled services. If the value was not specified, SDKs MUST fallback to `unknown_service:` concatenated with [`process.executable.name`](process.md#process), e.g. `unknown_service:bash`. If `process.executable.name` is not available, the value MUST be set to `unknown_service`.\n     */\n    SERVICE_NAME: 'service.name',\n    /**\n     * A namespace for `service.name`.\n     *\n     * Note: A string value having a meaning that helps to distinguish a group of services, for example the team name that owns a group of services. `service.name` is expected to be unique within the same namespace. If `service.namespace` is not specified in the Resource then `service.name` is expected to be unique for all services that have no explicit namespace defined (so the empty/unspecified namespace is simply one more valid namespace). Zero-length namespace string is assumed equal to unspecified namespace.\n     */\n    SERVICE_NAMESPACE: 'service.namespace',\n    /**\n     * The string ID of the service instance.\n     *\n     * Note: MUST be unique for each instance of the same `service.namespace,service.name` pair (in other words `service.namespace,service.name,service.instance.id` triplet MUST be globally unique). The ID helps to distinguish instances of the same service that exist at the same time (e.g. instances of a horizontally scaled service). It is preferable for the ID to be persistent and stay the same for the lifetime of the service instance, however it is acceptable that the ID is ephemeral and changes during important lifetime events for the service (e.g. service restarts). If the service has no inherent unique ID that can be used as the value of this attribute it is recommended to generate a random Version 1 or Version 4 RFC 4122 UUID (services aiming for reproducible UUIDs may also use Version 5, see RFC 4122 for more recommendations).\n     */\n    SERVICE_INSTANCE_ID: 'service.instance.id',\n    /**\n     * The version string of the service API or implementation.\n     */\n    SERVICE_VERSION: 'service.version',\n    /**\n     * The name of the telemetry SDK as defined above.\n     */\n    TELEMETRY_SDK_NAME: 'telemetry.sdk.name',\n    /**\n     * The language of the telemetry SDK.\n     */\n    TELEMETRY_SDK_LANGUAGE: 'telemetry.sdk.language',\n    /**\n     * The version string of the telemetry SDK.\n     */\n    TELEMETRY_SDK_VERSION: 'telemetry.sdk.version',\n    /**\n     * The version string of the auto instrumentation agent, if used.\n     */\n    TELEMETRY_AUTO_VERSION: 'telemetry.auto.version',\n    /**\n     * The name of the web engine.\n     */\n    WEBENGINE_NAME: 'webengine.name',\n    /**\n     * The version of the web engine.\n     */\n    WEBENGINE_VERSION: 'webengine.version',\n    /**\n     * Additional description of the web engine (e.g. detailed version and edition information).\n     */\n    WEBENGINE_DESCRIPTION: 'webengine.description',\n};\nexport var CloudProviderValues = {\n    /** Alibaba Cloud. */\n    ALIBABA_CLOUD: 'alibaba_cloud',\n    /** Amazon Web Services. */\n    AWS: 'aws',\n    /** Microsoft Azure. */\n    AZURE: 'azure',\n    /** Google Cloud Platform. */\n    GCP: 'gcp',\n};\nexport var CloudPlatformValues = {\n    /** Alibaba Cloud Elastic Compute Service. */\n    ALIBABA_CLOUD_ECS: 'alibaba_cloud_ecs',\n    /** Alibaba Cloud Function Compute. */\n    ALIBABA_CLOUD_FC: 'alibaba_cloud_fc',\n    /** AWS Elastic Compute Cloud. */\n    AWS_EC2: 'aws_ec2',\n    /** AWS Elastic Container Service. */\n    AWS_ECS: 'aws_ecs',\n    /** AWS Elastic Kubernetes Service. */\n    AWS_EKS: 'aws_eks',\n    /** AWS Lambda. */\n    AWS_LAMBDA: 'aws_lambda',\n    /** AWS Elastic Beanstalk. */\n    AWS_ELASTIC_BEANSTALK: 'aws_elastic_beanstalk',\n    /** Azure Virtual Machines. */\n    AZURE_VM: 'azure_vm',\n    /** Azure Container Instances. */\n    AZURE_CONTAINER_INSTANCES: 'azure_container_instances',\n    /** Azure Kubernetes Service. */\n    AZURE_AKS: 'azure_aks',\n    /** Azure Functions. */\n    AZURE_FUNCTIONS: 'azure_functions',\n    /** Azure App Service. */\n    AZURE_APP_SERVICE: 'azure_app_service',\n    /** Google Cloud Compute Engine (GCE). */\n    GCP_COMPUTE_ENGINE: 'gcp_compute_engine',\n    /** Google Cloud Run. */\n    GCP_CLOUD_RUN: 'gcp_cloud_run',\n    /** Google Cloud Kubernetes Engine (GKE). */\n    GCP_KUBERNETES_ENGINE: 'gcp_kubernetes_engine',\n    /** Google Cloud Functions (GCF). */\n    GCP_CLOUD_FUNCTIONS: 'gcp_cloud_functions',\n    /** Google Cloud App Engine (GAE). */\n    GCP_APP_ENGINE: 'gcp_app_engine',\n};\nexport var AwsEcsLaunchtypeValues = {\n    /** ec2. */\n    EC2: 'ec2',\n    /** fargate. */\n    FARGATE: 'fargate',\n};\nexport var HostArchValues = {\n    /** AMD64. */\n    AMD64: 'amd64',\n    /** ARM32. */\n    ARM32: 'arm32',\n    /** ARM64. */\n    ARM64: 'arm64',\n    /** Itanium. */\n    IA64: 'ia64',\n    /** 32-bit PowerPC. */\n    PPC32: 'ppc32',\n    /** 64-bit PowerPC. */\n    PPC64: 'ppc64',\n    /** 32-bit x86. */\n    X86: 'x86',\n};\nexport var OsTypeValues = {\n    /** Microsoft Windows. */\n    WINDOWS: 'windows',\n    /** Linux. */\n    LINUX: 'linux',\n    /** Apple Darwin. */\n    DARWIN: 'darwin',\n    /** FreeBSD. */\n    FREEBSD: 'freebsd',\n    /** NetBSD. */\n    NETBSD: 'netbsd',\n    /** OpenBSD. */\n    OPENBSD: 'openbsd',\n    /** DragonFly BSD. */\n    DRAGONFLYBSD: 'dragonflybsd',\n    /** HP-UX (Hewlett Packard Unix). */\n    HPUX: 'hpux',\n    /** AIX (Advanced Interactive eXecutive). */\n    AIX: 'aix',\n    /** Oracle Solaris. */\n    SOLARIS: 'solaris',\n    /** IBM z/OS. */\n    Z_OS: 'z_os',\n};\nexport var TelemetrySdkLanguageValues = {\n    /** cpp. */\n    CPP: 'cpp',\n    /** dotnet. */\n    DOTNET: 'dotnet',\n    /** erlang. */\n    ERLANG: 'erlang',\n    /** go. */\n    GO: 'go',\n    /** java. */\n    JAVA: 'java',\n    /** nodejs. */\n    NODEJS: 'nodejs',\n    /** php. */\n    PHP: 'php',\n    /** python. */\n    PYTHON: 'python',\n    /** ruby. */\n    RUBY: 'ruby',\n    /** webjs. */\n    WEBJS: 'webjs',\n};\n//# sourceMappingURL=SemanticResourceAttributes.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n// Updates to this file should also be replicated to @opentelemetry/api too.\n/**\n * - globalThis (New standard)\n * - self (Will return the current window instance for supported browsers)\n * - window (fallback for older browser implementations)\n * - global (NodeJS implementation)\n * - <object> (When all else fails)\n */\n/** only globals that common to node and browsers are allowed */\n// eslint-disable-next-line node/no-unsupported-features/es-builtins, no-undef\nexport var _globalThis = typeof globalThis === 'object'\n    ? globalThis\n    : typeof self === 'object'\n        ? self\n        : typeof window === 'object'\n            ? window\n            : typeof global === 'object'\n                ? global\n                : {};\n//# sourceMappingURL=globalThis.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { DiagLogLevel } from '@opentelemetry/api';\nimport { TracesSamplerValues } from './sampling';\nimport { _globalThis } from '../platform/browser/globalThis';\nvar DEFAULT_LIST_SEPARATOR = ',';\n/**\n * Environment interface to define all names\n */\nvar ENVIRONMENT_BOOLEAN_KEYS = ['OTEL_SDK_DISABLED'];\nfunction isEnvVarABoolean(key) {\n    return (ENVIRONMENT_BOOLEAN_KEYS.indexOf(key) > -1);\n}\nvar ENVIRONMENT_NUMBERS_KEYS = [\n    'OTEL_BSP_EXPORT_TIMEOUT',\n    'OTEL_BSP_MAX_EXPORT_BATCH_SIZE',\n    'OTEL_BSP_MAX_QUEUE_SIZE',\n    'OTEL_BSP_SCHEDULE_DELAY',\n    'OTEL_BLRP_EXPORT_TIMEOUT',\n    'OTEL_BLRP_MAX_EXPORT_BATCH_SIZE',\n    'OTEL_BLRP_MAX_QUEUE_SIZE',\n    'OTEL_BLRP_SCHEDULE_DELAY',\n    'OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT',\n    'OTEL_ATTRIBUTE_COUNT_LIMIT',\n    'OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT',\n    'OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT',\n    'OTEL_LOGRECORD_ATTRIBUTE_VALUE_LENGTH_LIMIT',\n    'OTEL_LOGRECORD_ATTRIBUTE_COUNT_LIMIT',\n    'OTEL_SPAN_EVENT_COUNT_LIMIT',\n    'OTEL_SPAN_LINK_COUNT_LIMIT',\n    'OTEL_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT',\n    'OTEL_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT',\n    'OTEL_EXPORTER_OTLP_TIMEOUT',\n    'OTEL_EXPORTER_OTLP_TRACES_TIMEOUT',\n    'OTEL_EXPORTER_OTLP_METRICS_TIMEOUT',\n    'OTEL_EXPORTER_OTLP_LOGS_TIMEOUT',\n    'OTEL_EXPORTER_JAEGER_AGENT_PORT',\n];\nfunction isEnvVarANumber(key) {\n    return (ENVIRONMENT_NUMBERS_KEYS.indexOf(key) > -1);\n}\nvar ENVIRONMENT_LISTS_KEYS = [\n    'OTEL_NO_PATCH_MODULES',\n    'OTEL_PROPAGATORS',\n];\nfunction isEnvVarAList(key) {\n    return ENVIRONMENT_LISTS_KEYS.indexOf(key) > -1;\n}\nexport var DEFAULT_ATTRIBUTE_VALUE_LENGTH_LIMIT = Infinity;\nexport var DEFAULT_ATTRIBUTE_COUNT_LIMIT = 128;\nexport var DEFAULT_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT = 128;\nexport var DEFAULT_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT = 128;\n/**\n * Default environment variables\n */\nexport var DEFAULT_ENVIRONMENT = {\n    OTEL_SDK_DISABLED: false,\n    CONTAINER_NAME: '',\n    ECS_CONTAINER_METADATA_URI_V4: '',\n    ECS_CONTAINER_METADATA_URI: '',\n    HOSTNAME: '',\n    KUBERNETES_SERVICE_HOST: '',\n    NAMESPACE: '',\n    OTEL_BSP_EXPORT_TIMEOUT: 30000,\n    OTEL_BSP_MAX_EXPORT_BATCH_SIZE: 512,\n    OTEL_BSP_MAX_QUEUE_SIZE: 2048,\n    OTEL_BSP_SCHEDULE_DELAY: 5000,\n    OTEL_BLRP_EXPORT_TIMEOUT: 30000,\n    OTEL_BLRP_MAX_EXPORT_BATCH_SIZE: 512,\n    OTEL_BLRP_MAX_QUEUE_SIZE: 2048,\n    OTEL_BLRP_SCHEDULE_DELAY: 5000,\n    OTEL_EXPORTER_JAEGER_AGENT_HOST: '',\n    OTEL_EXPORTER_JAEGER_AGENT_PORT: 6832,\n    OTEL_EXPORTER_JAEGER_ENDPOINT: '',\n    OTEL_EXPORTER_JAEGER_PASSWORD: '',\n    OTEL_EXPORTER_JAEGER_USER: '',\n    OTEL_EXPORTER_OTLP_ENDPOINT: '',\n    OTEL_EXPORTER_OTLP_TRACES_ENDPOINT: '',\n    OTEL_EXPORTER_OTLP_METRICS_ENDPOINT: '',\n    OTEL_EXPORTER_OTLP_LOGS_ENDPOINT: '',\n    OTEL_EXPORTER_OTLP_HEADERS: '',\n    OTEL_EXPORTER_OTLP_TRACES_HEADERS: '',\n    OTEL_EXPORTER_OTLP_METRICS_HEADERS: '',\n    OTEL_EXPORTER_OTLP_LOGS_HEADERS: '',\n    OTEL_EXPORTER_OTLP_TIMEOUT: 10000,\n    OTEL_EXPORTER_OTLP_TRACES_TIMEOUT: 10000,\n    OTEL_EXPORTER_OTLP_METRICS_TIMEOUT: 10000,\n    OTEL_EXPORTER_OTLP_LOGS_TIMEOUT: 10000,\n    OTEL_EXPORTER_ZIPKIN_ENDPOINT: 'http://localhost:9411/api/v2/spans',\n    OTEL_LOG_LEVEL: DiagLogLevel.INFO,\n    OTEL_NO_PATCH_MODULES: [],\n    OTEL_PROPAGATORS: ['tracecontext', 'baggage'],\n    OTEL_RESOURCE_ATTRIBUTES: '',\n    OTEL_SERVICE_NAME: '',\n    OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT: DEFAULT_ATTRIBUTE_VALUE_LENGTH_LIMIT,\n    OTEL_ATTRIBUTE_COUNT_LIMIT: DEFAULT_ATTRIBUTE_COUNT_LIMIT,\n    OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT: DEFAULT_ATTRIBUTE_VALUE_LENGTH_LIMIT,\n    OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT: DEFAULT_ATTRIBUTE_COUNT_LIMIT,\n    OTEL_LOGRECORD_ATTRIBUTE_VALUE_LENGTH_LIMIT: DEFAULT_ATTRIBUTE_VALUE_LENGTH_LIMIT,\n    OTEL_LOGRECORD_ATTRIBUTE_COUNT_LIMIT: DEFAULT_ATTRIBUTE_COUNT_LIMIT,\n    OTEL_SPAN_EVENT_COUNT_LIMIT: 128,\n    OTEL_SPAN_LINK_COUNT_LIMIT: 128,\n    OTEL_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT: DEFAULT_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT,\n    OTEL_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT: DEFAULT_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT,\n    OTEL_TRACES_EXPORTER: '',\n    OTEL_TRACES_SAMPLER: TracesSamplerValues.ParentBasedAlwaysOn,\n    OTEL_TRACES_SAMPLER_ARG: '',\n    OTEL_LOGS_EXPORTER: '',\n    OTEL_EXPORTER_OTLP_INSECURE: '',\n    OTEL_EXPORTER_OTLP_TRACES_INSECURE: '',\n    OTEL_EXPORTER_OTLP_METRICS_INSECURE: '',\n    OTEL_EXPORTER_OTLP_LOGS_INSECURE: '',\n    OTEL_EXPORTER_OTLP_CERTIFICATE: '',\n    OTEL_EXPORTER_OTLP_TRACES_CERTIFICATE: '',\n    OTEL_EXPORTER_OTLP_METRICS_CERTIFICATE: '',\n    OTEL_EXPORTER_OTLP_LOGS_CERTIFICATE: '',\n    OTEL_EXPORTER_OTLP_COMPRESSION: '',\n    OTEL_EXPORTER_OTLP_TRACES_COMPRESSION: '',\n    OTEL_EXPORTER_OTLP_METRICS_COMPRESSION: '',\n    OTEL_EXPORTER_OTLP_LOGS_COMPRESSION: '',\n    OTEL_EXPORTER_OTLP_CLIENT_KEY: '',\n    OTEL_EXPORTER_OTLP_TRACES_CLIENT_KEY: '',\n    OTEL_EXPORTER_OTLP_METRICS_CLIENT_KEY: '',\n    OTEL_EXPORTER_OTLP_LOGS_CLIENT_KEY: '',\n    OTEL_EXPORTER_OTLP_CLIENT_CERTIFICATE: '',\n    OTEL_EXPORTER_OTLP_TRACES_CLIENT_CERTIFICATE: '',\n    OTEL_EXPORTER_OTLP_METRICS_CLIENT_CERTIFICATE: '',\n    OTEL_EXPORTER_OTLP_LOGS_CLIENT_CERTIFICATE: '',\n    OTEL_EXPORTER_OTLP_PROTOCOL: 'http/protobuf',\n    OTEL_EXPORTER_OTLP_TRACES_PROTOCOL: 'http/protobuf',\n    OTEL_EXPORTER_OTLP_METRICS_PROTOCOL: 'http/protobuf',\n    OTEL_EXPORTER_OTLP_LOGS_PROTOCOL: 'http/protobuf',\n    OTEL_EXPORTER_OTLP_METRICS_TEMPORALITY_PREFERENCE: 'cumulative',\n};\n/**\n * @param key\n * @param environment\n * @param values\n */\nfunction parseBoolean(key, environment, values) {\n    if (typeof values[key] === 'undefined') {\n        return;\n    }\n    var value = String(values[key]);\n    // support case-insensitive \"true\"\n    environment[key] = value.toLowerCase() === 'true';\n}\n/**\n * Parses a variable as number with number validation\n * @param name\n * @param environment\n * @param values\n * @param min\n * @param max\n */\nfunction parseNumber(name, environment, values, min, max) {\n    if (min === void 0) { min = -Infinity; }\n    if (max === void 0) { max = Infinity; }\n    if (typeof values[name] !== 'undefined') {\n        var value = Number(values[name]);\n        if (!isNaN(value)) {\n            if (value < min) {\n                environment[name] = min;\n            }\n            else if (value > max) {\n                environment[name] = max;\n            }\n            else {\n                environment[name] = value;\n            }\n        }\n    }\n}\n/**\n * Parses list-like strings from input into output.\n * @param name\n * @param environment\n * @param values\n * @param separator\n */\nfunction parseStringList(name, output, input, separator) {\n    if (separator === void 0) { separator = DEFAULT_LIST_SEPARATOR; }\n    var givenValue = input[name];\n    if (typeof givenValue === 'string') {\n        output[name] = givenValue.split(separator).map(function (v) { return v.trim(); });\n    }\n}\n// The support string -> DiagLogLevel mappings\nvar logLevelMap = {\n    ALL: DiagLogLevel.ALL,\n    VERBOSE: DiagLogLevel.VERBOSE,\n    DEBUG: DiagLogLevel.DEBUG,\n    INFO: DiagLogLevel.INFO,\n    WARN: DiagLogLevel.WARN,\n    ERROR: DiagLogLevel.ERROR,\n    NONE: DiagLogLevel.NONE,\n};\n/**\n * Environmentally sets log level if valid log level string is provided\n * @param key\n * @param environment\n * @param values\n */\nfunction setLogLevelFromEnv(key, environment, values) {\n    var value = values[key];\n    if (typeof value === 'string') {\n        var theLevel = logLevelMap[value.toUpperCase()];\n        if (theLevel != null) {\n            environment[key] = theLevel;\n        }\n    }\n}\n/**\n * Parses environment values\n * @param values\n */\nexport function parseEnvironment(values) {\n    var environment = {};\n    for (var env in DEFAULT_ENVIRONMENT) {\n        var key = env;\n        switch (key) {\n            case 'OTEL_LOG_LEVEL':\n                setLogLevelFromEnv(key, environment, values);\n                break;\n            default:\n                if (isEnvVarABoolean(key)) {\n                    parseBoolean(key, environment, values);\n                }\n                else if (isEnvVarANumber(key)) {\n                    parseNumber(key, environment, values);\n                }\n                else if (isEnvVarAList(key)) {\n                    parseStringList(key, environment, values);\n                }\n                else {\n                    var value = values[key];\n                    if (typeof value !== 'undefined' && value !== null) {\n                        environment[key] = String(value);\n                    }\n                }\n        }\n    }\n    return environment;\n}\n/**\n * Get environment in node or browser without\n * populating default values.\n */\nexport function getEnvWithoutDefaults() {\n    return typeof process !== 'undefined' && process && process.env\n        ? parseEnvironment(process.env)\n        : parseEnvironment(_globalThis);\n}\n//# sourceMappingURL=environment.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { DEFAULT_ENVIRONMENT, parseEnvironment, } from '../../utils/environment';\nimport { _globalThis } from './globalThis';\n/**\n * Gets the environment variables\n */\nexport function getEnv() {\n    var globalEnv = parseEnvironment(_globalThis);\n    return Object.assign({}, DEFAULT_ENVIRONMENT, globalEnv);\n}\n//# sourceMappingURL=environment.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar Deferred = /** @class */ (function () {\n    function Deferred() {\n        var _this = this;\n        this._promise = new Promise(function (resolve, reject) {\n            _this._resolve = resolve;\n            _this._reject = reject;\n        });\n    }\n    Object.defineProperty(Deferred.prototype, \"promise\", {\n        get: function () {\n            return this._promise;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Deferred.prototype.resolve = function (val) {\n        this._resolve(val);\n    };\n    Deferred.prototype.reject = function (err) {\n        this._reject(err);\n    };\n    return Deferred;\n}());\nexport { Deferred };\n//# sourceMappingURL=promise.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nexport var ExportResultCode;\n(function (ExportResultCode) {\n    ExportResultCode[ExportResultCode[\"SUCCESS\"] = 0] = \"SUCCESS\";\n    ExportResultCode[ExportResultCode[\"FAILED\"] = 1] = \"FAILED\";\n})(ExportResultCode || (ExportResultCode = {}));\n//# sourceMappingURL=ExportResult.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport { Deferred } from './promise';\n/**\n * Bind the callback and only invoke the callback once regardless how many times `BindOnceFuture.call` is invoked.\n */\nvar BindOnceFuture = /** @class */ (function () {\n    function BindOnceFuture(_callback, _that) {\n        this._callback = _callback;\n        this._that = _that;\n        this._isCalled = false;\n        this._deferred = new Deferred();\n    }\n    Object.defineProperty(BindOnceFuture.prototype, \"isCalled\", {\n        get: function () {\n            return this._isCalled;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(BindOnceFuture.prototype, \"promise\", {\n        get: function () {\n            return this._deferred.promise;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    BindOnceFuture.prototype.call = function () {\n        var _a;\n        var _this = this;\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (!this._isCalled) {\n            this._isCalled = true;\n            try {\n                Promise.resolve((_a = this._callback).call.apply(_a, __spreadArray([this._that], __read(args), false))).then(function (val) { return _this._deferred.resolve(val); }, function (err) { return _this._deferred.reject(err); });\n            }\n            catch (err) {\n                this._deferred.reject(err);\n            }\n        }\n        return this._deferred.promise;\n    };\n    return BindOnceFuture;\n}());\nexport { BindOnceFuture };\n//# sourceMappingURL=callback.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { createContextKey } from '@opentelemetry/api';\nvar SUPPRESS_TRACING_KEY = createContextKey('OpenTelemetry SDK Context Key SUPPRESS_TRACING');\nexport function suppressTracing(context) {\n    return context.setValue(SUPPRESS_TRACING_KEY, true);\n}\nexport function unsuppressTracing(context) {\n    return context.deleteValue(SUPPRESS_TRACING_KEY);\n}\nexport function isTracingSuppressed(context) {\n    return context.getValue(SUPPRESS_TRACING_KEY) === true;\n}\n//# sourceMappingURL=suppress-tracing.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { loggingErrorHandler } from './logging-error-handler';\n/** The global error handler delegate */\nvar delegateHandler = loggingErrorHandler();\n/**\n * Set the global error handler\n * @param {ErrorHandler} handler\n */\nexport function setGlobalErrorHandler(handler) {\n    delegateHandler = handler;\n}\n/**\n * Return the global error handler\n * @param {Exception} ex\n */\nexport function globalErrorHandler(ex) {\n    try {\n        delegateHandler(ex);\n    }\n    catch (_a) { } // eslint-disable-line no-empty\n}\n//# sourceMappingURL=global-error-handler.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { diag } from '@opentelemetry/api';\n/**\n * Returns a function that logs an error using the provided logger, or a\n * console logger if one was not provided.\n */\nexport function loggingErrorHandler() {\n    return function (ex) {\n        diag.error(stringifyException(ex));\n    };\n}\n/**\n * Converts an exception into a string representation\n * @param {Exception} ex\n */\nfunction stringifyException(ex) {\n    if (typeof ex === 'string') {\n        return ex;\n    }\n    else {\n        return JSON.stringify(flattenException(ex));\n    }\n}\n/**\n * Flattens an exception into key-value pairs by traversing the prototype chain\n * and coercing values to strings. Duplicate properties will not be overwritten;\n * the first insert wins.\n */\nfunction flattenException(ex) {\n    var result = {};\n    var current = ex;\n    while (current !== null) {\n        Object.getOwnPropertyNames(current).forEach(function (propertyName) {\n            if (result[propertyName])\n                return;\n            var value = current[propertyName];\n            if (value) {\n                result[propertyName] = String(value);\n            }\n        });\n        current = Object.getPrototypeOf(current);\n    }\n    return result;\n}\n//# sourceMappingURL=logging-error-handler.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { context, diag, TraceFlags } from '@opentelemetry/api';\nimport { BindOnceFuture, ExportResultCode, getEnv, globalErrorHandler, suppressTracing, unrefTimer, } from '@opentelemetry/core';\n/**\n * Implementation of the {@link SpanProcessor} that batches spans exported by\n * the SDK then pushes them to the exporter pipeline.\n */\nvar BatchSpanProcessorBase = /** @class */ (function () {\n    function BatchSpanProcessorBase(_exporter, config) {\n        this._exporter = _exporter;\n        this._finishedSpans = [];\n        this._droppedSpansCount = 0;\n        var env = getEnv();\n        this._maxExportBatchSize =\n            typeof (config === null || config === void 0 ? void 0 : config.maxExportBatchSize) === 'number'\n                ? config.maxExportBatchSize\n                : env.OTEL_BSP_MAX_EXPORT_BATCH_SIZE;\n        this._maxQueueSize =\n            typeof (config === null || config === void 0 ? void 0 : config.maxQueueSize) === 'number'\n                ? config.maxQueueSize\n                : env.OTEL_BSP_MAX_QUEUE_SIZE;\n        this._scheduledDelayMillis =\n            typeof (config === null || config === void 0 ? void 0 : config.scheduledDelayMillis) === 'number'\n                ? config.scheduledDelayMillis\n                : env.OTEL_BSP_SCHEDULE_DELAY;\n        this._exportTimeoutMillis =\n            typeof (config === null || config === void 0 ? void 0 : config.exportTimeoutMillis) === 'number'\n                ? config.exportTimeoutMillis\n                : env.OTEL_BSP_EXPORT_TIMEOUT;\n        this._shutdownOnce = new BindOnceFuture(this._shutdown, this);\n        if (this._maxExportBatchSize > this._maxQueueSize) {\n            diag.warn('BatchSpanProcessor: maxExportBatchSize must be smaller or equal to maxQueueSize, setting maxExportBatchSize to match maxQueueSize');\n            this._maxExportBatchSize = this._maxQueueSize;\n        }\n    }\n    BatchSpanProcessorBase.prototype.forceFlush = function () {\n        if (this._shutdownOnce.isCalled) {\n            return this._shutdownOnce.promise;\n        }\n        return this._flushAll();\n    };\n    // does nothing.\n    BatchSpanProcessorBase.prototype.onStart = function (_span, _parentContext) { };\n    BatchSpanProcessorBase.prototype.onEnd = function (span) {\n        if (this._shutdownOnce.isCalled) {\n            return;\n        }\n        if ((span.spanContext().traceFlags & TraceFlags.SAMPLED) === 0) {\n            return;\n        }\n        this._addToBuffer(span);\n    };\n    BatchSpanProcessorBase.prototype.shutdown = function () {\n        return this._shutdownOnce.call();\n    };\n    BatchSpanProcessorBase.prototype._shutdown = function () {\n        var _this = this;\n        return Promise.resolve()\n            .then(function () {\n            return _this.onShutdown();\n        })\n            .then(function () {\n            return _this._flushAll();\n        })\n            .then(function () {\n            return _this._exporter.shutdown();\n        });\n    };\n    /** Add a span in the buffer. */\n    BatchSpanProcessorBase.prototype._addToBuffer = function (span) {\n        if (this._finishedSpans.length >= this._maxQueueSize) {\n            // limit reached, drop span\n            if (this._droppedSpansCount === 0) {\n                diag.debug('maxQueueSize reached, dropping spans');\n            }\n            this._droppedSpansCount++;\n            return;\n        }\n        if (this._droppedSpansCount > 0) {\n            // some spans were dropped, log once with count of spans dropped\n            diag.warn(\"Dropped \" + this._droppedSpansCount + \" spans because maxQueueSize reached\");\n            this._droppedSpansCount = 0;\n        }\n        this._finishedSpans.push(span);\n        this._maybeStartTimer();\n    };\n    /**\n     * Send all spans to the exporter respecting the batch size limit\n     * This function is used only on forceFlush or shutdown,\n     * for all other cases _flush should be used\n     * */\n    BatchSpanProcessorBase.prototype._flushAll = function () {\n        var _this = this;\n        return new Promise(function (resolve, reject) {\n            var promises = [];\n            // calculate number of batches\n            var count = Math.ceil(_this._finishedSpans.length / _this._maxExportBatchSize);\n            for (var i = 0, j = count; i < j; i++) {\n                promises.push(_this._flushOneBatch());\n            }\n            Promise.all(promises)\n                .then(function () {\n                resolve();\n            })\n                .catch(reject);\n        });\n    };\n    BatchSpanProcessorBase.prototype._flushOneBatch = function () {\n        var _this = this;\n        this._clearTimer();\n        if (this._finishedSpans.length === 0) {\n            return Promise.resolve();\n        }\n        return new Promise(function (resolve, reject) {\n            var timer = setTimeout(function () {\n                // don't wait anymore for export, this way the next batch can start\n                reject(new Error('Timeout'));\n            }, _this._exportTimeoutMillis);\n            // prevent downstream exporter calls from generating spans\n            context.with(suppressTracing(context.active()), function () {\n                // Reset the finished spans buffer here because the next invocations of the _flush method\n                // could pass the same finished spans to the exporter if the buffer is cleared\n                // outside the execution of this callback.\n                var spans = _this._finishedSpans.splice(0, _this._maxExportBatchSize);\n                var doExport = function () {\n                    return _this._exporter.export(spans, function (result) {\n                        var _a;\n                        clearTimeout(timer);\n                        if (result.code === ExportResultCode.SUCCESS) {\n                            resolve();\n                        }\n                        else {\n                            reject((_a = result.error) !== null && _a !== void 0 ? _a : new Error('BatchSpanProcessor: span export failed'));\n                        }\n                    });\n                };\n                var pendingResources = spans\n                    .map(function (span) { return span.resource; })\n                    .filter(function (resource) { return resource.asyncAttributesPending; });\n                // Avoid scheduling a promise to make the behavior more predictable and easier to test\n                if (pendingResources.length === 0) {\n                    doExport();\n                }\n                else {\n                    Promise.all(pendingResources.map(function (resource) { var _a; return (_a = resource.waitForAsyncAttributes) === null || _a === void 0 ? void 0 : _a.call(resource); })).then(doExport, function (err) {\n                        globalErrorHandler(err);\n                        reject(err);\n                    });\n                }\n            });\n        });\n    };\n    BatchSpanProcessorBase.prototype._maybeStartTimer = function () {\n        var _this = this;\n        if (this._timer !== undefined)\n            return;\n        this._timer = setTimeout(function () {\n            _this._flushOneBatch()\n                .then(function () {\n                if (_this._finishedSpans.length > 0) {\n                    _this._clearTimer();\n                    _this._maybeStartTimer();\n                }\n            })\n                .catch(function (e) {\n                globalErrorHandler(e);\n            });\n        }, this._scheduledDelayMillis);\n        unrefTimer(this._timer);\n    };\n    BatchSpanProcessorBase.prototype._clearTimer = function () {\n        if (this._timer !== undefined) {\n            clearTimeout(this._timer);\n            this._timer = undefined;\n        }\n    };\n    return BatchSpanProcessorBase;\n}());\nexport { BatchSpanProcessorBase };\n//# sourceMappingURL=BatchSpanProcessorBase.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { BatchSpanProcessorBase } from '../../../export/BatchSpanProcessorBase';\nvar BatchSpanProcessor = /** @class */ (function (_super) {\n    __extends(BatchSpanProcessor, _super);\n    function BatchSpanProcessor(_exporter, config) {\n        var _this = _super.call(this, _exporter, config) || this;\n        _this.onInit(config);\n        return _this;\n    }\n    BatchSpanProcessor.prototype.onInit = function (config) {\n        var _this = this;\n        if ((config === null || config === void 0 ? void 0 : config.disableAutoFlushOnDocumentHide) !== true &&\n            typeof document !== 'undefined') {\n            this._visibilityChangeListener = function () {\n                if (document.visibilityState === 'hidden') {\n                    void _this.forceFlush();\n                }\n            };\n            this._pageHideListener = function () {\n                void _this.forceFlush();\n            };\n            document.addEventListener('visibilitychange', this._visibilityChangeListener);\n            // use 'pagehide' event as a fallback for Safari; see https://bugs.webkit.org/show_bug.cgi?id=116769\n            document.addEventListener('pagehide', this._pageHideListener);\n        }\n    };\n    BatchSpanProcessor.prototype.onShutdown = function () {\n        if (typeof document !== 'undefined') {\n            if (this._visibilityChangeListener) {\n                document.removeEventListener('visibilitychange', this._visibilityChangeListener);\n            }\n            if (this._pageHideListener) {\n                document.removeEventListener('pagehide', this._pageHideListener);\n            }\n        }\n    };\n    return BatchSpanProcessor;\n}(BatchSpanProcessorBase));\nexport { BatchSpanProcessor };\n//# sourceMappingURL=BatchSpanProcessor.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/**\n * based on lodash in order to support esm builds without esModuleInterop.\n * lodash is using MIT License.\n **/\nvar objectTag = '[object Object]';\nvar nullTag = '[object Null]';\nvar undefinedTag = '[object Undefined]';\nvar funcProto = Function.prototype;\nvar funcToString = funcProto.toString;\nvar objectCtorString = funcToString.call(Object);\nvar getPrototype = overArg(Object.getPrototypeOf, Object);\nvar objectProto = Object.prototype;\nvar hasOwnProperty = objectProto.hasOwnProperty;\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\nvar nativeObjectToString = objectProto.toString;\n/**\n * Creates a unary function that invokes `func` with its argument transformed.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} transform The argument transform.\n * @returns {Function} Returns the new function.\n */\nfunction overArg(func, transform) {\n    return function (arg) {\n        return func(transform(arg));\n    };\n}\n/**\n * Checks if `value` is a plain object, that is, an object created by the\n * `Object` constructor or one with a `[[Prototype]]` of `null`.\n *\n * @static\n * @memberOf _\n * @since 0.8.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a plain object, else `false`.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n * }\n *\n * _.isPlainObject(new Foo);\n * // => false\n *\n * _.isPlainObject([1, 2, 3]);\n * // => false\n *\n * _.isPlainObject({ 'x': 0, 'y': 0 });\n * // => true\n *\n * _.isPlainObject(Object.create(null));\n * // => true\n */\nexport function isPlainObject(value) {\n    if (!isObjectLike(value) || baseGetTag(value) !== objectTag) {\n        return false;\n    }\n    var proto = getPrototype(value);\n    if (proto === null) {\n        return true;\n    }\n    var Ctor = hasOwnProperty.call(proto, 'constructor') && proto.constructor;\n    return (typeof Ctor == 'function' &&\n        Ctor instanceof Ctor &&\n        funcToString.call(Ctor) === objectCtorString);\n}\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n    return value != null && typeof value == 'object';\n}\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n    if (value == null) {\n        return value === undefined ? undefinedTag : nullTag;\n    }\n    return symToStringTag && symToStringTag in Object(value)\n        ? getRawTag(value)\n        : objectToString(value);\n}\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n    var isOwn = hasOwnProperty.call(value, symToStringTag), tag = value[symToStringTag];\n    var unmasked = false;\n    try {\n        value[symToStringTag] = undefined;\n        unmasked = true;\n    }\n    catch (e) {\n        // silence\n    }\n    var result = nativeObjectToString.call(value);\n    if (unmasked) {\n        if (isOwn) {\n            value[symToStringTag] = tag;\n        }\n        else {\n            delete value[symToStringTag];\n        }\n    }\n    return result;\n}\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n    return nativeObjectToString.call(value);\n}\n//# sourceMappingURL=lodash.merge.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { isPlainObject } from './lodash.merge';\nvar MAX_LEVEL = 20;\n/**\n * Merges objects together\n * @param args - objects / values to be merged\n */\nexport function merge() {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n    }\n    var result = args.shift();\n    var objects = new WeakMap();\n    while (args.length > 0) {\n        result = mergeTwoObjects(result, args.shift(), 0, objects);\n    }\n    return result;\n}\nfunction takeValue(value) {\n    if (isArray(value)) {\n        return value.slice();\n    }\n    return value;\n}\n/**\n * Merges two objects\n * @param one - first object\n * @param two - second object\n * @param level - current deep level\n * @param objects - objects holder that has been already referenced - to prevent\n * cyclic dependency\n */\nfunction mergeTwoObjects(one, two, level, objects) {\n    if (level === void 0) { level = 0; }\n    var result;\n    if (level > MAX_LEVEL) {\n        return undefined;\n    }\n    level++;\n    if (isPrimitive(one) || isPrimitive(two) || isFunction(two)) {\n        result = takeValue(two);\n    }\n    else if (isArray(one)) {\n        result = one.slice();\n        if (isArray(two)) {\n            for (var i = 0, j = two.length; i < j; i++) {\n                result.push(takeValue(two[i]));\n            }\n        }\n        else if (isObject(two)) {\n            var keys = Object.keys(two);\n            for (var i = 0, j = keys.length; i < j; i++) {\n                var key = keys[i];\n                result[key] = takeValue(two[key]);\n            }\n        }\n    }\n    else if (isObject(one)) {\n        if (isObject(two)) {\n            if (!shouldMerge(one, two)) {\n                return two;\n            }\n            result = Object.assign({}, one);\n            var keys = Object.keys(two);\n            for (var i = 0, j = keys.length; i < j; i++) {\n                var key = keys[i];\n                var twoValue = two[key];\n                if (isPrimitive(twoValue)) {\n                    if (typeof twoValue === 'undefined') {\n                        delete result[key];\n                    }\n                    else {\n                        // result[key] = takeValue(twoValue);\n                        result[key] = twoValue;\n                    }\n                }\n                else {\n                    var obj1 = result[key];\n                    var obj2 = twoValue;\n                    if (wasObjectReferenced(one, key, objects) ||\n                        wasObjectReferenced(two, key, objects)) {\n                        delete result[key];\n                    }\n                    else {\n                        if (isObject(obj1) && isObject(obj2)) {\n                            var arr1 = objects.get(obj1) || [];\n                            var arr2 = objects.get(obj2) || [];\n                            arr1.push({ obj: one, key: key });\n                            arr2.push({ obj: two, key: key });\n                            objects.set(obj1, arr1);\n                            objects.set(obj2, arr2);\n                        }\n                        result[key] = mergeTwoObjects(result[key], twoValue, level, objects);\n                    }\n                }\n            }\n        }\n        else {\n            result = two;\n        }\n    }\n    return result;\n}\n/**\n * Function to check if object has been already reference\n * @param obj\n * @param key\n * @param objects\n */\nfunction wasObjectReferenced(obj, key, objects) {\n    var arr = objects.get(obj[key]) || [];\n    for (var i = 0, j = arr.length; i < j; i++) {\n        var info = arr[i];\n        if (info.key === key && info.obj === obj) {\n            return true;\n        }\n    }\n    return false;\n}\nfunction isArray(value) {\n    return Array.isArray(value);\n}\nfunction isFunction(value) {\n    return typeof value === 'function';\n}\nfunction isObject(value) {\n    return (!isPrimitive(value) &&\n        !isArray(value) &&\n        !isFunction(value) &&\n        typeof value === 'object');\n}\nfunction isPrimitive(value) {\n    return (typeof value === 'string' ||\n        typeof value === 'number' ||\n        typeof value === 'boolean' ||\n        typeof value === 'undefined' ||\n        value instanceof Date ||\n        value instanceof RegExp ||\n        value === null);\n}\nfunction shouldMerge(one, two) {\n    if (!isPlainObject(one) || !isPlainObject(two)) {\n        return false;\n    }\n    return true;\n}\n//# sourceMappingURL=merge.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __values = (this && this.__values) || function(o) {\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n    if (m) return m.call(o);\n    if (o && typeof o.length === \"number\") return {\n        next: function () {\n            if (o && i >= o.length) o = void 0;\n            return { value: o && o[i++], done: !o };\n        }\n    };\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\nimport { diag, } from '@opentelemetry/api';\n/** Combines multiple propagators into a single propagator. */\nvar CompositePropagator = /** @class */ (function () {\n    /**\n     * Construct a composite propagator from a list of propagators.\n     *\n     * @param [config] Configuration object for composite propagator\n     */\n    function CompositePropagator(config) {\n        if (config === void 0) { config = {}; }\n        var _a;\n        this._propagators = (_a = config.propagators) !== null && _a !== void 0 ? _a : [];\n        this._fields = Array.from(new Set(this._propagators\n            // older propagators may not have fields function, null check to be sure\n            .map(function (p) { return (typeof p.fields === 'function' ? p.fields() : []); })\n            .reduce(function (x, y) { return x.concat(y); }, [])));\n    }\n    /**\n     * Run each of the configured propagators with the given context and carrier.\n     * Propagators are run in the order they are configured, so if multiple\n     * propagators write the same carrier key, the propagator later in the list\n     * will \"win\".\n     *\n     * @param context Context to inject\n     * @param carrier Carrier into which context will be injected\n     */\n    CompositePropagator.prototype.inject = function (context, carrier, setter) {\n        var e_1, _a;\n        try {\n            for (var _b = __values(this._propagators), _c = _b.next(); !_c.done; _c = _b.next()) {\n                var propagator = _c.value;\n                try {\n                    propagator.inject(context, carrier, setter);\n                }\n                catch (err) {\n                    diag.warn(\"Failed to inject with \" + propagator.constructor.name + \". Err: \" + err.message);\n                }\n            }\n        }\n        catch (e_1_1) { e_1 = { error: e_1_1 }; }\n        finally {\n            try {\n                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n            }\n            finally { if (e_1) throw e_1.error; }\n        }\n    };\n    /**\n     * Run each of the configured propagators with the given context and carrier.\n     * Propagators are run in the order they are configured, so if multiple\n     * propagators write the same context key, the propagator later in the list\n     * will \"win\".\n     *\n     * @param context Context to add values to\n     * @param carrier Carrier from which to extract context\n     */\n    CompositePropagator.prototype.extract = function (context, carrier, getter) {\n        return this._propagators.reduce(function (ctx, propagator) {\n            try {\n                return propagator.extract(ctx, carrier, getter);\n            }\n            catch (err) {\n                diag.warn(\"Failed to inject with \" + propagator.constructor.name + \". Err: \" + err.message);\n            }\n            return ctx;\n        }, context);\n    };\n    CompositePropagator.prototype.fields = function () {\n        // return a new array so our fields cannot be modified\n        return this._fields.slice();\n    };\n    return CompositePropagator;\n}());\nexport { CompositePropagator };\n//# sourceMappingURL=composite.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar VALID_KEY_CHAR_RANGE = '[_0-9a-z-*/]';\nvar VALID_KEY = \"[a-z]\" + VALID_KEY_CHAR_RANGE + \"{0,255}\";\nvar VALID_VENDOR_KEY = \"[a-z0-9]\" + VALID_KEY_CHAR_RANGE + \"{0,240}@[a-z]\" + VALID_KEY_CHAR_RANGE + \"{0,13}\";\nvar VALID_KEY_REGEX = new RegExp(\"^(?:\" + VALID_KEY + \"|\" + VALID_VENDOR_KEY + \")$\");\nvar VALID_VALUE_BASE_REGEX = /^[ -~]{0,255}[!-~]$/;\nvar INVALID_VALUE_COMMA_EQUAL_REGEX = /,|=/;\n/**\n * Key is opaque string up to 256 characters printable. It MUST begin with a\n * lowercase letter, and can only contain lowercase letters a-z, digits 0-9,\n * underscores _, dashes -, asterisks *, and forward slashes /.\n * For multi-tenant vendor scenarios, an at sign (@) can be used to prefix the\n * vendor name. Vendors SHOULD set the tenant ID at the beginning of the key.\n * see https://www.w3.org/TR/trace-context/#key\n */\nexport function validateKey(key) {\n    return VALID_KEY_REGEX.test(key);\n}\n/**\n * Value is opaque string up to 256 characters printable ASCII RFC0020\n * characters (i.e., the range 0x20 to 0x7E) except comma , and =.\n */\nexport function validateValue(value) {\n    return (VALID_VALUE_BASE_REGEX.test(value) &&\n        !INVALID_VALUE_COMMA_EQUAL_REGEX.test(value));\n}\n//# sourceMappingURL=validators.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { validateKey, validateValue } from '../internal/validators';\nvar MAX_TRACE_STATE_ITEMS = 32;\nvar MAX_TRACE_STATE_LEN = 512;\nvar LIST_MEMBERS_SEPARATOR = ',';\nvar LIST_MEMBER_KEY_VALUE_SPLITTER = '=';\n/**\n * TraceState must be a class and not a simple object type because of the spec\n * requirement (https://www.w3.org/TR/trace-context/#tracestate-field).\n *\n * Here is the list of allowed mutations:\n * - New key-value pair should be added into the beginning of the list\n * - The value of any key can be updated. Modified keys MUST be moved to the\n * beginning of the list.\n */\nvar TraceState = /** @class */ (function () {\n    function TraceState(rawTraceState) {\n        this._internalState = new Map();\n        if (rawTraceState)\n            this._parse(rawTraceState);\n    }\n    TraceState.prototype.set = function (key, value) {\n        // TODO: Benchmark the different approaches(map vs list) and\n        // use the faster one.\n        var traceState = this._clone();\n        if (traceState._internalState.has(key)) {\n            traceState._internalState.delete(key);\n        }\n        traceState._internalState.set(key, value);\n        return traceState;\n    };\n    TraceState.prototype.unset = function (key) {\n        var traceState = this._clone();\n        traceState._internalState.delete(key);\n        return traceState;\n    };\n    TraceState.prototype.get = function (key) {\n        return this._internalState.get(key);\n    };\n    TraceState.prototype.serialize = function () {\n        var _this = this;\n        return this._keys()\n            .reduce(function (agg, key) {\n            agg.push(key + LIST_MEMBER_KEY_VALUE_SPLITTER + _this.get(key));\n            return agg;\n        }, [])\n            .join(LIST_MEMBERS_SEPARATOR);\n    };\n    TraceState.prototype._parse = function (rawTraceState) {\n        if (rawTraceState.length > MAX_TRACE_STATE_LEN)\n            return;\n        this._internalState = rawTraceState\n            .split(LIST_MEMBERS_SEPARATOR)\n            .reverse() // Store in reverse so new keys (.set(...)) will be placed at the beginning\n            .reduce(function (agg, part) {\n            var listMember = part.trim(); // Optional Whitespace (OWS) handling\n            var i = listMember.indexOf(LIST_MEMBER_KEY_VALUE_SPLITTER);\n            if (i !== -1) {\n                var key = listMember.slice(0, i);\n                var value = listMember.slice(i + 1, part.length);\n                if (validateKey(key) && validateValue(value)) {\n                    agg.set(key, value);\n                }\n                else {\n                    // TODO: Consider to add warning log\n                }\n            }\n            return agg;\n        }, new Map());\n        // Because of the reverse() requirement, trunc must be done after map is created\n        if (this._internalState.size > MAX_TRACE_STATE_ITEMS) {\n            this._internalState = new Map(Array.from(this._internalState.entries())\n                .reverse() // Use reverse same as original tracestate parse chain\n                .slice(0, MAX_TRACE_STATE_ITEMS));\n        }\n    };\n    TraceState.prototype._keys = function () {\n        return Array.from(this._internalState.keys()).reverse();\n    };\n    TraceState.prototype._clone = function () {\n        var traceState = new TraceState();\n        traceState._internalState = new Map(this._internalState);\n        return traceState;\n    };\n    return TraceState;\n}());\nexport { TraceState };\n//# sourceMappingURL=TraceState.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { isSpanContextValid, trace, TraceFlags, } from '@opentelemetry/api';\nimport { isTracingSuppressed } from './suppress-tracing';\nimport { TraceState } from './TraceState';\nexport var TRACE_PARENT_HEADER = 'traceparent';\nexport var TRACE_STATE_HEADER = 'tracestate';\nvar VERSION = '00';\nvar VERSION_PART = '(?!ff)[\\\\da-f]{2}';\nvar TRACE_ID_PART = '(?![0]{32})[\\\\da-f]{32}';\nvar PARENT_ID_PART = '(?![0]{16})[\\\\da-f]{16}';\nvar FLAGS_PART = '[\\\\da-f]{2}';\nvar TRACE_PARENT_REGEX = new RegExp(\"^\\\\s?(\" + VERSION_PART + \")-(\" + TRACE_ID_PART + \")-(\" + PARENT_ID_PART + \")-(\" + FLAGS_PART + \")(-.*)?\\\\s?$\");\n/**\n * Parses information from the [traceparent] span tag and converts it into {@link SpanContext}\n * @param traceParent - A meta property that comes from server.\n *     It should be dynamically generated server side to have the server's request trace Id,\n *     a parent span Id that was set on the server's request span,\n *     and the trace flags to indicate the server's sampling decision\n *     (01 = sampled, 00 = not sampled).\n *     for example: '{version}-{traceId}-{spanId}-{sampleDecision}'\n *     For more information see {@link https://www.w3.org/TR/trace-context/}\n */\nexport function parseTraceParent(traceParent) {\n    var match = TRACE_PARENT_REGEX.exec(traceParent);\n    if (!match)\n        return null;\n    // According to the specification the implementation should be compatible\n    // with future versions. If there are more parts, we only reject it if it's using version 00\n    // See https://www.w3.org/TR/trace-context/#versioning-of-traceparent\n    if (match[1] === '00' && match[5])\n        return null;\n    return {\n        traceId: match[2],\n        spanId: match[3],\n        traceFlags: parseInt(match[4], 16),\n    };\n}\n/**\n * Propagates {@link SpanContext} through Trace Context format propagation.\n *\n * Based on the Trace Context specification:\n * https://www.w3.org/TR/trace-context/\n */\nvar W3CTraceContextPropagator = /** @class */ (function () {\n    function W3CTraceContextPropagator() {\n    }\n    W3CTraceContextPropagator.prototype.inject = function (context, carrier, setter) {\n        var spanContext = trace.getSpanContext(context);\n        if (!spanContext ||\n            isTracingSuppressed(context) ||\n            !isSpanContextValid(spanContext))\n            return;\n        var traceParent = VERSION + \"-\" + spanContext.traceId + \"-\" + spanContext.spanId + \"-0\" + Number(spanContext.traceFlags || TraceFlags.NONE).toString(16);\n        setter.set(carrier, TRACE_PARENT_HEADER, traceParent);\n        if (spanContext.traceState) {\n            setter.set(carrier, TRACE_STATE_HEADER, spanContext.traceState.serialize());\n        }\n    };\n    W3CTraceContextPropagator.prototype.extract = function (context, carrier, getter) {\n        var traceParentHeader = getter.get(carrier, TRACE_PARENT_HEADER);\n        if (!traceParentHeader)\n            return context;\n        var traceParent = Array.isArray(traceParentHeader)\n            ? traceParentHeader[0]\n            : traceParentHeader;\n        if (typeof traceParent !== 'string')\n            return context;\n        var spanContext = parseTraceParent(traceParent);\n        if (!spanContext)\n            return context;\n        spanContext.isRemote = true;\n        var traceStateHeader = getter.get(carrier, TRACE_STATE_HEADER);\n        if (traceStateHeader) {\n            // If more than one `tracestate` header is found, we merge them into a\n            // single header.\n            var state = Array.isArray(traceStateHeader)\n                ? traceStateHeader.join(',')\n                : traceStateHeader;\n            spanContext.traceState = new TraceState(typeof state === 'string' ? state : undefined);\n        }\n        return trace.setSpanContext(context, spanContext);\n    };\n    W3CTraceContextPropagator.prototype.fields = function () {\n        return [TRACE_PARENT_HEADER, TRACE_STATE_HEADER];\n    };\n    return W3CTraceContextPropagator;\n}());\nexport { W3CTraceContextPropagator };\n//# sourceMappingURL=W3CTraceContextPropagator.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nexport var BAGGAGE_KEY_PAIR_SEPARATOR = '=';\nexport var BAGGAGE_PROPERTIES_SEPARATOR = ';';\nexport var BAGGAGE_ITEMS_SEPARATOR = ',';\n// Name of the http header used to propagate the baggage\nexport var BAGGAGE_HEADER = 'baggage';\n// Maximum number of name-value pairs allowed by w3c spec\nexport var BAGGAGE_MAX_NAME_VALUE_PAIRS = 180;\n// Maximum number of bytes per a single name-value pair allowed by w3c spec\nexport var BAGGAGE_MAX_PER_NAME_VALUE_PAIRS = 4096;\n// Maximum total length of all name-value pairs allowed by w3c spec\nexport var BAGGAGE_MAX_TOTAL_LENGTH = 8192;\n//# sourceMappingURL=constants.js.map","var __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\n/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { baggageEntryMetadataFromString, } from '@opentelemetry/api';\nimport { BAGGAGE_ITEMS_SEPARATOR, BAGGAGE_PROPERTIES_SEPARATOR, BAGGAGE_KEY_PAIR_SEPARATOR, BAGGAGE_MAX_TOTAL_LENGTH, } from './constants';\nexport function serializeKeyPairs(keyPairs) {\n    return keyPairs.reduce(function (hValue, current) {\n        var value = \"\" + hValue + (hValue !== '' ? BAGGAGE_ITEMS_SEPARATOR : '') + current;\n        return value.length > BAGGAGE_MAX_TOTAL_LENGTH ? hValue : value;\n    }, '');\n}\nexport function getKeyPairs(baggage) {\n    return baggage.getAllEntries().map(function (_a) {\n        var _b = __read(_a, 2), key = _b[0], value = _b[1];\n        var entry = encodeURIComponent(key) + \"=\" + encodeURIComponent(value.value);\n        // include opaque metadata if provided\n        // NOTE: we intentionally don't URI-encode the metadata - that responsibility falls on the metadata implementation\n        if (value.metadata !== undefined) {\n            entry += BAGGAGE_PROPERTIES_SEPARATOR + value.metadata.toString();\n        }\n        return entry;\n    });\n}\nexport function parsePairKeyValue(entry) {\n    var valueProps = entry.split(BAGGAGE_PROPERTIES_SEPARATOR);\n    if (valueProps.length <= 0)\n        return;\n    var keyPairPart = valueProps.shift();\n    if (!keyPairPart)\n        return;\n    var keyPair = keyPairPart.split(BAGGAGE_KEY_PAIR_SEPARATOR);\n    if (keyPair.length !== 2)\n        return;\n    var key = decodeURIComponent(keyPair[0].trim());\n    var value = decodeURIComponent(keyPair[1].trim());\n    var metadata;\n    if (valueProps.length > 0) {\n        metadata = baggageEntryMetadataFromString(valueProps.join(BAGGAGE_PROPERTIES_SEPARATOR));\n    }\n    return { key: key, value: value, metadata: metadata };\n}\n/**\n * Parse a string serialized in the baggage HTTP Format (without metadata):\n * https://github.com/w3c/baggage/blob/master/baggage/HTTP_HEADER_FORMAT.md\n */\nexport function parseKeyPairsIntoRecord(value) {\n    if (typeof value !== 'string' || value.length === 0)\n        return {};\n    return value\n        .split(BAGGAGE_ITEMS_SEPARATOR)\n        .map(function (entry) {\n        return parsePairKeyValue(entry);\n    })\n        .filter(function (keyPair) { return keyPair !== undefined && keyPair.value.length > 0; })\n        .reduce(function (headers, keyPair) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        headers[keyPair.key] = keyPair.value;\n        return headers;\n    }, {});\n}\n//# sourceMappingURL=utils.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { propagation, } from '@opentelemetry/api';\nimport { isTracingSuppressed } from '../../trace/suppress-tracing';\nimport { BAGGAGE_HEADER, BAGGAGE_ITEMS_SEPARATOR, BAGGAGE_MAX_NAME_VALUE_PAIRS, BAGGAGE_MAX_PER_NAME_VALUE_PAIRS, } from '../constants';\nimport { getKeyPairs, parsePairKeyValue, serializeKeyPairs } from '../utils';\n/**\n * Propagates {@link Baggage} through Context format propagation.\n *\n * Based on the Baggage specification:\n * https://w3c.github.io/baggage/\n */\nvar W3CBaggagePropagator = /** @class */ (function () {\n    function W3CBaggagePropagator() {\n    }\n    W3CBaggagePropagator.prototype.inject = function (context, carrier, setter) {\n        var baggage = propagation.getBaggage(context);\n        if (!baggage || isTracingSuppressed(context))\n            return;\n        var keyPairs = getKeyPairs(baggage)\n            .filter(function (pair) {\n            return pair.length <= BAGGAGE_MAX_PER_NAME_VALUE_PAIRS;\n        })\n            .slice(0, BAGGAGE_MAX_NAME_VALUE_PAIRS);\n        var headerValue = serializeKeyPairs(keyPairs);\n        if (headerValue.length > 0) {\n            setter.set(carrier, BAGGAGE_HEADER, headerValue);\n        }\n    };\n    W3CBaggagePropagator.prototype.extract = function (context, carrier, getter) {\n        var headerValue = getter.get(carrier, BAGGAGE_HEADER);\n        var baggageString = Array.isArray(headerValue)\n            ? headerValue.join(BAGGAGE_ITEMS_SEPARATOR)\n            : headerValue;\n        if (!baggageString)\n            return context;\n        var baggage = {};\n        if (baggageString.length === 0) {\n            return context;\n        }\n        var pairs = baggageString.split(BAGGAGE_ITEMS_SEPARATOR);\n        pairs.forEach(function (entry) {\n            var keyPair = parsePairKeyValue(entry);\n            if (keyPair) {\n                var baggageEntry = { value: keyPair.value };\n                if (keyPair.metadata) {\n                    baggageEntry.metadata = keyPair.metadata;\n                }\n                baggage[keyPair.key] = baggageEntry;\n            }\n        });\n        if (Object.entries(baggage).length === 0) {\n            return context;\n        }\n        return propagation.setBaggage(context, propagation.createBaggage(baggage));\n    };\n    W3CBaggagePropagator.prototype.fields = function () {\n        return [BAGGAGE_HEADER];\n    };\n    return W3CBaggagePropagator;\n}());\nexport { W3CBaggagePropagator };\n//# sourceMappingURL=W3CBaggagePropagator.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar _a;\nimport { VERSION } from '../../version';\nimport { TelemetrySdkLanguageValues, SemanticResourceAttributes, } from '@opentelemetry/semantic-conventions';\n/** Constants describing the SDK in use */\nexport var SDK_INFO = (_a = {},\n    _a[SemanticResourceAttributes.TELEMETRY_SDK_NAME] = 'opentelemetry',\n    _a[SemanticResourceAttributes.PROCESS_RUNTIME_NAME] = 'browser',\n    _a[SemanticResourceAttributes.TELEMETRY_SDK_LANGUAGE] = TelemetrySdkLanguageValues.WEBJS,\n    _a[SemanticResourceAttributes.TELEMETRY_SDK_VERSION] = VERSION,\n    _a);\n//# sourceMappingURL=sdk-info.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n// this is autogenerated file, see scripts/version-update.js\nexport var VERSION = '1.15.1';\n//# sourceMappingURL=version.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nimport { diag } from '@opentelemetry/api';\nimport { SemanticResourceAttributes } from '@opentelemetry/semantic-conventions';\nimport { SDK_INFO } from '@opentelemetry/core';\nimport { defaultServiceName } from './platform';\n/**\n * A Resource describes the entity for which a signals (metrics or trace) are\n * collected.\n */\nvar Resource = /** @class */ (function () {\n    function Resource(\n    /**\n     * A dictionary of attributes with string keys and values that provide\n     * information about the entity as numbers, strings or booleans\n     * TODO: Consider to add check/validation on attributes.\n     */\n    attributes, asyncAttributesPromise) {\n        var _this = this;\n        var _a;\n        this._attributes = attributes;\n        this.asyncAttributesPending = asyncAttributesPromise != null;\n        this._syncAttributes = (_a = this._attributes) !== null && _a !== void 0 ? _a : {};\n        this._asyncAttributesPromise = asyncAttributesPromise === null || asyncAttributesPromise === void 0 ? void 0 : asyncAttributesPromise.then(function (asyncAttributes) {\n            _this._attributes = Object.assign({}, _this._attributes, asyncAttributes);\n            _this.asyncAttributesPending = false;\n            return asyncAttributes;\n        }, function (err) {\n            diag.debug(\"a resource's async attributes promise rejected: %s\", err);\n            _this.asyncAttributesPending = false;\n            return {};\n        });\n    }\n    /**\n     * Returns an empty Resource\n     */\n    Resource.empty = function () {\n        return Resource.EMPTY;\n    };\n    /**\n     * Returns a Resource that identifies the SDK in use.\n     */\n    Resource.default = function () {\n        var _a;\n        return new Resource((_a = {},\n            _a[SemanticResourceAttributes.SERVICE_NAME] = defaultServiceName(),\n            _a[SemanticResourceAttributes.TELEMETRY_SDK_LANGUAGE] = SDK_INFO[SemanticResourceAttributes.TELEMETRY_SDK_LANGUAGE],\n            _a[SemanticResourceAttributes.TELEMETRY_SDK_NAME] = SDK_INFO[SemanticResourceAttributes.TELEMETRY_SDK_NAME],\n            _a[SemanticResourceAttributes.TELEMETRY_SDK_VERSION] = SDK_INFO[SemanticResourceAttributes.TELEMETRY_SDK_VERSION],\n            _a));\n    };\n    Object.defineProperty(Resource.prototype, \"attributes\", {\n        get: function () {\n            var _a;\n            if (this.asyncAttributesPending) {\n                diag.error('Accessing resource attributes before async attributes settled');\n            }\n            return (_a = this._attributes) !== null && _a !== void 0 ? _a : {};\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * Returns a promise that will never be rejected. Resolves when all async attributes have finished being added to\n     * this Resource's attributes. This is useful in exporters to block until resource detection\n     * has finished.\n     */\n    Resource.prototype.waitForAsyncAttributes = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (!this.asyncAttributesPending) return [3 /*break*/, 2];\n                        return [4 /*yield*/, this._asyncAttributesPromise];\n                    case 1:\n                        _a.sent();\n                        _a.label = 2;\n                    case 2: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /**\n     * Returns a new, merged {@link Resource} by merging the current Resource\n     * with the other Resource. In case of a collision, other Resource takes\n     * precedence.\n     *\n     * @param other the Resource that will be merged with this.\n     * @returns the newly merged Resource.\n     */\n    Resource.prototype.merge = function (other) {\n        var _this = this;\n        var _a;\n        if (!other)\n            return this;\n        // SpanAttributes from other resource overwrite attributes from this resource.\n        var mergedSyncAttributes = __assign(__assign({}, this._syncAttributes), ((_a = other._syncAttributes) !== null && _a !== void 0 ? _a : other.attributes));\n        if (!this._asyncAttributesPromise &&\n            !other._asyncAttributesPromise) {\n            return new Resource(mergedSyncAttributes);\n        }\n        var mergedAttributesPromise = Promise.all([\n            this._asyncAttributesPromise,\n            other._asyncAttributesPromise,\n        ]).then(function (_a) {\n            var _b;\n            var _c = __read(_a, 2), thisAsyncAttributes = _c[0], otherAsyncAttributes = _c[1];\n            return __assign(__assign(__assign(__assign({}, _this._syncAttributes), thisAsyncAttributes), ((_b = other._syncAttributes) !== null && _b !== void 0 ? _b : other.attributes)), otherAsyncAttributes);\n        });\n        return new Resource(mergedSyncAttributes, mergedAttributesPromise);\n    };\n    Resource.EMPTY = new Resource({});\n    return Resource;\n}());\nexport { Resource };\n//# sourceMappingURL=Resource.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nexport function defaultServiceName() {\n    return 'unknown_service';\n}\n//# sourceMappingURL=default-service-name.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __values = (this && this.__values) || function(o) {\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n    if (m) return m.call(o);\n    if (o && typeof o.length === \"number\") return {\n        next: function () {\n            if (o && i >= o.length) o = void 0;\n            return { value: o && o[i++], done: !o };\n        }\n    };\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nimport { diag } from '@opentelemetry/api';\nexport function sanitizeAttributes(attributes) {\n    var e_1, _a;\n    var out = {};\n    if (typeof attributes !== 'object' || attributes == null) {\n        return out;\n    }\n    try {\n        for (var _b = __values(Object.entries(attributes)), _c = _b.next(); !_c.done; _c = _b.next()) {\n            var _d = __read(_c.value, 2), key = _d[0], val = _d[1];\n            if (!isAttributeKey(key)) {\n                diag.warn(\"Invalid attribute key: \" + key);\n                continue;\n            }\n            if (!isAttributeValue(val)) {\n                diag.warn(\"Invalid attribute value set for key: \" + key);\n                continue;\n            }\n            if (Array.isArray(val)) {\n                out[key] = val.slice();\n            }\n            else {\n                out[key] = val;\n            }\n        }\n    }\n    catch (e_1_1) { e_1 = { error: e_1_1 }; }\n    finally {\n        try {\n            if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n        }\n        finally { if (e_1) throw e_1.error; }\n    }\n    return out;\n}\nexport function isAttributeKey(key) {\n    return typeof key === 'string' && key.length > 0;\n}\nexport function isAttributeValue(val) {\n    if (val == null) {\n        return true;\n    }\n    if (Array.isArray(val)) {\n        return isHomogeneousAttributeValueArray(val);\n    }\n    return isValidPrimitiveAttributeValue(val);\n}\nfunction isHomogeneousAttributeValueArray(arr) {\n    var e_2, _a;\n    var type;\n    try {\n        for (var arr_1 = __values(arr), arr_1_1 = arr_1.next(); !arr_1_1.done; arr_1_1 = arr_1.next()) {\n            var element = arr_1_1.value;\n            // null/undefined elements are allowed\n            if (element == null)\n                continue;\n            if (!type) {\n                if (isValidPrimitiveAttributeValue(element)) {\n                    type = typeof element;\n                    continue;\n                }\n                // encountered an invalid primitive\n                return false;\n            }\n            if (typeof element === type) {\n                continue;\n            }\n            return false;\n        }\n    }\n    catch (e_2_1) { e_2 = { error: e_2_1 }; }\n    finally {\n        try {\n            if (arr_1_1 && !arr_1_1.done && (_a = arr_1.return)) _a.call(arr_1);\n        }\n        finally { if (e_2) throw e_2.error; }\n    }\n    return true;\n}\nfunction isValidPrimitiveAttributeValue(val) {\n    switch (typeof val) {\n        case 'number':\n        case 'boolean':\n        case 'string':\n            return true;\n    }\n    return false;\n}\n//# sourceMappingURL=attributes.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nexport var otperformance = performance;\n//# sourceMappingURL=performance.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { otperformance as performance } from '../platform';\nvar NANOSECOND_DIGITS = 9;\nvar NANOSECOND_DIGITS_IN_MILLIS = 6;\nvar MILLISECONDS_TO_NANOSECONDS = Math.pow(10, NANOSECOND_DIGITS_IN_MILLIS);\nvar SECOND_TO_NANOSECONDS = Math.pow(10, NANOSECOND_DIGITS);\n/**\n * Converts a number of milliseconds from epoch to HrTime([seconds, remainder in nanoseconds]).\n * @param epochMillis\n */\nexport function millisToHrTime(epochMillis) {\n    var epochSeconds = epochMillis / 1000;\n    // Decimals only.\n    var seconds = Math.trunc(epochSeconds);\n    // Round sub-nanosecond accuracy to nanosecond.\n    var nanos = Math.round((epochMillis % 1000) * MILLISECONDS_TO_NANOSECONDS);\n    return [seconds, nanos];\n}\nexport function getTimeOrigin() {\n    var timeOrigin = performance.timeOrigin;\n    if (typeof timeOrigin !== 'number') {\n        var perf = performance;\n        timeOrigin = perf.timing && perf.timing.fetchStart;\n    }\n    return timeOrigin;\n}\n/**\n * Returns an hrtime calculated via performance component.\n * @param performanceNow\n */\nexport function hrTime(performanceNow) {\n    var timeOrigin = millisToHrTime(getTimeOrigin());\n    var now = millisToHrTime(typeof performanceNow === 'number' ? performanceNow : performance.now());\n    return addHrTimes(timeOrigin, now);\n}\n/**\n *\n * Converts a TimeInput to an HrTime, defaults to _hrtime().\n * @param time\n */\nexport function timeInputToHrTime(time) {\n    // process.hrtime\n    if (isTimeInputHrTime(time)) {\n        return time;\n    }\n    else if (typeof time === 'number') {\n        // Must be a performance.now() if it's smaller than process start time.\n        if (time < getTimeOrigin()) {\n            return hrTime(time);\n        }\n        else {\n            // epoch milliseconds or performance.timeOrigin\n            return millisToHrTime(time);\n        }\n    }\n    else if (time instanceof Date) {\n        return millisToHrTime(time.getTime());\n    }\n    else {\n        throw TypeError('Invalid input type');\n    }\n}\n/**\n * Returns a duration of two hrTime.\n * @param startTime\n * @param endTime\n */\nexport function hrTimeDuration(startTime, endTime) {\n    var seconds = endTime[0] - startTime[0];\n    var nanos = endTime[1] - startTime[1];\n    // overflow\n    if (nanos < 0) {\n        seconds -= 1;\n        // negate\n        nanos += SECOND_TO_NANOSECONDS;\n    }\n    return [seconds, nanos];\n}\n/**\n * Convert hrTime to timestamp, for example \"2019-05-14T17:00:00.000123456Z\"\n * @param time\n */\nexport function hrTimeToTimeStamp(time) {\n    var precision = NANOSECOND_DIGITS;\n    var tmp = \"\" + '0'.repeat(precision) + time[1] + \"Z\";\n    var nanoString = tmp.substr(tmp.length - precision - 1);\n    var date = new Date(time[0] * 1000).toISOString();\n    return date.replace('000Z', nanoString);\n}\n/**\n * Convert hrTime to nanoseconds.\n * @param time\n */\nexport function hrTimeToNanoseconds(time) {\n    return time[0] * SECOND_TO_NANOSECONDS + time[1];\n}\n/**\n * Convert hrTime to milliseconds.\n * @param time\n */\nexport function hrTimeToMilliseconds(time) {\n    return Math.round(time[0] * 1e3 + time[1] / 1e6);\n}\n/**\n * Convert hrTime to microseconds.\n * @param time\n */\nexport function hrTimeToMicroseconds(time) {\n    return Math.round(time[0] * 1e6 + time[1] / 1e3);\n}\n/**\n * check if time is HrTime\n * @param value\n */\nexport function isTimeInputHrTime(value) {\n    return (Array.isArray(value) &&\n        value.length === 2 &&\n        typeof value[0] === 'number' &&\n        typeof value[1] === 'number');\n}\n/**\n * check if input value is a correct types.TimeInput\n * @param value\n */\nexport function isTimeInput(value) {\n    return (isTimeInputHrTime(value) ||\n        typeof value === 'number' ||\n        value instanceof Date);\n}\n/**\n * Given 2 HrTime formatted times, return their sum as an HrTime.\n */\nexport function addHrTimes(time1, time2) {\n    var out = [time1[0] + time2[0], time1[1] + time2[1]];\n    // Nanoseconds\n    if (out[1] >= SECOND_TO_NANOSECONDS) {\n        out[1] -= SECOND_TO_NANOSECONDS;\n        out[0] += 1;\n    }\n    return out;\n}\n//# sourceMappingURL=time.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n// DO NOT EDIT, this is an Auto-generated file from scripts/semconv/templates//templates/SemanticAttributes.ts.j2\nexport var SemanticAttributes = {\n    /**\n     * The full invoked ARN as provided on the `Context` passed to the function (`Lambda-Runtime-Invoked-Function-Arn` header on the `/runtime/invocation/next` applicable).\n     *\n     * Note: This may be different from `faas.id` if an alias is involved.\n     */\n    AWS_LAMBDA_INVOKED_ARN: 'aws.lambda.invoked_arn',\n    /**\n     * An identifier for the database management system (DBMS) product being used. See below for a list of well-known identifiers.\n     */\n    DB_SYSTEM: 'db.system',\n    /**\n     * The connection string used to connect to the database. It is recommended to remove embedded credentials.\n     */\n    DB_CONNECTION_STRING: 'db.connection_string',\n    /**\n     * Username for accessing the database.\n     */\n    DB_USER: 'db.user',\n    /**\n     * The fully-qualified class name of the [Java Database Connectivity (JDBC)](https://docs.oracle.com/javase/8/docs/technotes/guides/jdbc/) driver used to connect.\n     */\n    DB_JDBC_DRIVER_CLASSNAME: 'db.jdbc.driver_classname',\n    /**\n     * If no [tech-specific attribute](#call-level-attributes-for-specific-technologies) is defined, this attribute is used to report the name of the database being accessed. For commands that switch the database, this should be set to the target database (even if the command fails).\n     *\n     * Note: In some SQL databases, the database name to be used is called &#34;schema name&#34;.\n     */\n    DB_NAME: 'db.name',\n    /**\n     * The database statement being executed.\n     *\n     * Note: The value may be sanitized to exclude sensitive information.\n     */\n    DB_STATEMENT: 'db.statement',\n    /**\n     * The name of the operation being executed, e.g. the [MongoDB command name](https://docs.mongodb.com/manual/reference/command/#database-operations) such as `findAndModify`, or the SQL keyword.\n     *\n     * Note: When setting this to an SQL keyword, it is not recommended to attempt any client-side parsing of `db.statement` just to get this property, but it should be set if the operation name is provided by the library being instrumented. If the SQL statement has an ambiguous operation, or performs more than one operation, this value may be omitted.\n     */\n    DB_OPERATION: 'db.operation',\n    /**\n     * The Microsoft SQL Server [instance name](https://docs.microsoft.com/en-us/sql/connect/jdbc/building-the-connection-url?view=sql-server-ver15) connecting to. This name is used to determine the port of a named instance.\n     *\n     * Note: If setting a `db.mssql.instance_name`, `net.peer.port` is no longer required (but still recommended if non-standard).\n     */\n    DB_MSSQL_INSTANCE_NAME: 'db.mssql.instance_name',\n    /**\n     * The name of the keyspace being accessed. To be used instead of the generic `db.name` attribute.\n     */\n    DB_CASSANDRA_KEYSPACE: 'db.cassandra.keyspace',\n    /**\n     * The fetch size used for paging, i.e. how many rows will be returned at once.\n     */\n    DB_CASSANDRA_PAGE_SIZE: 'db.cassandra.page_size',\n    /**\n     * The consistency level of the query. Based on consistency values from [CQL](https://docs.datastax.com/en/cassandra-oss/3.0/cassandra/dml/dmlConfigConsistency.html).\n     */\n    DB_CASSANDRA_CONSISTENCY_LEVEL: 'db.cassandra.consistency_level',\n    /**\n     * The name of the primary table that the operation is acting upon, including the schema name (if applicable).\n     *\n     * Note: This mirrors the db.sql.table attribute but references cassandra rather than sql. It is not recommended to attempt any client-side parsing of `db.statement` just to get this property, but it should be set if it is provided by the library being instrumented. If the operation is acting upon an anonymous table, or more than one table, this value MUST NOT be set.\n     */\n    DB_CASSANDRA_TABLE: 'db.cassandra.table',\n    /**\n     * Whether or not the query is idempotent.\n     */\n    DB_CASSANDRA_IDEMPOTENCE: 'db.cassandra.idempotence',\n    /**\n     * The number of times a query was speculatively executed. Not set or `0` if the query was not executed speculatively.\n     */\n    DB_CASSANDRA_SPECULATIVE_EXECUTION_COUNT: 'db.cassandra.speculative_execution_count',\n    /**\n     * The ID of the coordinating node for a query.\n     */\n    DB_CASSANDRA_COORDINATOR_ID: 'db.cassandra.coordinator.id',\n    /**\n     * The data center of the coordinating node for a query.\n     */\n    DB_CASSANDRA_COORDINATOR_DC: 'db.cassandra.coordinator.dc',\n    /**\n     * The [HBase namespace](https://hbase.apache.org/book.html#_namespace) being accessed. To be used instead of the generic `db.name` attribute.\n     */\n    DB_HBASE_NAMESPACE: 'db.hbase.namespace',\n    /**\n     * The index of the database being accessed as used in the [`SELECT` command](https://redis.io/commands/select), provided as an integer. To be used instead of the generic `db.name` attribute.\n     */\n    DB_REDIS_DATABASE_INDEX: 'db.redis.database_index',\n    /**\n     * The collection being accessed within the database stated in `db.name`.\n     */\n    DB_MONGODB_COLLECTION: 'db.mongodb.collection',\n    /**\n     * The name of the primary table that the operation is acting upon, including the schema name (if applicable).\n     *\n     * Note: It is not recommended to attempt any client-side parsing of `db.statement` just to get this property, but it should be set if it is provided by the library being instrumented. If the operation is acting upon an anonymous table, or more than one table, this value MUST NOT be set.\n     */\n    DB_SQL_TABLE: 'db.sql.table',\n    /**\n     * The type of the exception (its fully-qualified class name, if applicable). The dynamic type of the exception should be preferred over the static type in languages that support it.\n     */\n    EXCEPTION_TYPE: 'exception.type',\n    /**\n     * The exception message.\n     */\n    EXCEPTION_MESSAGE: 'exception.message',\n    /**\n     * A stacktrace as a string in the natural representation for the language runtime. The representation is to be determined and documented by each language SIG.\n     */\n    EXCEPTION_STACKTRACE: 'exception.stacktrace',\n    /**\n    * SHOULD be set to true if the exception event is recorded at a point where it is known that the exception is escaping the scope of the span.\n    *\n    * Note: An exception is considered to have escaped (or left) the scope of a span,\n  if that span is ended while the exception is still logically &#34;in flight&#34;.\n  This may be actually &#34;in flight&#34; in some languages (e.g. if the exception\n  is passed to a Context manager&#39;s `__exit__` method in Python) but will\n  usually be caught at the point of recording the exception in most languages.\n  \n  It is usually not possible to determine at the point where an exception is thrown\n  whether it will escape the scope of a span.\n  However, it is trivial to know that an exception\n  will escape, if one checks for an active exception just before ending the span,\n  as done in the [example above](#exception-end-example).\n  \n  It follows that an exception may still escape the scope of the span\n  even if the `exception.escaped` attribute was not set or set to false,\n  since the event might have been recorded at a time where it was not\n  clear whether the exception will escape.\n    */\n    EXCEPTION_ESCAPED: 'exception.escaped',\n    /**\n     * Type of the trigger on which the function is executed.\n     */\n    FAAS_TRIGGER: 'faas.trigger',\n    /**\n     * The execution ID of the current function execution.\n     */\n    FAAS_EXECUTION: 'faas.execution',\n    /**\n     * The name of the source on which the triggering operation was performed. For example, in Cloud Storage or S3 corresponds to the bucket name, and in Cosmos DB to the database name.\n     */\n    FAAS_DOCUMENT_COLLECTION: 'faas.document.collection',\n    /**\n     * Describes the type of the operation that was performed on the data.\n     */\n    FAAS_DOCUMENT_OPERATION: 'faas.document.operation',\n    /**\n     * A string containing the time when the data was accessed in the [ISO 8601](https://www.iso.org/iso-8601-date-and-time-format.html) format expressed in [UTC](https://www.w3.org/TR/NOTE-datetime).\n     */\n    FAAS_DOCUMENT_TIME: 'faas.document.time',\n    /**\n     * The document name/table subjected to the operation. For example, in Cloud Storage or S3 is the name of the file, and in Cosmos DB the table name.\n     */\n    FAAS_DOCUMENT_NAME: 'faas.document.name',\n    /**\n     * A string containing the function invocation time in the [ISO 8601](https://www.iso.org/iso-8601-date-and-time-format.html) format expressed in [UTC](https://www.w3.org/TR/NOTE-datetime).\n     */\n    FAAS_TIME: 'faas.time',\n    /**\n     * A string containing the schedule period as [Cron Expression](https://docs.oracle.com/cd/E12058_01/doc/doc.1014/e12030/cron_expressions.htm).\n     */\n    FAAS_CRON: 'faas.cron',\n    /**\n     * A boolean that is true if the serverless function is executed for the first time (aka cold-start).\n     */\n    FAAS_COLDSTART: 'faas.coldstart',\n    /**\n     * The name of the invoked function.\n     *\n     * Note: SHOULD be equal to the `faas.name` resource attribute of the invoked function.\n     */\n    FAAS_INVOKED_NAME: 'faas.invoked_name',\n    /**\n     * The cloud provider of the invoked function.\n     *\n     * Note: SHOULD be equal to the `cloud.provider` resource attribute of the invoked function.\n     */\n    FAAS_INVOKED_PROVIDER: 'faas.invoked_provider',\n    /**\n     * The cloud region of the invoked function.\n     *\n     * Note: SHOULD be equal to the `cloud.region` resource attribute of the invoked function.\n     */\n    FAAS_INVOKED_REGION: 'faas.invoked_region',\n    /**\n     * Transport protocol used. See note below.\n     */\n    NET_TRANSPORT: 'net.transport',\n    /**\n     * Remote address of the peer (dotted decimal for IPv4 or [RFC5952](https://tools.ietf.org/html/rfc5952) for IPv6).\n     */\n    NET_PEER_IP: 'net.peer.ip',\n    /**\n     * Remote port number.\n     */\n    NET_PEER_PORT: 'net.peer.port',\n    /**\n     * Remote hostname or similar, see note below.\n     */\n    NET_PEER_NAME: 'net.peer.name',\n    /**\n     * Like `net.peer.ip` but for the host IP. Useful in case of a multi-IP host.\n     */\n    NET_HOST_IP: 'net.host.ip',\n    /**\n     * Like `net.peer.port` but for the host port.\n     */\n    NET_HOST_PORT: 'net.host.port',\n    /**\n     * Local hostname or similar, see note below.\n     */\n    NET_HOST_NAME: 'net.host.name',\n    /**\n     * The internet connection type currently being used by the host.\n     */\n    NET_HOST_CONNECTION_TYPE: 'net.host.connection.type',\n    /**\n     * This describes more details regarding the connection.type. It may be the type of cell technology connection, but it could be used for describing details about a wifi connection.\n     */\n    NET_HOST_CONNECTION_SUBTYPE: 'net.host.connection.subtype',\n    /**\n     * The name of the mobile carrier.\n     */\n    NET_HOST_CARRIER_NAME: 'net.host.carrier.name',\n    /**\n     * The mobile carrier country code.\n     */\n    NET_HOST_CARRIER_MCC: 'net.host.carrier.mcc',\n    /**\n     * The mobile carrier network code.\n     */\n    NET_HOST_CARRIER_MNC: 'net.host.carrier.mnc',\n    /**\n     * The ISO 3166-1 alpha-2 2-character country code associated with the mobile carrier network.\n     */\n    NET_HOST_CARRIER_ICC: 'net.host.carrier.icc',\n    /**\n     * The [`service.name`](../../resource/semantic_conventions/README.md#service) of the remote service. SHOULD be equal to the actual `service.name` resource attribute of the remote service if any.\n     */\n    PEER_SERVICE: 'peer.service',\n    /**\n     * Username or client_id extracted from the access token or [Authorization](https://tools.ietf.org/html/rfc7235#section-4.2) header in the inbound request from outside the system.\n     */\n    ENDUSER_ID: 'enduser.id',\n    /**\n     * Actual/assumed role the client is making the request under extracted from token or application security context.\n     */\n    ENDUSER_ROLE: 'enduser.role',\n    /**\n     * Scopes or granted authorities the client currently possesses extracted from token or application security context. The value would come from the scope associated with an [OAuth 2.0 Access Token](https://tools.ietf.org/html/rfc6749#section-3.3) or an attribute value in a [SAML 2.0 Assertion](http://docs.oasis-open.org/security/saml/Post2.0/sstc-saml-tech-overview-2.0.html).\n     */\n    ENDUSER_SCOPE: 'enduser.scope',\n    /**\n     * Current &#34;managed&#34; thread ID (as opposed to OS thread ID).\n     */\n    THREAD_ID: 'thread.id',\n    /**\n     * Current thread name.\n     */\n    THREAD_NAME: 'thread.name',\n    /**\n     * The method or function name, or equivalent (usually rightmost part of the code unit&#39;s name).\n     */\n    CODE_FUNCTION: 'code.function',\n    /**\n     * The &#34;namespace&#34; within which `code.function` is defined. Usually the qualified class or module name, such that `code.namespace` + some separator + `code.function` form a unique identifier for the code unit.\n     */\n    CODE_NAMESPACE: 'code.namespace',\n    /**\n     * The source code file name that identifies the code unit as uniquely as possible (preferably an absolute file path).\n     */\n    CODE_FILEPATH: 'code.filepath',\n    /**\n     * The line number in `code.filepath` best representing the operation. It SHOULD point within the code unit named in `code.function`.\n     */\n    CODE_LINENO: 'code.lineno',\n    /**\n     * HTTP request method.\n     */\n    HTTP_METHOD: 'http.method',\n    /**\n     * Full HTTP request URL in the form `scheme://host[:port]/path?query[#fragment]`. Usually the fragment is not transmitted over HTTP, but if it is known, it should be included nevertheless.\n     *\n     * Note: `http.url` MUST NOT contain credentials passed via URL in form of `https://username:password@www.example.com/`. In such case the attribute&#39;s value should be `https://www.example.com/`.\n     */\n    HTTP_URL: 'http.url',\n    /**\n     * The full request target as passed in a HTTP request line or equivalent.\n     */\n    HTTP_TARGET: 'http.target',\n    /**\n     * The value of the [HTTP host header](https://tools.ietf.org/html/rfc7230#section-5.4). An empty Host header should also be reported, see note.\n     *\n     * Note: When the header is present but empty the attribute SHOULD be set to the empty string. Note that this is a valid situation that is expected in certain cases, according the aforementioned [section of RFC 7230](https://tools.ietf.org/html/rfc7230#section-5.4). When the header is not set the attribute MUST NOT be set.\n     */\n    HTTP_HOST: 'http.host',\n    /**\n     * The URI scheme identifying the used protocol.\n     */\n    HTTP_SCHEME: 'http.scheme',\n    /**\n     * [HTTP response status code](https://tools.ietf.org/html/rfc7231#section-6).\n     */\n    HTTP_STATUS_CODE: 'http.status_code',\n    /**\n     * Kind of HTTP protocol used.\n     *\n     * Note: If `net.transport` is not specified, it can be assumed to be `IP.TCP` except if `http.flavor` is `QUIC`, in which case `IP.UDP` is assumed.\n     */\n    HTTP_FLAVOR: 'http.flavor',\n    /**\n     * Value of the [HTTP User-Agent](https://tools.ietf.org/html/rfc7231#section-5.5.3) header sent by the client.\n     */\n    HTTP_USER_AGENT: 'http.user_agent',\n    /**\n     * The size of the request payload body in bytes. This is the number of bytes transferred excluding headers and is often, but not always, present as the [Content-Length](https://tools.ietf.org/html/rfc7230#section-3.3.2) header. For requests using transport encoding, this should be the compressed size.\n     */\n    HTTP_REQUEST_CONTENT_LENGTH: 'http.request_content_length',\n    /**\n     * The size of the uncompressed request payload body after transport decoding. Not set if transport encoding not used.\n     */\n    HTTP_REQUEST_CONTENT_LENGTH_UNCOMPRESSED: 'http.request_content_length_uncompressed',\n    /**\n     * The size of the response payload body in bytes. This is the number of bytes transferred excluding headers and is often, but not always, present as the [Content-Length](https://tools.ietf.org/html/rfc7230#section-3.3.2) header. For requests using transport encoding, this should be the compressed size.\n     */\n    HTTP_RESPONSE_CONTENT_LENGTH: 'http.response_content_length',\n    /**\n     * The size of the uncompressed response payload body after transport decoding. Not set if transport encoding not used.\n     */\n    HTTP_RESPONSE_CONTENT_LENGTH_UNCOMPRESSED: 'http.response_content_length_uncompressed',\n    /**\n     * The primary server name of the matched virtual host. This should be obtained via configuration. If no such configuration can be obtained, this attribute MUST NOT be set ( `net.host.name` should be used instead).\n     *\n     * Note: `http.url` is usually not readily available on the server side but would have to be assembled in a cumbersome and sometimes lossy process from other information (see e.g. open-telemetry/opentelemetry-python/pull/148). It is thus preferred to supply the raw data that is available.\n     */\n    HTTP_SERVER_NAME: 'http.server_name',\n    /**\n     * The matched route (path template).\n     */\n    HTTP_ROUTE: 'http.route',\n    /**\n    * The IP address of the original client behind all proxies, if known (e.g. from [X-Forwarded-For](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Forwarded-For)).\n    *\n    * Note: This is not necessarily the same as `net.peer.ip`, which would\n  identify the network-level peer, which may be a proxy.\n  \n  This attribute should be set when a source of information different\n  from the one used for `net.peer.ip`, is available even if that other\n  source just confirms the same value as `net.peer.ip`.\n  Rationale: For `net.peer.ip`, one typically does not know if it\n  comes from a proxy, reverse proxy, or the actual client. Setting\n  `http.client_ip` when it&#39;s the same as `net.peer.ip` means that\n  one is at least somewhat confident that the address is not that of\n  the closest proxy.\n    */\n    HTTP_CLIENT_IP: 'http.client_ip',\n    /**\n     * The keys in the `RequestItems` object field.\n     */\n    AWS_DYNAMODB_TABLE_NAMES: 'aws.dynamodb.table_names',\n    /**\n     * The JSON-serialized value of each item in the `ConsumedCapacity` response field.\n     */\n    AWS_DYNAMODB_CONSUMED_CAPACITY: 'aws.dynamodb.consumed_capacity',\n    /**\n     * The JSON-serialized value of the `ItemCollectionMetrics` response field.\n     */\n    AWS_DYNAMODB_ITEM_COLLECTION_METRICS: 'aws.dynamodb.item_collection_metrics',\n    /**\n     * The value of the `ProvisionedThroughput.ReadCapacityUnits` request parameter.\n     */\n    AWS_DYNAMODB_PROVISIONED_READ_CAPACITY: 'aws.dynamodb.provisioned_read_capacity',\n    /**\n     * The value of the `ProvisionedThroughput.WriteCapacityUnits` request parameter.\n     */\n    AWS_DYNAMODB_PROVISIONED_WRITE_CAPACITY: 'aws.dynamodb.provisioned_write_capacity',\n    /**\n     * The value of the `ConsistentRead` request parameter.\n     */\n    AWS_DYNAMODB_CONSISTENT_READ: 'aws.dynamodb.consistent_read',\n    /**\n     * The value of the `ProjectionExpression` request parameter.\n     */\n    AWS_DYNAMODB_PROJECTION: 'aws.dynamodb.projection',\n    /**\n     * The value of the `Limit` request parameter.\n     */\n    AWS_DYNAMODB_LIMIT: 'aws.dynamodb.limit',\n    /**\n     * The value of the `AttributesToGet` request parameter.\n     */\n    AWS_DYNAMODB_ATTRIBUTES_TO_GET: 'aws.dynamodb.attributes_to_get',\n    /**\n     * The value of the `IndexName` request parameter.\n     */\n    AWS_DYNAMODB_INDEX_NAME: 'aws.dynamodb.index_name',\n    /**\n     * The value of the `Select` request parameter.\n     */\n    AWS_DYNAMODB_SELECT: 'aws.dynamodb.select',\n    /**\n     * The JSON-serialized value of each item of the `GlobalSecondaryIndexes` request field.\n     */\n    AWS_DYNAMODB_GLOBAL_SECONDARY_INDEXES: 'aws.dynamodb.global_secondary_indexes',\n    /**\n     * The JSON-serialized value of each item of the `LocalSecondaryIndexes` request field.\n     */\n    AWS_DYNAMODB_LOCAL_SECONDARY_INDEXES: 'aws.dynamodb.local_secondary_indexes',\n    /**\n     * The value of the `ExclusiveStartTableName` request parameter.\n     */\n    AWS_DYNAMODB_EXCLUSIVE_START_TABLE: 'aws.dynamodb.exclusive_start_table',\n    /**\n     * The the number of items in the `TableNames` response parameter.\n     */\n    AWS_DYNAMODB_TABLE_COUNT: 'aws.dynamodb.table_count',\n    /**\n     * The value of the `ScanIndexForward` request parameter.\n     */\n    AWS_DYNAMODB_SCAN_FORWARD: 'aws.dynamodb.scan_forward',\n    /**\n     * The value of the `Segment` request parameter.\n     */\n    AWS_DYNAMODB_SEGMENT: 'aws.dynamodb.segment',\n    /**\n     * The value of the `TotalSegments` request parameter.\n     */\n    AWS_DYNAMODB_TOTAL_SEGMENTS: 'aws.dynamodb.total_segments',\n    /**\n     * The value of the `Count` response parameter.\n     */\n    AWS_DYNAMODB_COUNT: 'aws.dynamodb.count',\n    /**\n     * The value of the `ScannedCount` response parameter.\n     */\n    AWS_DYNAMODB_SCANNED_COUNT: 'aws.dynamodb.scanned_count',\n    /**\n     * The JSON-serialized value of each item in the `AttributeDefinitions` request field.\n     */\n    AWS_DYNAMODB_ATTRIBUTE_DEFINITIONS: 'aws.dynamodb.attribute_definitions',\n    /**\n     * The JSON-serialized value of each item in the the `GlobalSecondaryIndexUpdates` request field.\n     */\n    AWS_DYNAMODB_GLOBAL_SECONDARY_INDEX_UPDATES: 'aws.dynamodb.global_secondary_index_updates',\n    /**\n     * A string identifying the messaging system.\n     */\n    MESSAGING_SYSTEM: 'messaging.system',\n    /**\n     * The message destination name. This might be equal to the span name but is required nevertheless.\n     */\n    MESSAGING_DESTINATION: 'messaging.destination',\n    /**\n     * The kind of message destination.\n     */\n    MESSAGING_DESTINATION_KIND: 'messaging.destination_kind',\n    /**\n     * A boolean that is true if the message destination is temporary.\n     */\n    MESSAGING_TEMP_DESTINATION: 'messaging.temp_destination',\n    /**\n     * The name of the transport protocol.\n     */\n    MESSAGING_PROTOCOL: 'messaging.protocol',\n    /**\n     * The version of the transport protocol.\n     */\n    MESSAGING_PROTOCOL_VERSION: 'messaging.protocol_version',\n    /**\n     * Connection string.\n     */\n    MESSAGING_URL: 'messaging.url',\n    /**\n     * A value used by the messaging system as an identifier for the message, represented as a string.\n     */\n    MESSAGING_MESSAGE_ID: 'messaging.message_id',\n    /**\n     * The [conversation ID](#conversations) identifying the conversation to which the message belongs, represented as a string. Sometimes called &#34;Correlation ID&#34;.\n     */\n    MESSAGING_CONVERSATION_ID: 'messaging.conversation_id',\n    /**\n     * The (uncompressed) size of the message payload in bytes. Also use this attribute if it is unknown whether the compressed or uncompressed payload size is reported.\n     */\n    MESSAGING_MESSAGE_PAYLOAD_SIZE_BYTES: 'messaging.message_payload_size_bytes',\n    /**\n     * The compressed size of the message payload in bytes.\n     */\n    MESSAGING_MESSAGE_PAYLOAD_COMPRESSED_SIZE_BYTES: 'messaging.message_payload_compressed_size_bytes',\n    /**\n     * A string identifying the kind of message consumption as defined in the [Operation names](#operation-names) section above. If the operation is &#34;send&#34;, this attribute MUST NOT be set, since the operation can be inferred from the span kind in that case.\n     */\n    MESSAGING_OPERATION: 'messaging.operation',\n    /**\n     * The identifier for the consumer receiving a message. For Kafka, set it to `{messaging.kafka.consumer_group} - {messaging.kafka.client_id}`, if both are present, or only `messaging.kafka.consumer_group`. For brokers, such as RabbitMQ and Artemis, set it to the `client_id` of the client consuming the message.\n     */\n    MESSAGING_CONSUMER_ID: 'messaging.consumer_id',\n    /**\n     * RabbitMQ message routing key.\n     */\n    MESSAGING_RABBITMQ_ROUTING_KEY: 'messaging.rabbitmq.routing_key',\n    /**\n     * Message keys in Kafka are used for grouping alike messages to ensure they&#39;re processed on the same partition. They differ from `messaging.message_id` in that they&#39;re not unique. If the key is `null`, the attribute MUST NOT be set.\n     *\n     * Note: If the key type is not string, it&#39;s string representation has to be supplied for the attribute. If the key has no unambiguous, canonical string form, don&#39;t include its value.\n     */\n    MESSAGING_KAFKA_MESSAGE_KEY: 'messaging.kafka.message_key',\n    /**\n     * Name of the Kafka Consumer Group that is handling the message. Only applies to consumers, not producers.\n     */\n    MESSAGING_KAFKA_CONSUMER_GROUP: 'messaging.kafka.consumer_group',\n    /**\n     * Client Id for the Consumer or Producer that is handling the message.\n     */\n    MESSAGING_KAFKA_CLIENT_ID: 'messaging.kafka.client_id',\n    /**\n     * Partition the message is sent to.\n     */\n    MESSAGING_KAFKA_PARTITION: 'messaging.kafka.partition',\n    /**\n     * A boolean that is true if the message is a tombstone.\n     */\n    MESSAGING_KAFKA_TOMBSTONE: 'messaging.kafka.tombstone',\n    /**\n     * A string identifying the remoting system.\n     */\n    RPC_SYSTEM: 'rpc.system',\n    /**\n     * The full (logical) name of the service being called, including its package name, if applicable.\n     *\n     * Note: This is the logical name of the service from the RPC interface perspective, which can be different from the name of any implementing class. The `code.namespace` attribute may be used to store the latter (despite the attribute name, it may include a class name; e.g., class with method actually executing the call on the server side, RPC client stub class on the client side).\n     */\n    RPC_SERVICE: 'rpc.service',\n    /**\n     * The name of the (logical) method being called, must be equal to the $method part in the span name.\n     *\n     * Note: This is the logical name of the method from the RPC interface perspective, which can be different from the name of any implementing method/function. The `code.function` attribute may be used to store the latter (e.g., method actually executing the call on the server side, RPC client stub method on the client side).\n     */\n    RPC_METHOD: 'rpc.method',\n    /**\n     * The [numeric status code](https://github.com/grpc/grpc/blob/v1.33.2/doc/statuscodes.md) of the gRPC request.\n     */\n    RPC_GRPC_STATUS_CODE: 'rpc.grpc.status_code',\n    /**\n     * Protocol version as in `jsonrpc` property of request/response. Since JSON-RPC 1.0 does not specify this, the value can be omitted.\n     */\n    RPC_JSONRPC_VERSION: 'rpc.jsonrpc.version',\n    /**\n     * `id` property of request or response. Since protocol allows id to be int, string, `null` or missing (for notifications), value is expected to be cast to string for simplicity. Use empty string in case of `null` value. Omit entirely if this is a notification.\n     */\n    RPC_JSONRPC_REQUEST_ID: 'rpc.jsonrpc.request_id',\n    /**\n     * `error.code` property of response if it is an error response.\n     */\n    RPC_JSONRPC_ERROR_CODE: 'rpc.jsonrpc.error_code',\n    /**\n     * `error.message` property of response if it is an error response.\n     */\n    RPC_JSONRPC_ERROR_MESSAGE: 'rpc.jsonrpc.error_message',\n    /**\n     * Whether this is a received or sent message.\n     */\n    MESSAGE_TYPE: 'message.type',\n    /**\n     * MUST be calculated as two different counters starting from `1` one for sent messages and one for received message.\n     *\n     * Note: This way we guarantee that the values will be consistent between different implementations.\n     */\n    MESSAGE_ID: 'message.id',\n    /**\n     * Compressed size of the message in bytes.\n     */\n    MESSAGE_COMPRESSED_SIZE: 'message.compressed_size',\n    /**\n     * Uncompressed size of the message in bytes.\n     */\n    MESSAGE_UNCOMPRESSED_SIZE: 'message.uncompressed_size',\n};\nexport var DbSystemValues = {\n    /** Some other SQL database. Fallback only. See notes. */\n    OTHER_SQL: 'other_sql',\n    /** Microsoft SQL Server. */\n    MSSQL: 'mssql',\n    /** MySQL. */\n    MYSQL: 'mysql',\n    /** Oracle Database. */\n    ORACLE: 'oracle',\n    /** IBM Db2. */\n    DB2: 'db2',\n    /** PostgreSQL. */\n    POSTGRESQL: 'postgresql',\n    /** Amazon Redshift. */\n    REDSHIFT: 'redshift',\n    /** Apache Hive. */\n    HIVE: 'hive',\n    /** Cloudscape. */\n    CLOUDSCAPE: 'cloudscape',\n    /** HyperSQL DataBase. */\n    HSQLDB: 'hsqldb',\n    /** Progress Database. */\n    PROGRESS: 'progress',\n    /** SAP MaxDB. */\n    MAXDB: 'maxdb',\n    /** SAP HANA. */\n    HANADB: 'hanadb',\n    /** Ingres. */\n    INGRES: 'ingres',\n    /** FirstSQL. */\n    FIRSTSQL: 'firstsql',\n    /** EnterpriseDB. */\n    EDB: 'edb',\n    /** InterSystems Caché. */\n    CACHE: 'cache',\n    /** Adabas (Adaptable Database System). */\n    ADABAS: 'adabas',\n    /** Firebird. */\n    FIREBIRD: 'firebird',\n    /** Apache Derby. */\n    DERBY: 'derby',\n    /** FileMaker. */\n    FILEMAKER: 'filemaker',\n    /** Informix. */\n    INFORMIX: 'informix',\n    /** InstantDB. */\n    INSTANTDB: 'instantdb',\n    /** InterBase. */\n    INTERBASE: 'interbase',\n    /** MariaDB. */\n    MARIADB: 'mariadb',\n    /** Netezza. */\n    NETEZZA: 'netezza',\n    /** Pervasive PSQL. */\n    PERVASIVE: 'pervasive',\n    /** PointBase. */\n    POINTBASE: 'pointbase',\n    /** SQLite. */\n    SQLITE: 'sqlite',\n    /** Sybase. */\n    SYBASE: 'sybase',\n    /** Teradata. */\n    TERADATA: 'teradata',\n    /** Vertica. */\n    VERTICA: 'vertica',\n    /** H2. */\n    H2: 'h2',\n    /** ColdFusion IMQ. */\n    COLDFUSION: 'coldfusion',\n    /** Apache Cassandra. */\n    CASSANDRA: 'cassandra',\n    /** Apache HBase. */\n    HBASE: 'hbase',\n    /** MongoDB. */\n    MONGODB: 'mongodb',\n    /** Redis. */\n    REDIS: 'redis',\n    /** Couchbase. */\n    COUCHBASE: 'couchbase',\n    /** CouchDB. */\n    COUCHDB: 'couchdb',\n    /** Microsoft Azure Cosmos DB. */\n    COSMOSDB: 'cosmosdb',\n    /** Amazon DynamoDB. */\n    DYNAMODB: 'dynamodb',\n    /** Neo4j. */\n    NEO4J: 'neo4j',\n    /** Apache Geode. */\n    GEODE: 'geode',\n    /** Elasticsearch. */\n    ELASTICSEARCH: 'elasticsearch',\n    /** Memcached. */\n    MEMCACHED: 'memcached',\n    /** CockroachDB. */\n    COCKROACHDB: 'cockroachdb',\n};\nexport var DbCassandraConsistencyLevelValues = {\n    /** all. */\n    ALL: 'all',\n    /** each_quorum. */\n    EACH_QUORUM: 'each_quorum',\n    /** quorum. */\n    QUORUM: 'quorum',\n    /** local_quorum. */\n    LOCAL_QUORUM: 'local_quorum',\n    /** one. */\n    ONE: 'one',\n    /** two. */\n    TWO: 'two',\n    /** three. */\n    THREE: 'three',\n    /** local_one. */\n    LOCAL_ONE: 'local_one',\n    /** any. */\n    ANY: 'any',\n    /** serial. */\n    SERIAL: 'serial',\n    /** local_serial. */\n    LOCAL_SERIAL: 'local_serial',\n};\nexport var FaasTriggerValues = {\n    /** A response to some data source operation such as a database or filesystem read/write. */\n    DATASOURCE: 'datasource',\n    /** To provide an answer to an inbound HTTP request. */\n    HTTP: 'http',\n    /** A function is set to be executed when messages are sent to a messaging system. */\n    PUBSUB: 'pubsub',\n    /** A function is scheduled to be executed regularly. */\n    TIMER: 'timer',\n    /** If none of the others apply. */\n    OTHER: 'other',\n};\nexport var FaasDocumentOperationValues = {\n    /** When a new object is created. */\n    INSERT: 'insert',\n    /** When an object is modified. */\n    EDIT: 'edit',\n    /** When an object is deleted. */\n    DELETE: 'delete',\n};\nexport var FaasInvokedProviderValues = {\n    /** Alibaba Cloud. */\n    ALIBABA_CLOUD: 'alibaba_cloud',\n    /** Amazon Web Services. */\n    AWS: 'aws',\n    /** Microsoft Azure. */\n    AZURE: 'azure',\n    /** Google Cloud Platform. */\n    GCP: 'gcp',\n};\nexport var NetTransportValues = {\n    /** ip_tcp. */\n    IP_TCP: 'ip_tcp',\n    /** ip_udp. */\n    IP_UDP: 'ip_udp',\n    /** Another IP-based protocol. */\n    IP: 'ip',\n    /** Unix Domain socket. See below. */\n    UNIX: 'unix',\n    /** Named or anonymous pipe. See note below. */\n    PIPE: 'pipe',\n    /** In-process communication. */\n    INPROC: 'inproc',\n    /** Something else (non IP-based). */\n    OTHER: 'other',\n};\nexport var NetHostConnectionTypeValues = {\n    /** wifi. */\n    WIFI: 'wifi',\n    /** wired. */\n    WIRED: 'wired',\n    /** cell. */\n    CELL: 'cell',\n    /** unavailable. */\n    UNAVAILABLE: 'unavailable',\n    /** unknown. */\n    UNKNOWN: 'unknown',\n};\nexport var NetHostConnectionSubtypeValues = {\n    /** GPRS. */\n    GPRS: 'gprs',\n    /** EDGE. */\n    EDGE: 'edge',\n    /** UMTS. */\n    UMTS: 'umts',\n    /** CDMA. */\n    CDMA: 'cdma',\n    /** EVDO Rel. 0. */\n    EVDO_0: 'evdo_0',\n    /** EVDO Rev. A. */\n    EVDO_A: 'evdo_a',\n    /** CDMA2000 1XRTT. */\n    CDMA2000_1XRTT: 'cdma2000_1xrtt',\n    /** HSDPA. */\n    HSDPA: 'hsdpa',\n    /** HSUPA. */\n    HSUPA: 'hsupa',\n    /** HSPA. */\n    HSPA: 'hspa',\n    /** IDEN. */\n    IDEN: 'iden',\n    /** EVDO Rev. B. */\n    EVDO_B: 'evdo_b',\n    /** LTE. */\n    LTE: 'lte',\n    /** EHRPD. */\n    EHRPD: 'ehrpd',\n    /** HSPAP. */\n    HSPAP: 'hspap',\n    /** GSM. */\n    GSM: 'gsm',\n    /** TD-SCDMA. */\n    TD_SCDMA: 'td_scdma',\n    /** IWLAN. */\n    IWLAN: 'iwlan',\n    /** 5G NR (New Radio). */\n    NR: 'nr',\n    /** 5G NRNSA (New Radio Non-Standalone). */\n    NRNSA: 'nrnsa',\n    /** LTE CA. */\n    LTE_CA: 'lte_ca',\n};\nexport var HttpFlavorValues = {\n    /** HTTP 1.0. */\n    HTTP_1_0: '1.0',\n    /** HTTP 1.1. */\n    HTTP_1_1: '1.1',\n    /** HTTP 2. */\n    HTTP_2_0: '2.0',\n    /** SPDY protocol. */\n    SPDY: 'SPDY',\n    /** QUIC protocol. */\n    QUIC: 'QUIC',\n};\nexport var MessagingDestinationKindValues = {\n    /** A message sent to a queue. */\n    QUEUE: 'queue',\n    /** A message sent to a topic. */\n    TOPIC: 'topic',\n};\nexport var MessagingOperationValues = {\n    /** receive. */\n    RECEIVE: 'receive',\n    /** process. */\n    PROCESS: 'process',\n};\nexport var RpcGrpcStatusCodeValues = {\n    /** OK. */\n    OK: 0,\n    /** CANCELLED. */\n    CANCELLED: 1,\n    /** UNKNOWN. */\n    UNKNOWN: 2,\n    /** INVALID_ARGUMENT. */\n    INVALID_ARGUMENT: 3,\n    /** DEADLINE_EXCEEDED. */\n    DEADLINE_EXCEEDED: 4,\n    /** NOT_FOUND. */\n    NOT_FOUND: 5,\n    /** ALREADY_EXISTS. */\n    ALREADY_EXISTS: 6,\n    /** PERMISSION_DENIED. */\n    PERMISSION_DENIED: 7,\n    /** RESOURCE_EXHAUSTED. */\n    RESOURCE_EXHAUSTED: 8,\n    /** FAILED_PRECONDITION. */\n    FAILED_PRECONDITION: 9,\n    /** ABORTED. */\n    ABORTED: 10,\n    /** OUT_OF_RANGE. */\n    OUT_OF_RANGE: 11,\n    /** UNIMPLEMENTED. */\n    UNIMPLEMENTED: 12,\n    /** INTERNAL. */\n    INTERNAL: 13,\n    /** UNAVAILABLE. */\n    UNAVAILABLE: 14,\n    /** DATA_LOSS. */\n    DATA_LOSS: 15,\n    /** UNAUTHENTICATED. */\n    UNAUTHENTICATED: 16,\n};\nexport var MessageTypeValues = {\n    /** sent. */\n    SENT: 'SENT',\n    /** received. */\n    RECEIVED: 'RECEIVED',\n};\n//# sourceMappingURL=SemanticAttributes.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * A sampling decision that determines how a {@link Span} will be recorded\n * and collected.\n */\nexport var SamplingDecision;\n(function (SamplingDecision) {\n    /**\n     * `Span.isRecording() === false`, span will not be recorded and all events\n     * and attributes will be dropped.\n     */\n    SamplingDecision[SamplingDecision[\"NOT_RECORD\"] = 0] = \"NOT_RECORD\";\n    /**\n     * `Span.isRecording() === true`, but `Sampled` flag in {@link TraceFlags}\n     * MUST NOT be set.\n     */\n    SamplingDecision[SamplingDecision[\"RECORD\"] = 1] = \"RECORD\";\n    /**\n     * `Span.isRecording() === true` AND `Sampled` flag in {@link TraceFlags}\n     * MUST be set.\n     */\n    SamplingDecision[SamplingDecision[\"RECORD_AND_SAMPLED\"] = 2] = \"RECORD_AND_SAMPLED\";\n})(SamplingDecision || (SamplingDecision = {}));\n//# sourceMappingURL=Sampler.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __values = (this && this.__values) || function(o) {\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n    if (m) return m.call(o);\n    if (o && typeof o.length === \"number\") return {\n        next: function () {\n            if (o && i >= o.length) o = void 0;\n            return { value: o && o[i++], done: !o };\n        }\n    };\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nimport { diag, SpanStatusCode, } from '@opentelemetry/api';\nimport { addHrTimes, millisToHrTime, getTimeOrigin, hrTime, hrTimeDuration, isAttributeValue, isTimeInput, isTimeInputHrTime, otperformance, sanitizeAttributes, } from '@opentelemetry/core';\nimport { SemanticAttributes } from '@opentelemetry/semantic-conventions';\nimport { ExceptionEventName } from './enums';\n/**\n * This class represents a span.\n */\nvar Span = /** @class */ (function () {\n    /**\n     * Constructs a new Span instance.\n     *\n     * @deprecated calling Span constructor directly is not supported. Please use tracer.startSpan.\n     * */\n    function Span(parentTracer, context, spanName, spanContext, kind, parentSpanId, links, startTime, _deprecatedClock // keeping this argument even though it is unused to ensure backwards compatibility\n    ) {\n        if (links === void 0) { links = []; }\n        this.attributes = {};\n        this.links = [];\n        this.events = [];\n        this._droppedAttributesCount = 0;\n        this._droppedEventsCount = 0;\n        this._droppedLinksCount = 0;\n        this.status = {\n            code: SpanStatusCode.UNSET,\n        };\n        this.endTime = [0, 0];\n        this._ended = false;\n        this._duration = [-1, -1];\n        this.name = spanName;\n        this._spanContext = spanContext;\n        this.parentSpanId = parentSpanId;\n        this.kind = kind;\n        this.links = links;\n        var now = Date.now();\n        this._performanceStartTime = otperformance.now();\n        this._performanceOffset =\n            now - (this._performanceStartTime + getTimeOrigin());\n        this._startTimeProvided = startTime != null;\n        this.startTime = this._getTime(startTime !== null && startTime !== void 0 ? startTime : now);\n        this.resource = parentTracer.resource;\n        this.instrumentationLibrary = parentTracer.instrumentationLibrary;\n        this._spanLimits = parentTracer.getSpanLimits();\n        this._spanProcessor = parentTracer.getActiveSpanProcessor();\n        this._spanProcessor.onStart(this, context);\n        this._attributeValueLengthLimit =\n            this._spanLimits.attributeValueLengthLimit || 0;\n    }\n    Span.prototype.spanContext = function () {\n        return this._spanContext;\n    };\n    Span.prototype.setAttribute = function (key, value) {\n        if (value == null || this._isSpanEnded())\n            return this;\n        if (key.length === 0) {\n            diag.warn(\"Invalid attribute key: \" + key);\n            return this;\n        }\n        if (!isAttributeValue(value)) {\n            diag.warn(\"Invalid attribute value set for key: \" + key);\n            return this;\n        }\n        if (Object.keys(this.attributes).length >=\n            this._spanLimits.attributeCountLimit &&\n            !Object.prototype.hasOwnProperty.call(this.attributes, key)) {\n            this._droppedAttributesCount++;\n            return this;\n        }\n        this.attributes[key] = this._truncateToSize(value);\n        return this;\n    };\n    Span.prototype.setAttributes = function (attributes) {\n        var e_1, _a;\n        try {\n            for (var _b = __values(Object.entries(attributes)), _c = _b.next(); !_c.done; _c = _b.next()) {\n                var _d = __read(_c.value, 2), k = _d[0], v = _d[1];\n                this.setAttribute(k, v);\n            }\n        }\n        catch (e_1_1) { e_1 = { error: e_1_1 }; }\n        finally {\n            try {\n                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n            }\n            finally { if (e_1) throw e_1.error; }\n        }\n        return this;\n    };\n    /**\n     *\n     * @param name Span Name\n     * @param [attributesOrStartTime] Span attributes or start time\n     *     if type is {@type TimeInput} and 3rd param is undefined\n     * @param [timeStamp] Specified time stamp for the event\n     */\n    Span.prototype.addEvent = function (name, attributesOrStartTime, timeStamp) {\n        if (this._isSpanEnded())\n            return this;\n        if (this._spanLimits.eventCountLimit === 0) {\n            diag.warn('No events allowed.');\n            this._droppedEventsCount++;\n            return this;\n        }\n        if (this.events.length >= this._spanLimits.eventCountLimit) {\n            diag.warn('Dropping extra events.');\n            this.events.shift();\n            this._droppedEventsCount++;\n        }\n        if (isTimeInput(attributesOrStartTime)) {\n            if (!isTimeInput(timeStamp)) {\n                timeStamp = attributesOrStartTime;\n            }\n            attributesOrStartTime = undefined;\n        }\n        var attributes = sanitizeAttributes(attributesOrStartTime);\n        this.events.push({\n            name: name,\n            attributes: attributes,\n            time: this._getTime(timeStamp),\n            droppedAttributesCount: 0,\n        });\n        return this;\n    };\n    Span.prototype.setStatus = function (status) {\n        if (this._isSpanEnded())\n            return this;\n        this.status = status;\n        return this;\n    };\n    Span.prototype.updateName = function (name) {\n        if (this._isSpanEnded())\n            return this;\n        this.name = name;\n        return this;\n    };\n    Span.prototype.end = function (endTime) {\n        if (this._isSpanEnded()) {\n            diag.error(this.name + \" \" + this._spanContext.traceId + \"-\" + this._spanContext.spanId + \" - You can only call end() on a span once.\");\n            return;\n        }\n        this._ended = true;\n        this.endTime = this._getTime(endTime);\n        this._duration = hrTimeDuration(this.startTime, this.endTime);\n        if (this._duration[0] < 0) {\n            diag.warn('Inconsistent start and end time, startTime > endTime. Setting span duration to 0ms.', this.startTime, this.endTime);\n            this.endTime = this.startTime.slice();\n            this._duration = [0, 0];\n        }\n        this._spanProcessor.onEnd(this);\n    };\n    Span.prototype._getTime = function (inp) {\n        if (typeof inp === 'number' && inp < otperformance.now()) {\n            // must be a performance timestamp\n            // apply correction and convert to hrtime\n            return hrTime(inp + this._performanceOffset);\n        }\n        if (typeof inp === 'number') {\n            return millisToHrTime(inp);\n        }\n        if (inp instanceof Date) {\n            return millisToHrTime(inp.getTime());\n        }\n        if (isTimeInputHrTime(inp)) {\n            return inp;\n        }\n        if (this._startTimeProvided) {\n            // if user provided a time for the start manually\n            // we can't use duration to calculate event/end times\n            return millisToHrTime(Date.now());\n        }\n        var msDuration = otperformance.now() - this._performanceStartTime;\n        return addHrTimes(this.startTime, millisToHrTime(msDuration));\n    };\n    Span.prototype.isRecording = function () {\n        return this._ended === false;\n    };\n    Span.prototype.recordException = function (exception, time) {\n        var attributes = {};\n        if (typeof exception === 'string') {\n            attributes[SemanticAttributes.EXCEPTION_MESSAGE] = exception;\n        }\n        else if (exception) {\n            if (exception.code) {\n                attributes[SemanticAttributes.EXCEPTION_TYPE] =\n                    exception.code.toString();\n            }\n            else if (exception.name) {\n                attributes[SemanticAttributes.EXCEPTION_TYPE] = exception.name;\n            }\n            if (exception.message) {\n                attributes[SemanticAttributes.EXCEPTION_MESSAGE] = exception.message;\n            }\n            if (exception.stack) {\n                attributes[SemanticAttributes.EXCEPTION_STACKTRACE] = exception.stack;\n            }\n        }\n        // these are minimum requirements from spec\n        if (attributes[SemanticAttributes.EXCEPTION_TYPE] ||\n            attributes[SemanticAttributes.EXCEPTION_MESSAGE]) {\n            this.addEvent(ExceptionEventName, attributes, time);\n        }\n        else {\n            diag.warn(\"Failed to record an exception \" + exception);\n        }\n    };\n    Object.defineProperty(Span.prototype, \"duration\", {\n        get: function () {\n            return this._duration;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Span.prototype, \"ended\", {\n        get: function () {\n            return this._ended;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Span.prototype, \"droppedAttributesCount\", {\n        get: function () {\n            return this._droppedAttributesCount;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Span.prototype, \"droppedEventsCount\", {\n        get: function () {\n            return this._droppedEventsCount;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Span.prototype, \"droppedLinksCount\", {\n        get: function () {\n            return this._droppedLinksCount;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Span.prototype._isSpanEnded = function () {\n        if (this._ended) {\n            diag.warn(\"Can not execute the operation on ended Span {traceId: \" + this._spanContext.traceId + \", spanId: \" + this._spanContext.spanId + \"}\");\n        }\n        return this._ended;\n    };\n    // Utility function to truncate given value within size\n    // for value type of string, will truncate to given limit\n    // for type of non-string, will return same value\n    Span.prototype._truncateToLimitUtil = function (value, limit) {\n        if (value.length <= limit) {\n            return value;\n        }\n        return value.substr(0, limit);\n    };\n    /**\n     * If the given attribute value is of type string and has more characters than given {@code attributeValueLengthLimit} then\n     * return string with trucated to {@code attributeValueLengthLimit} characters\n     *\n     * If the given attribute value is array of strings then\n     * return new array of strings with each element truncated to {@code attributeValueLengthLimit} characters\n     *\n     * Otherwise return same Attribute {@code value}\n     *\n     * @param value Attribute value\n     * @returns truncated attribute value if required, otherwise same value\n     */\n    Span.prototype._truncateToSize = function (value) {\n        var _this = this;\n        var limit = this._attributeValueLengthLimit;\n        // Check limit\n        if (limit <= 0) {\n            // Negative values are invalid, so do not truncate\n            diag.warn(\"Attribute value limit must be positive, got \" + limit);\n            return value;\n        }\n        // String\n        if (typeof value === 'string') {\n            return this._truncateToLimitUtil(value, limit);\n        }\n        // Array of strings\n        if (Array.isArray(value)) {\n            return value.map(function (val) {\n                return typeof val === 'string' ? _this._truncateToLimitUtil(val, limit) : val;\n            });\n        }\n        // Other types, no need to apply value length limit\n        return value;\n    };\n    return Span;\n}());\nexport { Span };\n//# sourceMappingURL=Span.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n// Event name definitions\nexport var ExceptionEventName = 'exception';\n//# sourceMappingURL=enums.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { SamplingDecision } from '../Sampler';\n/** Sampler that samples no traces. */\nvar AlwaysOffSampler = /** @class */ (function () {\n    function AlwaysOffSampler() {\n    }\n    AlwaysOffSampler.prototype.shouldSample = function () {\n        return {\n            decision: SamplingDecision.NOT_RECORD,\n        };\n    };\n    AlwaysOffSampler.prototype.toString = function () {\n        return 'AlwaysOffSampler';\n    };\n    return AlwaysOffSampler;\n}());\nexport { AlwaysOffSampler };\n//# sourceMappingURL=AlwaysOffSampler.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { SamplingDecision } from '../Sampler';\n/** Sampler that samples all traces. */\nvar AlwaysOnSampler = /** @class */ (function () {\n    function AlwaysOnSampler() {\n    }\n    AlwaysOnSampler.prototype.shouldSample = function () {\n        return {\n            decision: SamplingDecision.RECORD_AND_SAMPLED,\n        };\n    };\n    AlwaysOnSampler.prototype.toString = function () {\n        return 'AlwaysOnSampler';\n    };\n    return AlwaysOnSampler;\n}());\nexport { AlwaysOnSampler };\n//# sourceMappingURL=AlwaysOnSampler.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { isSpanContextValid, TraceFlags, trace, } from '@opentelemetry/api';\nimport { globalErrorHandler } from '@opentelemetry/core';\nimport { AlwaysOffSampler } from './AlwaysOffSampler';\nimport { AlwaysOnSampler } from './AlwaysOnSampler';\n/**\n * A composite sampler that either respects the parent span's sampling decision\n * or delegates to `delegateSampler` for root spans.\n */\nvar ParentBasedSampler = /** @class */ (function () {\n    function ParentBasedSampler(config) {\n        var _a, _b, _c, _d;\n        this._root = config.root;\n        if (!this._root) {\n            globalErrorHandler(new Error('ParentBasedSampler must have a root sampler configured'));\n            this._root = new AlwaysOnSampler();\n        }\n        this._remoteParentSampled =\n            (_a = config.remoteParentSampled) !== null && _a !== void 0 ? _a : new AlwaysOnSampler();\n        this._remoteParentNotSampled =\n            (_b = config.remoteParentNotSampled) !== null && _b !== void 0 ? _b : new AlwaysOffSampler();\n        this._localParentSampled =\n            (_c = config.localParentSampled) !== null && _c !== void 0 ? _c : new AlwaysOnSampler();\n        this._localParentNotSampled =\n            (_d = config.localParentNotSampled) !== null && _d !== void 0 ? _d : new AlwaysOffSampler();\n    }\n    ParentBasedSampler.prototype.shouldSample = function (context, traceId, spanName, spanKind, attributes, links) {\n        var parentContext = trace.getSpanContext(context);\n        if (!parentContext || !isSpanContextValid(parentContext)) {\n            return this._root.shouldSample(context, traceId, spanName, spanKind, attributes, links);\n        }\n        if (parentContext.isRemote) {\n            if (parentContext.traceFlags & TraceFlags.SAMPLED) {\n                return this._remoteParentSampled.shouldSample(context, traceId, spanName, spanKind, attributes, links);\n            }\n            return this._remoteParentNotSampled.shouldSample(context, traceId, spanName, spanKind, attributes, links);\n        }\n        if (parentContext.traceFlags & TraceFlags.SAMPLED) {\n            return this._localParentSampled.shouldSample(context, traceId, spanName, spanKind, attributes, links);\n        }\n        return this._localParentNotSampled.shouldSample(context, traceId, spanName, spanKind, attributes, links);\n    };\n    ParentBasedSampler.prototype.toString = function () {\n        return \"ParentBased{root=\" + this._root.toString() + \", remoteParentSampled=\" + this._remoteParentSampled.toString() + \", remoteParentNotSampled=\" + this._remoteParentNotSampled.toString() + \", localParentSampled=\" + this._localParentSampled.toString() + \", localParentNotSampled=\" + this._localParentNotSampled.toString() + \"}\";\n    };\n    return ParentBasedSampler;\n}());\nexport { ParentBasedSampler };\n//# sourceMappingURL=ParentBasedSampler.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { isValidTraceId } from '@opentelemetry/api';\nimport { SamplingDecision } from '../Sampler';\n/** Sampler that samples a given fraction of traces based of trace id deterministically. */\nvar TraceIdRatioBasedSampler = /** @class */ (function () {\n    function TraceIdRatioBasedSampler(_ratio) {\n        if (_ratio === void 0) { _ratio = 0; }\n        this._ratio = _ratio;\n        this._ratio = this._normalize(_ratio);\n        this._upperBound = Math.floor(this._ratio * 0xffffffff);\n    }\n    TraceIdRatioBasedSampler.prototype.shouldSample = function (context, traceId) {\n        return {\n            decision: isValidTraceId(traceId) && this._accumulate(traceId) < this._upperBound\n                ? SamplingDecision.RECORD_AND_SAMPLED\n                : SamplingDecision.NOT_RECORD,\n        };\n    };\n    TraceIdRatioBasedSampler.prototype.toString = function () {\n        return \"TraceIdRatioBased{\" + this._ratio + \"}\";\n    };\n    TraceIdRatioBasedSampler.prototype._normalize = function (ratio) {\n        if (typeof ratio !== 'number' || isNaN(ratio))\n            return 0;\n        return ratio >= 1 ? 1 : ratio <= 0 ? 0 : ratio;\n    };\n    TraceIdRatioBasedSampler.prototype._accumulate = function (traceId) {\n        var accumulation = 0;\n        for (var i = 0; i < traceId.length / 8; i++) {\n            var pos = i * 8;\n            var part = parseInt(traceId.slice(pos, pos + 8), 16);\n            accumulation = (accumulation ^ part) >>> 0;\n        }\n        return accumulation;\n    };\n    return TraceIdRatioBasedSampler;\n}());\nexport { TraceIdRatioBasedSampler };\n//# sourceMappingURL=TraceIdRatioBasedSampler.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { diag } from '@opentelemetry/api';\nimport { getEnv, TracesSamplerValues } from '@opentelemetry/core';\nimport { AlwaysOffSampler } from './sampler/AlwaysOffSampler';\nimport { AlwaysOnSampler } from './sampler/AlwaysOnSampler';\nimport { ParentBasedSampler } from './sampler/ParentBasedSampler';\nimport { TraceIdRatioBasedSampler } from './sampler/TraceIdRatioBasedSampler';\nvar env = getEnv();\nvar FALLBACK_OTEL_TRACES_SAMPLER = TracesSamplerValues.AlwaysOn;\nvar DEFAULT_RATIO = 1;\n/**\n * Load default configuration. For fields with primitive values, any user-provided\n * value will override the corresponding default value. For fields with\n * non-primitive values (like `spanLimits`), the user-provided value will be\n * used to extend the default value.\n */\n// object needs to be wrapped in this function and called when needed otherwise\n// envs are parsed before tests are ran - causes tests using these envs to fail\nexport function loadDefaultConfig() {\n    return {\n        sampler: buildSamplerFromEnv(env),\n        forceFlushTimeoutMillis: 30000,\n        generalLimits: {\n            attributeValueLengthLimit: getEnv().OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT,\n            attributeCountLimit: getEnv().OTEL_ATTRIBUTE_COUNT_LIMIT,\n        },\n        spanLimits: {\n            attributeValueLengthLimit: getEnv().OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT,\n            attributeCountLimit: getEnv().OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT,\n            linkCountLimit: getEnv().OTEL_SPAN_LINK_COUNT_LIMIT,\n            eventCountLimit: getEnv().OTEL_SPAN_EVENT_COUNT_LIMIT,\n            attributePerEventCountLimit: getEnv().OTEL_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT,\n            attributePerLinkCountLimit: getEnv().OTEL_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT,\n        },\n    };\n}\n/**\n * Based on environment, builds a sampler, complies with specification.\n * @param environment optional, by default uses getEnv(), but allows passing a value to reuse parsed environment\n */\nexport function buildSamplerFromEnv(environment) {\n    if (environment === void 0) { environment = getEnv(); }\n    switch (environment.OTEL_TRACES_SAMPLER) {\n        case TracesSamplerValues.AlwaysOn:\n            return new AlwaysOnSampler();\n        case TracesSamplerValues.AlwaysOff:\n            return new AlwaysOffSampler();\n        case TracesSamplerValues.ParentBasedAlwaysOn:\n            return new ParentBasedSampler({\n                root: new AlwaysOnSampler(),\n            });\n        case TracesSamplerValues.ParentBasedAlwaysOff:\n            return new ParentBasedSampler({\n                root: new AlwaysOffSampler(),\n            });\n        case TracesSamplerValues.TraceIdRatio:\n            return new TraceIdRatioBasedSampler(getSamplerProbabilityFromEnv(environment));\n        case TracesSamplerValues.ParentBasedTraceIdRatio:\n            return new ParentBasedSampler({\n                root: new TraceIdRatioBasedSampler(getSamplerProbabilityFromEnv(environment)),\n            });\n        default:\n            diag.error(\"OTEL_TRACES_SAMPLER value \\\"\" + environment.OTEL_TRACES_SAMPLER + \" invalid, defaulting to \" + FALLBACK_OTEL_TRACES_SAMPLER + \"\\\".\");\n            return new AlwaysOnSampler();\n    }\n}\nfunction getSamplerProbabilityFromEnv(environment) {\n    if (environment.OTEL_TRACES_SAMPLER_ARG === undefined ||\n        environment.OTEL_TRACES_SAMPLER_ARG === '') {\n        diag.error(\"OTEL_TRACES_SAMPLER_ARG is blank, defaulting to \" + DEFAULT_RATIO + \".\");\n        return DEFAULT_RATIO;\n    }\n    var probability = Number(environment.OTEL_TRACES_SAMPLER_ARG);\n    if (isNaN(probability)) {\n        diag.error(\"OTEL_TRACES_SAMPLER_ARG=\" + environment.OTEL_TRACES_SAMPLER_ARG + \" was given, but it is invalid, defaulting to \" + DEFAULT_RATIO + \".\");\n        return DEFAULT_RATIO;\n    }\n    if (probability < 0 || probability > 1) {\n        diag.error(\"OTEL_TRACES_SAMPLER_ARG=\" + environment.OTEL_TRACES_SAMPLER_ARG + \" was given, but it is out of range ([0..1]), defaulting to \" + DEFAULT_RATIO + \".\");\n        return DEFAULT_RATIO;\n    }\n    return probability;\n}\n//# sourceMappingURL=config.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { buildSamplerFromEnv, loadDefaultConfig } from './config';\nimport { DEFAULT_ATTRIBUTE_COUNT_LIMIT, DEFAULT_ATTRIBUTE_VALUE_LENGTH_LIMIT, getEnvWithoutDefaults, } from '@opentelemetry/core';\n/**\n * Function to merge Default configuration (as specified in './config') with\n * user provided configurations.\n */\nexport function mergeConfig(userConfig) {\n    var perInstanceDefaults = {\n        sampler: buildSamplerFromEnv(),\n    };\n    var DEFAULT_CONFIG = loadDefaultConfig();\n    var target = Object.assign({}, DEFAULT_CONFIG, perInstanceDefaults, userConfig);\n    target.generalLimits = Object.assign({}, DEFAULT_CONFIG.generalLimits, userConfig.generalLimits || {});\n    target.spanLimits = Object.assign({}, DEFAULT_CONFIG.spanLimits, userConfig.spanLimits || {});\n    return target;\n}\n/**\n * When general limits are provided and model specific limits are not,\n * configures the model specific limits by using the values from the general ones.\n * @param userConfig User provided tracer configuration\n */\nexport function reconfigureLimits(userConfig) {\n    var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m;\n    var spanLimits = Object.assign({}, userConfig.spanLimits);\n    var parsedEnvConfig = getEnvWithoutDefaults();\n    /**\n     * Reassign span attribute count limit to use first non null value defined by user or use default value\n     */\n    spanLimits.attributeCountLimit =\n        (_f = (_e = (_d = (_b = (_a = userConfig.spanLimits) === null || _a === void 0 ? void 0 : _a.attributeCountLimit) !== null && _b !== void 0 ? _b : (_c = userConfig.generalLimits) === null || _c === void 0 ? void 0 : _c.attributeCountLimit) !== null && _d !== void 0 ? _d : parsedEnvConfig.OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT) !== null && _e !== void 0 ? _e : parsedEnvConfig.OTEL_ATTRIBUTE_COUNT_LIMIT) !== null && _f !== void 0 ? _f : DEFAULT_ATTRIBUTE_COUNT_LIMIT;\n    /**\n     * Reassign span attribute value length limit to use first non null value defined by user or use default value\n     */\n    spanLimits.attributeValueLengthLimit =\n        (_m = (_l = (_k = (_h = (_g = userConfig.spanLimits) === null || _g === void 0 ? void 0 : _g.attributeValueLengthLimit) !== null && _h !== void 0 ? _h : (_j = userConfig.generalLimits) === null || _j === void 0 ? void 0 : _j.attributeValueLengthLimit) !== null && _k !== void 0 ? _k : parsedEnvConfig.OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT) !== null && _l !== void 0 ? _l : parsedEnvConfig.OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT) !== null && _m !== void 0 ? _m : DEFAULT_ATTRIBUTE_VALUE_LENGTH_LIMIT;\n    return Object.assign({}, userConfig, { spanLimits: spanLimits });\n}\n//# sourceMappingURL=utility.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar SPAN_ID_BYTES = 8;\nvar TRACE_ID_BYTES = 16;\nvar RandomIdGenerator = /** @class */ (function () {\n    function RandomIdGenerator() {\n        /**\n         * Returns a random 16-byte trace ID formatted/encoded as a 32 lowercase hex\n         * characters corresponding to 128 bits.\n         */\n        this.generateTraceId = getIdGenerator(TRACE_ID_BYTES);\n        /**\n         * Returns a random 8-byte span ID formatted/encoded as a 16 lowercase hex\n         * characters corresponding to 64 bits.\n         */\n        this.generateSpanId = getIdGenerator(SPAN_ID_BYTES);\n    }\n    return RandomIdGenerator;\n}());\nexport { RandomIdGenerator };\nvar SHARED_CHAR_CODES_ARRAY = Array(32);\nfunction getIdGenerator(bytes) {\n    return function generateId() {\n        for (var i = 0; i < bytes * 2; i++) {\n            SHARED_CHAR_CODES_ARRAY[i] = Math.floor(Math.random() * 16) + 48;\n            // valid hex characters in the range 48-57 and 97-102\n            if (SHARED_CHAR_CODES_ARRAY[i] >= 58) {\n                SHARED_CHAR_CODES_ARRAY[i] += 39;\n            }\n        }\n        return String.fromCharCode.apply(null, SHARED_CHAR_CODES_ARRAY.slice(0, bytes * 2));\n    };\n}\n//# sourceMappingURL=RandomIdGenerator.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport * as api from '@opentelemetry/api';\nimport { sanitizeAttributes, isTracingSuppressed, } from '@opentelemetry/core';\nimport { Span } from './Span';\nimport { mergeConfig } from './utility';\nimport { RandomIdGenerator } from './platform';\n/**\n * This class represents a basic tracer.\n */\nvar Tracer = /** @class */ (function () {\n    /**\n     * Constructs a new Tracer instance.\n     */\n    function Tracer(instrumentationLibrary, config, _tracerProvider) {\n        this._tracerProvider = _tracerProvider;\n        var localConfig = mergeConfig(config);\n        this._sampler = localConfig.sampler;\n        this._generalLimits = localConfig.generalLimits;\n        this._spanLimits = localConfig.spanLimits;\n        this._idGenerator = config.idGenerator || new RandomIdGenerator();\n        this.resource = _tracerProvider.resource;\n        this.instrumentationLibrary = instrumentationLibrary;\n    }\n    /**\n     * Starts a new Span or returns the default NoopSpan based on the sampling\n     * decision.\n     */\n    Tracer.prototype.startSpan = function (name, options, context) {\n        var _a, _b, _c;\n        if (options === void 0) { options = {}; }\n        if (context === void 0) { context = api.context.active(); }\n        // remove span from context in case a root span is requested via options\n        if (options.root) {\n            context = api.trace.deleteSpan(context);\n        }\n        var parentSpan = api.trace.getSpan(context);\n        if (isTracingSuppressed(context)) {\n            api.diag.debug('Instrumentation suppressed, returning Noop Span');\n            var nonRecordingSpan = api.trace.wrapSpanContext(api.INVALID_SPAN_CONTEXT);\n            return nonRecordingSpan;\n        }\n        var parentSpanContext = parentSpan === null || parentSpan === void 0 ? void 0 : parentSpan.spanContext();\n        var spanId = this._idGenerator.generateSpanId();\n        var traceId;\n        var traceState;\n        var parentSpanId;\n        if (!parentSpanContext ||\n            !api.trace.isSpanContextValid(parentSpanContext)) {\n            // New root span.\n            traceId = this._idGenerator.generateTraceId();\n        }\n        else {\n            // New child span.\n            traceId = parentSpanContext.traceId;\n            traceState = parentSpanContext.traceState;\n            parentSpanId = parentSpanContext.spanId;\n        }\n        var spanKind = (_a = options.kind) !== null && _a !== void 0 ? _a : api.SpanKind.INTERNAL;\n        var links = ((_b = options.links) !== null && _b !== void 0 ? _b : []).map(function (link) {\n            return {\n                context: link.context,\n                attributes: sanitizeAttributes(link.attributes),\n            };\n        });\n        var attributes = sanitizeAttributes(options.attributes);\n        // make sampling decision\n        var samplingResult = this._sampler.shouldSample(context, traceId, name, spanKind, attributes, links);\n        traceState = (_c = samplingResult.traceState) !== null && _c !== void 0 ? _c : traceState;\n        var traceFlags = samplingResult.decision === api.SamplingDecision.RECORD_AND_SAMPLED\n            ? api.TraceFlags.SAMPLED\n            : api.TraceFlags.NONE;\n        var spanContext = { traceId: traceId, spanId: spanId, traceFlags: traceFlags, traceState: traceState };\n        if (samplingResult.decision === api.SamplingDecision.NOT_RECORD) {\n            api.diag.debug('Recording is off, propagating context in a non-recording span');\n            var nonRecordingSpan = api.trace.wrapSpanContext(spanContext);\n            return nonRecordingSpan;\n        }\n        var span = new Span(this, context, name, spanContext, spanKind, parentSpanId, links, options.startTime);\n        // Set initial span attributes. The attributes object may have been mutated\n        // by the sampler, so we sanitize the merged attributes before setting them.\n        var initAttributes = sanitizeAttributes(Object.assign(attributes, samplingResult.attributes));\n        span.setAttributes(initAttributes);\n        return span;\n    };\n    Tracer.prototype.startActiveSpan = function (name, arg2, arg3, arg4) {\n        var opts;\n        var ctx;\n        var fn;\n        if (arguments.length < 2) {\n            return;\n        }\n        else if (arguments.length === 2) {\n            fn = arg2;\n        }\n        else if (arguments.length === 3) {\n            opts = arg2;\n            fn = arg3;\n        }\n        else {\n            opts = arg2;\n            ctx = arg3;\n            fn = arg4;\n        }\n        var parentContext = ctx !== null && ctx !== void 0 ? ctx : api.context.active();\n        var span = this.startSpan(name, opts, parentContext);\n        var contextWithSpanSet = api.trace.setSpan(parentContext, span);\n        return api.context.with(contextWithSpanSet, fn, undefined, span);\n    };\n    /** Returns the active {@link GeneralLimits}. */\n    Tracer.prototype.getGeneralLimits = function () {\n        return this._generalLimits;\n    };\n    /** Returns the active {@link SpanLimits}. */\n    Tracer.prototype.getSpanLimits = function () {\n        return this._spanLimits;\n    };\n    Tracer.prototype.getActiveSpanProcessor = function () {\n        return this._tracerProvider.getActiveSpanProcessor();\n    };\n    return Tracer;\n}());\nexport { Tracer };\n//# sourceMappingURL=Tracer.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { context, diag, propagation, trace, } from '@opentelemetry/api';\nimport { CompositePropagator, W3CBaggagePropagator, W3CTraceContextPropagator, getEnv, merge, } from '@opentelemetry/core';\nimport { Resource } from '@opentelemetry/resources';\nimport { Tracer } from '.';\nimport { loadDefaultConfig } from './config';\nimport { MultiSpanProcessor } from './MultiSpanProcessor';\nimport { NoopSpanProcessor } from './export/NoopSpanProcessor';\nimport { BatchSpanProcessor } from './platform';\nimport { reconfigureLimits } from './utility';\nexport var ForceFlushState;\n(function (ForceFlushState) {\n    ForceFlushState[ForceFlushState[\"resolved\"] = 0] = \"resolved\";\n    ForceFlushState[ForceFlushState[\"timeout\"] = 1] = \"timeout\";\n    ForceFlushState[ForceFlushState[\"error\"] = 2] = \"error\";\n    ForceFlushState[ForceFlushState[\"unresolved\"] = 3] = \"unresolved\";\n})(ForceFlushState || (ForceFlushState = {}));\n/**\n * This class represents a basic tracer provider which platform libraries can extend\n */\nvar BasicTracerProvider = /** @class */ (function () {\n    function BasicTracerProvider(config) {\n        if (config === void 0) { config = {}; }\n        var _a;\n        this._registeredSpanProcessors = [];\n        this._tracers = new Map();\n        var mergedConfig = merge({}, loadDefaultConfig(), reconfigureLimits(config));\n        this.resource = (_a = mergedConfig.resource) !== null && _a !== void 0 ? _a : Resource.empty();\n        this.resource = Resource.default().merge(this.resource);\n        this._config = Object.assign({}, mergedConfig, {\n            resource: this.resource,\n        });\n        var defaultExporter = this._buildExporterFromEnv();\n        if (defaultExporter !== undefined) {\n            var batchProcessor = new BatchSpanProcessor(defaultExporter);\n            this.activeSpanProcessor = batchProcessor;\n        }\n        else {\n            this.activeSpanProcessor = new NoopSpanProcessor();\n        }\n    }\n    BasicTracerProvider.prototype.getTracer = function (name, version, options) {\n        var key = name + \"@\" + (version || '') + \":\" + ((options === null || options === void 0 ? void 0 : options.schemaUrl) || '');\n        if (!this._tracers.has(key)) {\n            this._tracers.set(key, new Tracer({ name: name, version: version, schemaUrl: options === null || options === void 0 ? void 0 : options.schemaUrl }, this._config, this));\n        }\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        return this._tracers.get(key);\n    };\n    /**\n     * Adds a new {@link SpanProcessor} to this tracer.\n     * @param spanProcessor the new SpanProcessor to be added.\n     */\n    BasicTracerProvider.prototype.addSpanProcessor = function (spanProcessor) {\n        if (this._registeredSpanProcessors.length === 0) {\n            // since we might have enabled by default a batchProcessor, we disable it\n            // before adding the new one\n            this.activeSpanProcessor\n                .shutdown()\n                .catch(function (err) {\n                return diag.error('Error while trying to shutdown current span processor', err);\n            });\n        }\n        this._registeredSpanProcessors.push(spanProcessor);\n        this.activeSpanProcessor = new MultiSpanProcessor(this._registeredSpanProcessors);\n    };\n    BasicTracerProvider.prototype.getActiveSpanProcessor = function () {\n        return this.activeSpanProcessor;\n    };\n    /**\n     * Register this TracerProvider for use with the OpenTelemetry API.\n     * Undefined values may be replaced with defaults, and\n     * null values will be skipped.\n     *\n     * @param config Configuration object for SDK registration\n     */\n    BasicTracerProvider.prototype.register = function (config) {\n        if (config === void 0) { config = {}; }\n        trace.setGlobalTracerProvider(this);\n        if (config.propagator === undefined) {\n            config.propagator = this._buildPropagatorFromEnv();\n        }\n        if (config.contextManager) {\n            context.setGlobalContextManager(config.contextManager);\n        }\n        if (config.propagator) {\n            propagation.setGlobalPropagator(config.propagator);\n        }\n    };\n    BasicTracerProvider.prototype.forceFlush = function () {\n        var timeout = this._config.forceFlushTimeoutMillis;\n        var promises = this._registeredSpanProcessors.map(function (spanProcessor) {\n            return new Promise(function (resolve) {\n                var state;\n                var timeoutInterval = setTimeout(function () {\n                    resolve(new Error(\"Span processor did not completed within timeout period of \" + timeout + \" ms\"));\n                    state = ForceFlushState.timeout;\n                }, timeout);\n                spanProcessor\n                    .forceFlush()\n                    .then(function () {\n                    clearTimeout(timeoutInterval);\n                    if (state !== ForceFlushState.timeout) {\n                        state = ForceFlushState.resolved;\n                        resolve(state);\n                    }\n                })\n                    .catch(function (error) {\n                    clearTimeout(timeoutInterval);\n                    state = ForceFlushState.error;\n                    resolve(error);\n                });\n            });\n        });\n        return new Promise(function (resolve, reject) {\n            Promise.all(promises)\n                .then(function (results) {\n                var errors = results.filter(function (result) { return result !== ForceFlushState.resolved; });\n                if (errors.length > 0) {\n                    reject(errors);\n                }\n                else {\n                    resolve();\n                }\n            })\n                .catch(function (error) { return reject([error]); });\n        });\n    };\n    BasicTracerProvider.prototype.shutdown = function () {\n        return this.activeSpanProcessor.shutdown();\n    };\n    /**\n     * TS cannot yet infer the type of this.constructor:\n     * https://github.com/Microsoft/TypeScript/issues/3841#issuecomment-337560146\n     * There is no need to override either of the getters in your child class.\n     * The type of the registered component maps should be the same across all\n     * classes in the inheritance tree.\n     */\n    BasicTracerProvider.prototype._getPropagator = function (name) {\n        var _a;\n        return (_a = this.constructor._registeredPropagators.get(name)) === null || _a === void 0 ? void 0 : _a();\n    };\n    BasicTracerProvider.prototype._getSpanExporter = function (name) {\n        var _a;\n        return (_a = this.constructor._registeredExporters.get(name)) === null || _a === void 0 ? void 0 : _a();\n    };\n    BasicTracerProvider.prototype._buildPropagatorFromEnv = function () {\n        var _this = this;\n        // per spec, propagators from env must be deduplicated\n        var uniquePropagatorNames = Array.from(new Set(getEnv().OTEL_PROPAGATORS));\n        var propagators = uniquePropagatorNames.map(function (name) {\n            var propagator = _this._getPropagator(name);\n            if (!propagator) {\n                diag.warn(\"Propagator \\\"\" + name + \"\\\" requested through environment variable is unavailable.\");\n            }\n            return propagator;\n        });\n        var validPropagators = propagators.reduce(function (list, item) {\n            if (item) {\n                list.push(item);\n            }\n            return list;\n        }, []);\n        if (validPropagators.length === 0) {\n            return;\n        }\n        else if (uniquePropagatorNames.length === 1) {\n            return validPropagators[0];\n        }\n        else {\n            return new CompositePropagator({\n                propagators: validPropagators,\n            });\n        }\n    };\n    BasicTracerProvider.prototype._buildExporterFromEnv = function () {\n        var exporterName = getEnv().OTEL_TRACES_EXPORTER;\n        if (exporterName === 'none' || exporterName === '')\n            return;\n        var exporter = this._getSpanExporter(exporterName);\n        if (!exporter) {\n            diag.error(\"Exporter \\\"\" + exporterName + \"\\\" requested through environment variable is unavailable.\");\n        }\n        return exporter;\n    };\n    BasicTracerProvider._registeredPropagators = new Map([\n        ['tracecontext', function () { return new W3CTraceContextPropagator(); }],\n        ['baggage', function () { return new W3CBaggagePropagator(); }],\n    ]);\n    BasicTracerProvider._registeredExporters = new Map();\n    return BasicTracerProvider;\n}());\nexport { BasicTracerProvider };\n//# sourceMappingURL=BasicTracerProvider.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __values = (this && this.__values) || function(o) {\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n    if (m) return m.call(o);\n    if (o && typeof o.length === \"number\") return {\n        next: function () {\n            if (o && i >= o.length) o = void 0;\n            return { value: o && o[i++], done: !o };\n        }\n    };\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\nimport { globalErrorHandler } from '@opentelemetry/core';\n/**\n * Implementation of the {@link SpanProcessor} that simply forwards all\n * received events to a list of {@link SpanProcessor}s.\n */\nvar MultiSpanProcessor = /** @class */ (function () {\n    function MultiSpanProcessor(_spanProcessors) {\n        this._spanProcessors = _spanProcessors;\n    }\n    MultiSpanProcessor.prototype.forceFlush = function () {\n        var e_1, _a;\n        var promises = [];\n        try {\n            for (var _b = __values(this._spanProcessors), _c = _b.next(); !_c.done; _c = _b.next()) {\n                var spanProcessor = _c.value;\n                promises.push(spanProcessor.forceFlush());\n            }\n        }\n        catch (e_1_1) { e_1 = { error: e_1_1 }; }\n        finally {\n            try {\n                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n            }\n            finally { if (e_1) throw e_1.error; }\n        }\n        return new Promise(function (resolve) {\n            Promise.all(promises)\n                .then(function () {\n                resolve();\n            })\n                .catch(function (error) {\n                globalErrorHandler(error || new Error('MultiSpanProcessor: forceFlush failed'));\n                resolve();\n            });\n        });\n    };\n    MultiSpanProcessor.prototype.onStart = function (span, context) {\n        var e_2, _a;\n        try {\n            for (var _b = __values(this._spanProcessors), _c = _b.next(); !_c.done; _c = _b.next()) {\n                var spanProcessor = _c.value;\n                spanProcessor.onStart(span, context);\n            }\n        }\n        catch (e_2_1) { e_2 = { error: e_2_1 }; }\n        finally {\n            try {\n                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n            }\n            finally { if (e_2) throw e_2.error; }\n        }\n    };\n    MultiSpanProcessor.prototype.onEnd = function (span) {\n        var e_3, _a;\n        try {\n            for (var _b = __values(this._spanProcessors), _c = _b.next(); !_c.done; _c = _b.next()) {\n                var spanProcessor = _c.value;\n                spanProcessor.onEnd(span);\n            }\n        }\n        catch (e_3_1) { e_3 = { error: e_3_1 }; }\n        finally {\n            try {\n                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n            }\n            finally { if (e_3) throw e_3.error; }\n        }\n    };\n    MultiSpanProcessor.prototype.shutdown = function () {\n        var e_4, _a;\n        var promises = [];\n        try {\n            for (var _b = __values(this._spanProcessors), _c = _b.next(); !_c.done; _c = _b.next()) {\n                var spanProcessor = _c.value;\n                promises.push(spanProcessor.shutdown());\n            }\n        }\n        catch (e_4_1) { e_4 = { error: e_4_1 }; }\n        finally {\n            try {\n                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n            }\n            finally { if (e_4) throw e_4.error; }\n        }\n        return new Promise(function (resolve, reject) {\n            Promise.all(promises).then(function () {\n                resolve();\n            }, reject);\n        });\n    };\n    return MultiSpanProcessor;\n}());\nexport { MultiSpanProcessor };\n//# sourceMappingURL=MultiSpanProcessor.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/** No-op implementation of SpanProcessor */\nvar NoopSpanProcessor = /** @class */ (function () {\n    function NoopSpanProcessor() {\n    }\n    NoopSpanProcessor.prototype.onStart = function (_span, _context) { };\n    NoopSpanProcessor.prototype.onEnd = function (_span) { };\n    NoopSpanProcessor.prototype.shutdown = function () {\n        return Promise.resolve();\n    };\n    NoopSpanProcessor.prototype.forceFlush = function () {\n        return Promise.resolve();\n    };\n    return NoopSpanProcessor;\n}());\nexport { NoopSpanProcessor };\n//# sourceMappingURL=NoopSpanProcessor.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport { ROOT_CONTEXT } from '@opentelemetry/api';\n/**\n * Stack Context Manager for managing the state in web\n * it doesn't fully support the async calls though\n */\nvar StackContextManager = /** @class */ (function () {\n    function StackContextManager() {\n        /**\n         * whether the context manager is enabled or not\n         */\n        this._enabled = false;\n        /**\n         * Keeps the reference to current context\n         */\n        this._currentContext = ROOT_CONTEXT;\n    }\n    /**\n     *\n     * @param context\n     * @param target Function to be executed within the context\n     */\n    // eslint-disable-next-line @typescript-eslint/ban-types\n    StackContextManager.prototype._bindFunction = function (context, target) {\n        if (context === void 0) { context = ROOT_CONTEXT; }\n        var manager = this;\n        var contextWrapper = function () {\n            var _this = this;\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i] = arguments[_i];\n            }\n            return manager.with(context, function () { return target.apply(_this, args); });\n        };\n        Object.defineProperty(contextWrapper, 'length', {\n            enumerable: false,\n            configurable: true,\n            writable: false,\n            value: target.length,\n        });\n        return contextWrapper;\n    };\n    /**\n     * Returns the active context\n     */\n    StackContextManager.prototype.active = function () {\n        return this._currentContext;\n    };\n    /**\n     * Binds a the certain context or the active one to the target function and then returns the target\n     * @param context A context (span) to be bind to target\n     * @param target a function or event emitter. When target or one of its callbacks is called,\n     *  the provided context will be used as the active context for the duration of the call.\n     */\n    StackContextManager.prototype.bind = function (context, target) {\n        // if no specific context to propagate is given, we use the current one\n        if (context === undefined) {\n            context = this.active();\n        }\n        if (typeof target === 'function') {\n            return this._bindFunction(context, target);\n        }\n        return target;\n    };\n    /**\n     * Disable the context manager (clears the current context)\n     */\n    StackContextManager.prototype.disable = function () {\n        this._currentContext = ROOT_CONTEXT;\n        this._enabled = false;\n        return this;\n    };\n    /**\n     * Enables the context manager and creates a default(root) context\n     */\n    StackContextManager.prototype.enable = function () {\n        if (this._enabled) {\n            return this;\n        }\n        this._enabled = true;\n        this._currentContext = ROOT_CONTEXT;\n        return this;\n    };\n    /**\n     * Calls the callback function [fn] with the provided [context]. If [context] is undefined then it will use the window.\n     * The context will be set as active\n     * @param context\n     * @param fn Callback function\n     * @param thisArg optional receiver to be used for calling fn\n     * @param args optional arguments forwarded to fn\n     */\n    StackContextManager.prototype.with = function (context, fn, thisArg) {\n        var args = [];\n        for (var _i = 3; _i < arguments.length; _i++) {\n            args[_i - 3] = arguments[_i];\n        }\n        var previousContext = this._currentContext;\n        this._currentContext = context || ROOT_CONTEXT;\n        try {\n            return fn.call.apply(fn, __spreadArray([thisArg], __read(args), false));\n        }\n        finally {\n            this._currentContext = previousContext;\n        }\n    };\n    return StackContextManager;\n}());\nexport { StackContextManager };\n//# sourceMappingURL=StackContextManager.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { BasicTracerProvider, } from '@opentelemetry/sdk-trace-base';\nimport { StackContextManager } from './StackContextManager';\n/**\n * This class represents a web tracer with {@link StackContextManager}\n */\nvar WebTracerProvider = /** @class */ (function (_super) {\n    __extends(WebTracerProvider, _super);\n    /**\n     * Constructs a new Tracer instance.\n     * @param config Web Tracer config\n     */\n    function WebTracerProvider(config) {\n        if (config === void 0) { config = {}; }\n        var _this = _super.call(this, config) || this;\n        if (config.contextManager) {\n            throw ('contextManager should be defined in register method not in' +\n                ' constructor');\n        }\n        if (config.propagator) {\n            throw 'propagator should be defined in register method not in constructor';\n        }\n        return _this;\n    }\n    /**\n     * Register this TracerProvider for use with the OpenTelemetry API.\n     * Undefined values may be replaced with defaults, and\n     * null values will be skipped.\n     *\n     * @param config Configuration object for SDK registration\n     */\n    WebTracerProvider.prototype.register = function (config) {\n        if (config === void 0) { config = {}; }\n        if (config.contextManager === undefined) {\n            config.contextManager = new StackContextManager();\n        }\n        if (config.contextManager) {\n            config.contextManager.enable();\n        }\n        _super.prototype.register.call(this, config);\n    };\n    return WebTracerProvider;\n}(BasicTracerProvider));\nexport { WebTracerProvider };\n//# sourceMappingURL=WebTracerProvider.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nimport { diag } from '@opentelemetry/api';\nimport { getEnv } from '@opentelemetry/core';\nvar DEFAULT_TRACE_TIMEOUT = 10000;\n/**\n * Parses headers from config leaving only those that have defined values\n * @param partialHeaders\n */\nexport function parseHeaders(partialHeaders) {\n    if (partialHeaders === void 0) { partialHeaders = {}; }\n    var headers = {};\n    Object.entries(partialHeaders).forEach(function (_a) {\n        var _b = __read(_a, 2), key = _b[0], value = _b[1];\n        if (typeof value !== 'undefined') {\n            headers[key] = String(value);\n        }\n        else {\n            diag.warn(\"Header \\\"\" + key + \"\\\" has wrong value and will be ignored\");\n        }\n    });\n    return headers;\n}\n/**\n * Adds path (version + signal) to a no per-signal endpoint\n * @param url\n * @param path\n * @returns url + path\n */\nexport function appendResourcePathToUrl(url, path) {\n    if (!url.endsWith('/')) {\n        url = url + '/';\n    }\n    return url + path;\n}\n/**\n * Adds root path to signal specific endpoint when endpoint contains no path part and no root path\n * @param url\n * @param path\n * @returns url\n */\nexport function appendRootPathToUrlIfNeeded(url, path) {\n    if (!url.includes(path) && !url.endsWith('/')) {\n        url = url + '/';\n    }\n    return url;\n}\n/**\n * Configure exporter trace timeout value from passed in value or environment variables\n * @param timeoutMillis\n * @returns timeout value in milliseconds\n */\nexport function configureExporterTimeout(timeoutMillis) {\n    if (typeof timeoutMillis === 'number') {\n        if (timeoutMillis <= 0) {\n            // OTLP exporter configured timeout - using default value of 10000ms\n            return invalidTimeout(timeoutMillis, DEFAULT_TRACE_TIMEOUT);\n        }\n        return timeoutMillis;\n    }\n    else {\n        return getExporterTimeoutFromEnv();\n    }\n}\nfunction getExporterTimeoutFromEnv() {\n    var _a;\n    var definedTimeout = Number((_a = getEnv().OTEL_EXPORTER_OTLP_TRACES_TIMEOUT) !== null && _a !== void 0 ? _a : getEnv().OTEL_EXPORTER_OTLP_TIMEOUT);\n    if (definedTimeout <= 0) {\n        // OTLP exporter configured timeout - using default value of 10000ms\n        return invalidTimeout(definedTimeout, DEFAULT_TRACE_TIMEOUT);\n    }\n    else {\n        return definedTimeout;\n    }\n}\n// OTLP exporter configured timeout - using default value of 10000ms\nexport function invalidTimeout(timeout, defaultTimeout) {\n    diag.warn('Timeout must be greater than 0', timeout);\n    return defaultTimeout;\n}\n//# sourceMappingURL=util.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { diag } from '@opentelemetry/api';\nimport { ExportResultCode, BindOnceFuture } from '@opentelemetry/core';\nimport { configureExporterTimeout } from './util';\n/**\n * Collector Exporter abstract base class\n */\nvar OTLPExporterBase = /** @class */ (function () {\n    /**\n     * @param config\n     */\n    function OTLPExporterBase(config) {\n        if (config === void 0) { config = {}; }\n        this._sendingPromises = [];\n        this.url = this.getDefaultUrl(config);\n        if (typeof config.hostname === 'string') {\n            this.hostname = config.hostname;\n        }\n        this.shutdown = this.shutdown.bind(this);\n        this._shutdownOnce = new BindOnceFuture(this._shutdown, this);\n        this._concurrencyLimit =\n            typeof config.concurrencyLimit === 'number'\n                ? config.concurrencyLimit\n                : Infinity;\n        this.timeoutMillis = configureExporterTimeout(config.timeoutMillis);\n        // platform dependent\n        this.onInit(config);\n    }\n    /**\n     * Export items.\n     * @param items\n     * @param resultCallback\n     */\n    OTLPExporterBase.prototype.export = function (items, resultCallback) {\n        if (this._shutdownOnce.isCalled) {\n            resultCallback({\n                code: ExportResultCode.FAILED,\n                error: new Error('Exporter has been shutdown'),\n            });\n            return;\n        }\n        if (this._sendingPromises.length >= this._concurrencyLimit) {\n            resultCallback({\n                code: ExportResultCode.FAILED,\n                error: new Error('Concurrent export limit reached'),\n            });\n            return;\n        }\n        this._export(items)\n            .then(function () {\n            resultCallback({ code: ExportResultCode.SUCCESS });\n        })\n            .catch(function (error) {\n            resultCallback({ code: ExportResultCode.FAILED, error: error });\n        });\n    };\n    OTLPExporterBase.prototype._export = function (items) {\n        var _this = this;\n        return new Promise(function (resolve, reject) {\n            try {\n                diag.debug('items to be sent', items);\n                _this.send(items, resolve, reject);\n            }\n            catch (e) {\n                reject(e);\n            }\n        });\n    };\n    /**\n     * Shutdown the exporter.\n     */\n    OTLPExporterBase.prototype.shutdown = function () {\n        return this._shutdownOnce.call();\n    };\n    /**\n     * Called by _shutdownOnce with BindOnceFuture\n     */\n    OTLPExporterBase.prototype._shutdown = function () {\n        diag.debug('shutdown started');\n        this.onShutdown();\n        return Promise.all(this._sendingPromises)\n            .then(function () {\n            /** ignore resolved values */\n        });\n    };\n    return OTLPExporterBase;\n}());\nexport { OTLPExporterBase };\n//# sourceMappingURL=OTLPExporterBase.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n/**\n * Interface for handling error\n */\nvar OTLPExporterError = /** @class */ (function (_super) {\n    __extends(OTLPExporterError, _super);\n    function OTLPExporterError(message, code, data) {\n        var _this = _super.call(this, message) || this;\n        _this.name = 'OTLPExporterError';\n        _this.data = data;\n        _this.code = code;\n        return _this;\n    }\n    return OTLPExporterError;\n}(Error));\nexport { OTLPExporterError };\n//# sourceMappingURL=types.js.map","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\n/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { diag } from '@opentelemetry/api';\nimport { OTLPExporterError } from '../../types';\n/**\n * Send metrics/spans using browser navigator.sendBeacon\n * @param body\n * @param url\n * @param blobPropertyBag\n * @param onSuccess\n * @param onError\n */\nexport function sendWithBeacon(body, url, blobPropertyBag, onSuccess, onError) {\n    if (navigator.sendBeacon(url, new Blob([body], blobPropertyBag))) {\n        diag.debug('sendBeacon - can send', body);\n        onSuccess();\n    }\n    else {\n        var error = new OTLPExporterError(\"sendBeacon - cannot send \" + body);\n        onError(error);\n    }\n}\n/**\n * function to send metrics/spans using browser XMLHttpRequest\n *     used when navigator.sendBeacon is not available\n * @param body\n * @param url\n * @param headers\n * @param onSuccess\n * @param onError\n */\nexport function sendWithXhr(body, url, headers, exporterTimeout, onSuccess, onError) {\n    var reqIsDestroyed;\n    var exporterTimer = setTimeout(function () {\n        reqIsDestroyed = true;\n        xhr.abort();\n    }, exporterTimeout);\n    var xhr = new XMLHttpRequest();\n    xhr.open('POST', url);\n    var defaultHeaders = {\n        'Accept': 'application/json',\n        'Content-Type': 'application/json',\n    };\n    Object.entries(__assign(__assign({}, defaultHeaders), headers)).forEach(function (_a) {\n        var _b = __read(_a, 2), k = _b[0], v = _b[1];\n        xhr.setRequestHeader(k, v);\n    });\n    xhr.send(body);\n    xhr.onreadystatechange = function () {\n        if (xhr.readyState === XMLHttpRequest.DONE) {\n            if (xhr.status >= 200 && xhr.status <= 299) {\n                clearTimeout(exporterTimer);\n                diag.debug('xhr success', body);\n                onSuccess();\n            }\n            else if (reqIsDestroyed) {\n                var error = new OTLPExporterError('Request Timeout', xhr.status);\n                onError(error);\n            }\n            else {\n                var error = new OTLPExporterError(\"Failed to export with XHR (status: \" + xhr.status + \")\", xhr.status);\n                clearTimeout(exporterTimer);\n                onError(error);\n            }\n        }\n    };\n}\n//# sourceMappingURL=util.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { OTLPExporterBase } from '../../OTLPExporterBase';\nimport { parseHeaders } from '../../util';\nimport { sendWithBeacon, sendWithXhr } from './util';\nimport { diag } from '@opentelemetry/api';\nimport { getEnv, baggageUtils } from '@opentelemetry/core';\n/**\n * Collector Metric Exporter abstract base class\n */\nvar OTLPExporterBrowserBase = /** @class */ (function (_super) {\n    __extends(OTLPExporterBrowserBase, _super);\n    /**\n     * @param config\n     */\n    function OTLPExporterBrowserBase(config) {\n        if (config === void 0) { config = {}; }\n        var _this = _super.call(this, config) || this;\n        _this._useXHR = false;\n        _this._useXHR =\n            !!config.headers || typeof navigator.sendBeacon !== 'function';\n        if (_this._useXHR) {\n            _this._headers = Object.assign({}, parseHeaders(config.headers), baggageUtils.parseKeyPairsIntoRecord(getEnv().OTEL_EXPORTER_OTLP_HEADERS));\n        }\n        else {\n            _this._headers = {};\n        }\n        return _this;\n    }\n    OTLPExporterBrowserBase.prototype.onInit = function () {\n        window.addEventListener('unload', this.shutdown);\n    };\n    OTLPExporterBrowserBase.prototype.onShutdown = function () {\n        window.removeEventListener('unload', this.shutdown);\n    };\n    OTLPExporterBrowserBase.prototype.send = function (items, onSuccess, onError) {\n        var _this = this;\n        if (this._shutdownOnce.isCalled) {\n            diag.debug('Shutdown already started. Cannot send objects');\n            return;\n        }\n        var serviceRequest = this.convert(items);\n        var body = JSON.stringify(serviceRequest);\n        var promise = new Promise(function (resolve, reject) {\n            if (_this._useXHR) {\n                sendWithXhr(body, _this.url, _this._headers, _this.timeoutMillis, resolve, reject);\n            }\n            else {\n                sendWithBeacon(body, _this.url, { type: 'application/json' }, resolve, reject);\n            }\n        })\n            .then(onSuccess, onError);\n        this._sendingPromises.push(promise);\n        var popPromise = function () {\n            var index = _this._sendingPromises.indexOf(promise);\n            _this._sendingPromises.splice(index, 1);\n        };\n        promise.then(popPromise, popPromise);\n    };\n    return OTLPExporterBrowserBase;\n}(OTLPExporterBase));\nexport { OTLPExporterBrowserBase };\n//# sourceMappingURL=OTLPExporterBrowserBase.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * SpanKind is the type of span. Can be used to specify additional relationships between spans\n * in addition to a parent/child relationship.\n */\nexport var ESpanKind;\n(function (ESpanKind) {\n    /** Unspecified. Do NOT use as default. Implementations MAY assume SpanKind to be INTERNAL when receiving UNSPECIFIED. */\n    ESpanKind[ESpanKind[\"SPAN_KIND_UNSPECIFIED\"] = 0] = \"SPAN_KIND_UNSPECIFIED\";\n    /** Indicates that the span represents an internal operation within an application,\n      * as opposed to an operation happening at the boundaries. Default value.\n      */\n    ESpanKind[ESpanKind[\"SPAN_KIND_INTERNAL\"] = 1] = \"SPAN_KIND_INTERNAL\";\n    /** Indicates that the span covers server-side handling of an RPC or other\n      * remote network request.\n      */\n    ESpanKind[ESpanKind[\"SPAN_KIND_SERVER\"] = 2] = \"SPAN_KIND_SERVER\";\n    /** Indicates that the span describes a request to some remote service.\n      */\n    ESpanKind[ESpanKind[\"SPAN_KIND_CLIENT\"] = 3] = \"SPAN_KIND_CLIENT\";\n    /** Indicates that the span describes a producer sending a message to a broker.\n      * Unlike CLIENT and SERVER, there is often no direct critical path latency relationship\n      * between producer and consumer spans. A PRODUCER span ends when the message was accepted\n      * by the broker while the logical processing of the message might span a much longer time.\n      */\n    ESpanKind[ESpanKind[\"SPAN_KIND_PRODUCER\"] = 4] = \"SPAN_KIND_PRODUCER\";\n    /** Indicates that the span describes consumer receiving a message from a broker.\n      * Like the PRODUCER kind, there is often no direct critical path latency relationship\n      * between producer and consumer spans.\n      */\n    ESpanKind[ESpanKind[\"SPAN_KIND_CONSUMER\"] = 5] = \"SPAN_KIND_CONSUMER\";\n})(ESpanKind || (ESpanKind = {}));\n//# sourceMappingURL=types.js.map","var __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nexport function toAttributes(attributes) {\n    return Object.keys(attributes).map(function (key) { return toKeyValue(key, attributes[key]); });\n}\nexport function toKeyValue(key, value) {\n    return {\n        key: key,\n        value: toAnyValue(value),\n    };\n}\nexport function toAnyValue(value) {\n    var t = typeof value;\n    if (t === 'string')\n        return { stringValue: value };\n    if (t === 'number') {\n        if (!Number.isInteger(value))\n            return { doubleValue: value };\n        return { intValue: value };\n    }\n    if (t === 'boolean')\n        return { boolValue: value };\n    if (value instanceof Uint8Array)\n        return { bytesValue: value };\n    if (Array.isArray(value))\n        return { arrayValue: { values: value.map(toAnyValue) } };\n    if (t === 'object' && value != null)\n        return { kvlistValue: { values: Object.entries(value).map(function (_a) {\n                    var _b = __read(_a, 2), k = _b[0], v = _b[1];\n                    return toKeyValue(k, v);\n                }) } };\n    return {};\n}\nexport function hexToBuf(hex) {\n    var _a;\n    var ints = (_a = hex.match(/[\\da-f]{2}/gi)) === null || _a === void 0 ? void 0 : _a.map(function (h) { return parseInt(h, 16); });\n    return ints && new Uint8Array(ints);\n}\nfunction i2hex(i) {\n    return ('0' + i.toString(16)).slice(-2);\n}\nexport function bufToHex(buf) {\n    if (buf == null || buf.length === 0)\n        return undefined;\n    return Array.from(buf).map(i2hex).join('');\n}\n//# sourceMappingURL=internal.js.map","import { hrTimeToNanoseconds } from '@opentelemetry/core';\nimport { toAttributes } from '../common/internal';\nimport * as core from '@opentelemetry/core';\nexport function sdkSpanToOtlpSpan(span, useHex) {\n    var ctx = span.spanContext();\n    var status = span.status;\n    var parentSpanId = useHex ? span.parentSpanId : span.parentSpanId != null ? core.hexToBase64(span.parentSpanId) : undefined;\n    return {\n        traceId: useHex ? ctx.traceId : core.hexToBase64(ctx.traceId),\n        spanId: useHex ? ctx.spanId : core.hexToBase64(ctx.spanId),\n        parentSpanId: parentSpanId,\n        name: span.name,\n        // Span kind is offset by 1 because the API does not define a value for unset\n        kind: span.kind == null ? 0 : span.kind + 1,\n        startTimeUnixNano: hrTimeToNanoseconds(span.startTime),\n        endTimeUnixNano: hrTimeToNanoseconds(span.endTime),\n        attributes: toAttributes(span.attributes),\n        droppedAttributesCount: 0,\n        events: span.events.map(toOtlpSpanEvent),\n        droppedEventsCount: 0,\n        status: {\n            // API and proto enums share the same values\n            code: status.code,\n            message: status.message,\n        },\n        links: span.links.map(function (link) { return toOtlpLink(link, useHex); }),\n        droppedLinksCount: 0,\n    };\n}\nexport function toOtlpLink(link, useHex) {\n    return {\n        attributes: link.attributes ? toAttributes(link.attributes) : [],\n        spanId: useHex ? link.context.spanId : core.hexToBase64(link.context.spanId),\n        traceId: useHex ? link.context.traceId : core.hexToBase64(link.context.traceId),\n        droppedAttributesCount: 0,\n    };\n}\nexport function toOtlpSpanEvent(timedEvent) {\n    return {\n        attributes: timedEvent.attributes ? toAttributes(timedEvent.attributes) : [],\n        name: timedEvent.name,\n        timeUnixNano: hrTimeToNanoseconds(timedEvent.time),\n        droppedAttributesCount: 0,\n    };\n}\n//# sourceMappingURL=internal.js.map","var __values = (this && this.__values) || function(o) {\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n    if (m) return m.call(o);\n    if (o && typeof o.length === \"number\") return {\n        next: function () {\n            if (o && i >= o.length) o = void 0;\n            return { value: o && o[i++], done: !o };\n        }\n    };\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nimport { toAttributes } from '../common/internal';\nimport { sdkSpanToOtlpSpan } from './internal';\nexport function createExportTraceServiceRequest(spans, useHex) {\n    return {\n        resourceSpans: spanRecordsToResourceSpans(spans, useHex)\n    };\n}\nfunction createResourceMap(readableSpans) {\n    var e_1, _a;\n    var resourceMap = new Map();\n    try {\n        for (var readableSpans_1 = __values(readableSpans), readableSpans_1_1 = readableSpans_1.next(); !readableSpans_1_1.done; readableSpans_1_1 = readableSpans_1.next()) {\n            var record = readableSpans_1_1.value;\n            var ilmMap = resourceMap.get(record.resource);\n            if (!ilmMap) {\n                ilmMap = new Map();\n                resourceMap.set(record.resource, ilmMap);\n            }\n            // TODO this is duplicated in basic tracer. Consolidate on a common helper in core\n            var instrumentationLibraryKey = record.instrumentationLibrary.name + \"@\" + (record.instrumentationLibrary.version || '') + \":\" + (record.instrumentationLibrary.schemaUrl || '');\n            var records = ilmMap.get(instrumentationLibraryKey);\n            if (!records) {\n                records = [];\n                ilmMap.set(instrumentationLibraryKey, records);\n            }\n            records.push(record);\n        }\n    }\n    catch (e_1_1) { e_1 = { error: e_1_1 }; }\n    finally {\n        try {\n            if (readableSpans_1_1 && !readableSpans_1_1.done && (_a = readableSpans_1.return)) _a.call(readableSpans_1);\n        }\n        finally { if (e_1) throw e_1.error; }\n    }\n    return resourceMap;\n}\nfunction spanRecordsToResourceSpans(readableSpans, useHex) {\n    var resourceMap = createResourceMap(readableSpans);\n    var out = [];\n    var entryIterator = resourceMap.entries();\n    var entry = entryIterator.next();\n    while (!entry.done) {\n        var _a = __read(entry.value, 2), resource = _a[0], ilmMap = _a[1];\n        var scopeResourceSpans = [];\n        var ilmIterator = ilmMap.values();\n        var ilmEntry = ilmIterator.next();\n        while (!ilmEntry.done) {\n            var scopeSpans = ilmEntry.value;\n            if (scopeSpans.length > 0) {\n                var _b = scopeSpans[0].instrumentationLibrary, name_1 = _b.name, version = _b.version, schemaUrl = _b.schemaUrl;\n                var spans = scopeSpans.map(function (readableSpan) { return sdkSpanToOtlpSpan(readableSpan, useHex); });\n                scopeResourceSpans.push({\n                    scope: { name: name_1, version: version },\n                    spans: spans,\n                    schemaUrl: schemaUrl\n                });\n            }\n            ilmEntry = ilmIterator.next();\n        }\n        // TODO SDK types don't provide resource schema URL at this time\n        var transformedSpans = {\n            resource: {\n                attributes: toAttributes(resource.attributes),\n                droppedAttributesCount: 0,\n            },\n            scopeSpans: scopeResourceSpans,\n            schemaUrl: undefined\n        };\n        out.push(transformedSpans);\n        entry = entryIterator.next();\n    }\n    return out;\n}\n//# sourceMappingURL=index.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n/**\n * NoopMeter is a noop implementation of the {@link Meter} interface. It reuses\n * constant NoopMetrics for all of its methods.\n */\nvar NoopMeter = /** @class */ (function () {\n    function NoopMeter() {\n    }\n    /**\n     * @see {@link Meter.createHistogram}\n     */\n    NoopMeter.prototype.createHistogram = function (_name, _options) {\n        return NOOP_HISTOGRAM_METRIC;\n    };\n    /**\n     * @see {@link Meter.createCounter}\n     */\n    NoopMeter.prototype.createCounter = function (_name, _options) {\n        return NOOP_COUNTER_METRIC;\n    };\n    /**\n     * @see {@link Meter.createUpDownCounter}\n     */\n    NoopMeter.prototype.createUpDownCounter = function (_name, _options) {\n        return NOOP_UP_DOWN_COUNTER_METRIC;\n    };\n    /**\n     * @see {@link Meter.createObservableGauge}\n     */\n    NoopMeter.prototype.createObservableGauge = function (_name, _options) {\n        return NOOP_OBSERVABLE_GAUGE_METRIC;\n    };\n    /**\n     * @see {@link Meter.createObservableCounter}\n     */\n    NoopMeter.prototype.createObservableCounter = function (_name, _options) {\n        return NOOP_OBSERVABLE_COUNTER_METRIC;\n    };\n    /**\n     * @see {@link Meter.createObservableUpDownCounter}\n     */\n    NoopMeter.prototype.createObservableUpDownCounter = function (_name, _options) {\n        return NOOP_OBSERVABLE_UP_DOWN_COUNTER_METRIC;\n    };\n    /**\n     * @see {@link Meter.addBatchObservableCallback}\n     */\n    NoopMeter.prototype.addBatchObservableCallback = function (_callback, _observables) { };\n    /**\n     * @see {@link Meter.removeBatchObservableCallback}\n     */\n    NoopMeter.prototype.removeBatchObservableCallback = function (_callback) { };\n    return NoopMeter;\n}());\nexport { NoopMeter };\nvar NoopMetric = /** @class */ (function () {\n    function NoopMetric() {\n    }\n    return NoopMetric;\n}());\nexport { NoopMetric };\nvar NoopCounterMetric = /** @class */ (function (_super) {\n    __extends(NoopCounterMetric, _super);\n    function NoopCounterMetric() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    NoopCounterMetric.prototype.add = function (_value, _attributes) { };\n    return NoopCounterMetric;\n}(NoopMetric));\nexport { NoopCounterMetric };\nvar NoopUpDownCounterMetric = /** @class */ (function (_super) {\n    __extends(NoopUpDownCounterMetric, _super);\n    function NoopUpDownCounterMetric() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    NoopUpDownCounterMetric.prototype.add = function (_value, _attributes) { };\n    return NoopUpDownCounterMetric;\n}(NoopMetric));\nexport { NoopUpDownCounterMetric };\nvar NoopHistogramMetric = /** @class */ (function (_super) {\n    __extends(NoopHistogramMetric, _super);\n    function NoopHistogramMetric() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    NoopHistogramMetric.prototype.record = function (_value, _attributes) { };\n    return NoopHistogramMetric;\n}(NoopMetric));\nexport { NoopHistogramMetric };\nvar NoopObservableMetric = /** @class */ (function () {\n    function NoopObservableMetric() {\n    }\n    NoopObservableMetric.prototype.addCallback = function (_callback) { };\n    NoopObservableMetric.prototype.removeCallback = function (_callback) { };\n    return NoopObservableMetric;\n}());\nexport { NoopObservableMetric };\nvar NoopObservableCounterMetric = /** @class */ (function (_super) {\n    __extends(NoopObservableCounterMetric, _super);\n    function NoopObservableCounterMetric() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    return NoopObservableCounterMetric;\n}(NoopObservableMetric));\nexport { NoopObservableCounterMetric };\nvar NoopObservableGaugeMetric = /** @class */ (function (_super) {\n    __extends(NoopObservableGaugeMetric, _super);\n    function NoopObservableGaugeMetric() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    return NoopObservableGaugeMetric;\n}(NoopObservableMetric));\nexport { NoopObservableGaugeMetric };\nvar NoopObservableUpDownCounterMetric = /** @class */ (function (_super) {\n    __extends(NoopObservableUpDownCounterMetric, _super);\n    function NoopObservableUpDownCounterMetric() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    return NoopObservableUpDownCounterMetric;\n}(NoopObservableMetric));\nexport { NoopObservableUpDownCounterMetric };\nexport var NOOP_METER = new NoopMeter();\n// Synchronous instruments\nexport var NOOP_COUNTER_METRIC = new NoopCounterMetric();\nexport var NOOP_HISTOGRAM_METRIC = new NoopHistogramMetric();\nexport var NOOP_UP_DOWN_COUNTER_METRIC = new NoopUpDownCounterMetric();\n// Asynchronous instruments\nexport var NOOP_OBSERVABLE_COUNTER_METRIC = new NoopObservableCounterMetric();\nexport var NOOP_OBSERVABLE_GAUGE_METRIC = new NoopObservableGaugeMetric();\nexport var NOOP_OBSERVABLE_UP_DOWN_COUNTER_METRIC = new NoopObservableUpDownCounterMetric();\n/**\n * Create a no-op Meter\n */\nexport function createNoopMeter() {\n    return NOOP_METER;\n}\n//# sourceMappingURL=NoopMeter.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/** The Type of value. It describes how the data is reported. */\nexport var ValueType;\n(function (ValueType) {\n    ValueType[ValueType[\"INT\"] = 0] = \"INT\";\n    ValueType[ValueType[\"DOUBLE\"] = 1] = \"DOUBLE\";\n})(ValueType || (ValueType = {}));\n//# sourceMappingURL=Metric.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { NOOP_METER } from './NoopMeter';\n/**\n * An implementation of the {@link MeterProvider} which returns an impotent Meter\n * for all calls to `getMeter`\n */\nvar NoopMeterProvider = /** @class */ (function () {\n    function NoopMeterProvider() {\n    }\n    NoopMeterProvider.prototype.getMeter = function (_name, _version, _options) {\n        return NOOP_METER;\n    };\n    return NoopMeterProvider;\n}());\nexport { NoopMeterProvider };\nexport var NOOP_METER_PROVIDER = new NoopMeterProvider();\n//# sourceMappingURL=NoopMeterProvider.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n// Updates to this file should also be replicated to @opentelemetry/api and\n// @opentelemetry/core too.\n/**\n * - globalThis (New standard)\n * - self (Will return the current window instance for supported browsers)\n * - window (fallback for older browser implementations)\n * - global (NodeJS implementation)\n * - <object> (When all else fails)\n */\n/** only globals that common to node and browsers are allowed */\n// eslint-disable-next-line node/no-unsupported-features/es-builtins, no-undef\nexport var _globalThis = typeof globalThis === 'object' ? globalThis :\n    typeof self === 'object' ? self :\n        typeof window === 'object' ? window :\n            typeof global === 'object' ? global :\n                {};\n//# sourceMappingURL=globalThis.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { _globalThis } from '../platform';\nexport var GLOBAL_METRICS_API_KEY = Symbol.for('io.opentelemetry.js.api.metrics');\nexport var _global = _globalThis;\n/**\n * Make a function which accepts a version integer and returns the instance of an API if the version\n * is compatible, or a fallback version (usually NOOP) if it is not.\n *\n * @param requiredVersion Backwards compatibility version which is required to return the instance\n * @param instance Instance which should be returned if the required version is compatible\n * @param fallback Fallback instance, usually NOOP, which will be returned if the required version is not compatible\n */\nexport function makeGetter(requiredVersion, instance, fallback) {\n    return function (version) {\n        return version === requiredVersion ? instance : fallback;\n    };\n}\n/**\n * A number which should be incremented each time a backwards incompatible\n * change is made to the API. This number is used when an API package\n * attempts to access the global API to ensure it is getting a compatible\n * version. If the global API is not compatible with the API package\n * attempting to get it, a NOOP API implementation will be returned.\n */\nexport var API_BACKWARDS_COMPATIBILITY_VERSION = 4;\n//# sourceMappingURL=global-utils.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * AggregationTemporality indicates the way additive quantities are expressed.\n */\nexport var AggregationTemporality;\n(function (AggregationTemporality) {\n    AggregationTemporality[AggregationTemporality[\"DELTA\"] = 0] = \"DELTA\";\n    AggregationTemporality[AggregationTemporality[\"CUMULATIVE\"] = 1] = \"CUMULATIVE\";\n})(AggregationTemporality || (AggregationTemporality = {}));\n//# sourceMappingURL=AggregationTemporality.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * The aggregated point data type.\n */\nexport var DataPointType;\n(function (DataPointType) {\n    /**\n     * A histogram data point contains a histogram statistics of collected\n     * values with a list of explicit bucket boundaries and statistics such\n     * as min, max, count, and sum of all collected values.\n     */\n    DataPointType[DataPointType[\"HISTOGRAM\"] = 0] = \"HISTOGRAM\";\n    /**\n     * An exponential histogram data point contains a histogram statistics of\n     * collected values where bucket boundaries are automatically calculated\n     * using an exponential function, and statistics such as min, max, count,\n     * and sum of all collected values.\n     */\n    DataPointType[DataPointType[\"EXPONENTIAL_HISTOGRAM\"] = 1] = \"EXPONENTIAL_HISTOGRAM\";\n    /**\n     * A gauge metric data point has only a single numeric value.\n     */\n    DataPointType[DataPointType[\"GAUGE\"] = 2] = \"GAUGE\";\n    /**\n     * A sum metric data point has a single numeric value and a\n     * monotonicity-indicator.\n     */\n    DataPointType[DataPointType[\"SUM\"] = 3] = \"SUM\";\n})(DataPointType || (DataPointType = {}));\n//# sourceMappingURL=MetricData.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { NOOP_METER_PROVIDER } from '../NoopMeterProvider';\nimport { API_BACKWARDS_COMPATIBILITY_VERSION, GLOBAL_METRICS_API_KEY, makeGetter, _global, } from './global-utils';\n/**\n * Singleton object which represents the entry point to the OpenTelemetry Metrics API\n */\nvar MetricsAPI = /** @class */ (function () {\n    /** Empty private constructor prevents end users from constructing a new instance of the API */\n    function MetricsAPI() {\n    }\n    /** Get the singleton instance of the Metrics API */\n    MetricsAPI.getInstance = function () {\n        if (!this._instance) {\n            this._instance = new MetricsAPI();\n        }\n        return this._instance;\n    };\n    /**\n     * Set the current global meter. Returns the initialized global meter provider.\n     */\n    MetricsAPI.prototype.setGlobalMeterProvider = function (provider) {\n        if (_global[GLOBAL_METRICS_API_KEY]) {\n            // global meter provider has already been set\n            return this.getMeterProvider();\n        }\n        _global[GLOBAL_METRICS_API_KEY] = makeGetter(API_BACKWARDS_COMPATIBILITY_VERSION, provider, NOOP_METER_PROVIDER);\n        return provider;\n    };\n    /**\n     * Returns the global meter provider.\n     */\n    MetricsAPI.prototype.getMeterProvider = function () {\n        var _a, _b;\n        return ((_b = (_a = _global[GLOBAL_METRICS_API_KEY]) === null || _a === void 0 ? void 0 : _a.call(_global, API_BACKWARDS_COMPATIBILITY_VERSION)) !== null && _b !== void 0 ? _b : NOOP_METER_PROVIDER);\n    };\n    /**\n     * Returns a meter from the global meter provider.\n     */\n    MetricsAPI.prototype.getMeter = function (name, version, options) {\n        return this.getMeterProvider().getMeter(name, version, options);\n    };\n    /** Remove the global meter provider */\n    MetricsAPI.prototype.disable = function () {\n        delete _global[GLOBAL_METRICS_API_KEY];\n    };\n    return MetricsAPI;\n}());\nexport { MetricsAPI };\n//# sourceMappingURL=metrics.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nexport { createNoopMeter, } from './NoopMeter';\nexport { ValueType, } from './types/Metric';\nimport { MetricsAPI } from './api/metrics';\n/** Entrypoint for metrics API */\nexport var metrics = MetricsAPI.getInstance();\n//# sourceMappingURL=index.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nvar __values = (this && this.__values) || function(o) {\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n    if (m) return m.call(o);\n    if (o && typeof o.length === \"number\") return {\n        next: function () {\n            if (o && i >= o.length) o = void 0;\n            return { value: o && o[i++], done: !o };\n        }\n    };\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\nexport function isNotNullish(item) {\n    return item !== undefined && item !== null;\n}\n/**\n * Converting the unordered attributes into unique identifier string.\n * @param attributes user provided unordered MetricAttributes.\n */\nexport function hashAttributes(attributes) {\n    var keys = Object.keys(attributes);\n    if (keys.length === 0)\n        return '';\n    // Return a string that is stable on key orders.\n    keys = keys.sort();\n    return JSON.stringify(keys.map(function (key) { return [key, attributes[key]]; }));\n}\n/**\n * Converting the instrumentation scope object to a unique identifier string.\n * @param instrumentationScope\n */\nexport function instrumentationScopeId(instrumentationScope) {\n    var _a, _b;\n    return instrumentationScope.name + \":\" + ((_a = instrumentationScope.version) !== null && _a !== void 0 ? _a : '') + \":\" + ((_b = instrumentationScope.schemaUrl) !== null && _b !== void 0 ? _b : '');\n}\n/**\n * Error that is thrown on timeouts.\n */\nvar TimeoutError = /** @class */ (function (_super) {\n    __extends(TimeoutError, _super);\n    function TimeoutError(message) {\n        var _this = _super.call(this, message) || this;\n        // manually adjust prototype to retain `instanceof` functionality when targeting ES5, see:\n        // https://github.com/Microsoft/TypeScript-wiki/blob/main/Breaking-Changes.md#extending-built-ins-like-error-array-and-map-may-no-longer-work\n        Object.setPrototypeOf(_this, TimeoutError.prototype);\n        return _this;\n    }\n    return TimeoutError;\n}(Error));\nexport { TimeoutError };\n/**\n * Adds a timeout to a promise and rejects if the specified timeout has elapsed. Also rejects if the specified promise\n * rejects, and resolves if the specified promise resolves.\n *\n * <p> NOTE: this operation will continue even after it throws a {@link TimeoutError}.\n *\n * @param promise promise to use with timeout.\n * @param timeout the timeout in milliseconds until the returned promise is rejected.\n */\nexport function callWithTimeout(promise, timeout) {\n    var timeoutHandle;\n    var timeoutPromise = new Promise(function timeoutFunction(_resolve, reject) {\n        timeoutHandle = setTimeout(function timeoutHandler() {\n            reject(new TimeoutError('Operation timed out.'));\n        }, timeout);\n    });\n    return Promise.race([promise, timeoutPromise]).then(function (result) {\n        clearTimeout(timeoutHandle);\n        return result;\n    }, function (reason) {\n        clearTimeout(timeoutHandle);\n        throw reason;\n    });\n}\n/**\n * Node.js v12.9 lower and browser compatible `Promise.allSettled`.\n */\nexport function PromiseAllSettled(promises) {\n    return __awaiter(this, void 0, void 0, function () {\n        var _this = this;\n        return __generator(this, function (_a) {\n            return [2 /*return*/, Promise.all(promises.map(function (p) { return __awaiter(_this, void 0, void 0, function () {\n                    var ret, e_1;\n                    return __generator(this, function (_a) {\n                        switch (_a.label) {\n                            case 0:\n                                _a.trys.push([0, 2, , 3]);\n                                return [4 /*yield*/, p];\n                            case 1:\n                                ret = _a.sent();\n                                return [2 /*return*/, {\n                                        status: 'fulfilled',\n                                        value: ret,\n                                    }];\n                            case 2:\n                                e_1 = _a.sent();\n                                return [2 /*return*/, {\n                                        status: 'rejected',\n                                        reason: e_1,\n                                    }];\n                            case 3: return [2 /*return*/];\n                        }\n                    });\n                }); }))];\n        });\n    });\n}\nexport function isPromiseAllSettledRejectionResult(it) {\n    return it.status === 'rejected';\n}\n/**\n * Node.js v11.0 lower and browser compatible `Array.prototype.flatMap`.\n */\nexport function FlatMap(arr, fn) {\n    var result = [];\n    arr.forEach(function (it) {\n        result.push.apply(result, __spreadArray([], __read(fn(it)), false));\n    });\n    return result;\n}\nexport function setEquals(lhs, rhs) {\n    var e_2, _a;\n    if (lhs.size !== rhs.size) {\n        return false;\n    }\n    try {\n        for (var lhs_1 = __values(lhs), lhs_1_1 = lhs_1.next(); !lhs_1_1.done; lhs_1_1 = lhs_1.next()) {\n            var item = lhs_1_1.value;\n            if (!rhs.has(item)) {\n                return false;\n            }\n        }\n    }\n    catch (e_2_1) { e_2 = { error: e_2_1 }; }\n    finally {\n        try {\n            if (lhs_1_1 && !lhs_1_1.done && (_a = lhs_1.return)) _a.call(lhs_1);\n        }\n        finally { if (e_2) throw e_2.error; }\n    }\n    return true;\n}\n//# sourceMappingURL=utils.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/** The kind of aggregator. */\nexport var AggregatorKind;\n(function (AggregatorKind) {\n    AggregatorKind[AggregatorKind[\"DROP\"] = 0] = \"DROP\";\n    AggregatorKind[AggregatorKind[\"SUM\"] = 1] = \"SUM\";\n    AggregatorKind[AggregatorKind[\"LAST_VALUE\"] = 2] = \"LAST_VALUE\";\n    AggregatorKind[AggregatorKind[\"HISTOGRAM\"] = 3] = \"HISTOGRAM\";\n})(AggregatorKind || (AggregatorKind = {}));\n//# sourceMappingURL=types.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { AggregatorKind, } from './types';\n/** Basic aggregator for None which keeps no recorded value. */\nvar DropAggregator = /** @class */ (function () {\n    function DropAggregator() {\n        this.kind = AggregatorKind.DROP;\n    }\n    DropAggregator.prototype.createAccumulation = function () {\n        return undefined;\n    };\n    DropAggregator.prototype.merge = function (_previous, _delta) {\n        return undefined;\n    };\n    DropAggregator.prototype.diff = function (_previous, _current) {\n        return undefined;\n    };\n    DropAggregator.prototype.toMetricData = function (_descriptor, _aggregationTemporality, _accumulationByAttributes, _endTime) {\n        return undefined;\n    };\n    return DropAggregator;\n}());\nexport { DropAggregator };\n//# sourceMappingURL=Drop.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { ValueType } from '@opentelemetry/api-metrics';\n/**\n * Supported types of metric instruments.\n */\nexport var InstrumentType;\n(function (InstrumentType) {\n    InstrumentType[\"COUNTER\"] = \"COUNTER\";\n    InstrumentType[\"HISTOGRAM\"] = \"HISTOGRAM\";\n    InstrumentType[\"UP_DOWN_COUNTER\"] = \"UP_DOWN_COUNTER\";\n    InstrumentType[\"OBSERVABLE_COUNTER\"] = \"OBSERVABLE_COUNTER\";\n    InstrumentType[\"OBSERVABLE_GAUGE\"] = \"OBSERVABLE_GAUGE\";\n    InstrumentType[\"OBSERVABLE_UP_DOWN_COUNTER\"] = \"OBSERVABLE_UP_DOWN_COUNTER\";\n})(InstrumentType || (InstrumentType = {}));\nexport function createInstrumentDescriptor(name, type, options) {\n    var _a, _b, _c;\n    return {\n        name: name,\n        type: type,\n        description: (_a = options === null || options === void 0 ? void 0 : options.description) !== null && _a !== void 0 ? _a : '',\n        unit: (_b = options === null || options === void 0 ? void 0 : options.unit) !== null && _b !== void 0 ? _b : '',\n        valueType: (_c = options === null || options === void 0 ? void 0 : options.valueType) !== null && _c !== void 0 ? _c : ValueType.DOUBLE,\n    };\n}\nexport function createInstrumentDescriptorWithView(view, instrument) {\n    var _a, _b;\n    return {\n        name: (_a = view.name) !== null && _a !== void 0 ? _a : instrument.name,\n        description: (_b = view.description) !== null && _b !== void 0 ? _b : instrument.description,\n        type: instrument.type,\n        unit: instrument.unit,\n        valueType: instrument.valueType,\n    };\n}\nexport function isDescriptorCompatibleWith(descriptor, otherDescriptor) {\n    return descriptor.name === otherDescriptor.name\n        && descriptor.unit === otherDescriptor.unit\n        && descriptor.type === otherDescriptor.type\n        && descriptor.valueType === otherDescriptor.valueType;\n}\n//# sourceMappingURL=InstrumentDescriptor.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nimport { AggregatorKind } from './types';\nimport { DataPointType } from '../export/MetricData';\nimport { InstrumentType } from '../InstrumentDescriptor';\nfunction createNewEmptyCheckpoint(boundaries) {\n    var counts = boundaries.map(function () { return 0; });\n    counts.push(0);\n    return {\n        buckets: {\n            boundaries: boundaries,\n            counts: counts,\n        },\n        sum: 0,\n        count: 0,\n        hasMinMax: false,\n        min: Infinity,\n        max: -Infinity\n    };\n}\nvar HistogramAccumulation = /** @class */ (function () {\n    function HistogramAccumulation(startTime, _boundaries, _recordMinMax, _current) {\n        if (_recordMinMax === void 0) { _recordMinMax = true; }\n        if (_current === void 0) { _current = createNewEmptyCheckpoint(_boundaries); }\n        this.startTime = startTime;\n        this._boundaries = _boundaries;\n        this._recordMinMax = _recordMinMax;\n        this._current = _current;\n    }\n    HistogramAccumulation.prototype.record = function (value) {\n        this._current.count += 1;\n        this._current.sum += value;\n        if (this._recordMinMax) {\n            this._current.min = Math.min(value, this._current.min);\n            this._current.max = Math.max(value, this._current.max);\n            this._current.hasMinMax = true;\n        }\n        for (var i = 0; i < this._boundaries.length; i++) {\n            if (value < this._boundaries[i]) {\n                this._current.buckets.counts[i] += 1;\n                return;\n            }\n        }\n        // value is above all observed boundaries\n        this._current.buckets.counts[this._boundaries.length] += 1;\n    };\n    HistogramAccumulation.prototype.setStartTime = function (startTime) {\n        this.startTime = startTime;\n    };\n    HistogramAccumulation.prototype.toPointValue = function () {\n        return this._current;\n    };\n    return HistogramAccumulation;\n}());\nexport { HistogramAccumulation };\n/**\n * Basic aggregator which observes events and counts them in pre-defined buckets\n * and provides the total sum and count of all observations.\n */\nvar HistogramAggregator = /** @class */ (function () {\n    /**\n     * @param _boundaries upper bounds of recorded values.\n     * @param _recordMinMax If set to true, min and max will be recorded. Otherwise, min and max will not be recorded.\n     */\n    function HistogramAggregator(_boundaries, _recordMinMax) {\n        this._boundaries = _boundaries;\n        this._recordMinMax = _recordMinMax;\n        this.kind = AggregatorKind.HISTOGRAM;\n    }\n    HistogramAggregator.prototype.createAccumulation = function (startTime) {\n        return new HistogramAccumulation(startTime, this._boundaries, this._recordMinMax);\n    };\n    /**\n     * Return the result of the merge of two histogram accumulations. As long as one Aggregator\n     * instance produces all Accumulations with constant boundaries we don't need to worry about\n     * merging accumulations with different boundaries.\n     */\n    HistogramAggregator.prototype.merge = function (previous, delta) {\n        var previousValue = previous.toPointValue();\n        var deltaValue = delta.toPointValue();\n        var previousCounts = previousValue.buckets.counts;\n        var deltaCounts = deltaValue.buckets.counts;\n        var mergedCounts = new Array(previousCounts.length);\n        for (var idx = 0; idx < previousCounts.length; idx++) {\n            mergedCounts[idx] = previousCounts[idx] + deltaCounts[idx];\n        }\n        var min = Infinity;\n        var max = -Infinity;\n        if (this._recordMinMax) {\n            if (previousValue.hasMinMax && deltaValue.hasMinMax) {\n                min = Math.min(previousValue.min, deltaValue.min);\n                max = Math.max(previousValue.max, deltaValue.max);\n            }\n            else if (previousValue.hasMinMax) {\n                min = previousValue.min;\n                max = previousValue.max;\n            }\n            else if (deltaValue.hasMinMax) {\n                min = deltaValue.min;\n                max = deltaValue.max;\n            }\n        }\n        return new HistogramAccumulation(previous.startTime, previousValue.buckets.boundaries, this._recordMinMax, {\n            buckets: {\n                boundaries: previousValue.buckets.boundaries,\n                counts: mergedCounts,\n            },\n            count: previousValue.count + deltaValue.count,\n            sum: previousValue.sum + deltaValue.sum,\n            hasMinMax: this._recordMinMax && (previousValue.hasMinMax || deltaValue.hasMinMax),\n            min: min,\n            max: max\n        });\n    };\n    /**\n     * Returns a new DELTA aggregation by comparing two cumulative measurements.\n     */\n    HistogramAggregator.prototype.diff = function (previous, current) {\n        var previousValue = previous.toPointValue();\n        var currentValue = current.toPointValue();\n        var previousCounts = previousValue.buckets.counts;\n        var currentCounts = currentValue.buckets.counts;\n        var diffedCounts = new Array(previousCounts.length);\n        for (var idx = 0; idx < previousCounts.length; idx++) {\n            diffedCounts[idx] = currentCounts[idx] - previousCounts[idx];\n        }\n        return new HistogramAccumulation(current.startTime, previousValue.buckets.boundaries, this._recordMinMax, {\n            buckets: {\n                boundaries: previousValue.buckets.boundaries,\n                counts: diffedCounts,\n            },\n            count: currentValue.count - previousValue.count,\n            sum: currentValue.sum - previousValue.sum,\n            hasMinMax: false,\n            min: Infinity,\n            max: -Infinity\n        });\n    };\n    HistogramAggregator.prototype.toMetricData = function (descriptor, aggregationTemporality, accumulationByAttributes, endTime) {\n        return {\n            descriptor: descriptor,\n            aggregationTemporality: aggregationTemporality,\n            dataPointType: DataPointType.HISTOGRAM,\n            dataPoints: accumulationByAttributes.map(function (_a) {\n                var _b = __read(_a, 2), attributes = _b[0], accumulation = _b[1];\n                var pointValue = accumulation.toPointValue();\n                // determine if instrument allows negative values.\n                var allowsNegativeValues = (descriptor.type === InstrumentType.UP_DOWN_COUNTER) ||\n                    (descriptor.type === InstrumentType.OBSERVABLE_GAUGE) ||\n                    (descriptor.type === InstrumentType.OBSERVABLE_UP_DOWN_COUNTER);\n                return {\n                    attributes: attributes,\n                    startTime: accumulation.startTime,\n                    endTime: endTime,\n                    value: {\n                        min: pointValue.hasMinMax ? pointValue.min : undefined,\n                        max: pointValue.hasMinMax ? pointValue.max : undefined,\n                        sum: !allowsNegativeValues ? pointValue.sum : undefined,\n                        buckets: pointValue.buckets,\n                        count: pointValue.count\n                    },\n                };\n            })\n        };\n    };\n    return HistogramAggregator;\n}());\nexport { HistogramAggregator };\n//# sourceMappingURL=Histogram.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nimport { AggregatorKind } from './types';\nimport { hrTime, hrTimeToMicroseconds } from '@opentelemetry/core';\nimport { DataPointType } from '../export/MetricData';\nvar LastValueAccumulation = /** @class */ (function () {\n    function LastValueAccumulation(startTime, _current, sampleTime) {\n        if (_current === void 0) { _current = 0; }\n        if (sampleTime === void 0) { sampleTime = [0, 0]; }\n        this.startTime = startTime;\n        this._current = _current;\n        this.sampleTime = sampleTime;\n    }\n    LastValueAccumulation.prototype.record = function (value) {\n        this._current = value;\n        this.sampleTime = hrTime();\n    };\n    LastValueAccumulation.prototype.setStartTime = function (startTime) {\n        this.startTime = startTime;\n    };\n    LastValueAccumulation.prototype.toPointValue = function () {\n        return this._current;\n    };\n    return LastValueAccumulation;\n}());\nexport { LastValueAccumulation };\n/** Basic aggregator which calculates a LastValue from individual measurements. */\nvar LastValueAggregator = /** @class */ (function () {\n    function LastValueAggregator() {\n        this.kind = AggregatorKind.LAST_VALUE;\n    }\n    LastValueAggregator.prototype.createAccumulation = function (startTime) {\n        return new LastValueAccumulation(startTime);\n    };\n    /**\n     * Returns the result of the merge of the given accumulations.\n     *\n     * Return the newly captured (delta) accumulation for LastValueAggregator.\n     */\n    LastValueAggregator.prototype.merge = function (previous, delta) {\n        // nanoseconds may lose precisions.\n        var latestAccumulation = hrTimeToMicroseconds(delta.sampleTime) >= hrTimeToMicroseconds(previous.sampleTime) ? delta : previous;\n        return new LastValueAccumulation(previous.startTime, latestAccumulation.toPointValue(), latestAccumulation.sampleTime);\n    };\n    /**\n     * Returns a new DELTA aggregation by comparing two cumulative measurements.\n     *\n     * A delta aggregation is not meaningful to LastValueAggregator, just return\n     * the newly captured (delta) accumulation for LastValueAggregator.\n     */\n    LastValueAggregator.prototype.diff = function (previous, current) {\n        // nanoseconds may lose precisions.\n        var latestAccumulation = hrTimeToMicroseconds(current.sampleTime) >= hrTimeToMicroseconds(previous.sampleTime) ? current : previous;\n        return new LastValueAccumulation(current.startTime, latestAccumulation.toPointValue(), latestAccumulation.sampleTime);\n    };\n    LastValueAggregator.prototype.toMetricData = function (descriptor, aggregationTemporality, accumulationByAttributes, endTime) {\n        return {\n            descriptor: descriptor,\n            aggregationTemporality: aggregationTemporality,\n            dataPointType: DataPointType.GAUGE,\n            dataPoints: accumulationByAttributes.map(function (_a) {\n                var _b = __read(_a, 2), attributes = _b[0], accumulation = _b[1];\n                return {\n                    attributes: attributes,\n                    startTime: accumulation.startTime,\n                    endTime: endTime,\n                    value: accumulation.toPointValue(),\n                };\n            })\n        };\n    };\n    return LastValueAggregator;\n}());\nexport { LastValueAggregator };\n//# sourceMappingURL=LastValue.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nimport { AggregatorKind } from './types';\nimport { DataPointType } from '../export/MetricData';\nvar SumAccumulation = /** @class */ (function () {\n    function SumAccumulation(startTime, monotonic, _current, reset) {\n        if (_current === void 0) { _current = 0; }\n        if (reset === void 0) { reset = false; }\n        this.startTime = startTime;\n        this.monotonic = monotonic;\n        this._current = _current;\n        this.reset = reset;\n    }\n    SumAccumulation.prototype.record = function (value) {\n        if (this.monotonic && value < 0) {\n            return;\n        }\n        this._current += value;\n    };\n    SumAccumulation.prototype.setStartTime = function (startTime) {\n        this.startTime = startTime;\n    };\n    SumAccumulation.prototype.toPointValue = function () {\n        return this._current;\n    };\n    return SumAccumulation;\n}());\nexport { SumAccumulation };\n/** Basic aggregator which calculates a Sum from individual measurements. */\nvar SumAggregator = /** @class */ (function () {\n    function SumAggregator(monotonic) {\n        this.monotonic = monotonic;\n        this.kind = AggregatorKind.SUM;\n    }\n    SumAggregator.prototype.createAccumulation = function (startTime) {\n        return new SumAccumulation(startTime, this.monotonic);\n    };\n    /**\n     * Returns the result of the merge of the given accumulations.\n     */\n    SumAggregator.prototype.merge = function (previous, delta) {\n        var prevPv = previous.toPointValue();\n        var deltaPv = delta.toPointValue();\n        if (delta.reset) {\n            return new SumAccumulation(delta.startTime, this.monotonic, deltaPv, delta.reset);\n        }\n        return new SumAccumulation(previous.startTime, this.monotonic, prevPv + deltaPv);\n    };\n    /**\n     * Returns a new DELTA aggregation by comparing two cumulative measurements.\n     */\n    SumAggregator.prototype.diff = function (previous, current) {\n        var prevPv = previous.toPointValue();\n        var currPv = current.toPointValue();\n        /**\n         * If the SumAggregator is a monotonic one and the previous point value is\n         * greater than the current one, a reset is deemed to be happened.\n         * Return the current point value to prevent the value from been reset.\n         */\n        if (this.monotonic && (prevPv > currPv)) {\n            return new SumAccumulation(current.startTime, this.monotonic, currPv, true);\n        }\n        return new SumAccumulation(current.startTime, this.monotonic, currPv - prevPv);\n    };\n    SumAggregator.prototype.toMetricData = function (descriptor, aggregationTemporality, accumulationByAttributes, endTime) {\n        return {\n            descriptor: descriptor,\n            aggregationTemporality: aggregationTemporality,\n            dataPointType: DataPointType.SUM,\n            dataPoints: accumulationByAttributes.map(function (_a) {\n                var _b = __read(_a, 2), attributes = _b[0], accumulation = _b[1];\n                return {\n                    attributes: attributes,\n                    startTime: accumulation.startTime,\n                    endTime: endTime,\n                    value: accumulation.toPointValue(),\n                };\n            }),\n            isMonotonic: this.monotonic\n        };\n    };\n    return SumAggregator;\n}());\nexport { SumAggregator };\n//# sourceMappingURL=Sum.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport * as api from '@opentelemetry/api';\nimport { SumAggregator, DropAggregator, LastValueAggregator, HistogramAggregator } from '../aggregator';\nimport { InstrumentType } from '../InstrumentDescriptor';\n/**\n * Configures how measurements are combined into metrics for views.\n *\n * Aggregation provides a set of built-in aggregations via static methods.\n */\nvar Aggregation = /** @class */ (function () {\n    function Aggregation() {\n    }\n    Aggregation.Drop = function () {\n        return DROP_AGGREGATION;\n    };\n    Aggregation.Sum = function () {\n        return SUM_AGGREGATION;\n    };\n    Aggregation.LastValue = function () {\n        return LAST_VALUE_AGGREGATION;\n    };\n    Aggregation.Histogram = function () {\n        return HISTOGRAM_AGGREGATION;\n    };\n    Aggregation.Default = function () {\n        return DEFAULT_AGGREGATION;\n    };\n    return Aggregation;\n}());\nexport { Aggregation };\n/**\n * The default drop aggregation.\n */\nvar DropAggregation = /** @class */ (function (_super) {\n    __extends(DropAggregation, _super);\n    function DropAggregation() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    DropAggregation.prototype.createAggregator = function (_instrument) {\n        return DropAggregation.DEFAULT_INSTANCE;\n    };\n    DropAggregation.DEFAULT_INSTANCE = new DropAggregator();\n    return DropAggregation;\n}(Aggregation));\nexport { DropAggregation };\n/**\n * The default sum aggregation.\n */\nvar SumAggregation = /** @class */ (function (_super) {\n    __extends(SumAggregation, _super);\n    function SumAggregation() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    SumAggregation.prototype.createAggregator = function (instrument) {\n        switch (instrument.type) {\n            case InstrumentType.COUNTER:\n            case InstrumentType.OBSERVABLE_COUNTER:\n            case InstrumentType.HISTOGRAM: {\n                return SumAggregation.MONOTONIC_INSTANCE;\n            }\n            default: {\n                return SumAggregation.NON_MONOTONIC_INSTANCE;\n            }\n        }\n    };\n    SumAggregation.MONOTONIC_INSTANCE = new SumAggregator(true);\n    SumAggregation.NON_MONOTONIC_INSTANCE = new SumAggregator(false);\n    return SumAggregation;\n}(Aggregation));\nexport { SumAggregation };\n/**\n * The default last value aggregation.\n */\nvar LastValueAggregation = /** @class */ (function (_super) {\n    __extends(LastValueAggregation, _super);\n    function LastValueAggregation() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    LastValueAggregation.prototype.createAggregator = function (_instrument) {\n        return LastValueAggregation.DEFAULT_INSTANCE;\n    };\n    LastValueAggregation.DEFAULT_INSTANCE = new LastValueAggregator();\n    return LastValueAggregation;\n}(Aggregation));\nexport { LastValueAggregation };\n/**\n * The default histogram aggregation.\n */\nvar HistogramAggregation = /** @class */ (function (_super) {\n    __extends(HistogramAggregation, _super);\n    function HistogramAggregation() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    HistogramAggregation.prototype.createAggregator = function (_instrument) {\n        return HistogramAggregation.DEFAULT_INSTANCE;\n    };\n    HistogramAggregation.DEFAULT_INSTANCE = new HistogramAggregator([0, 5, 10, 25, 50, 75, 100, 250, 500, 1000], true);\n    return HistogramAggregation;\n}(Aggregation));\nexport { HistogramAggregation };\n/**\n * The explicit bucket histogram aggregation.\n */\nvar ExplicitBucketHistogramAggregation = /** @class */ (function (_super) {\n    __extends(ExplicitBucketHistogramAggregation, _super);\n    /**\n     * @param boundaries the bucket boundaries of the histogram aggregation\n     * @param _recordMinMax If set to true, min and max will be recorded. Otherwise, min and max will not be recorded.\n     */\n    function ExplicitBucketHistogramAggregation(boundaries, _recordMinMax) {\n        if (_recordMinMax === void 0) { _recordMinMax = true; }\n        var _this = _super.call(this) || this;\n        _this._recordMinMax = _recordMinMax;\n        if (boundaries === undefined || boundaries.length === 0) {\n            throw new Error('HistogramAggregator should be created with boundaries.');\n        }\n        // Copy the boundaries array for modification.\n        boundaries = boundaries.concat();\n        // We need to an ordered set to be able to correctly compute count for each\n        // boundary since we'll iterate on each in order.\n        boundaries = boundaries.sort(function (a, b) { return a - b; });\n        // Remove all Infinity from the boundaries.\n        var minusInfinityIndex = boundaries.lastIndexOf(-Infinity);\n        var infinityIndex = boundaries.indexOf(Infinity);\n        if (infinityIndex === -1) {\n            infinityIndex = undefined;\n        }\n        _this._boundaries = boundaries.slice(minusInfinityIndex + 1, infinityIndex);\n        return _this;\n    }\n    ExplicitBucketHistogramAggregation.prototype.createAggregator = function (_instrument) {\n        return new HistogramAggregator(this._boundaries, this._recordMinMax);\n    };\n    return ExplicitBucketHistogramAggregation;\n}(Aggregation));\nexport { ExplicitBucketHistogramAggregation };\n/**\n * The default aggregation.\n */\nvar DefaultAggregation = /** @class */ (function (_super) {\n    __extends(DefaultAggregation, _super);\n    function DefaultAggregation() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    DefaultAggregation.prototype._resolve = function (instrument) {\n        // cast to unknown to disable complaints on the (unreachable) fallback.\n        switch (instrument.type) {\n            case InstrumentType.COUNTER:\n            case InstrumentType.UP_DOWN_COUNTER:\n            case InstrumentType.OBSERVABLE_COUNTER:\n            case InstrumentType.OBSERVABLE_UP_DOWN_COUNTER: {\n                return SUM_AGGREGATION;\n            }\n            case InstrumentType.OBSERVABLE_GAUGE: {\n                return LAST_VALUE_AGGREGATION;\n            }\n            case InstrumentType.HISTOGRAM: {\n                return HISTOGRAM_AGGREGATION;\n            }\n        }\n        api.diag.warn(\"Unable to recognize instrument type: \" + instrument.type);\n        return DROP_AGGREGATION;\n    };\n    DefaultAggregation.prototype.createAggregator = function (instrument) {\n        return this._resolve(instrument).createAggregator(instrument);\n    };\n    return DefaultAggregation;\n}(Aggregation));\nexport { DefaultAggregation };\nvar DROP_AGGREGATION = new DropAggregation();\nvar SUM_AGGREGATION = new SumAggregation();\nvar LAST_VALUE_AGGREGATION = new LastValueAggregation();\nvar HISTOGRAM_AGGREGATION = new HistogramAggregation();\nvar DEFAULT_AGGREGATION = new DefaultAggregation();\n//# sourceMappingURL=Aggregation.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { Aggregation } from '../view/Aggregation';\nimport { AggregationTemporality } from './AggregationTemporality';\nexport var DEFAULT_AGGREGATION_SELECTOR = function (_instrumentType) { return Aggregation.Default(); };\nexport var DEFAULT_AGGREGATION_TEMPORALITY_SELECTOR = function (_instrumentType) { return AggregationTemporality.CUMULATIVE; };\n//# sourceMappingURL=AggregationSelector.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport * as api from '@opentelemetry/api';\nimport { callWithTimeout } from '../utils';\nimport { DEFAULT_AGGREGATION_SELECTOR, DEFAULT_AGGREGATION_TEMPORALITY_SELECTOR } from './AggregationSelector';\n/**\n * A registered reader of metrics that, when linked to a {@link MetricProducer}, offers global\n * control over metrics.\n */\nvar MetricReader = /** @class */ (function () {\n    function MetricReader(options) {\n        var _a, _b;\n        // Tracks the shutdown state.\n        // TODO: use BindOncePromise here once a new version of @opentelemetry/core is available.\n        this._shutdown = false;\n        this._aggregationSelector = (_a = options === null || options === void 0 ? void 0 : options.aggregationSelector) !== null && _a !== void 0 ? _a : DEFAULT_AGGREGATION_SELECTOR;\n        this._aggregationTemporalitySelector = (_b = options === null || options === void 0 ? void 0 : options.aggregationTemporalitySelector) !== null && _b !== void 0 ? _b : DEFAULT_AGGREGATION_TEMPORALITY_SELECTOR;\n    }\n    /**\n     * Set the {@link MetricProducer} used by this instance.\n     *\n     * @param metricProducer\n     */\n    MetricReader.prototype.setMetricProducer = function (metricProducer) {\n        if (this._metricProducer) {\n            throw new Error('MetricReader can not be bound to a MeterProvider again.');\n        }\n        this._metricProducer = metricProducer;\n        this.onInitialized();\n    };\n    /**\n     * Select the {@link Aggregation} for the given {@link InstrumentType} for this\n     * reader.\n     */\n    MetricReader.prototype.selectAggregation = function (instrumentType) {\n        return this._aggregationSelector(instrumentType);\n    };\n    /**\n     * Select the {@link AggregationTemporality} for the given\n     * {@link InstrumentType} for this reader.\n     */\n    MetricReader.prototype.selectAggregationTemporality = function (instrumentType) {\n        return this._aggregationTemporalitySelector(instrumentType);\n    };\n    /**\n     * Handle once the SDK has initialized this {@link MetricReader}\n     * Overriding this method is optional.\n     */\n    MetricReader.prototype.onInitialized = function () {\n        // Default implementation is empty.\n    };\n    /**\n     * Collect all metrics from the associated {@link MetricProducer}\n     */\n    MetricReader.prototype.collect = function (options) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                if (this._metricProducer === undefined) {\n                    throw new Error('MetricReader is not bound to a MetricProducer');\n                }\n                // Subsequent invocations to collect are not allowed. SDKs SHOULD return some failure for these calls.\n                if (this._shutdown) {\n                    throw new Error('MetricReader is shutdown');\n                }\n                return [2 /*return*/, this._metricProducer.collect({\n                        timeoutMillis: options === null || options === void 0 ? void 0 : options.timeoutMillis,\n                    })];\n            });\n        });\n    };\n    /**\n     * Shuts down the metric reader, the promise will reject after the optional timeout or resolve after completion.\n     *\n     * <p> NOTE: this operation will continue even after the promise rejects due to a timeout.\n     * @param options options with timeout.\n     */\n    MetricReader.prototype.shutdown = function (options) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        // Do not call shutdown again if it has already been called.\n                        if (this._shutdown) {\n                            api.diag.error('Cannot call shutdown twice.');\n                            return [2 /*return*/];\n                        }\n                        if (!((options === null || options === void 0 ? void 0 : options.timeoutMillis) == null)) return [3 /*break*/, 2];\n                        return [4 /*yield*/, this.onShutdown()];\n                    case 1:\n                        _a.sent();\n                        return [3 /*break*/, 4];\n                    case 2: return [4 /*yield*/, callWithTimeout(this.onShutdown(), options.timeoutMillis)];\n                    case 3:\n                        _a.sent();\n                        _a.label = 4;\n                    case 4:\n                        this._shutdown = true;\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /**\n     * Flushes metrics read by this reader, the promise will reject after the optional timeout or resolve after completion.\n     *\n     * <p> NOTE: this operation will continue even after the promise rejects due to a timeout.\n     * @param options options with timeout.\n     */\n    MetricReader.prototype.forceFlush = function (options) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (this._shutdown) {\n                            api.diag.warn('Cannot forceFlush on already shutdown MetricReader.');\n                            return [2 /*return*/];\n                        }\n                        if (!((options === null || options === void 0 ? void 0 : options.timeoutMillis) == null)) return [3 /*break*/, 2];\n                        return [4 /*yield*/, this.onForceFlush()];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/];\n                    case 2: return [4 /*yield*/, callWithTimeout(this.onForceFlush(), options.timeoutMillis)];\n                    case 3:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    return MetricReader;\n}());\nexport { MetricReader };\n//# sourceMappingURL=MetricReader.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport * as api from '@opentelemetry/api';\nimport { ExportResultCode, globalErrorHandler, unrefTimer } from '@opentelemetry/core';\nimport { MetricReader } from './MetricReader';\nimport { callWithTimeout, TimeoutError } from '../utils';\n/**\n * {@link MetricReader} which collects metrics based on a user-configurable time interval, and passes the metrics to\n * the configured {@link PushMetricExporter}\n */\nvar PeriodicExportingMetricReader = /** @class */ (function (_super) {\n    __extends(PeriodicExportingMetricReader, _super);\n    function PeriodicExportingMetricReader(options) {\n        var _a, _b, _c, _d;\n        var _this = _super.call(this, {\n            aggregationSelector: (_a = options.exporter.selectAggregation) === null || _a === void 0 ? void 0 : _a.bind(options.exporter),\n            aggregationTemporalitySelector: (_b = options.exporter.selectAggregationTemporality) === null || _b === void 0 ? void 0 : _b.bind(options.exporter)\n        }) || this;\n        if (options.exportIntervalMillis !== undefined && options.exportIntervalMillis <= 0) {\n            throw Error('exportIntervalMillis must be greater than 0');\n        }\n        if (options.exportTimeoutMillis !== undefined && options.exportTimeoutMillis <= 0) {\n            throw Error('exportTimeoutMillis must be greater than 0');\n        }\n        if (options.exportTimeoutMillis !== undefined &&\n            options.exportIntervalMillis !== undefined &&\n            options.exportIntervalMillis < options.exportTimeoutMillis) {\n            throw Error('exportIntervalMillis must be greater than or equal to exportTimeoutMillis');\n        }\n        _this._exportInterval = (_c = options.exportIntervalMillis) !== null && _c !== void 0 ? _c : 60000;\n        _this._exportTimeout = (_d = options.exportTimeoutMillis) !== null && _d !== void 0 ? _d : 30000;\n        _this._exporter = options.exporter;\n        return _this;\n    }\n    PeriodicExportingMetricReader.prototype._runOnce = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, resourceMetrics, errors;\n            var _b;\n            var _this = this;\n            return __generator(this, function (_c) {\n                switch (_c.label) {\n                    case 0: return [4 /*yield*/, this.collect({})];\n                    case 1:\n                        _a = _c.sent(), resourceMetrics = _a.resourceMetrics, errors = _a.errors;\n                        if (errors.length > 0) {\n                            (_b = api.diag).error.apply(_b, __spreadArray(['PeriodicExportingMetricReader: metrics collection errors'], __read(errors), false));\n                        }\n                        return [2 /*return*/, new Promise(function (resolve, reject) {\n                                _this._exporter.export(resourceMetrics, function (result) {\n                                    var _a;\n                                    if (result.code !== ExportResultCode.SUCCESS) {\n                                        reject((_a = result.error) !== null && _a !== void 0 ? _a : new Error(\"PeriodicExportingMetricReader: metrics export failed (error \" + result.error + \")\"));\n                                    }\n                                    else {\n                                        resolve();\n                                    }\n                                });\n                            })];\n                }\n            });\n        });\n    };\n    PeriodicExportingMetricReader.prototype.onInitialized = function () {\n        var _this = this;\n        // start running the interval as soon as this reader is initialized and keep handle for shutdown.\n        this._interval = setInterval(function () { return __awaiter(_this, void 0, void 0, function () {\n            var err_1;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 2, , 3]);\n                        return [4 /*yield*/, callWithTimeout(this._runOnce(), this._exportTimeout)];\n                    case 1:\n                        _a.sent();\n                        return [3 /*break*/, 3];\n                    case 2:\n                        err_1 = _a.sent();\n                        if (err_1 instanceof TimeoutError) {\n                            api.diag.error('Export took longer than %s milliseconds and timed out.', this._exportTimeout);\n                            return [2 /*return*/];\n                        }\n                        globalErrorHandler(err_1);\n                        return [3 /*break*/, 3];\n                    case 3: return [2 /*return*/];\n                }\n            });\n        }); }, this._exportInterval);\n        unrefTimer(this._interval);\n    };\n    PeriodicExportingMetricReader.prototype.onForceFlush = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this._exporter.forceFlush()];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    PeriodicExportingMetricReader.prototype.onShutdown = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (this._interval) {\n                            clearInterval(this._interval);\n                        }\n                        return [4 /*yield*/, this._exporter.shutdown()];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    return PeriodicExportingMetricReader;\n}(MetricReader));\nexport { PeriodicExportingMetricReader };\n//# sourceMappingURL=PeriodicExportingMetricReader.js.map","var __values = (this && this.__values) || function(o) {\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n    if (m) return m.call(o);\n    if (o && typeof o.length === \"number\") return {\n        next: function () {\n            if (o && i >= o.length) o = void 0;\n            return { value: o && o[i++], done: !o };\n        }\n    };\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\n/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { ExportResultCode } from '@opentelemetry/core';\nimport { AggregationTemporality } from './AggregationTemporality';\n/* eslint-disable no-console */\nvar ConsoleMetricExporter = /** @class */ (function () {\n    function ConsoleMetricExporter() {\n        this._shutdown = false;\n    }\n    ConsoleMetricExporter.prototype.export = function (metrics, resultCallback) {\n        if (this._shutdown) {\n            // If the exporter is shutting down, by spec, we need to return FAILED as export result\n            setImmediate(resultCallback, { code: ExportResultCode.FAILED });\n            return;\n        }\n        return ConsoleMetricExporter._sendMetrics(metrics, resultCallback);\n    };\n    ConsoleMetricExporter.prototype.forceFlush = function () {\n        return Promise.resolve();\n    };\n    ConsoleMetricExporter.prototype.selectAggregationTemporality = function (_instrumentType) {\n        return AggregationTemporality.CUMULATIVE;\n    };\n    ConsoleMetricExporter.prototype.shutdown = function () {\n        this._shutdown = true;\n        return Promise.resolve();\n    };\n    ConsoleMetricExporter._sendMetrics = function (metrics, done) {\n        var e_1, _a, e_2, _b;\n        try {\n            for (var _c = __values(metrics.scopeMetrics), _d = _c.next(); !_d.done; _d = _c.next()) {\n                var scopeMetrics = _d.value;\n                try {\n                    for (var _e = (e_2 = void 0, __values(scopeMetrics.metrics)), _f = _e.next(); !_f.done; _f = _e.next()) {\n                        var metric = _f.value;\n                        console.dir({\n                            descriptor: metric.descriptor,\n                            dataPointType: metric.dataPointType,\n                            dataPoints: metric.dataPoints\n                        });\n                    }\n                }\n                catch (e_2_1) { e_2 = { error: e_2_1 }; }\n                finally {\n                    try {\n                        if (_f && !_f.done && (_b = _e.return)) _b.call(_e);\n                    }\n                    finally { if (e_2) throw e_2.error; }\n                }\n            }\n        }\n        catch (e_1_1) { e_1 = { error: e_1_1 }; }\n        finally {\n            try {\n                if (_d && !_d.done && (_a = _c.return)) _a.call(_c);\n            }\n            finally { if (e_1) throw e_1.error; }\n        }\n        done({ code: ExportResultCode.SUCCESS });\n    };\n    return ConsoleMetricExporter;\n}());\nexport { ConsoleMetricExporter };\n//# sourceMappingURL=ConsoleMetricExporter.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { ExportResultCode } from '@opentelemetry/core';\n/**\n * In-memory Metrics Exporter is a Push Metric Exporter\n * which accumulates metrics data in the local memory and\n * allows to inspect it (useful for e.g. unit tests).\n */\nvar InMemoryMetricExporter = /** @class */ (function () {\n    function InMemoryMetricExporter(aggregationTemporality) {\n        this._shutdown = false;\n        this._metrics = [];\n        this._aggregationTemporality = aggregationTemporality;\n    }\n    /**\n     * @inheritedDoc\n     */\n    InMemoryMetricExporter.prototype.export = function (metrics, resultCallback) {\n        // Avoid storing metrics when exporter is shutdown\n        if (this._shutdown) {\n            setTimeout(function () { return resultCallback({ code: ExportResultCode.FAILED }); }, 0);\n            return;\n        }\n        this._metrics.push(metrics);\n        setTimeout(function () { return resultCallback({ code: ExportResultCode.SUCCESS }); }, 0);\n    };\n    /**\n     * Returns all the collected resource metrics\n     * @returns ResourceMetrics[]\n     */\n    InMemoryMetricExporter.prototype.getMetrics = function () {\n        return this._metrics;\n    };\n    InMemoryMetricExporter.prototype.forceFlush = function () {\n        return Promise.resolve();\n    };\n    InMemoryMetricExporter.prototype.reset = function () {\n        this._metrics = [];\n    };\n    InMemoryMetricExporter.prototype.selectAggregationTemporality = function (_instrumentType) {\n        return this._aggregationTemporality;\n    };\n    InMemoryMetricExporter.prototype.shutdown = function () {\n        this._shutdown = true;\n        return Promise.resolve();\n    };\n    return InMemoryMetricExporter;\n}());\nexport { InMemoryMetricExporter };\n//# sourceMappingURL=InMemoryMetricExporter.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar ViewRegistry = /** @class */ (function () {\n    function ViewRegistry() {\n        this._registeredViews = [];\n    }\n    ViewRegistry.prototype.addView = function (view) {\n        this._registeredViews.push(view);\n    };\n    ViewRegistry.prototype.findViews = function (instrument, meter) {\n        var _this = this;\n        var views = this._registeredViews\n            .filter(function (registeredView) {\n            return _this._matchInstrument(registeredView.instrumentSelector, instrument) &&\n                _this._matchMeter(registeredView.meterSelector, meter);\n        });\n        return views;\n    };\n    ViewRegistry.prototype._matchInstrument = function (selector, instrument) {\n        return (selector.getType() === undefined || instrument.type === selector.getType()) &&\n            selector.getNameFilter().match(instrument.name);\n    };\n    ViewRegistry.prototype._matchMeter = function (selector, meter) {\n        return selector.getNameFilter().match(meter.name) &&\n            (meter.version === undefined || selector.getVersionFilter().match(meter.version)) &&\n            (meter.schemaUrl === undefined || selector.getSchemaUrlFilter().match(meter.schemaUrl));\n    };\n    return ViewRegistry;\n}());\nexport { ViewRegistry };\n//# sourceMappingURL=ViewRegistry.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport * as api from '@opentelemetry/api';\nimport * as metrics from '@opentelemetry/api-metrics';\nimport { hrTime } from '@opentelemetry/core';\nvar SyncInstrument = /** @class */ (function () {\n    function SyncInstrument(_writableMetricStorage, _descriptor) {\n        this._writableMetricStorage = _writableMetricStorage;\n        this._descriptor = _descriptor;\n    }\n    SyncInstrument.prototype._record = function (value, attributes, context) {\n        if (attributes === void 0) { attributes = {}; }\n        if (context === void 0) { context = api.context.active(); }\n        if (this._descriptor.valueType === metrics.ValueType.INT && !Number.isInteger(value)) {\n            api.diag.warn(\"INT value type cannot accept a floating-point value for \" + this._descriptor.name + \", ignoring the fractional digits.\");\n            value = Math.trunc(value);\n        }\n        this._writableMetricStorage.record(value, attributes, context, hrTime());\n    };\n    return SyncInstrument;\n}());\nexport { SyncInstrument };\n/**\n * The class implements {@link metrics.UpDownCounter} interface.\n */\nvar UpDownCounterInstrument = /** @class */ (function (_super) {\n    __extends(UpDownCounterInstrument, _super);\n    function UpDownCounterInstrument() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    /**\n     * Increment value of counter by the input. Inputs may be negative.\n     */\n    UpDownCounterInstrument.prototype.add = function (value, attributes, ctx) {\n        this._record(value, attributes, ctx);\n    };\n    return UpDownCounterInstrument;\n}(SyncInstrument));\nexport { UpDownCounterInstrument };\n/**\n * The class implements {@link metrics.Counter} interface.\n */\nvar CounterInstrument = /** @class */ (function (_super) {\n    __extends(CounterInstrument, _super);\n    function CounterInstrument() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    /**\n     * Increment value of counter by the input. Inputs may not be negative.\n     */\n    CounterInstrument.prototype.add = function (value, attributes, ctx) {\n        if (value < 0) {\n            api.diag.warn(\"negative value provided to counter \" + this._descriptor.name + \": \" + value);\n            return;\n        }\n        this._record(value, attributes, ctx);\n    };\n    return CounterInstrument;\n}(SyncInstrument));\nexport { CounterInstrument };\n/**\n * The class implements {@link metrics.Histogram} interface.\n */\nvar HistogramInstrument = /** @class */ (function (_super) {\n    __extends(HistogramInstrument, _super);\n    function HistogramInstrument() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    /**\n     * Records a measurement. Value of the measurement must not be negative.\n     */\n    HistogramInstrument.prototype.record = function (value, attributes, ctx) {\n        if (value < 0) {\n            api.diag.warn(\"negative value provided to histogram \" + this._descriptor.name + \": \" + value);\n            return;\n        }\n        this._record(value, attributes, ctx);\n    };\n    return HistogramInstrument;\n}(SyncInstrument));\nexport { HistogramInstrument };\nvar ObservableInstrument = /** @class */ (function () {\n    function ObservableInstrument(descriptor, metricStorages, _observableRegistry) {\n        this._observableRegistry = _observableRegistry;\n        this._descriptor = descriptor;\n        this._metricStorages = metricStorages;\n    }\n    /**\n     * @see {metrics.Observable.addCallback}\n     */\n    ObservableInstrument.prototype.addCallback = function (callback) {\n        this._observableRegistry.addCallback(callback, this);\n    };\n    /**\n     * @see {metrics.Observable.removeCallback}\n     */\n    ObservableInstrument.prototype.removeCallback = function (callback) {\n        this._observableRegistry.removeCallback(callback, this);\n    };\n    return ObservableInstrument;\n}());\nexport { ObservableInstrument };\nvar ObservableCounterInstrument = /** @class */ (function (_super) {\n    __extends(ObservableCounterInstrument, _super);\n    function ObservableCounterInstrument() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    return ObservableCounterInstrument;\n}(ObservableInstrument));\nexport { ObservableCounterInstrument };\nvar ObservableGaugeInstrument = /** @class */ (function (_super) {\n    __extends(ObservableGaugeInstrument, _super);\n    function ObservableGaugeInstrument() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    return ObservableGaugeInstrument;\n}(ObservableInstrument));\nexport { ObservableGaugeInstrument };\nvar ObservableUpDownCounterInstrument = /** @class */ (function (_super) {\n    __extends(ObservableUpDownCounterInstrument, _super);\n    function ObservableUpDownCounterInstrument() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    return ObservableUpDownCounterInstrument;\n}(ObservableInstrument));\nexport { ObservableUpDownCounterInstrument };\nexport function isObservableInstrument(it) {\n    return it instanceof ObservableInstrument;\n}\n//# sourceMappingURL=Instruments.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { createInstrumentDescriptor, InstrumentType } from './InstrumentDescriptor';\nimport { CounterInstrument, HistogramInstrument, ObservableCounterInstrument, ObservableGaugeInstrument, ObservableUpDownCounterInstrument, UpDownCounterInstrument, } from './Instruments';\n/**\n * This class implements the {@link metrics.Meter} interface.\n */\nvar Meter = /** @class */ (function () {\n    function Meter(_meterSharedState) {\n        this._meterSharedState = _meterSharedState;\n    }\n    /**\n     * Create a {@link metrics.Histogram} instrument.\n     */\n    Meter.prototype.createHistogram = function (name, options) {\n        var descriptor = createInstrumentDescriptor(name, InstrumentType.HISTOGRAM, options);\n        var storage = this._meterSharedState.registerMetricStorage(descriptor);\n        return new HistogramInstrument(storage, descriptor);\n    };\n    /**\n     * Create a {@link metrics.Counter} instrument.\n     */\n    Meter.prototype.createCounter = function (name, options) {\n        var descriptor = createInstrumentDescriptor(name, InstrumentType.COUNTER, options);\n        var storage = this._meterSharedState.registerMetricStorage(descriptor);\n        return new CounterInstrument(storage, descriptor);\n    };\n    /**\n     * Create a {@link metrics.UpDownCounter} instrument.\n     */\n    Meter.prototype.createUpDownCounter = function (name, options) {\n        var descriptor = createInstrumentDescriptor(name, InstrumentType.UP_DOWN_COUNTER, options);\n        var storage = this._meterSharedState.registerMetricStorage(descriptor);\n        return new UpDownCounterInstrument(storage, descriptor);\n    };\n    /**\n     * Create a {@link metrics.ObservableGauge} instrument.\n     */\n    Meter.prototype.createObservableGauge = function (name, options) {\n        var descriptor = createInstrumentDescriptor(name, InstrumentType.OBSERVABLE_GAUGE, options);\n        var storages = this._meterSharedState.registerAsyncMetricStorage(descriptor);\n        return new ObservableGaugeInstrument(descriptor, storages, this._meterSharedState.observableRegistry);\n    };\n    /**\n     * Create a {@link metrics.ObservableCounter} instrument.\n     */\n    Meter.prototype.createObservableCounter = function (name, options) {\n        var descriptor = createInstrumentDescriptor(name, InstrumentType.OBSERVABLE_COUNTER, options);\n        var storages = this._meterSharedState.registerAsyncMetricStorage(descriptor);\n        return new ObservableCounterInstrument(descriptor, storages, this._meterSharedState.observableRegistry);\n    };\n    /**\n     * Create a {@link metrics.ObservableUpDownCounter} instrument.\n     */\n    Meter.prototype.createObservableUpDownCounter = function (name, options) {\n        var descriptor = createInstrumentDescriptor(name, InstrumentType.OBSERVABLE_UP_DOWN_COUNTER, options);\n        var storages = this._meterSharedState.registerAsyncMetricStorage(descriptor);\n        return new ObservableUpDownCounterInstrument(descriptor, storages, this._meterSharedState.observableRegistry);\n    };\n    /**\n     * @see {@link metrics.Meter.addBatchObservableCallback}\n     */\n    Meter.prototype.addBatchObservableCallback = function (callback, observables) {\n        this._meterSharedState.observableRegistry.addBatchCallback(callback, observables);\n    };\n    /**\n     * @see {@link metrics.Meter.removeBatchObservableCallback}\n     */\n    Meter.prototype.removeBatchObservableCallback = function (callback, observables) {\n        this._meterSharedState.observableRegistry.removeBatchCallback(callback, observables);\n    };\n    return Meter;\n}());\nexport { Meter };\n//# sourceMappingURL=Meter.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { createInstrumentDescriptor } from '../InstrumentDescriptor';\n/**\n * Internal interface.\n *\n * Represents a storage from which we can collect metrics.\n */\nvar MetricStorage = /** @class */ (function () {\n    function MetricStorage(_instrumentDescriptor) {\n        this._instrumentDescriptor = _instrumentDescriptor;\n    }\n    MetricStorage.prototype.getInstrumentDescriptor = function () {\n        return this._instrumentDescriptor;\n    };\n    MetricStorage.prototype.updateDescription = function (description) {\n        this._instrumentDescriptor = createInstrumentDescriptor(this._instrumentDescriptor.name, this._instrumentDescriptor.type, {\n            description: description,\n            valueType: this._instrumentDescriptor.valueType,\n            unit: this._instrumentDescriptor.unit\n        });\n    };\n    return MetricStorage;\n}());\nexport { MetricStorage };\n//# sourceMappingURL=MetricStorage.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport { hashAttributes } from '../utils';\nvar HashMap = /** @class */ (function () {\n    function HashMap(_hash) {\n        this._hash = _hash;\n        this._valueMap = new Map();\n        this._keyMap = new Map();\n    }\n    HashMap.prototype.get = function (key, hashCode) {\n        hashCode !== null && hashCode !== void 0 ? hashCode : (hashCode = this._hash(key));\n        return this._valueMap.get(hashCode);\n    };\n    HashMap.prototype.getOrDefault = function (key, defaultFactory) {\n        var hash = this._hash(key);\n        if (this._valueMap.has(hash)) {\n            return this._valueMap.get(hash);\n        }\n        var val = defaultFactory();\n        if (!this._keyMap.has(hash)) {\n            this._keyMap.set(hash, key);\n        }\n        this._valueMap.set(hash, val);\n        return val;\n    };\n    HashMap.prototype.set = function (key, value, hashCode) {\n        hashCode !== null && hashCode !== void 0 ? hashCode : (hashCode = this._hash(key));\n        if (!this._keyMap.has(hashCode)) {\n            this._keyMap.set(hashCode, key);\n        }\n        this._valueMap.set(hashCode, value);\n    };\n    HashMap.prototype.has = function (key, hashCode) {\n        hashCode !== null && hashCode !== void 0 ? hashCode : (hashCode = this._hash(key));\n        return this._valueMap.has(hashCode);\n    };\n    HashMap.prototype.keys = function () {\n        var keyIterator, next;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    keyIterator = this._keyMap.entries();\n                    next = keyIterator.next();\n                    _a.label = 1;\n                case 1:\n                    if (!(next.done !== true)) return [3 /*break*/, 3];\n                    return [4 /*yield*/, [next.value[1], next.value[0]]];\n                case 2:\n                    _a.sent();\n                    next = keyIterator.next();\n                    return [3 /*break*/, 1];\n                case 3: return [2 /*return*/];\n            }\n        });\n    };\n    HashMap.prototype.entries = function () {\n        var valueIterator, next;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    valueIterator = this._valueMap.entries();\n                    next = valueIterator.next();\n                    _a.label = 1;\n                case 1:\n                    if (!(next.done !== true)) return [3 /*break*/, 3];\n                    // next.value[0] here can not be undefined\n                    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                    return [4 /*yield*/, [this._keyMap.get(next.value[0]), next.value[1], next.value[0]]];\n                case 2:\n                    // next.value[0] here can not be undefined\n                    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                    _a.sent();\n                    next = valueIterator.next();\n                    return [3 /*break*/, 1];\n                case 3: return [2 /*return*/];\n            }\n        });\n    };\n    Object.defineProperty(HashMap.prototype, \"size\", {\n        get: function () {\n            return this._valueMap.size;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return HashMap;\n}());\nexport { HashMap };\nvar AttributeHashMap = /** @class */ (function (_super) {\n    __extends(AttributeHashMap, _super);\n    function AttributeHashMap() {\n        return _super.call(this, hashAttributes) || this;\n    }\n    return AttributeHashMap;\n}(HashMap));\nexport { AttributeHashMap };\n//# sourceMappingURL=HashMap.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nimport { AttributeHashMap } from './HashMap';\n/**\n * Internal interface.\n *\n * Allows synchronous collection of metrics. This processor should allow\n * allocation of new aggregation cells for metrics and convert cumulative\n * recording to delta data points.\n */\nvar DeltaMetricProcessor = /** @class */ (function () {\n    function DeltaMetricProcessor(_aggregator) {\n        this._aggregator = _aggregator;\n        this._activeCollectionStorage = new AttributeHashMap();\n        // TODO: find a reasonable mean to clean the memo;\n        // https://github.com/open-telemetry/opentelemetry-specification/pull/2208\n        this._cumulativeMemoStorage = new AttributeHashMap();\n    }\n    DeltaMetricProcessor.prototype.record = function (value, attributes, _context, collectionTime) {\n        var _this = this;\n        var accumulation = this._activeCollectionStorage.getOrDefault(attributes, function () { return _this._aggregator.createAccumulation(collectionTime); });\n        accumulation === null || accumulation === void 0 ? void 0 : accumulation.record(value);\n    };\n    DeltaMetricProcessor.prototype.batchCumulate = function (measurements, collectionTime) {\n        var _this = this;\n        Array.from(measurements.entries()).forEach(function (_a) {\n            var _b = __read(_a, 3), attributes = _b[0], value = _b[1], hashCode = _b[2];\n            var accumulation = _this._aggregator.createAccumulation(collectionTime);\n            accumulation === null || accumulation === void 0 ? void 0 : accumulation.record(value);\n            var delta = accumulation;\n            if (_this._cumulativeMemoStorage.has(attributes, hashCode)) {\n                // has() returned true, previous is present.\n                // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                var previous = _this._cumulativeMemoStorage.get(attributes, hashCode);\n                delta = _this._aggregator.diff(previous, accumulation);\n            }\n            // Save the current record and the delta record.\n            _this._cumulativeMemoStorage.set(attributes, accumulation, hashCode);\n            _this._activeCollectionStorage.set(attributes, delta, hashCode);\n        });\n    };\n    /**\n     * Returns a collection of delta metrics. Start time is the when first\n     * time event collected.\n     */\n    DeltaMetricProcessor.prototype.collect = function () {\n        var unreportedDelta = this._activeCollectionStorage;\n        this._activeCollectionStorage = new AttributeHashMap();\n        return unreportedDelta;\n    };\n    return DeltaMetricProcessor;\n}());\nexport { DeltaMetricProcessor };\n//# sourceMappingURL=DeltaMetricProcessor.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __values = (this && this.__values) || function(o) {\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n    if (m) return m.call(o);\n    if (o && typeof o.length === \"number\") return {\n        next: function () {\n            if (o && i >= o.length) o = void 0;\n            return { value: o && o[i++], done: !o };\n        }\n    };\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nimport { AggregationTemporality } from '../export/AggregationTemporality';\nimport { AttributeHashMap } from './HashMap';\n/**\n * Internal interface.\n *\n * Provides unique reporting for each collector. Allows synchronous collection\n * of metrics and reports given temporality values.\n */\nvar TemporalMetricProcessor = /** @class */ (function () {\n    function TemporalMetricProcessor(_aggregator) {\n        this._aggregator = _aggregator;\n        this._unreportedAccumulations = new Map();\n        this._reportHistory = new Map();\n    }\n    /**\n     * Builds the {@link MetricData} streams to report against a specific MetricCollector.\n     * @param collector The information of the MetricCollector.\n     * @param collectors The registered collectors.\n     * @param instrumentDescriptor The instrumentation descriptor that these metrics generated with.\n     * @param currentAccumulations The current accumulation of metric data from instruments.\n     * @param collectionTime The current collection timestamp.\n     * @returns The {@link MetricData} points or `null`.\n     */\n    TemporalMetricProcessor.prototype.buildMetrics = function (collector, collectors, instrumentDescriptor, currentAccumulations, collectionTime) {\n        this._stashAccumulations(collectors, currentAccumulations);\n        var unreportedAccumulations = this._getMergedUnreportedAccumulations(collector);\n        var result = unreportedAccumulations;\n        var aggregationTemporality;\n        // Check our last report time.\n        if (this._reportHistory.has(collector)) {\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            var last = this._reportHistory.get(collector);\n            var lastCollectionTime = last.collectionTime;\n            aggregationTemporality = last.aggregationTemporality;\n            // Use aggregation temporality + instrument to determine if we do a merge or a diff of\n            // previous. We have the following four scenarios:\n            // 1. Cumulative Aggregation (temporality) + Delta recording (sync instrument).\n            //    Here we merge with our last record to get a cumulative aggregation.\n            // 2. Cumulative Aggregation + Cumulative recording (async instrument).\n            //    Cumulative records are converted to delta recording with DeltaMetricProcessor.\n            //    Here we merge with our last record to get a cumulative aggregation.\n            // 3. Delta Aggregation + Delta recording\n            //    Calibrate the startTime of metric streams to be the reader's lastCollectionTime.\n            // 4. Delta Aggregation + Cumulative recording.\n            //    Cumulative records are converted to delta recording with DeltaMetricProcessor.\n            //    Calibrate the startTime of metric streams to be the reader's lastCollectionTime.\n            if (aggregationTemporality === AggregationTemporality.CUMULATIVE) {\n                // We need to make sure the current delta recording gets merged into the previous cumulative\n                // for the next cumulative recording.\n                result = TemporalMetricProcessor.merge(last.accumulations, unreportedAccumulations, this._aggregator);\n            }\n            else {\n                result = TemporalMetricProcessor.calibrateStartTime(last.accumulations, unreportedAccumulations, lastCollectionTime);\n            }\n        }\n        else {\n            // Call into user code to select aggregation temporality for the instrument.\n            aggregationTemporality = collector.selectAggregationTemporality(instrumentDescriptor.type);\n        }\n        // Update last reported (cumulative) accumulation.\n        this._reportHistory.set(collector, {\n            accumulations: result,\n            collectionTime: collectionTime,\n            aggregationTemporality: aggregationTemporality,\n        });\n        return this._aggregator.toMetricData(instrumentDescriptor, aggregationTemporality, AttributesMapToAccumulationRecords(result), \n        /* endTime */ collectionTime);\n    };\n    TemporalMetricProcessor.prototype._stashAccumulations = function (collectors, currentAccumulation) {\n        var _this = this;\n        collectors.forEach(function (it) {\n            var stash = _this._unreportedAccumulations.get(it);\n            if (stash === undefined) {\n                stash = [];\n                _this._unreportedAccumulations.set(it, stash);\n            }\n            stash.push(currentAccumulation);\n        });\n    };\n    TemporalMetricProcessor.prototype._getMergedUnreportedAccumulations = function (collector) {\n        var e_1, _a;\n        var result = new AttributeHashMap();\n        var unreportedList = this._unreportedAccumulations.get(collector);\n        this._unreportedAccumulations.set(collector, []);\n        if (unreportedList === undefined) {\n            return result;\n        }\n        try {\n            for (var unreportedList_1 = __values(unreportedList), unreportedList_1_1 = unreportedList_1.next(); !unreportedList_1_1.done; unreportedList_1_1 = unreportedList_1.next()) {\n                var it_1 = unreportedList_1_1.value;\n                result = TemporalMetricProcessor.merge(result, it_1, this._aggregator);\n            }\n        }\n        catch (e_1_1) { e_1 = { error: e_1_1 }; }\n        finally {\n            try {\n                if (unreportedList_1_1 && !unreportedList_1_1.done && (_a = unreportedList_1.return)) _a.call(unreportedList_1);\n            }\n            finally { if (e_1) throw e_1.error; }\n        }\n        return result;\n    };\n    TemporalMetricProcessor.merge = function (last, current, aggregator) {\n        var result = last;\n        var iterator = current.entries();\n        var next = iterator.next();\n        while (next.done !== true) {\n            var _a = __read(next.value, 3), key = _a[0], record = _a[1], hash = _a[2];\n            if (last.has(key, hash)) {\n                var lastAccumulation = last.get(key, hash);\n                // last.has() returned true, lastAccumulation is present.\n                // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                var accumulation = aggregator.merge(lastAccumulation, record);\n                result.set(key, accumulation, hash);\n            }\n            else {\n                result.set(key, record, hash);\n            }\n            next = iterator.next();\n        }\n        return result;\n    };\n    /**\n     * Calibrate the reported metric streams' startTime to lastCollectionTime. Leaves\n     * the new stream to be the initial observation time unchanged.\n     */\n    TemporalMetricProcessor.calibrateStartTime = function (last, current, lastCollectionTime) {\n        var e_2, _a;\n        try {\n            for (var _b = __values(last.keys()), _c = _b.next(); !_c.done; _c = _b.next()) {\n                var _d = __read(_c.value, 2), key = _d[0], hash = _d[1];\n                var currentAccumulation = current.get(key, hash);\n                currentAccumulation === null || currentAccumulation === void 0 ? void 0 : currentAccumulation.setStartTime(lastCollectionTime);\n            }\n        }\n        catch (e_2_1) { e_2 = { error: e_2_1 }; }\n        finally {\n            try {\n                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n            }\n            finally { if (e_2) throw e_2.error; }\n        }\n        return current;\n    };\n    return TemporalMetricProcessor;\n}());\nexport { TemporalMetricProcessor };\n// TypeScript complains about converting 3 elements tuple to AccumulationRecord<T>.\nfunction AttributesMapToAccumulationRecords(map) {\n    return Array.from(map.entries());\n}\n//# sourceMappingURL=TemporalMetricProcessor.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nimport { MetricStorage } from './MetricStorage';\nimport { DeltaMetricProcessor } from './DeltaMetricProcessor';\nimport { TemporalMetricProcessor } from './TemporalMetricProcessor';\nimport { AttributeHashMap } from './HashMap';\n/**\n * Internal interface.\n *\n * Stores and aggregates {@link MetricData} for asynchronous instruments.\n */\nvar AsyncMetricStorage = /** @class */ (function (_super) {\n    __extends(AsyncMetricStorage, _super);\n    function AsyncMetricStorage(_instrumentDescriptor, aggregator, _attributesProcessor) {\n        var _this = _super.call(this, _instrumentDescriptor) || this;\n        _this._attributesProcessor = _attributesProcessor;\n        _this._deltaMetricStorage = new DeltaMetricProcessor(aggregator);\n        _this._temporalMetricStorage = new TemporalMetricProcessor(aggregator);\n        return _this;\n    }\n    AsyncMetricStorage.prototype.record = function (measurements, observationTime) {\n        var _this = this;\n        var processed = new AttributeHashMap();\n        Array.from(measurements.entries()).forEach(function (_a) {\n            var _b = __read(_a, 2), attributes = _b[0], value = _b[1];\n            processed.set(_this._attributesProcessor.process(attributes), value);\n        });\n        this._deltaMetricStorage.batchCumulate(processed, observationTime);\n    };\n    /**\n     * Collects the metrics from this storage. The ObservableCallback is invoked\n     * during the collection.\n     *\n     * Note: This is a stateful operation and may reset any interval-related\n     * state for the MetricCollector.\n     */\n    AsyncMetricStorage.prototype.collect = function (collector, collectors, collectionTime) {\n        var accumulations = this._deltaMetricStorage.collect();\n        return this._temporalMetricStorage.buildMetrics(collector, collectors, this._instrumentDescriptor, accumulations, collectionTime);\n    };\n    return AsyncMetricStorage;\n}(MetricStorage));\nexport { AsyncMetricStorage };\n//# sourceMappingURL=AsyncMetricStorage.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nexport function getIncompatibilityDetails(existing, otherDescriptor) {\n    var incompatibility = '';\n    if (existing.unit !== otherDescriptor.unit) {\n        incompatibility += \"\\t- Unit '\" + existing.unit + \"' does not match '\" + otherDescriptor.unit + \"'\\n\";\n    }\n    if (existing.type !== otherDescriptor.type) {\n        incompatibility += \"\\t- Type '\" + existing.type + \"' does not match '\" + otherDescriptor.type + \"'\\n\";\n    }\n    if (existing.valueType !== otherDescriptor.valueType) {\n        incompatibility += \"\\t- Value Type '\" + existing.valueType + \"' does not match '\" + otherDescriptor.valueType + \"'\\n\";\n    }\n    if (existing.description !== otherDescriptor.description) {\n        incompatibility += \"\\t- Description '\" + existing.description + \"' does not match '\" + otherDescriptor.description + \"'\\n\";\n    }\n    return incompatibility;\n}\nexport function getValueTypeConflictResolutionRecipe(existing, otherDescriptor) {\n    return \"\\t- use valueType '\" + existing.valueType + \"' on instrument creation or use an instrument name other than '\" + otherDescriptor.name + \"'\";\n}\nexport function getUnitConflictResolutionRecipe(existing, otherDescriptor) {\n    return \"\\t- use unit '\" + existing.unit + \"' on instrument creation or use an instrument name other than '\" + otherDescriptor.name + \"'\";\n}\nexport function getTypeConflictResolutionRecipe(existing, otherDescriptor) {\n    var selector = {\n        name: otherDescriptor.name,\n        type: otherDescriptor.type\n    };\n    var selectorString = JSON.stringify(selector);\n    return \"\\t- create a new view with a name other than '\" + existing.name + \"' and InstrumentSelector '\" + selectorString + \"'\";\n}\nexport function getDescriptionResolutionRecipe(existing, otherDescriptor) {\n    var selector = {\n        name: otherDescriptor.name,\n        type: otherDescriptor.type\n    };\n    var selectorString = JSON.stringify(selector);\n    return \"\\t- create a new view with a name other than '\" + existing.name + \"' and InstrumentSelector '\" + selectorString + \"'\\n    \\t- OR - create a new view with the name \" + existing.name + \" and description '\" + existing.description + \"' and InstrumentSelector \" + selectorString + \"\\n    \\t- OR - create a new view with the name \" + otherDescriptor.name + \" and description '\" + existing.description + \"' and InstrumentSelector \" + selectorString;\n}\nexport function getConflictResolutionRecipe(existing, otherDescriptor) {\n    // Conflicts that cannot be solved via views.\n    if (existing.valueType !== otherDescriptor.valueType) {\n        return getValueTypeConflictResolutionRecipe(existing, otherDescriptor);\n    }\n    if (existing.unit !== otherDescriptor.unit) {\n        return getUnitConflictResolutionRecipe(existing, otherDescriptor);\n    }\n    // Conflicts that can be solved via views.\n    if (existing.type !== otherDescriptor.type) {\n        // this will automatically solve possible description conflicts.\n        return getTypeConflictResolutionRecipe(existing, otherDescriptor);\n    }\n    if (existing.description !== otherDescriptor.description) {\n        return getDescriptionResolutionRecipe(existing, otherDescriptor);\n    }\n    return '';\n}\n//# sourceMappingURL=RegistrationConflicts.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __values = (this && this.__values) || function(o) {\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n    if (m) return m.call(o);\n    if (o && typeof o.length === \"number\") return {\n        next: function () {\n            if (o && i >= o.length) o = void 0;\n            return { value: o && o[i++], done: !o };\n        }\n    };\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\nimport { isDescriptorCompatibleWith } from '../InstrumentDescriptor';\nimport * as api from '@opentelemetry/api';\nimport { getConflictResolutionRecipe, getIncompatibilityDetails } from '../view/RegistrationConflicts';\n/**\n * Internal class for storing {@link MetricStorage}\n */\nvar MetricStorageRegistry = /** @class */ (function () {\n    function MetricStorageRegistry() {\n        this._sharedRegistry = new Map();\n        this._perCollectorRegistry = new Map();\n    }\n    MetricStorageRegistry.create = function () {\n        return new MetricStorageRegistry();\n    };\n    MetricStorageRegistry.prototype.getStorages = function (collector) {\n        var e_1, _a, e_2, _b;\n        var storages = [];\n        try {\n            for (var _c = __values(this._sharedRegistry.values()), _d = _c.next(); !_d.done; _d = _c.next()) {\n                var metricStorages = _d.value;\n                storages = storages.concat(metricStorages);\n            }\n        }\n        catch (e_1_1) { e_1 = { error: e_1_1 }; }\n        finally {\n            try {\n                if (_d && !_d.done && (_a = _c.return)) _a.call(_c);\n            }\n            finally { if (e_1) throw e_1.error; }\n        }\n        var perCollectorStorages = this._perCollectorRegistry.get(collector);\n        if (perCollectorStorages != null) {\n            try {\n                for (var _e = __values(perCollectorStorages.values()), _f = _e.next(); !_f.done; _f = _e.next()) {\n                    var metricStorages = _f.value;\n                    storages = storages.concat(metricStorages);\n                }\n            }\n            catch (e_2_1) { e_2 = { error: e_2_1 }; }\n            finally {\n                try {\n                    if (_f && !_f.done && (_b = _e.return)) _b.call(_e);\n                }\n                finally { if (e_2) throw e_2.error; }\n            }\n        }\n        return storages;\n    };\n    MetricStorageRegistry.prototype.register = function (storage) {\n        this._registerStorage(storage, this._sharedRegistry);\n    };\n    MetricStorageRegistry.prototype.registerForCollector = function (collector, storage) {\n        var storageMap = this._perCollectorRegistry.get(collector);\n        if (storageMap == null) {\n            storageMap = new Map();\n            this._perCollectorRegistry.set(collector, storageMap);\n        }\n        this._registerStorage(storage, storageMap);\n    };\n    MetricStorageRegistry.prototype.findOrUpdateCompatibleStorage = function (expectedDescriptor) {\n        var storages = this._sharedRegistry.get(expectedDescriptor.name);\n        if (storages === undefined) {\n            return null;\n        }\n        // If the descriptor is compatible, the type of their metric storage\n        // (either SyncMetricStorage or AsyncMetricStorage) must be compatible.\n        return this._findOrUpdateCompatibleStorage(expectedDescriptor, storages);\n    };\n    MetricStorageRegistry.prototype.findOrUpdateCompatibleCollectorStorage = function (collector, expectedDescriptor) {\n        var storageMap = this._perCollectorRegistry.get(collector);\n        if (storageMap === undefined) {\n            return null;\n        }\n        var storages = this._sharedRegistry.get(expectedDescriptor.name);\n        if (storages === undefined) {\n            return null;\n        }\n        // If the descriptor is compatible, the type of their metric storage\n        // (either SyncMetricStorage or AsyncMetricStorage) must be compatible.\n        return this._findOrUpdateCompatibleStorage(expectedDescriptor, storages);\n    };\n    MetricStorageRegistry.prototype._registerStorage = function (storage, storageMap) {\n        var descriptor = storage.getInstrumentDescriptor();\n        var storages = storageMap.get(descriptor.name);\n        if (storages === undefined) {\n            storageMap.set(descriptor.name, [storage]);\n            return;\n        }\n        storages.push(storage);\n    };\n    MetricStorageRegistry.prototype._findOrUpdateCompatibleStorage = function (expectedDescriptor, existingStorages) {\n        var e_3, _a;\n        var compatibleStorage = null;\n        try {\n            for (var existingStorages_1 = __values(existingStorages), existingStorages_1_1 = existingStorages_1.next(); !existingStorages_1_1.done; existingStorages_1_1 = existingStorages_1.next()) {\n                var existingStorage = existingStorages_1_1.value;\n                var existingDescriptor = existingStorage.getInstrumentDescriptor();\n                if (isDescriptorCompatibleWith(existingDescriptor, expectedDescriptor)) {\n                    // Use the longer description if it does not match.\n                    if (existingDescriptor.description !== expectedDescriptor.description) {\n                        if (expectedDescriptor.description.length > existingDescriptor.description.length) {\n                            existingStorage.updateDescription(expectedDescriptor.description);\n                        }\n                        api.diag.warn('A view or instrument with the name ', expectedDescriptor.name, ' has already been registered, but has a different description and is incompatible with another registered view.\\n', 'Details:\\n', getIncompatibilityDetails(existingDescriptor, expectedDescriptor), 'The longer description will be used.\\nTo resolve the conflict:', getConflictResolutionRecipe(existingDescriptor, expectedDescriptor));\n                    }\n                    // Storage is fully compatible. There will never be more than one pre-existing fully compatible storage.\n                    compatibleStorage = existingStorage;\n                }\n                else {\n                    // The implementation SHOULD warn about duplicate instrument registration\n                    // conflicts after applying View configuration.\n                    api.diag.warn('A view or instrument with the name ', expectedDescriptor.name, ' has already been registered and is incompatible with another registered view.\\n', 'Details:\\n', getIncompatibilityDetails(existingDescriptor, expectedDescriptor), 'To resolve the conflict:\\n', getConflictResolutionRecipe(existingDescriptor, expectedDescriptor));\n                }\n            }\n        }\n        catch (e_3_1) { e_3 = { error: e_3_1 }; }\n        finally {\n            try {\n                if (existingStorages_1_1 && !existingStorages_1_1.done && (_a = existingStorages_1.return)) _a.call(existingStorages_1);\n            }\n            finally { if (e_3) throw e_3.error; }\n        }\n        return compatibleStorage;\n    };\n    return MetricStorageRegistry;\n}());\nexport { MetricStorageRegistry };\n//# sourceMappingURL=MetricStorageRegistry.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * Internal interface.\n */\nvar MultiMetricStorage = /** @class */ (function () {\n    function MultiMetricStorage(_backingStorages) {\n        this._backingStorages = _backingStorages;\n    }\n    MultiMetricStorage.prototype.record = function (value, attributes, context, recordTime) {\n        this._backingStorages.forEach(function (it) {\n            it.record(value, attributes, context, recordTime);\n        });\n    };\n    return MultiMetricStorage;\n}());\nexport { MultiMetricStorage };\n//# sourceMappingURL=MultiWritableMetricStorage.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport * as api from '@opentelemetry/api';\nimport * as metrics from '@opentelemetry/api-metrics';\nimport { AttributeHashMap } from './state/HashMap';\nimport { isObservableInstrument } from './Instruments';\n/**\n * The class implements {@link metrics.ObservableResult} interface.\n */\nvar ObservableResultImpl = /** @class */ (function () {\n    function ObservableResultImpl(_descriptor) {\n        this._descriptor = _descriptor;\n        /**\n         * @internal\n         */\n        this._buffer = new AttributeHashMap();\n    }\n    /**\n     * Observe a measurement of the value associated with the given attributes.\n     */\n    ObservableResultImpl.prototype.observe = function (value, attributes) {\n        if (attributes === void 0) { attributes = {}; }\n        if (this._descriptor.valueType === metrics.ValueType.INT && !Number.isInteger(value)) {\n            api.diag.warn(\"INT value type cannot accept a floating-point value for \" + this._descriptor.name + \", ignoring the fractional digits.\");\n            value = Math.trunc(value);\n        }\n        this._buffer.set(attributes, value);\n    };\n    return ObservableResultImpl;\n}());\nexport { ObservableResultImpl };\n/**\n * The class implements {@link metrics.BatchObservableCallback} interface.\n */\nvar BatchObservableResultImpl = /** @class */ (function () {\n    function BatchObservableResultImpl() {\n        /**\n         * @internal\n         */\n        this._buffer = new Map();\n    }\n    /**\n     * Observe a measurement of the value associated with the given attributes.\n     */\n    BatchObservableResultImpl.prototype.observe = function (metric, value, attributes) {\n        if (attributes === void 0) { attributes = {}; }\n        if (!isObservableInstrument(metric)) {\n            return;\n        }\n        var map = this._buffer.get(metric);\n        if (map == null) {\n            map = new AttributeHashMap();\n            this._buffer.set(metric, map);\n        }\n        if (metric._descriptor.valueType === metrics.ValueType.INT && !Number.isInteger(value)) {\n            api.diag.warn(\"INT value type cannot accept a floating-point value for \" + metric._descriptor.name + \", ignoring the fractional digits.\");\n            value = Math.trunc(value);\n        }\n        map.set(attributes, value);\n    };\n    return BatchObservableResultImpl;\n}());\nexport { BatchObservableResultImpl };\n//# sourceMappingURL=ObservableResult.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport * as api from '@opentelemetry/api';\nimport { isObservableInstrument } from '../Instruments';\nimport { BatchObservableResultImpl, ObservableResultImpl } from '../ObservableResult';\nimport { callWithTimeout, PromiseAllSettled, isPromiseAllSettledRejectionResult, setEquals } from '../utils';\n/**\n * An internal interface for managing ObservableCallbacks.\n *\n * Every registered callback associated with a set of instruments are be evaluated\n * exactly once during collection prior to reading data for that instrument.\n */\nvar ObservableRegistry = /** @class */ (function () {\n    function ObservableRegistry() {\n        this._callbacks = [];\n        this._batchCallbacks = [];\n    }\n    ObservableRegistry.prototype.addCallback = function (callback, instrument) {\n        var idx = this._findCallback(callback, instrument);\n        if (idx >= 0) {\n            return;\n        }\n        this._callbacks.push({ callback: callback, instrument: instrument });\n    };\n    ObservableRegistry.prototype.removeCallback = function (callback, instrument) {\n        var idx = this._findCallback(callback, instrument);\n        if (idx < 0) {\n            return;\n        }\n        this._callbacks.splice(idx, 1);\n    };\n    ObservableRegistry.prototype.addBatchCallback = function (callback, instruments) {\n        // Create a set of unique instruments.\n        var observableInstruments = new Set(instruments.filter(isObservableInstrument));\n        if (observableInstruments.size === 0) {\n            api.diag.error('BatchObservableCallback is not associated with valid instruments', instruments);\n            return;\n        }\n        var idx = this._findBatchCallback(callback, observableInstruments);\n        if (idx >= 0) {\n            return;\n        }\n        this._batchCallbacks.push({ callback: callback, instruments: observableInstruments });\n    };\n    ObservableRegistry.prototype.removeBatchCallback = function (callback, instruments) {\n        // Create a set of unique instruments.\n        var observableInstruments = new Set(instruments.filter(isObservableInstrument));\n        var idx = this._findBatchCallback(callback, observableInstruments);\n        if (idx < 0) {\n            return;\n        }\n        this._batchCallbacks.splice(idx, 1);\n    };\n    /**\n     * @returns a promise of rejected reasons for invoking callbacks.\n     */\n    ObservableRegistry.prototype.observe = function (collectionTime, timeoutMillis) {\n        return __awaiter(this, void 0, void 0, function () {\n            var callbackFutures, batchCallbackFutures, results, rejections;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        callbackFutures = this._observeCallbacks(collectionTime, timeoutMillis);\n                        batchCallbackFutures = this._observeBatchCallbacks(collectionTime, timeoutMillis);\n                        return [4 /*yield*/, PromiseAllSettled(__spreadArray(__spreadArray([], __read(callbackFutures), false), __read(batchCallbackFutures), false))];\n                    case 1:\n                        results = _a.sent();\n                        rejections = results.filter(isPromiseAllSettledRejectionResult)\n                            .map(function (it) { return it.reason; });\n                        return [2 /*return*/, rejections];\n                }\n            });\n        });\n    };\n    ObservableRegistry.prototype._observeCallbacks = function (observationTime, timeoutMillis) {\n        var _this = this;\n        return this._callbacks\n            .map(function (_a) {\n            var callback = _a.callback, instrument = _a.instrument;\n            return __awaiter(_this, void 0, void 0, function () {\n                var observableResult, callPromise;\n                return __generator(this, function (_b) {\n                    switch (_b.label) {\n                        case 0:\n                            observableResult = new ObservableResultImpl(instrument._descriptor);\n                            callPromise = Promise.resolve(callback(observableResult));\n                            if (timeoutMillis != null) {\n                                callPromise = callWithTimeout(callPromise, timeoutMillis);\n                            }\n                            return [4 /*yield*/, callPromise];\n                        case 1:\n                            _b.sent();\n                            instrument._metricStorages.forEach(function (metricStorage) {\n                                metricStorage.record(observableResult._buffer, observationTime);\n                            });\n                            return [2 /*return*/];\n                    }\n                });\n            });\n        });\n    };\n    ObservableRegistry.prototype._observeBatchCallbacks = function (observationTime, timeoutMillis) {\n        var _this = this;\n        return this._batchCallbacks\n            .map(function (_a) {\n            var callback = _a.callback, instruments = _a.instruments;\n            return __awaiter(_this, void 0, void 0, function () {\n                var observableResult, callPromise;\n                return __generator(this, function (_b) {\n                    switch (_b.label) {\n                        case 0:\n                            observableResult = new BatchObservableResultImpl();\n                            callPromise = Promise.resolve(callback(observableResult));\n                            if (timeoutMillis != null) {\n                                callPromise = callWithTimeout(callPromise, timeoutMillis);\n                            }\n                            return [4 /*yield*/, callPromise];\n                        case 1:\n                            _b.sent();\n                            instruments.forEach(function (instrument) {\n                                var buffer = observableResult._buffer.get(instrument);\n                                if (buffer == null) {\n                                    return;\n                                }\n                                instrument._metricStorages.forEach(function (metricStorage) {\n                                    metricStorage.record(buffer, observationTime);\n                                });\n                            });\n                            return [2 /*return*/];\n                    }\n                });\n            });\n        });\n    };\n    ObservableRegistry.prototype._findCallback = function (callback, instrument) {\n        return this._callbacks.findIndex(function (record) {\n            return record.callback === callback && record.instrument === instrument;\n        });\n    };\n    ObservableRegistry.prototype._findBatchCallback = function (callback, instruments) {\n        return this._batchCallbacks.findIndex(function (record) {\n            return record.callback === callback && setEquals(record.instruments, instruments);\n        });\n    };\n    return ObservableRegistry;\n}());\nexport { ObservableRegistry };\n//# sourceMappingURL=ObservableRegistry.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { MetricStorage } from './MetricStorage';\nimport { DeltaMetricProcessor } from './DeltaMetricProcessor';\nimport { TemporalMetricProcessor } from './TemporalMetricProcessor';\n/**\n * Internal interface.\n *\n * Stores and aggregates {@link MetricData} for synchronous instruments.\n */\nvar SyncMetricStorage = /** @class */ (function (_super) {\n    __extends(SyncMetricStorage, _super);\n    function SyncMetricStorage(instrumentDescriptor, aggregator, _attributesProcessor) {\n        var _this = _super.call(this, instrumentDescriptor) || this;\n        _this._attributesProcessor = _attributesProcessor;\n        _this._deltaMetricStorage = new DeltaMetricProcessor(aggregator);\n        _this._temporalMetricStorage = new TemporalMetricProcessor(aggregator);\n        return _this;\n    }\n    SyncMetricStorage.prototype.record = function (value, attributes, context, recordTime) {\n        attributes = this._attributesProcessor.process(attributes, context);\n        this._deltaMetricStorage.record(value, attributes, context, recordTime);\n    };\n    /**\n     * Collects the metrics from this storage.\n     *\n     * Note: This is a stateful operation and may reset any interval-related\n     * state for the MetricCollector.\n     */\n    SyncMetricStorage.prototype.collect = function (collector, collectors, collectionTime) {\n        var accumulations = this._deltaMetricStorage.collect();\n        return this._temporalMetricStorage.buildMetrics(collector, collectors, this._instrumentDescriptor, accumulations, collectionTime);\n    };\n    return SyncMetricStorage;\n}(MetricStorage));\nexport { SyncMetricStorage };\n//# sourceMappingURL=SyncMetricStorage.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n/**\n * The {@link AttributesProcessor} is responsible for customizing which\n * attribute(s) are to be reported as metrics dimension(s) and adding\n * additional dimension(s) from the {@link Context}.\n */\nvar AttributesProcessor = /** @class */ (function () {\n    function AttributesProcessor() {\n    }\n    AttributesProcessor.Noop = function () {\n        return NOOP;\n    };\n    return AttributesProcessor;\n}());\nexport { AttributesProcessor };\nvar NoopAttributesProcessor = /** @class */ (function (_super) {\n    __extends(NoopAttributesProcessor, _super);\n    function NoopAttributesProcessor() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    NoopAttributesProcessor.prototype.process = function (incoming, _context) {\n        return incoming;\n    };\n    return NoopAttributesProcessor;\n}(AttributesProcessor));\nexport { NoopAttributesProcessor };\n/**\n * {@link AttributesProcessor} that filters by allowed attribute names and drops any names that are not in the\n * allow list.\n */\nvar FilteringAttributesProcessor = /** @class */ (function (_super) {\n    __extends(FilteringAttributesProcessor, _super);\n    function FilteringAttributesProcessor(_allowedAttributeNames) {\n        var _this = _super.call(this) || this;\n        _this._allowedAttributeNames = _allowedAttributeNames;\n        return _this;\n    }\n    FilteringAttributesProcessor.prototype.process = function (incoming, _context) {\n        var _this = this;\n        var filteredAttributes = {};\n        Object.keys(incoming)\n            .filter(function (attributeName) { return _this._allowedAttributeNames.includes(attributeName); })\n            .forEach(function (attributeName) { return filteredAttributes[attributeName] = incoming[attributeName]; });\n        return filteredAttributes;\n    };\n    return FilteringAttributesProcessor;\n}(AttributesProcessor));\nexport { FilteringAttributesProcessor };\nvar NOOP = new NoopAttributesProcessor;\n//# sourceMappingURL=AttributesProcessor.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nimport { createInstrumentDescriptorWithView } from '../InstrumentDescriptor';\nimport { Meter } from '../Meter';\nimport { isNotNullish } from '../utils';\nimport { AsyncMetricStorage } from './AsyncMetricStorage';\nimport { MetricStorageRegistry } from './MetricStorageRegistry';\nimport { MultiMetricStorage } from './MultiWritableMetricStorage';\nimport { ObservableRegistry } from './ObservableRegistry';\nimport { SyncMetricStorage } from './SyncMetricStorage';\nimport { AttributesProcessor } from '../view/AttributesProcessor';\n/**\n * An internal record for shared meter provider states.\n */\nvar MeterSharedState = /** @class */ (function () {\n    function MeterSharedState(_meterProviderSharedState, _instrumentationScope) {\n        this._meterProviderSharedState = _meterProviderSharedState;\n        this._instrumentationScope = _instrumentationScope;\n        this.metricStorageRegistry = new MetricStorageRegistry();\n        this.observableRegistry = new ObservableRegistry();\n        this.meter = new Meter(this);\n    }\n    MeterSharedState.prototype.registerMetricStorage = function (descriptor) {\n        var storages = this._registerMetricStorage(descriptor, SyncMetricStorage);\n        if (storages.length === 1) {\n            return storages[0];\n        }\n        return new MultiMetricStorage(storages);\n    };\n    MeterSharedState.prototype.registerAsyncMetricStorage = function (descriptor) {\n        var storages = this._registerMetricStorage(descriptor, AsyncMetricStorage);\n        return storages;\n    };\n    /**\n     * @param collector opaque handle of {@link MetricCollector} which initiated the collection.\n     * @param collectionTime the HrTime at which the collection was initiated.\n     * @param options options for collection.\n     * @returns the list of metric data collected.\n     */\n    MeterSharedState.prototype.collect = function (collector, collectionTime, options) {\n        return __awaiter(this, void 0, void 0, function () {\n            var errors, metricDataList;\n            var _this = this;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.observableRegistry.observe(collectionTime, options === null || options === void 0 ? void 0 : options.timeoutMillis)];\n                    case 1:\n                        errors = _a.sent();\n                        metricDataList = Array.from(this.metricStorageRegistry.getStorages(collector))\n                            .map(function (metricStorage) {\n                            return metricStorage.collect(collector, _this._meterProviderSharedState.metricCollectors, collectionTime);\n                        })\n                            .filter(isNotNullish);\n                        return [2 /*return*/, {\n                                scopeMetrics: {\n                                    scope: this._instrumentationScope,\n                                    metrics: metricDataList.filter(isNotNullish),\n                                },\n                                errors: errors,\n                            }];\n                }\n            });\n        });\n    };\n    MeterSharedState.prototype._registerMetricStorage = function (descriptor, MetricStorageType) {\n        var _this = this;\n        var views = this._meterProviderSharedState.viewRegistry.findViews(descriptor, this._instrumentationScope);\n        var storages = views\n            .map(function (view) {\n            var viewDescriptor = createInstrumentDescriptorWithView(view, descriptor);\n            var compatibleStorage = _this.metricStorageRegistry.findOrUpdateCompatibleStorage(viewDescriptor);\n            if (compatibleStorage != null) {\n                return compatibleStorage;\n            }\n            var aggregator = view.aggregation.createAggregator(viewDescriptor);\n            var viewStorage = new MetricStorageType(viewDescriptor, aggregator, view.attributesProcessor);\n            _this.metricStorageRegistry.register(viewStorage);\n            return viewStorage;\n        });\n        // Fallback to the per-collector aggregations if no view is configured for the instrument.\n        if (storages.length === 0) {\n            var perCollectorAggregations = this._meterProviderSharedState.selectAggregations(descriptor.type);\n            var collectorStorages = perCollectorAggregations.map(function (_a) {\n                var _b = __read(_a, 2), collector = _b[0], aggregation = _b[1];\n                var compatibleStorage = _this.metricStorageRegistry.findOrUpdateCompatibleCollectorStorage(collector, descriptor);\n                if (compatibleStorage != null) {\n                    return compatibleStorage;\n                }\n                var aggregator = aggregation.createAggregator(descriptor);\n                var storage = new MetricStorageType(descriptor, aggregator, AttributesProcessor.Noop());\n                _this.metricStorageRegistry.registerForCollector(collector, storage);\n                return storage;\n            });\n            storages = storages.concat(collectorStorages);\n        }\n        return storages;\n    };\n    return MeterSharedState;\n}());\nexport { MeterSharedState };\n//# sourceMappingURL=MeterSharedState.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __values = (this && this.__values) || function(o) {\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n    if (m) return m.call(o);\n    if (o && typeof o.length === \"number\") return {\n        next: function () {\n            if (o && i >= o.length) o = void 0;\n            return { value: o && o[i++], done: !o };\n        }\n    };\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\nimport { instrumentationScopeId } from '../utils';\nimport { ViewRegistry } from '../view/ViewRegistry';\nimport { MeterSharedState } from './MeterSharedState';\n/**\n * An internal record for shared meter provider states.\n */\nvar MeterProviderSharedState = /** @class */ (function () {\n    function MeterProviderSharedState(resource) {\n        this.resource = resource;\n        this.viewRegistry = new ViewRegistry();\n        this.metricCollectors = [];\n        this.meterSharedStates = new Map();\n    }\n    MeterProviderSharedState.prototype.getMeterSharedState = function (instrumentationScope) {\n        var id = instrumentationScopeId(instrumentationScope);\n        var meterSharedState = this.meterSharedStates.get(id);\n        if (meterSharedState == null) {\n            meterSharedState = new MeterSharedState(this, instrumentationScope);\n            this.meterSharedStates.set(id, meterSharedState);\n        }\n        return meterSharedState;\n    };\n    MeterProviderSharedState.prototype.selectAggregations = function (instrumentType) {\n        var e_1, _a;\n        var result = [];\n        try {\n            for (var _b = __values(this.metricCollectors), _c = _b.next(); !_c.done; _c = _b.next()) {\n                var collector = _c.value;\n                result.push([collector, collector.selectAggregation(instrumentType)]);\n            }\n        }\n        catch (e_1_1) { e_1 = { error: e_1_1 }; }\n        finally {\n            try {\n                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n            }\n            finally { if (e_1) throw e_1.error; }\n        }\n        return result;\n    };\n    return MeterProviderSharedState;\n}());\nexport { MeterProviderSharedState };\n//# sourceMappingURL=MeterProviderSharedState.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport { hrTime } from '@opentelemetry/core';\nimport { FlatMap } from '../utils';\n/**\n * An internal opaque interface that the MetricReader receives as\n * MetricProducer. It acts as the storage key to the internal metric stream\n * state for each MetricReader.\n */\nvar MetricCollector = /** @class */ (function () {\n    function MetricCollector(_sharedState, _metricReader) {\n        this._sharedState = _sharedState;\n        this._metricReader = _metricReader;\n    }\n    MetricCollector.prototype.collect = function (options) {\n        return __awaiter(this, void 0, void 0, function () {\n            var collectionTime, meterCollectionPromises, result;\n            var _this = this;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        collectionTime = hrTime();\n                        meterCollectionPromises = Array.from(this._sharedState.meterSharedStates.values())\n                            .map(function (meterSharedState) { return meterSharedState.collect(_this, collectionTime, options); });\n                        return [4 /*yield*/, Promise.all(meterCollectionPromises)];\n                    case 1:\n                        result = _a.sent();\n                        return [2 /*return*/, {\n                                resourceMetrics: {\n                                    resource: this._sharedState.resource,\n                                    scopeMetrics: result.map(function (it) { return it.scopeMetrics; }),\n                                },\n                                errors: FlatMap(result, function (it) { return it.errors; }),\n                            }];\n                }\n            });\n        });\n    };\n    /**\n     * Delegates for MetricReader.forceFlush.\n     */\n    MetricCollector.prototype.forceFlush = function (options) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this._metricReader.forceFlush(options)];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /**\n     * Delegates for MetricReader.shutdown.\n     */\n    MetricCollector.prototype.shutdown = function (options) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this._metricReader.shutdown(options)];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    MetricCollector.prototype.selectAggregationTemporality = function (instrumentType) {\n        return this._metricReader.selectAggregationTemporality(instrumentType);\n    };\n    MetricCollector.prototype.selectAggregation = function (instrumentType) {\n        return this._metricReader.selectAggregation(instrumentType);\n    };\n    return MetricCollector;\n}());\nexport { MetricCollector };\n//# sourceMappingURL=MetricCollector.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __values = (this && this.__values) || function(o) {\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n    if (m) return m.call(o);\n    if (o && typeof o.length === \"number\") return {\n        next: function () {\n            if (o && i >= o.length) o = void 0;\n            return { value: o && o[i++], done: !o };\n        }\n    };\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\nimport * as api from '@opentelemetry/api';\nimport * as metrics from '@opentelemetry/api-metrics';\nimport { Resource } from '@opentelemetry/resources';\nimport { MeterProviderSharedState } from './state/MeterProviderSharedState';\nimport { MetricCollector } from './state/MetricCollector';\n/**\n * This class implements the {@link metrics.MeterProvider} interface.\n */\nvar MeterProvider = /** @class */ (function () {\n    function MeterProvider(options) {\n        var e_1, _a;\n        var _b;\n        this._shutdown = false;\n        this._sharedState = new MeterProviderSharedState((_b = options === null || options === void 0 ? void 0 : options.resource) !== null && _b !== void 0 ? _b : Resource.empty());\n        if ((options === null || options === void 0 ? void 0 : options.views) != null && options.views.length > 0) {\n            try {\n                for (var _c = __values(options.views), _d = _c.next(); !_d.done; _d = _c.next()) {\n                    var view = _d.value;\n                    this._sharedState.viewRegistry.addView(view);\n                }\n            }\n            catch (e_1_1) { e_1 = { error: e_1_1 }; }\n            finally {\n                try {\n                    if (_d && !_d.done && (_a = _c.return)) _a.call(_c);\n                }\n                finally { if (e_1) throw e_1.error; }\n            }\n        }\n    }\n    /**\n     * Get a meter with the configuration of the MeterProvider.\n     */\n    MeterProvider.prototype.getMeter = function (name, version, options) {\n        if (version === void 0) { version = ''; }\n        if (options === void 0) { options = {}; }\n        // https://github.com/open-telemetry/opentelemetry-specification/blob/main/specification/metrics/sdk.md#meter-creation\n        if (this._shutdown) {\n            api.diag.warn('A shutdown MeterProvider cannot provide a Meter');\n            return metrics.createNoopMeter();\n        }\n        return this._sharedState\n            .getMeterSharedState({ name: name, version: version, schemaUrl: options.schemaUrl })\n            .meter;\n    };\n    /**\n     * Register a {@link MetricReader} to the meter provider. After the\n     * registration, the MetricReader can start metrics collection.\n     *\n     * @param metricReader the metric reader to be registered.\n     */\n    MeterProvider.prototype.addMetricReader = function (metricReader) {\n        var collector = new MetricCollector(this._sharedState, metricReader);\n        metricReader.setMetricProducer(collector);\n        this._sharedState.metricCollectors.push(collector);\n    };\n    /**\n     * Flush all buffered data and shut down the MeterProvider and all registered\n     * MetricReaders.\n     *\n     * Returns a promise which is resolved when all flushes are complete.\n     */\n    MeterProvider.prototype.shutdown = function (options) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (this._shutdown) {\n                            api.diag.warn('shutdown may only be called once per MeterProvider');\n                            return [2 /*return*/];\n                        }\n                        this._shutdown = true;\n                        return [4 /*yield*/, Promise.all(this._sharedState.metricCollectors.map(function (collector) {\n                                return collector.shutdown(options);\n                            }))];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /**\n     * Notifies all registered MetricReaders to flush any buffered data.\n     *\n     * Returns a promise which is resolved when all flushes are complete.\n     */\n    MeterProvider.prototype.forceFlush = function (options) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        // do not flush after shutdown\n                        if (this._shutdown) {\n                            api.diag.warn('invalid attempt to force flush after MeterProvider shutdown');\n                            return [2 /*return*/];\n                        }\n                        return [4 /*yield*/, Promise.all(this._sharedState.metricCollectors.map(function (collector) {\n                                return collector.forceFlush(options);\n                            }))];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    return MeterProvider;\n}());\nexport { MeterProvider };\n//# sourceMappingURL=MeterProvider.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n// https://tc39.es/proposal-regex-escaping\n// escape ^ $ \\ .  + ? ( ) [ ] { } |\n// do not need to escape * as we interpret it as wildcard\nvar ESCAPE = /[\\^$\\\\.+?()[\\]{}|]/g;\n/**\n * Wildcard pattern predicate, supports patterns like `*`, `foo*`, `*bar`.\n */\nvar PatternPredicate = /** @class */ (function () {\n    function PatternPredicate(pattern) {\n        if (pattern === '*') {\n            this._matchAll = true;\n            this._regexp = /.*/;\n        }\n        else {\n            this._matchAll = false;\n            this._regexp = new RegExp(PatternPredicate.escapePattern(pattern));\n        }\n    }\n    PatternPredicate.prototype.match = function (str) {\n        if (this._matchAll) {\n            return true;\n        }\n        return this._regexp.test(str);\n    };\n    PatternPredicate.escapePattern = function (pattern) {\n        return \"^\" + pattern.replace(ESCAPE, '\\\\$&').replace('*', '.*') + \"$\";\n    };\n    PatternPredicate.hasWildcard = function (pattern) {\n        return pattern.includes('*');\n    };\n    return PatternPredicate;\n}());\nexport { PatternPredicate };\nvar ExactPredicate = /** @class */ (function () {\n    function ExactPredicate(pattern) {\n        this._matchAll = pattern === undefined;\n        this._pattern = pattern;\n    }\n    ExactPredicate.prototype.match = function (str) {\n        if (this._matchAll) {\n            return true;\n        }\n        if (str === this._pattern) {\n            return true;\n        }\n        return false;\n    };\n    return ExactPredicate;\n}());\nexport { ExactPredicate };\n//# sourceMappingURL=Predicate.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { PatternPredicate } from './Predicate';\nvar InstrumentSelector = /** @class */ (function () {\n    function InstrumentSelector(criteria) {\n        var _a;\n        this._nameFilter = new PatternPredicate((_a = criteria === null || criteria === void 0 ? void 0 : criteria.name) !== null && _a !== void 0 ? _a : '*');\n        this._type = criteria === null || criteria === void 0 ? void 0 : criteria.type;\n    }\n    InstrumentSelector.prototype.getType = function () {\n        return this._type;\n    };\n    InstrumentSelector.prototype.getNameFilter = function () {\n        return this._nameFilter;\n    };\n    return InstrumentSelector;\n}());\nexport { InstrumentSelector };\n//# sourceMappingURL=InstrumentSelector.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { ExactPredicate } from './Predicate';\nvar MeterSelector = /** @class */ (function () {\n    function MeterSelector(criteria) {\n        this._nameFilter = new ExactPredicate(criteria === null || criteria === void 0 ? void 0 : criteria.name);\n        this._versionFilter = new ExactPredicate(criteria === null || criteria === void 0 ? void 0 : criteria.version);\n        this._schemaUrlFilter = new ExactPredicate(criteria === null || criteria === void 0 ? void 0 : criteria.schemaUrl);\n    }\n    MeterSelector.prototype.getNameFilter = function () {\n        return this._nameFilter;\n    };\n    /**\n     * TODO: semver filter? no spec yet.\n     */\n    MeterSelector.prototype.getVersionFilter = function () {\n        return this._versionFilter;\n    };\n    MeterSelector.prototype.getSchemaUrlFilter = function () {\n        return this._schemaUrlFilter;\n    };\n    return MeterSelector;\n}());\nexport { MeterSelector };\n//# sourceMappingURL=MeterSelector.js.map","/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { getEnv, baggageUtils } from '@opentelemetry/core';\nimport { appendResourcePathToUrl, appendRootPathToUrlIfNeeded, OTLPExporterBrowserBase } from '@opentelemetry/otlp-exporter-base';\nimport { createExportTraceServiceRequest } from '@opentelemetry/otlp-transformer';\nvar DEFAULT_COLLECTOR_RESOURCE_PATH = 'v1/traces';\nvar DEFAULT_COLLECTOR_URL = \"http://localhost:4318/\" + DEFAULT_COLLECTOR_RESOURCE_PATH;\n/**\n * Collector Trace Exporter for Web\n */\nvar OTLPTraceExporter = /** @class */ (function (_super) {\n    __extends(OTLPTraceExporter, _super);\n    function OTLPTraceExporter(config) {\n        if (config === void 0) { config = {}; }\n        var _this = _super.call(this, config) || this;\n        _this._headers = Object.assign(_this._headers, baggageUtils.parseKeyPairsIntoRecord(getEnv().OTEL_EXPORTER_OTLP_TRACES_HEADERS));\n        return _this;\n    }\n    OTLPTraceExporter.prototype.convert = function (spans) {\n        return createExportTraceServiceRequest(spans, true);\n    };\n    OTLPTraceExporter.prototype.getDefaultUrl = function (config) {\n        return typeof config.url === 'string'\n            ? config.url\n            : getEnv().OTEL_EXPORTER_OTLP_TRACES_ENDPOINT.length > 0\n                ? appendRootPathToUrlIfNeeded(getEnv().OTEL_EXPORTER_OTLP_TRACES_ENDPOINT, DEFAULT_COLLECTOR_RESOURCE_PATH)\n                : getEnv().OTEL_EXPORTER_OTLP_ENDPOINT.length > 0\n                    ? appendResourcePathToUrl(getEnv().OTEL_EXPORTER_OTLP_ENDPOINT, DEFAULT_COLLECTOR_RESOURCE_PATH)\n                    : DEFAULT_COLLECTOR_URL;\n    };\n    return OTLPTraceExporter;\n}(OTLPExporterBrowserBase));\nexport { OTLPTraceExporter };\n//# sourceMappingURL=OTLPTraceExporter.js.map","import { Tracer } from '@opentelemetry/api';\nimport { Resource } from '@opentelemetry/resources';\nimport { SemanticResourceAttributes } from '@opentelemetry/semantic-conventions';\nimport { BatchSpanProcessor } from '@opentelemetry/sdk-trace-base';\nimport { WebTracerProvider } from '@opentelemetry/sdk-trace-web';\nimport { OTLPTraceExporter } from '@opentelemetry/exporter-trace-otlp-http';\n\nconst DEFAULT_URL = 'http://localhost:4318/v1/traces';\n\nexport const SmTracerProvider: {\n  init: (opts: ProviderInitOptions) => void;\n  isInitialized: () => boolean;\n  getTracer: () => Tracer;\n  defaultUrl: string;\n} = (() => {\n  let _tracerProvider: WebTracerProvider;\n  let _instance: Tracer;\n  return {\n    init: (opts) => {\n      if (_instance) {\n        return;\n      }\n      opts.url = opts.url || DEFAULT_URL;\n      opts.webSDKVersion = opts.webSDKVersion || 'unknown';\n      _tracerProvider = new WebTracerProvider({\n        resource: new Resource({\n          [SemanticResourceAttributes.SERVICE_NAME]: 'smwebsdk',\n          [SemanticResourceAttributes.SERVICE_VERSION]: opts.webSDKVersion,\n        }),\n      });\n      _tracerProvider.addSpanProcessor(\n        new BatchSpanProcessor(\n          new OTLPTraceExporter({\n            url: opts.url,\n            headers: {\n              Authorization: 'Bearer ' + opts.jwt,\n            },\n          })\n        )\n      );\n      _tracerProvider.register();\n      _instance = _tracerProvider.getTracer('smwebsdk');\n    },\n    isInitialized: () => {\n      return !!_instance;\n    },\n    getTracer: () => {\n      return _instance;\n    },\n    defaultUrl: DEFAULT_URL,\n  };\n})();\nObject.freeze(SmTracerProvider);\n\n/**\n * Available configuration options for the tracer provider.\n */\nexport type ProviderInitOptions = {\n  jwt: string;\n  url: string | undefined;\n  webSDKVersion: string | undefined;\n};\n","/*\nWARNING\n- We have three different bundles, only one is built with webpack and supports environment variables.\n- This file gets string replaced at build time, which is a temporary solution until we can use webpack (or a similar bundler) for all bundles\n*/\n\nexport const websdkVersion =\n  (typeof process !== 'undefined' && process.env.SM_WEBSDK_VERSION) ||\n  'unknown';\n","/**\n * @module smwebsdk\n */\n\n/*\n * Copyright 2017-2020 Soul Machines Ltd. All Rights Reserved.\n */\n\nimport { Persona } from './Persona';\nimport { SmEvent } from './SmEvent';\nimport { LocalSession } from './LocalSession';\nimport { Session } from './Session';\nimport { WebSocketSession } from './WebSocketSession';\nimport {\n  WebsocketResponse,\n  WebsocketCategory,\n  WebsocketKind,\n} from './websocket-message/index';\nimport { SpeechState } from './websocket-message/enums/SpeechState';\nimport {\n  SceneRequest,\n  SceneRequestBody,\n  StartRecognizeRequestBody,\n  SceneResponse,\n  RecognizeResultsResponseBody,\n  DemoModeResponseBody,\n  SceneResponseError,\n  ConversationResultResponseBody,\n  SpeechMarkerResponseBody,\n  StateResponseBody,\n} from './websocket-message/scene/index';\nimport { AudioSourceTypes } from './enums/index';\nimport {\n  ConfigurationModel,\n  PersonaEventMap,\n  PendingPromise,\n} from './models/index';\nimport { SceneResponseBody } from './websocket-message/scene/SceneResponse';\nimport { FeatureFlag } from './websocket-message/scene/response-body/StateResponseBody';\nimport { ContentAwareness } from './ContentAwareness';\nimport { Logger, LogLevel } from './utils/Logger';\nimport { Context, ROOT_CONTEXT, Span } from '@opentelemetry/api';\nimport { makeError } from './utils/make-error';\nimport convertToUserMedia from './utils/convertToUserMedia';\nimport { convertWssToHttps, getUrlHost } from './utils/utils';\nimport {\n  LoggingConfig,\n  MediaDeviceOptions,\n  RetryOptions,\n  UserMedia,\n} from './types/scene';\nimport { Conversation } from './Conversation';\nimport { MetadataSender } from './MetadataSender';\nimport { PersonaId } from './models/PersonaId';\nimport { ConnectionState } from './ConnectionState';\nimport { SmTracerProvider } from './SmTelemetry';\nimport { websdkVersion } from './env-vars';\nimport { ChromaKeyOptions } from './dedicated-workers/chroma-key.worker';\n\nfunction sleep(t: number): Promise<void> {\n  return new Promise((resolve) => setTimeout(() => resolve(), t));\n}\n\nconst DEFAULT_RETRY_COUNT = 50;\nconst DEFAULT_RETRY_DELAY = 200;\nconst DEFAULT_PERSONA_ID = 1;\n\n/**\n * Configuration to use when constructing a Scene\n *\n * @public\n */\nexport interface SceneOptions {\n  /** The HTMLVideoElement where the digital person should be displayed */\n  videoElement?: HTMLVideoElement;\n  /** Whether the connection should be established with audio but no video */\n  audioOnly?: boolean;\n  /** Default true. True means that the DP's speech should be interrupted when the user changes tabs */\n  stopSpeakingWhenNotVisible?: boolean;\n  /** Media devices (camera and microphone) to request from the user before connecting */\n  requestedMediaDevices?: MediaDeviceOptions;\n  /** Media devices (camera and microphone) that the user must approve access to for the connection to succeed */\n  requiredMediaDevices?: MediaDeviceOptions;\n  /** Frequency of sending on-screen content measurements to the server in milliseconds */\n  contentAwarenessDebounceTime?: number;\n  /** Preferred logging levels for websdk */\n  loggingConfig?: LoggingConfig;\n  /** The API key used to authenticate with the server */\n  apiKey?: string;\n  /** The config to allow sending current page url when connection succeeds */\n  sendMetadata?: {\n    pageUrl: boolean;\n  };\n  /** Configuration of the OpenTelemetry tracer */\n  tracerOptions?: TracerOptions;\n  /** Chroma key options\n   * @internal\n   */\n  chromaKeyOptions?: ChromaKeyOptions;\n}\n\n/**\n * Configuration to use when connecting to a Scene\n *\n * @public\n */\nexport interface ConnectOptions {\n  /** Options for customizing connection error retries */\n  retryOptions?: RetryOptions;\n  /** A custom text string that is sent to the orchestration server */\n  userText?: string;\n  /** The custom token server config */\n  tokenServer?: {\n    /** The server websocket uri  */\n    uri: string;\n    /** A jwt access token issued to permit access to the server */\n    token: string;\n  };\n}\n\nasync function retry(\n  task: () => Promise<any>,\n  retryOptions: RetryOptions = {},\n  scene: Scene\n) {\n  const errors = [];\n  const count = retryOptions.maxRetries || DEFAULT_RETRY_COUNT;\n  const delay = retryOptions.delayMs || DEFAULT_RETRY_DELAY;\n  let result: Promise<any> | undefined;\n  for (let i = 0; i < count; i++) {\n    try {\n      result = await task();\n\n      // store the result on the scene object\n      scene.connectionResult = {\n        message: 'success',\n        value: result,\n        retries: errors,\n      };\n    } catch (error: unknown) {\n      // collect a history of errors encountered during connect\n      errors.push(error);\n\n      // store the result on the scene object\n      scene.connectionResult = {\n        message: 'failed',\n        retries: errors,\n      };\n\n      //if error is 'noResumeSession` should cleanup session storage\n      if (error instanceof Error && error.name === 'noSessionToResume') {\n        clearSessionData();\n      }\n\n      // any error other than 'noScene' should throw immediately\n      // and should not retry repeatedly.\n      // allows for proper errors and also string errors\n      if (!(error instanceof Error) || error.name !== 'noScene') {\n        throw error;\n      }\n\n      // when we have reached the max number of retries,\n      // we should give up and throw the error\n      if (errors.length === count) {\n        console.warn(\n          `Retry gave up after ${count} retries:\\n${errors\n            .map((e) =>\n              e instanceof Error ? e.message : (e as string).toString()\n            )\n            .join('\\n')}`\n        );\n\n        // throw the most recent error as the primary cause of failure\n        throw error;\n      }\n\n      await sleep(delay);\n      continue;\n    }\n    break;\n  }\n  return result;\n}\n\nfunction storeSessionData(server: string, sessionId: string, apiKey: string) {\n  sessionStorage.setItem('sm-server', server);\n  sessionStorage.setItem('sm-session-id', sessionId);\n  sessionStorage.setItem('sm-api-key', apiKey);\n}\n\nfunction getSessionData() {\n  return {\n    server: sessionStorage.getItem('sm-server'),\n    resumeSessionId: sessionStorage.getItem('sm-session-id'),\n    savedApiKey: sessionStorage.getItem('sm-api-key'),\n  };\n}\n\nfunction clearSessionData() {\n  sessionStorage.removeItem('sm-server');\n  sessionStorage.removeItem('sm-session-id');\n  sessionStorage.removeItem('sm-api-key');\n}\n\n/**\n * Available configuration options for the `Scene.connect` tracer.\n */\nexport type TracerOptions = {\n  /** Suppress tracing by OpenTelemetry. */\n  disableTracing: boolean;\n  /** The context to use as the parent for tracing. */\n  parentCtx: Context;\n  /** The endpoint to use for sending traces */\n  url: string;\n};\n\n/**\n * Scene class to hold a webrtc connection to a scene containing a persona.\n * @public\n */\nexport class Scene {\n  private _apiKey: string | undefined;\n  private _videoElement: HTMLVideoElement | undefined;\n  private _audioOnly: boolean;\n  private _requestedUserMedia: UserMedia;\n  private _requiredUserMedia: UserMedia;\n  /**\n   * set to function(scene, state) called when a state message is received as per the scene protocol\n   * (DEPRECATED: onStateEvent.addListener allows for multiple listeners).\n   */\n  // eslint-disable-next-line @typescript-eslint/ban-types\n  private _onState: Function | undefined; // function (scene, state)\n  private _onStateEvent: SmEvent;\n\n  /**\n   * set to function(scene, results) called when speech to text results are recognized,\n   * results are documented in scene protocol\n   * (DEPRECATED: onRecognizeResultsEvent.addListener allows for multiple listeners).\n   */\n  // eslint-disable-next-line @typescript-eslint/ban-types\n  private _onRecognizeResults: Function | undefined; // function (scene, results)\n  private _onRecognizeResultsEvent: SmEvent;\n\n  private _metadataSender: MetadataSender;\n\n  /**\n   * set to function(scene, sessionId, reason) called when the session is disconnected.\n   * 'reason' can be one of 'normal' or 'sessionTimeout'\n   * (DEPRECATED: onDisconnectedEvent.addListener allows for multiple listeners).\n   */\n  // eslint-disable-next-line @typescript-eslint/ban-types\n  private _onDisconnected: Function | undefined; // function (scene, sessionId, reason)\n  private _onDisconnectedEvent: SmEvent;\n\n  /** set to function(scene, text) called when a custom text message is sent from the orchestration server */\n  // eslint-disable-next-line @typescript-eslint/ban-types\n  private _onUserText: Function | undefined; // function (scene, text)\n  private _onUserTextEvent: SmEvent;\n\n  /** Demo mode events */\n  // eslint-disable-next-line @typescript-eslint/ban-types\n  private _onDemoMode: Function | undefined; // function (scene, params)\n  private _onDemoModeEvent: SmEvent;\n\n  private _onConversationResultEvents: PersonaEventMap = {}; // persona id -> SmEvent with function(persona, result)\n  private _onSpeechMarkerEvents: PersonaEventMap = {}; // persona id -> SmEvent function(persona, marker)\n\n  private _session: Session | LocalSession | WebSocketSession | undefined =\n    undefined;\n\n  private _underRuntimeHost: boolean;\n  private _isWebSocketOnly = false;\n\n  private _transactionId = 0;\n  private _pendingResponses: { [index: string]: PendingPromise } = {};\n\n  private _sceneId: string;\n\n  private _microphoneUnmuteTimer: any = undefined;\n\n  private _echoCancellationEnabled = true;\n\n  private _serverControlledCameras = false;\n\n  private _stopSpeakingWhenNotVisible = true;\n\n  private _loggingConfig: LoggingConfig = {\n    session: {},\n    contentAwareness: {},\n  };\n\n  private _logger: Logger = new Logger();\n\n  private _tracerOptions: TracerOptions = {\n    disableTracing: false,\n    parentCtx: ROOT_CONTEXT,\n    url: SmTracerProvider.defaultUrl,\n  };\n\n  private _chromaKeyOptions: ChromaKeyOptions | undefined = undefined;\n\n  public connectionResult: any;\n\n  public contentAwareness: ContentAwareness | undefined;\n  public contentAwarenessDebounceTime: number | undefined;\n  private _sessionResumeEnabled = false;\n  private _isResumedSession = false;\n  private _sendMetadata = { pageUrl: false };\n\n  private _onMicrophoneActive = new SmEvent();\n  private _onCameraActive = new SmEvent();\n\n  public conversation: Conversation;\n  public connectionState: ConnectionState;\n  public currentPersonaId: PersonaId = DEFAULT_PERSONA_ID;\n  /** Returns the version of the webSdk and platformSdk */\n  public version = {\n    webSdk: websdkVersion,\n    platformSdk: 'unknown',\n  };\n\n  /**\n   * Tests the first value of the Scene construtor to decide if\n   * it matches the new-style config options format.\n   */\n  private isSceneOptions(\n    videoOrOptions?: HTMLVideoElement | SceneOptions\n  ): videoOrOptions is SceneOptions {\n    // scene options must be defined, even if they're an empty object\n    const isDefined = !!videoOrOptions;\n    // scene options object will not have a tagName\n    const isHTMLElement = !!(videoOrOptions as HTMLVideoElement)?.tagName;\n\n    return isDefined && !isHTMLElement;\n  }\n\n  /**\n   * Construct Scene from options object\n   * @param options - {@link SceneOptions} Optional configuration for the Scene. May be an empty object.\n   */\n  constructor(options: SceneOptions);\n  /**\n   * Construct Scene with parameters\n   * @deprecated Use `new Scene(options: SceneOptions)` instead\n   * @param videoElement - A video element that will display the connected scene\n   * @param audioOnly - This streaming should be audio streaming only (no video streaming)\n   * @param requestedUserMedia - The user media devices (microphone/camera) that should be requested, one of:\n   *     UserMedia.None, UserMedia.Microphone, UserMedia.MicrophoneAndCamera (default)\n   * @param requiredUserMedia - Required user media devices, one of:\n   *     UserMedia.None, UserMedia.Microphone, UserMedia.MicrophoneAndCamera\n   *     If less user media devices are requested then are required then the requirements takes precedence.\n   *     If this user media requirements is not met then Connect() will fail.\n   * @param contentAwarenessDebounceTime - The timeout period used for debouncing messaging within the content awareness class\n   * @param loggingConfig - Options to configure different log levels for different classes\n   */\n  constructor(\n    videoElement?: HTMLVideoElement,\n    audioOnly?: boolean,\n    requestedUserMedia?: UserMedia,\n    requiredUserMedia?: UserMedia,\n    contentAwarenessDebounceTime?: number,\n    loggingConfig?: Partial<LoggingConfig>,\n    tracerOptions?: TracerOptions,\n    chromaKeyOptions?: ChromaKeyOptions\n  );\n  constructor(\n    videoOrOptions?: HTMLVideoElement | SceneOptions,\n    audioOnly = false,\n    requestedUserMedia = UserMedia.MicrophoneAndCamera,\n    requiredUserMedia = UserMedia.Microphone,\n    contentAwarenessDebounceTime?: number,\n    loggingConfig?: Partial<LoggingConfig>,\n    tracerOptions?: TracerOptions,\n    chromaKeyOptions?: ChromaKeyOptions\n  ) {\n    // use the first parameter of the constructor to figure out\n    // whether it was constructed using SceneOptions, or using\n    // the deprecated multi-param format.\n    if (this.isSceneOptions(videoOrOptions)) {\n      // pull all private property initial values from the config object,\n      // with fallbacks to the constructor property defaults if not provided\n      const options = videoOrOptions;\n      this._videoElement = options.videoElement;\n      this._apiKey = options.apiKey;\n      this._audioOnly = options.audioOnly || audioOnly;\n\n      // default is \"true\" so can't use a shorthand falsy assessment to read this config option\n      if (options.stopSpeakingWhenNotVisible === false) {\n        this._stopSpeakingWhenNotVisible = false;\n      }\n\n      this._requestedUserMedia = convertToUserMedia(\n        options.requestedMediaDevices,\n        requestedUserMedia\n      );\n      this._requiredUserMedia = convertToUserMedia(\n        options.requiredMediaDevices,\n        requiredUserMedia\n      );\n      this.contentAwarenessDebounceTime = options.contentAwarenessDebounceTime;\n      this._loggingConfig = {\n        ...this._loggingConfig,\n        ...(options.loggingConfig || {}),\n      };\n      if (options.sendMetadata) {\n        this._sendMetadata = options.sendMetadata;\n      }\n      if (options.tracerOptions) {\n        this._tracerOptions = options.tracerOptions;\n      }\n      this._chromaKeyOptions = options.chromaKeyOptions;\n    } else {\n      // take all private property initial values directly from the constructor props\n      this._videoElement = videoOrOptions;\n      this._audioOnly = audioOnly;\n      this._requestedUserMedia = requestedUserMedia;\n      this._requiredUserMedia = requiredUserMedia;\n      this.contentAwarenessDebounceTime = contentAwarenessDebounceTime;\n      this._loggingConfig = {\n        ...this._loggingConfig,\n        ...loggingConfig,\n      };\n      if (tracerOptions) {\n        this._tracerOptions = tracerOptions;\n      }\n      this._chromaKeyOptions = chromaKeyOptions;\n    }\n\n    this._logger = new Logger(\n      this._loggingConfig.session.minLogLevel,\n      this._loggingConfig.session.enabled\n    );\n\n    /**\n     * call onStateEvent.addListener(function(scene, state)) to be called when a state message is received as per the scene protocol\n     * call onStateEvent.removeListener(function(scene, state)) to deregister a listener.\n     */\n    this._onStateEvent = new SmEvent();\n    this._onStateEvent.addListener((scene: Scene, state: StateResponseBody) => {\n      if (this._onState) {\n        this._onState(scene, state);\n      }\n    });\n\n    /**\n     * call onRecognizeResultsEvent.addListener(function(scene, status, errorMessage, results)) to be called when speech to text results are recognized, results are documented in scene protocol.\n     * call onRecognizeResultsEvent.removeListener(function(scene, status, errorMessage, results)) to deregister a listener.\n     */\n    this._onRecognizeResultsEvent = new SmEvent();\n    this._onRecognizeResultsEvent.addListener(\n      (\n        scene: Scene,\n        status: RecognizeResultsResponseBody['status'],\n        errorMessage: RecognizeResultsResponseBody['errorMessage'],\n        results: RecognizeResultsResponseBody['results']\n      ) => {\n        if (this._onRecognizeResults) {\n          this._onRecognizeResults(scene, status, errorMessage, results);\n        }\n      }\n    );\n\n    /**\n     * call onDisconnectedEvent.addListener(function(scene, sessionId, reason)) to be  called when the session is disconnected.\n     * call onDisconnectedEvent.removeListener(function(scene, sessionId, reason)) to deregister a listener.\n     */\n    this._onDisconnectedEvent = new SmEvent();\n    this._onDisconnectedEvent.addListener(\n      (scene: Scene, sessionId: string, reason: string) => {\n        clearSessionData();\n        this.cleanupEventListeners();\n        if (this._onDisconnected) {\n          this._onDisconnected(scene, sessionId, reason);\n        }\n      }\n    );\n\n    /**\n     * call onUserTextEvent.addListener(function(scene, text)) to be called when a custom text message is sent from the orchestration server\n     * call onUserTextEvent.removeListener(function(scene, text)) to deregister a listener.\n     */\n    this._onUserTextEvent = new SmEvent();\n    this._onUserTextEvent.addListener((scene: Scene, text: string) => {\n      if (this._onUserText) {\n        this._onUserText(scene, text);\n      }\n    });\n\n    this._onDemoModeEvent = new SmEvent();\n\n    this._underRuntimeHost = Boolean(window.SmIsUnderRuntimeHost);\n\n    // Generate a random id for the scene. This is used internally with the _transactionId\n    // to ensure unique transaction ids when mulitple Scene instances access the same BL instances\n    // eg multiple Soul Studio windows\n    const randArray = new Uint32Array(3);\n    window.crypto.getRandomValues(randArray);\n    this._sceneId = randArray.toString().replace(/,/g, '-');\n\n    this.conversation = new Conversation();\n    this.connectionState = new ConnectionState();\n    this._metadataSender = new MetadataSender(this);\n\n    this._logger.log('debug', 'websdk version:', this.version.webSdk);\n  }\n\n  public connectionValid(): boolean {\n    if (this._underRuntimeHost) {\n      return true;\n    }\n    if (this._session && this._session.serverConnection) {\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Check if the scene connection is open and valid.\n   *\n   * @returns Returns true if the connection is open and valid otherwise false.\n   */\n  public isConnected(): boolean {\n    if (\n      this.connectionValid() &&\n      this._session &&\n      this._session.serverConnection &&\n      this._session.serverConnection.readyState ===\n        this._session.serverConnection.OPEN\n    ) {\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Extends the server side timeout. This also happens automatically whenever the persona speaks.\n   */\n  public keepAlive() {\n    if (this._session && this._session.peerConnection !== null) {\n      this._session.sendRtcEvent('keepAlive', {});\n    }\n  }\n\n  /**\n   * Disconnects the session\n   */\n  public disconnect() {\n    clearSessionData();\n    this.cleanupEventListeners();\n    this.connectionState.reset();\n    this.conversation.reset();\n    this.contentAwareness?.disconnect();\n    this._metadataSender.disconnect();\n    this._session?.close(true);\n    this._session = undefined;\n  }\n\n  private iosVisibilityChange = () => {\n    const visible = document.visibilityState === 'visible';\n    setTimeout(() => {\n      if (this._session) {\n        this._session.sendRtcEvent('ui', { visible });\n      }\n    }, 500); // allow 100ms for the H.264 decoder to become fully available again\n  };\n  /**\n   * Connect to a scene using options object\n   */\n  public async connect(options?: ConnectOptions): Promise<string | undefined>;\n  // from sceneKind (e.g. persona selection - rachel/nadia) and process into serverUri if needed, keep connection\n  // abstract from person in case we need straight webrtc connection\n  /**\n   * Connect to a scene at the given server uri.\n   *\n   * @param serverUri - The server websocket uri to connect to.\n   * @param userText - A custom text string that is sent to the orchestration server.\n   * @param accessToken - A jwt access token issued to permit access to this server.\n   * @param retryOptions - Options for customizing connection error retry.\n   * @returns  Returns a promise that holds success/failure callbacks. If the promise\n   *                      is rejected then an Eror is given as the argument\n   *                      converts to a string message.  The error result has two fields 'message'\n   *                      which is the string message and 'name' which is one of the following\n   *                      error name/reason codes:\n   *    - **notSupported** - the browser does not support getUserMedia\n   *    - **noUserMedia** - the microphone/camera is either not available, not usable or the user declined permission to use them\n   *    - **serverConnectionFailed** - the connection to the server failed\n   *    - **noScene** - no persona was available\n   *    - **mediaStreamFailed** - the audio/video stream failed\n   *    - **sessionTimeout** - the session timed out before it was fully available\n   */\n  public async connect(\n    serverUri?: string,\n    userText?: string,\n    accessToken?: string,\n    retryOptions?: RetryOptions\n  ): Promise<string | undefined>;\n  public async connect(\n    serverUriOrOptions?: string | ConnectOptions,\n    userText?: string,\n    accessToken?: string,\n    retryOptions?: RetryOptions\n  ) {\n    const connectStartTime = Date.now();\n\n    const config = this.connectArgsToConfig(\n      serverUriOrOptions,\n      userText,\n      accessToken,\n      retryOptions\n    );\n\n    let span: Span;\n    const recordEventsToSpan = (event: { name: string }) => {\n      span?.addEvent(event.name);\n    };\n    this.connectionState.onConnectionStateUpdated.addListener(\n      recordEventsToSpan\n    );\n    if (this._underRuntimeHost) {\n      this._session = new LocalSession(this._videoElement, this._logger);\n    } else {\n      // Determine if user is passing in auth via the params\n      const hasPassedInTokenServerAuth =\n        config.tokenServerUri || config.tokenServerAccessToken;\n\n      if (this._apiKey && hasPassedInTokenServerAuth) {\n        this._logger.log(\n          'warn',\n          'You are trying to connect via an API key and a token server. Please use one or the other'\n        );\n      }\n\n      // If API key is defined and the auth creds have not been passed in\n      if (this._apiKey && !hasPassedInTokenServerAuth) {\n        try {\n          const response = await this.fetchAuthConfig(this._apiKey);\n          const data: { url: string; jwt: string } = await response.json();\n          const { server } = getSessionData();\n          config.tokenServerUri = data.url;\n          config.tokenServerAccessToken = data.jwt;\n          if (server) {\n            config.tokenServerUri = getUrlHost(data.url) + 'server/' + server;\n          }\n        } catch (error) {\n          if (error instanceof Error && error.message === 'Broken API key') {\n            this._logger.log(\n              'error',\n              'Broken API key. Please check your key or re copy the key from DDNA Studio.'\n            );\n          } else {\n            this._logger.log(\n              'error',\n              'Invalid API key: Please check your key configuration in DDNA Studio. For more information click here https://soulmachines-support.atlassian.net/wiki/spaces/SSAS/pages/1320058919/Connecting+Using+API+Keys#Troubleshooting'\n            );\n          }\n          throw makeError('Invalid API key', 'serverConnectionFailed');\n        }\n      }\n\n      if (!config.tokenServerUri || !config.tokenServerAccessToken) {\n        throw makeError(\n          'Please authenticate via an API key or with a serverUri and accessToken',\n          'serverConnectionFailed'\n        );\n      }\n\n      // Initialize the tracer\n      const { initTracerStartTime, initTracerEndTime } =\n        await this.initializeTracer(\n          config.tokenServerUri,\n          config.tokenServerAccessToken\n        );\n\n      span = SmTracerProvider.getTracer()\n        ?.startSpan('createSessionAndConnect')\n        ?.setAttribute(\n          'sm.websdk.connection.pretraceinitduration.milliseconds',\n          initTracerStartTime - connectStartTime\n        )\n        ?.setAttribute(\n          'sm.websdk.connection.traceinitduration.milliseconds',\n          initTracerEndTime - initTracerStartTime\n        );\n\n      if (this._isWebSocketOnly) {\n        this._session = new WebSocketSession(\n          config.tokenServerUri,\n          config.tokenServerAccessToken,\n          this._logger\n        );\n      } else {\n        this._session = new Session(\n          this._videoElement as HTMLVideoElement,\n          config.tokenServerUri,\n          config.userText,\n          config.tokenServerAccessToken,\n          this._audioOnly,\n          this._requestedUserMedia,\n          this._requiredUserMedia,\n          this._echoCancellationEnabled,\n          this._logger,\n          this.connectionState,\n          this._chromaKeyOptions\n        );\n      }\n    }\n\n    if (!this._session) {\n      throw makeError('Failed to create session', 'unknown');\n    }\n\n    this._session.onConnected = this.sessionConnected.bind(this);\n    this._session.onMessage = this.onMessage.bind(this);\n    this._session.onClose = this.sessionClosed.bind(this);\n    this._session.onUserText = this.rtcUserText.bind(this);\n\n    if ('microphoneActiveCallbacks' in this._session) {\n      this._session.microphoneActiveCallbacks = this._onMicrophoneActive;\n    }\n    if ('cameraActiveCallbacks' in this._session) {\n      this._session.cameraActiveCallbacks = this._onCameraActive;\n    }\n    if (this._session.features.isIos) {\n      document.addEventListener('visibilitychange', this.iosVisibilityChange);\n    }\n\n    return await retry(\n      async () => {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        return await this!._session!.connect();\n      },\n      config.retryOptions,\n      this\n    ).finally(() => {\n      this.connectionState.onConnectionStateUpdated.removeListener(\n        recordEventsToSpan\n      );\n      span?.end();\n    });\n  }\n\n  private async initializeTracer(\n    tokenServerUri: string,\n    tokenServerAccessToken: string\n  ): Promise<{ initTracerStartTime: number; initTracerEndTime: number }> {\n    const initTracerStartTime = Date.now();\n    if (\n      !this._tracerOptions.disableTracing &&\n      !SmTracerProvider.isInitialized()\n    ) {\n      try {\n        await this.initTelemetryToken({\n          tokenServerUri,\n          authToken: tokenServerAccessToken,\n        });\n      } catch (error: unknown) {\n        const base = 'Could not initialize tracer telemetry token: ';\n        if (\n          error instanceof ReferenceError &&\n          error.message === 'fetch is not defined'\n        ) {\n          // This happens in a non-browser environment (usually a test\n          // environment), so we can't get a telemetry token. Just log to\n          // debug.\n          this._logger.log('debug', base + error.name + ': ' + error.message);\n        } else if (error instanceof Error) {\n          this._logger.log('warn', base + error.name + ': ' + error.message);\n        } else {\n          this._logger.log('warn', base + 'unknown error type');\n        }\n      }\n    }\n    return { initTracerStartTime, initTracerEndTime: Date.now() };\n  }\n\n  private async initTelemetryToken({\n    tokenServerUri,\n    authToken,\n  }: {\n    tokenServerUri: string;\n    authToken: string;\n  }): Promise<void> {\n    const otelJwtEndpoint = 'api/telemetry/jwt';\n    const tracesEndpoint = 'api/telemetry/v1/traces';\n    const telemetryHost = getUrlHost(convertWssToHttps(tokenServerUri));\n    if (!telemetryHost) {\n      this._logger.log(\n        'debug',\n        'Could not initialize tracer telemetry token: invalid token server URI'\n      );\n      return;\n    }\n\n    const resp = await fetch(telemetryHost + otelJwtEndpoint, {\n      headers: {\n        Authorization: 'Bearer ' + authToken,\n      },\n    });\n\n    if (!resp) {\n      this._logger.log(\n        'warn',\n        'Failed to receive response from otel token endpoint'\n      );\n      return;\n    }\n    if (!resp.ok) {\n      this._logger.log(\n        'warn',\n        'Failed to fetch otel token: ' + resp.status + ': ' + resp.statusText\n      );\n      return;\n    }\n\n    const otelResponse: { success: boolean; telemetryJwt: string } =\n      await resp.json();\n    if (!otelResponse.success) {\n      this._logger.log('warn', 'Failed: otel response not successful');\n      return;\n    }\n\n    try {\n      SmTracerProvider.init({\n        jwt: otelResponse.telemetryJwt,\n        url: telemetryHost + tracesEndpoint,\n        webSDKVersion: this.version.webSdk,\n      });\n      this._logger.log('log', 'Telemetry initialized');\n    } catch (error: unknown) {\n      if (error instanceof Error) {\n        this._logger.log(\n          'warn',\n          'Failed to initialize tracer: ' + error.message\n        );\n      } else {\n        this._logger.log('warn', 'Failed to initialize tracer: unknown error');\n      }\n    }\n  }\n\n  public onMessage(message: WebsocketResponse) {\n    const { category } = message;\n\n    if (category === 'scene') {\n      const sceneMessage = message as SceneResponse;\n      this.onSceneMessage(sceneMessage);\n      return;\n    }\n  }\n\n  public sendOnewaySceneRequest(name: string, body: SceneRequestBody) {\n    if (!this._session) {\n      return;\n    }\n\n    const payload: SceneRequest = {\n      name,\n      body,\n      category: WebsocketCategory.Scene,\n      kind: WebsocketKind.Request,\n    };\n    this._session.sendMessage(payload);\n  }\n\n  /**\n   * The internal method used for sending request messages.\n   *\n   * All offically supported message have their own public methods (e.g. `conversationSend()` or `scene.startRecognize()`). \\\n   * Please use those instead.\n   *\n   * @internal\n   */\n  public sendRequest(name: string, body: SceneRequestBody = {}): Promise<any> {\n    return new Promise<any>((resolve, reject) => {\n      if (!this._session) {\n        reject(makeError('No session available', 'noSession'));\n        return;\n      }\n\n      const transaction = this._sceneId + '_' + ++this._transactionId;\n      const payload: SceneRequest = {\n        transaction,\n        name,\n        body,\n        category: WebsocketCategory.Scene,\n        kind: WebsocketKind.Request,\n      };\n\n      const pending: PendingPromise = { resolve, reject };\n      this._pendingResponses[transaction] = pending;\n      if (this._session) {\n        this._session.sendMessage(payload);\n      }\n    });\n  }\n\n  public onSceneMessage(message: SceneResponse) {\n    const { name, body, kind, status, transaction } = message;\n\n    // Process events\n    if (body && name === 'state') {\n      const responseBody = body as StateResponseBody;\n      this._onStateEvent.call(this, responseBody);\n\n      if (responseBody.scene?.featureFlags) {\n        this.enableFlaggedFeatures(responseBody.scene.featureFlags);\n      }\n\n      if (responseBody.scene?.sdkVersion) {\n        this.version.platformSdk = responseBody.scene?.sdkVersion;\n        this._logger.log(\n          'debug',\n          'platformSdk version:',\n          this.version.platformSdk\n        );\n      }\n\n      this.conversation.processStateMessage(responseBody);\n\n      // mute the microphone while a persona is speaking\n      this.controlMicrophoneMute(body as StateResponseBody);\n    } else if (body && name === 'recognizeResults') {\n      const { status, errorMessage, results } =\n        body as RecognizeResultsResponseBody;\n      this.conversation.processRecognizeResultsMessage(\n        body as RecognizeResultsResponseBody\n      );\n      this._onRecognizeResultsEvent.call(this, status, errorMessage, results);\n    } else if (body && name === 'conversationResult') {\n      this.conversation.onConversationResult(\n        body as ConversationResultResponseBody\n      );\n      const { personaId } = body as ConversationResultResponseBody;\n      if (personaId) {\n        const persona = new Persona(this, personaId);\n        const event: SmEvent = this._onConversationResultEvents[personaId];\n        event.call(persona, body as ConversationResultResponseBody);\n        this.currentPersonaId = personaId;\n      }\n    } else if (body && name === 'speechMarker') {\n      this.conversation.onSpeechMarker(body as SpeechMarkerResponseBody);\n      const { personaId } = body as SpeechMarkerResponseBody;\n      if (personaId) {\n        const persona = new Persona(this, personaId);\n        const event: SmEvent = this._onSpeechMarkerEvents[personaId];\n        event.call(persona, body as SpeechMarkerResponseBody);\n        this.currentPersonaId = personaId;\n      }\n    } else if (body && name === 'demoMode') {\n      this._onDemoModeEvent.call(this, body as DemoModeResponseBody);\n    }\n\n    // Process responses, message should always be a response as far as we're aware\n    if (kind === WebsocketKind.Response && transaction) {\n      this.processResponse(body, name, status, transaction);\n    }\n  }\n\n  protected processResponse(\n    body: SceneResponseBody,\n    name: string,\n    status: number,\n    transaction: string\n  ) {\n    // Check for a pending response\n    const pending: PendingPromise = this._pendingResponses[transaction];\n    if (pending) {\n      if (status === 0) {\n        // Success\n        pending.resolve(body);\n      } else {\n        // Failure\n        const error = new SceneResponseError();\n        error.requestName = name;\n        error.status = status;\n        error.responseBody = body;\n        pending.reject(error);\n      }\n\n      delete this._pendingResponses[transaction];\n    }\n  }\n\n  private controlMicrophoneMute(state: StateResponseBody) {\n    // Watch for speaking state transitions and mute the\n    // microphone during persona speech to prevent self interruption\n    if (\n      state.persona &&\n      this._session &&\n      this._session.microphoneMuteDelay !== -1\n    ) {\n      // iterate through the personas looking for speaking state changes\n      for (const personaId in state.persona) {\n        const persona_state = state.persona[personaId];\n        if (!persona_state.speechState) {\n          continue;\n        }\n\n        if (persona_state.speechState === SpeechState.Speaking) {\n          // A persona is speaking, mute the microphone\n          if (!this._session.microphoneMuted) {\n            this._logger.log('warn', 'Persona is speaking - mute microphone');\n            this._session.microphoneMuted = true;\n          }\n          if (this._microphoneUnmuteTimer) {\n            // ensure an in-progress timeout doesn't incorrectly unmute\n            clearTimeout(this._microphoneUnmuteTimer);\n            this._microphoneUnmuteTimer = undefined;\n          }\n        } else {\n          // A persona has stopped speaking, unmute the microphone after\n          // the microphone mute delay\n          if (this._session.microphoneMuted && !this._microphoneUnmuteTimer) {\n            this._microphoneUnmuteTimer = setTimeout(() => {\n              if (!this._session || !this._microphoneUnmuteTimer) {\n                return;\n              }\n              this._logger.log(\n                `warn`,\n                'Persona is no longer speaking - unmute microphone'\n              );\n              this._session.microphoneMuted = false;\n              this._microphoneUnmuteTimer = undefined;\n            }, this._session.microphoneMuteDelay);\n          }\n        }\n      }\n    }\n  }\n\n  /** Close the current scene connection */\n  private close(): void {\n    // close/disconnect the session\n    if (this._session) {\n      this._session.close(true);\n    }\n  }\n\n  private stopSpeakingWhenNotVisible = () => {\n    if (document.visibilityState !== 'visible') {\n      this.sendRequest('stopSpeaking', { personaId: this.currentPersonaId });\n    }\n  };\n\n  private stopSpeakingWhenUnloaded = () => {\n    this.sendRequest('stopSpeaking', { personaId: this.currentPersonaId });\n  };\n\n  private sessionConnected(\n    resumeRequested: boolean,\n    isResumedSession: boolean,\n    server: string,\n    sessionId: string\n  ) {\n    this.contentAwareness = new ContentAwareness(\n      this as Scene,\n      this.contentAwarenessDebounceTime,\n      new Logger(\n        this._loggingConfig.contentAwareness.minLogLevel,\n        this._loggingConfig.contentAwareness.enabled\n      )\n    );\n\n    /*\n    Interrupt DP from speaking so it does not continue talking when user switches tabs\n    */\n    if (this._stopSpeakingWhenNotVisible) {\n      document.addEventListener(\n        'visibilitychange',\n        this.stopSpeakingWhenNotVisible\n      );\n    }\n\n    //when user navigates to a new page, widget DP should stop speaking to allow new welcome message coming through in the new page\n    //however browser doesn't trigger visibilitychange event, only \"beforeunload\" event is sure to be triggered\n    window.addEventListener('beforeunload', this.stopSpeakingWhenUnloaded);\n\n    if (this._sendMetadata.pageUrl) {\n      this._metadataSender.observeUrlChanges();\n    }\n\n    //update resume session data\n    this._isResumedSession = isResumedSession;\n    if (resumeRequested) {\n      this._sessionResumeEnabled = true;\n      storeSessionData(server, sessionId, this._apiKey || '');\n    }\n\n    // When page navigation happens, check if any value in _sendMetadata is true and send it back to NLP so conversation writers can use it\n    if (isResumedSession && this._sendMetadata.pageUrl) {\n      this._metadataSender.send();\n    }\n  }\n\n  private cleanupEventListeners() {\n    if (this._session?.features.isIos) {\n      document.removeEventListener(\n        'visibilitychange',\n        this.iosVisibilityChange\n      );\n    }\n    if (this._stopSpeakingWhenNotVisible) {\n      document.removeEventListener(\n        'visibilitychange',\n        this.stopSpeakingWhenNotVisible\n      );\n    }\n    window.removeEventListener('beforeunload', this.stopSpeakingWhenUnloaded);\n  }\n\n  private sessionClosed(reason: string) {\n    clearSessionData();\n    this.cleanupEventListeners();\n    if (this._session) {\n      this.connectionState.reset();\n      this.conversation.reset();\n      this._onDisconnectedEvent.call(this, this._session.sessionId, reason);\n    }\n  }\n\n  private rtcUserText(text: string) {\n    this._onUserTextEvent.call(this, text);\n  }\n  private enableFlaggedFeatures(featureFlags: FeatureFlag[]) {\n    this._serverControlledCameras = featureFlags.includes(\n      FeatureFlag.UI_SDK_CAMERA_CONTROL\n    );\n  }\n\n  public sendContent() {\n    if (!this.contentAwareness) {\n      console.warn('ContentAwareness is not enabled for this project');\n    }\n    this.contentAwareness?.measure();\n  }\n\n  /**\n   * Sends updated video element size to server\n   * this gives the app the chance to choose what size should be rendered on server\n   * and the application is responsible to register for a video element size change\n   * event and call this method to maintain best possible video quality for the size\n   * and/or to set an updated video element size and then call this method.\n   * @param width - The width in pixels to render the video\n   * @param height - The height in pixels to render the video\n   */\n  public sendVideoBounds(width: number, height: number) {\n    if (this._session) {\n      this._session.sendVideoBounds(width, height);\n    }\n  }\n\n  /**\n   * Send configuration to the scene\n   * @param configuration - Scene configuration as per the scene protocol\n   */\n  public configure(configuration: ConfigurationModel): Promise<any> {\n    return this.sendRequest('configure', configuration);\n  }\n\n  /**\n   * Send a custom user text message to the orchestration server\n   * @param text - Custom text sent to the orchestration server\n   */\n  private sendUserText(text: string) {\n    if (this._session) {\n      this._session.sendUserText(text);\n    }\n  }\n\n  /**\n   * Start the speech to text recognizer\n   * @param audioSource - The audio source either smwebsdk.audioSource.processed or\n   *                    smwebsdk.audioSource.squelched, defaults to processed.\n   */\n  public startRecognize(audioSource?: AudioSourceTypes): Promise<any> {\n    const body: StartRecognizeRequestBody = {};\n\n    if (audioSource !== undefined) {\n      body.audioSource = audioSource;\n    }\n\n    return this.sendRequest('startRecognize', body);\n  }\n\n  /** Stop the speech to text reconizer */\n  public stopRecognize(): Promise<any> {\n    return this.sendRequest('stopRecognize');\n  }\n\n  /** Is the microphone connected in the session */\n  public isMicrophoneConnected(): boolean | null {\n    // public function rather than getter for back compatibility\n    if (this._session) {\n      return this._session.isMicrophoneConnected;\n    }\n    return false;\n  }\n\n  /** Is the camera connected in the session */\n  public isCameraConnected(): boolean | null {\n    // public function rather than getter for back compatibility\n    if (this._session) {\n      return this._session.isCameraConnected;\n    }\n    return false;\n  }\n\n  public session(): Session | LocalSession | WebSocketSession | undefined {\n    // public function rather than getter for back compatibility\n    return this._session;\n  }\n\n  public hasContentAwareness(): boolean {\n    return !!this.contentAwareness;\n  }\n\n  public hasServerControlledCameras(): boolean {\n    return this._serverControlledCameras;\n  }\n\n  /**\n   * Check if session persistence feature is supported in current session\n   *\n   * @returns `boolean`\n   *\n   * Usage:\n   * ```javascript\n   * const isSessionPersistenceSupported = scene.supportsSessionPersistence();\n   * ```\n   */\n  public supportsSessionPersistence(): boolean {\n    return this._sessionResumeEnabled;\n  }\n\n  /**\n   * Check if current session is a new session or a resumed session\n   *\n   * @returns `boolean`\n   *\n   * Usage:\n   * ```javascript\n   * const isResumedSession = scene.isResumedSession();\n   * ```\n   */\n  public isResumedSession(): boolean {\n    return this._isResumedSession;\n  }\n\n  get onConversationResultEvents(): PersonaEventMap {\n    return this._onConversationResultEvents;\n  }\n\n  get onSpeechMarkerEvents(): PersonaEventMap {\n    return this._onSpeechMarkerEvents;\n  }\n\n  /** Get the current scene state */\n  public async getState(): Promise<any> {\n    return this.sendRequest('getState');\n  }\n\n  get onStateEvent(): SmEvent {\n    return this._onStateEvent;\n  }\n\n  // eslint-disable-next-line @typescript-eslint/ban-types\n  set onState(onState: Function) {\n    this._onState = onState;\n  }\n\n  get onDisconnectedEvent(): SmEvent {\n    return this._onDisconnectedEvent;\n  }\n\n  // eslint-disable-next-line @typescript-eslint/ban-types\n  set onDisconnected(onDisconnected: Function) {\n    this._onDisconnected = onDisconnected;\n  }\n\n  get onRecognizeResultsEvent(): SmEvent {\n    return this._onRecognizeResultsEvent;\n  }\n\n  // eslint-disable-next-line @typescript-eslint/ban-types\n  set onRecognizeResults(onRecognizeResults: Function) {\n    this._onRecognizeResults = onRecognizeResults;\n  }\n\n  get onUserTextEvent(): SmEvent {\n    return this._onUserTextEvent;\n  }\n\n  // eslint-disable-next-line @typescript-eslint/ban-types\n  set onUserText(onUserText: Function) {\n    this._onUserText = onUserText;\n  }\n\n  public get echoCancellationEnabled() {\n    return this._echoCancellationEnabled;\n  }\n\n  public set echoCancellationEnabled(enabled: boolean) {\n    this._echoCancellationEnabled = enabled;\n  }\n\n  /**\n   * @internal\n   */\n  get onDemoModeEvent(): SmEvent {\n    return this._onDemoModeEvent;\n  }\n\n  get videoElement(): HTMLVideoElement | undefined {\n    return this._videoElement;\n  }\n\n  set videoElement(videoElement: HTMLVideoElement | undefined) {\n    this._videoElement = videoElement;\n\n    // cast HTMLVideoElement | undefined to HTMLElement,\n    // not ideal, but this is same to when session is constructed.\n    this._session?.setVideoElement(this._videoElement as HTMLVideoElement);\n  }\n\n  get viewerOffsetX(): number {\n    if (this._session) {\n      return this._session.offsetX;\n    }\n    return 0;\n  }\n\n  get viewerOffsetY(): number {\n    if (this._session) {\n      return this._session.offsetY;\n    }\n    return 0;\n  }\n\n  get isWebSocketOnly(): boolean {\n    return this._isWebSocketOnly;\n  }\n\n  set isWebSocketOnly(isWebSocketOnly: boolean) {\n    this._isWebSocketOnly = isWebSocketOnly;\n  }\n\n  /**\n   * @returns an {@link SmEvent} associated with the microphone.\n   *\n   * Listeners can then be added to this event allowing you to call functions when the microphone active status changes.\n   *\n   * Usage:\n   * ```javascript\n   * scene.onMicrophoneActive.addListener(\n   *   (active) => console.log('Microphone Active: ', active));\n   * ```\n   */\n  public get onMicrophoneActive(): SmEvent {\n    return this._onMicrophoneActive;\n  }\n\n  /**\n   * Specifies if the microphone is currently active and streaming audio\n   * to the server.\n   *\n   * @returns `boolean`\n   *\n   * Usage:\n   * ```javascript\n   * const isMicrophoneActive = scene.isMicrophoneActive();\n   * ```\n   */\n  public isMicrophoneActive(): boolean {\n    return Boolean(this._session?.isMicrophoneActive());\n  }\n\n  /**\n   * @returns an {@link SmEvent} associated with the camera.\n   *\n   * Listeners can then be added to this event allowing you to call functions when the camera active status changes.\n   *\n   * Usage:\n   * ```javascript\n   * scene.onCameraActive.addListener(\n   *   (active) => console.log('Camera Active: ', active));\n   * ```\n   */\n  public get onCameraActive(): SmEvent {\n    return this._onCameraActive;\n  }\n\n  /**\n   * Specifies if the camera is currently active and streaming video\n   * to the server.\n   *\n   * @returns `boolean`\n   *\n   * Usage:\n   * ```javascript\n   * const isCameraActive = scene.isCameraActive();\n   * ```\n   */\n  public isCameraActive(): boolean {\n    return Boolean(this._session?.isCameraActive());\n  }\n\n  /**\n   * On success, starts or stops streaming video/audio to the server based on the values of `microphone` and `camera`.\n   *\n   * @param options.microphone - If `true`, activates the microphone and starts streaming audio. \\\n   * If `false` deactivates the microphone and stops streaming audio. \\\n   * If not set, microphone will retain its existing state.\n   * @param options.camera - If `true`, activates the camera and starts streaming video. \\\n   * If `false` deactivates the camera and stops streaming video. \\\n   * If not set, microphone will retain its existing state.\n   *\n   * @returns Returns a promise which is fulfilled when the media active state has been successfully changed. \\\n   * If the session is not defined it will return `undefined`. \\\n   * If the active state could not be changed, the promise is rejected with an Error object having the format:\n   * ```javascript\n   * {\n   *   message: string;\n   *   name: errorCode;\n   * }\n   * ```\n   * Where `errorCode` is one of:\n   *    - `noUserMedia` - the microphone/camera is either not available, not usable or the user declined permission to use them\n   *    - `failedUpgrade` - the media upgrade failed\n   *    - `notSupported` - user’s browser does not support the getUserMedia API\n   *    - `noConnection` - connection has not been established - ensure scene.connect() has been called previously\n   *\n   * Usage:\n   * ```javascript\n   * scene.setMediaDeviceActive({ microphone: true, camera: false })\n   *   .then(console.log('microphone activated, camera deactivated'));\n   *   .catch((error) => console.log('error occurred: ', error);\n   * ```\n   */\n  public async setMediaDeviceActive(options: {\n    microphone?: boolean;\n    camera?: boolean;\n  }): Promise<void> {\n    if (this.isConnected()) {\n      await this._session?.setMediaDeviceActive({\n        microphone: options.microphone,\n        camera: options.camera,\n      });\n    } else {\n      throw makeError('Connection has not been established', 'noConnection');\n    }\n  }\n\n  /**\n   * Play the video element and return results. Different browsers have different restrictions on autoplay.\n   * Using this method can handle all the cases browsers can have on inital video playback.\n   * @param videoElement - Optional parameter specifying the video element hosting the Digital Person. If not specified the video element passed to the Scene constructor will be used.\n   * @returns Returns a promise which is fulfilled when the video playback is successful, with indication of video and audio status.\n   * If the video element is not defined or video play fails the promise is rejected with an Error object having the format:\n   * ```javascript\n   * {\n   *   message: string;\n   *   name: errorCode;\n   * }\n   * ```\n   * Where `errorCode` is one of:\n   *    - `noVideoElement` - no HTMLVideoElement found from `videoElement` or `Scene` constructor\n   *    - `userInteractionRequired` - cannot start media playback due to browser restriction; user interaction is required before playing again\n   *\n   * Usage:\n   * ```javascript\n   * scene.startVideo()\n   *      .then(({ video, audio }) => {\n   *         if (!audio) {\n   *          //video is muted, ask user to unmute video\n   *         }\n   *      })\n   *      .catch((error) => {\n   *         if (error.name === 'userInteractionRequired') {\n   *          //ask user to interact with the UI\n   *          //unmute video and play again\n   *          video.muted = false;\n   *          video.play();\n   *         }\n   *      });\n   * ```\n   */\n  public async startVideo(\n    videoElement?: HTMLVideoElement\n  ): Promise<{ video: boolean; audio: boolean } | Error> {\n    const video = videoElement || this._videoElement;\n    if (!video) {\n      throw makeError('Cannot find HTMLVideoElement', 'noVideoElement');\n    }\n    // best case, play with audio\n    if (await this.playVideo(video)) {\n      return {\n        video: true,\n        audio: true,\n      };\n    }\n    //second-best case, play without audio\n    video.muted = true;\n    if (await this.playVideo(video)) {\n      return {\n        video: true,\n        audio: false,\n      };\n    }\n    //worst case, not able to play, require user interaction\n    throw makeError('Cannot start media playback', 'userInteractionRequired');\n  }\n\n  private async playVideo(videoElement: HTMLVideoElement): Promise<boolean> {\n    try {\n      await videoElement.play();\n      return true;\n    } catch {\n      return false;\n    }\n  }\n\n  private fetchAuthConfig(apiKey: string) {\n    let authServer: string;\n    try {\n      const decodedApiKey: { authServer: string } = JSON.parse(atob(apiKey));\n      authServer = decodedApiKey.authServer;\n    } catch (error) {\n      throw makeError('Broken API key', 'Failed to decode api key');\n    }\n    // check if sessionId exists in browser storage\n    const { server, resumeSessionId, savedApiKey } = getSessionData();\n    // check if the current api key is same as saved api key (if it is intended to resume to the same DP)\n    if (server && resumeSessionId && savedApiKey === apiKey) {\n      authServer = authServer + '?sessionId=' + resumeSessionId;\n    }\n    return fetch(authServer, {\n      headers: {\n        key: apiKey,\n      },\n    });\n  }\n\n  // Use the first parameter of the constructor to figure out\n  // whether it was constructed using ConnectOptions, or using the deprecated multi-param format.\n  private connectArgsToConfig(\n    serverUriOrOptions?: string | ConnectOptions,\n    userText?: string,\n    accessToken?: string,\n    retryOptions?: RetryOptions\n  ) {\n    if (typeof serverUriOrOptions === 'string') {\n      return {\n        tokenServerUri: serverUriOrOptions,\n        tokenServerAccessToken: accessToken,\n        userText,\n        retryOptions,\n      };\n    } else {\n      return {\n        tokenServerUri: serverUriOrOptions?.tokenServer?.uri || '',\n        tokenServerAccessToken: serverUriOrOptions?.tokenServer?.token,\n        userText: serverUriOrOptions?.userText,\n        retryOptions: serverUriOrOptions?.retryOptions,\n      };\n    }\n  }\n\n  /**\n   * Check if the session logging is enabled.\n   *\n   * @returns Returns true if the session logging is enabled otherwise false.\n   */\n  public isLoggingEnabled(): boolean {\n    return this._logger.isEnabled;\n  }\n\n  /**\n   * Check minimal log level of session logging.\n   *\n   * @returns Returns minimal log setting of session logging, type is LogLevel.\n   */\n  public getMinLogLevel() {\n    return this._logger.getMinLogLevel();\n  }\n\n  /**\n   * Enable/disable session logging\n   * @param enable - set true to enable session log, false to disable\n   */\n  public setLogging(enable: boolean) {\n    this._logger.enableLogging(enable);\n  }\n\n  /**\n   * Set minimal log level of session logging.\n   * @param level - use LogLevel type to set minimal log level of session logging\n   */\n  public setMinLogLevel(level: LogLevel) {\n    this._logger.setMinLogLevel(level);\n  }\n}\n","/**\n * smwebsdk.js creates the global namespace variable _smwebsdk_ to access the API from.\n *\n * ```ts\n * window.smwebsdk\n * ```\n * @module smwebsdk\n * @preferred\n */\n\n/**\n * Copyright 2017-2020 Soul Machines Ltd. All Rights Reserved.\n */\n\nimport { Features } from './Features';\nimport { Persona } from './Persona';\nimport { Scene } from './Scene';\nimport { UserMedia as SessionUserMedia } from './types/scene';\n\nexport enum userMedia {\n  none = SessionUserMedia.None,\n  microphone = SessionUserMedia.Microphone,\n  microphoneAndCamera = SessionUserMedia.MicrophoneAndCamera,\n  camera = SessionUserMedia.Camera,\n}\n\n/**\n * SmWebSdk class for legacy compatibility\n * @deprecated - please use the other top level classes such as {@link Scene} or {@link Persona} instead\n */\nexport class SmWebSdk {\n  public Scene = Scene;\n  public Persona = Persona;\n\n  // eslint-disable-next-line @typescript-eslint/ban-types\n  public DetectCapabilities: Function;\n  public userMedia = {\n    none: SessionUserMedia.None,\n    microphone: SessionUserMedia.Microphone,\n    microphoneAndCamera: SessionUserMedia.MicrophoneAndCamera,\n    camera: SessionUserMedia.Camera,\n  };\n\n  // eslint-disable-next-line @typescript-eslint/ban-types\n  public setLogging: Function;\n\n  constructor() {\n    this.DetectCapabilities = function () {\n      return new Features().detectWebRTCFeatures();\n    };\n\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\n    this.setLogging = function (value: boolean) {};\n  }\n}\n\n/**\n * @deprecated - please use the other top level classes such as {@link Scene} or {@link Persona} instead\n * @public\n */\nexport const smwebsdk = new SmWebSdk();\n\n// This is here purely to coerce the documentation\n/**\n * Detect the browser capabilities\n */\nexport function DetectCapabilities() {\n  return new Features().detectWebRTCFeatures();\n}\n\n// This is here purely to coerce the documentation\n/**\n * Set logging for smbwebsdk to enabled or disabled, defaults to enabled\n */\n// eslint-disable-next-line @typescript-eslint/no-empty-function\nexport function setLogging(value: boolean) {}\n"],"names":["root","factory","exports","module","define","amd","a","i","self","__webpack_require__","definition","key","o","Object","defineProperty","enumerable","get","g","globalThis","this","Function","e","window","obj","prop","prototype","hasOwnProperty","call","r","Symbol","toStringTag","value","_callbacks","addListener","callback","push","removeListener","callbackIndex","indexOf","splice","forEach","apply","args","scene","personaId","_scene","_personaId","onConversationResultEvents","SmEvent","_onConversationResultEvent","onSpeechMarkerEvents","_onSpeechMarkerEvent","startSpeaking","text","context","optionalArgs","body","sendRequest","stopSpeaking","conversationSend","variables","conversationSetVariables","conversationGetVariables","animateToNamedCameraWithOrbitPan","cameraName","time","orbitDegX","orbitDegY","panDeg","tiltDeg","playAnimation","animation","getVariables","names","errorTolerant","format","setVariables","Variables","setVariablesOneway","sendOnewaySceneRequest","getVariablesList","getModelVariablesList","modelName","Models","getModelChildren","getModelFilterSearchResult","getModelVariableFilterSearchResult","variableName","getConnectorEntries","model","startBlProfiling","stopBlProfiling","reverse","getModelHierarchy","createMonitorSet","setName","SetName","removeMonitorSet","addVariableToMonitorSet","removeVariableFromMonitorSet","renderModel","extendStatics","d","b","setPrototypeOf","__proto__","Array","p","__extends","TypeError","String","__","constructor","create","__assign","assign","t","s","n","arguments","length","__rest","getOwnPropertySymbols","propertyIsEnumerable","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","rejected","result","done","then","f","y","_","label","sent","trys","ops","verb","iterator","v","op","pop","__values","m","__read","ar","error","__spreadArray","to","from","pack","l","slice","concat","SuppressedError","state","fate","promise","_resolve","_reject","console","reason","isResolved","isPending","isFulfilled","isRejected","_hasMicrophone","_hasCamera","_isAndroid","_isBrowserSupported","_isEdge","_isIos","detectAndroid","detectEdge","detectIos","userAgentMatches","test","navigator","platform","maxTouchPoints","MSStream","matches","userAgent","match","detectWebRTCFeatures","SmIsUnderRuntimeHost","isWebRTCSupported","item","iOS","isSafari","navEnumerateDevices","mediaDevices","enumerateDevices","catch","MediaStreamTrack","getSources","bind","devices","device","kind","logLevels","minLogLevel","isEnabled","availableLogLevels","_minLogLevel","setMinLogLevel","log","type","includes","enableLogging","enable","getMinLogLevel","level","index","makeError","message","Error","name","SpeechMarkerName","FeatureFlag","videoElement","logger","Logger","_isMicrophoneConnected","_isCameraConnected","_onConnectedStorage","resumeRequested","isResumedSession","server","sessionId","_closed","_outgoingQueue","_microphoneMuteDelay","_offsetX","_offsetY","_viewport_element","SmRuntimeHostReceiveMessage","receiveMessage","SmRuntimeHostStyleViewportElement","_onClose","_onMessage","_onUserText","sendVideoBounds","setTimeout","_features","setVideoElement","raw_text","JSON","parse","category","session","close","sessionFunction","closeFunction","messageFunction","userTextFunction","setLogging","widthIgnored","heightIgnored","el","view","document","defaultView","width","parseInt","getComputedStyle","height","rect","getBoundingClientRect","x","payload","top","left","bottom","right","sendMessage","hideVideo","sendRtcEvent","connect","deferred","Deferred","_sessionId","undefined","hasMicrophone","hasCamera","local_websocket_port","_serverConnection","WebSocket","onmessage","msg","gotMessageFromServer","onerror","event","onopen","send","stringify","onclose","code","wasClean","websocket_message","data","readyState","OPEN","sendUserText","sendRtcClose","SmRuntimeHostIsMicrophoneMuted","mute","SmRuntimeHostMuteMicrophone","isMicrophoneActive","isMicrophoneConnected","microphoneMuted","isCameraActive","isCameraConnected","setMediaDeviceActive","UserMedia","NLPIntent","ConnectionStateTypes","requestName","status","offscreenCanvas","gl","buffer","visibleRect","keyColorLoc","similarityLoc","smoothnessLoc","spillLoc","keyColor","similarity","smoothness","spill","updateChromaKeyOptions","options","videoFrameBufferInit","timestamp","codedWidth","codedHeight","chromaKeyOptions","RGBtoUV","processChromaKey","rgb_FragmentShader","rgb_VertexShader","i420_to_rgb_FragmentShader","i420_to_rgb_VertexShader","n12_to_rgb_FragmentShader","n12_to_rgb_VertexShader","getGl","OffscreenCanvas","getContext","premultipliedAlpha","createShader","src","shader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","createProgram","vertexShader","fragmentShader","program","attachShader","linkProgram","useProgram","getProgramParameter","LINK_STATUS","createTexture","filter","LINEAR","bindTexture","TEXTURE_2D","texParameteri","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","TEXTURE_MIN_FILTER","TEXTURE_MAG_FILTER","initWebGL_rgb_with_canvas","canvas","getCanvasGL","initWebGL_rgb_with_gl","pixelStorei","UNPACK_ALIGNMENT","VERTEX_SHADER","FRAGMENT_SHADER","initVertexBuffers","activeTexture","TEXTURE0","uniform1i","getUniformLocation","vertexBuffer","createBuffer","vertexRectangle","Float32Array","bindBuffer","ARRAY_BUFFER","bufferData","STATIC_DRAW","vertexPositionAttribute","getAttribLocation","vertexAttribPointer","FLOAT","enableVertexAttribArray","textureRectangle","textureBuffer","textureCoord","ArrayBufferViewValue","getPrototypeOf","Uint8Array","render_rgb","viewport","texImage2D","RGBA","UNSIGNED_BYTE","uniform3f","uniform1f","drawArrays","TRIANGLE_STRIP","flush","finish","transform","frame","controller","vs","fs","TEXTURE1","uv","initWebGL_NV12","positionLocation","texcoordLocation","positionBuffer","x2","y2","texcoordBuffer","textures","texture","NEAREST","pixelData","LUMINANCE","u_image_frame","clearColor","clear","COLOR_BUFFER_BIT","size","normalize","stride","offset","resolutionLocation","uniform2f","TRIANGLES","initWebGL_I420","roundedFrameHeight","ArrayBuffer","allocationSize","copyTo","uvOffset","subarray","LUMINANCE_ALPHA","render_nv12","render_i420","newFrame","VideoFrame","enqueue","handleTransform","readable","writable","pipeThrough","TransformStream","pipeTo","process","JEST_WORKER_ID","RTCTransformEvent","onrtctransform","transformer","WebsocketCategory","WebsocketKind","SpeechState","serverUri","connectUserText","accessToken","audioOnly","requestedUserMedia","requiredUserMedia","echoCancellationEnabled","connectionState","_chromaKeyedCanvas","_videoElementStyleObserver","_connectPendingRemoteStream","_resumeRequested","_isResumedSession","_controlOpen","_controlQueue","_chromaKeyOptions","_requestedUserMedia","None","_requiredUserMedia","_onConnected","_pendingLog","_shouldLogToServer","_changeUserMediaQueue","_removeListeners","_videoOptions","frameRate","facingMode","_audioOptions","noiseSuppression","autoGainControl","channelCount","sampleRate","sampleSize","echoCancellation","_videoElement","_serverUri","_connectUserText","_accessToken","_audioOnly","_logger","_sessionError","_connectionState","removeEventListener","onVideoLoaded","removeLister","target","srcObject","disconnect","setupVideoElement","enabled","restoreChromaKeySettings","supportsInsertableStreams","supportsTransferableStreams","parentElement","removeChild","appendChild","copyStyleFromVideoElementToCanvas","hideVideoElement","observeAndCopyStyleChangesFromVideoElementToCanvas","HTMLVideoElement","requestVideoFrameCallback","processFrameForChromaKey","_remoteStream","setupChromaKeyedVideo","now","Date","toISOString","logToServer","sendlogMessage","textArray","userText","startsWith","selectUserMedia","getUserMediaSuccess","xhr","XMLHttpRequest","open","location","search","onreadystatechange","ev","DONE","responseText","response","url","jwt","statusText","webcamRequested","requestedMedia","requiredMedia","MicrophoneAndCamera","Camera","some","micRequested","Microphone","getMediaConstraints","supports","getSupportedConstraints","audio","buildAudioOptions","video","supportedConstraints","constraints","keys","constraint","completion","getUserMedia","stream","MakeErrorForUserMedia","getUserMediaRequiredOnlyFallback","getUserMediaAudioOnlyFallback","_localStream","setConnectionState","SearchingForDigitalPerson","hasTurnServer","iceServers","urls","_controlConnection","DownloadingAssets","config","iceTransportPolicy","settings","microphoneMuteDelay","_peerConnection","RTCPeerConnection","onicecandidate","gotIceCandidate","isEdge","ontrack","track","onRemoteStream","streams","onaddstream","streamEvent","oniceconnectionstatechange","iceConnectionState","CONNECTING","addTrack","getTracks","addStream","addTransceiver","direction","resumeSessionId","offerOptions","voiceActivityDetection","iceRestart","createOffer","sessionDescription","createdDescription","ConnectingToDigitalPerson","_server","_sceneId","sceneId","sendCameraRotation","addEventListener","style","video_width","video_height","controlUrl","_controlUrl","sdp","setRemoteDescription","Connected","onConnectedSuccess","addCandidate","complete","addIceCandidate","RTCIceCandidate","candidate","sdpMid","sdpMLineIndex","iceCandidate","createAnswer","description","messageName","descriptionObj","setLocalDescription","localDescription","user_text","features","videoStartedEvent","cssText","reduce","cssString","property","propertyValue","getPropertyValue","replace","MutationObserver","mutationList","observer","observe","attributes","metadata","hidden","sendUserCamera","_onMicrophoneActive","_onCameraActive","display","setupTransferableStreamChromaKeyedVideo","setupChromaKeyedCanvas","setupRequestVideoFrameCallbackChromaKeyedVideo","setupRequestAnimationFrameChromaKeyedVideo","createElement","worker","Worker","postMessage","RTCRtpScriptTransform","getTransceivers","receiver","videoTrack","getTrackByKind","audioTrack","MediaStreamTrackProcessor","MediaStreamTrackGenerator","mediaStream","MediaStream","videoMediaStream","update","videoWidth","videoHeight","requestAnimationFrame","videoStarted","muted","unmuteCallback","rotation","active","isIos","orientation","rotateCamera","userMedia","makeUserMedia","microphone","webcam","findSenderTrackByKind","senders","getSenders","sender","findSenderByKind","transceiver","processChangeUserMediaQueue","operation","lastMicrophoneActive","lastCameraActive","changeUserMediaInternal","camera","shift","newUserMedia","microphoneTrack","cameraTrack","needMicrophoneUpgrade","needCameraUpgrade","newMediaStream","mediaDeferred","updateSenderTrack","removeTrack","newTrack","replaceTrack","stop","isSenderTrackEnabled","Boolean","tracks","listener","peerConnection","audioTracks","getAudioTracks","audioSender","videoTracks","getVideoTracks","videoSender","callbacks","RTCRtpSender","createEncodedStreams","ReadableStream","loggingEnabled","connectByWebSocket","ResizeObserverBoxOptions","resizeObservers","trigger","freeze","ResizeObserverSize","inlineSize","blockSize","DOMRectReadOnly","toJSON","_a","fromRect","rectangle","isSVG","SVGElement","isHidden","getBBox","_b","offsetWidth","offsetHeight","getClientRects","isElement","Element","scope","ownerDocument","global","cache","WeakMap","scrollRegexp","verticalRegexp","IE","parseDimension","pixel","parseFloat","switchSizes","zeroBoxes","devicePixelContentBoxSize","borderBoxSize","contentBoxSize","contentRect","calculateBoxSizes","forceRecalculation","has","set","cs","svg","ownerSVGElement","removePadding","boxSizing","writingMode","canScrollVertically","overflowY","canScrollHorizontally","overflowX","paddingTop","paddingRight","paddingBottom","paddingLeft","borderTop","borderTopWidth","borderRight","borderRightWidth","borderBottom","borderBottomWidth","horizontalPadding","verticalPadding","horizontalBorderArea","borderLeftWidth","verticalBorderArea","horizontalScrollbarThickness","clientHeight","verticalScrollbarThickness","clientWidth","widthReduction","heightReduction","contentWidth","contentHeight","borderBoxWidth","borderBoxHeight","boxes","Math","round","devicePixelRatio","calculateBoxSize","observedBox","DEVICE_PIXEL_CONTENT_BOX","BORDER_BOX","ResizeObserverEntry","calculateDepthForNode","node","Infinity","depth","parent","parentNode","broadcastActiveObservations","shallowestDepth","ro","activeTargets","entries","ot","entry","targetDepth","lastReportedSize","_i","callbacks_1","gatherActiveObservationsAtDepth","skippedTargets","observationTargets","isActive","ErrorEvent","createEvent","initEvent","dispatchEvent","queueMicroTask","toggle_1","el_1","createTextNode","cb","characterData","textContent","watching","observerConfig","childList","subtree","events","timeout","scheduled","scheduler","Scheduler","_this","stopped","schedule","run","until","elementsHaveResized","start","updateCount","ResizeObservation","CONTENT_BOX","tagName","isReplacedElement","ResizeObserverDetail","resizeObserver","observerMap","getObservationIndex","ResizeObserverController","detail","firstObservation","box","unobserve","lastObservation","ResizeObserver","toString","all","images","img","map","onload","debounceTime","VIDEO_FRAME_STR","VIDEO_FRAME_STR_BRACKETED","CONTENT_STR","CONTENT_STR_BRACKETED","CUE_ATTRIBUTES","CUE_ATTRIBUTES_BRACKETED","join","RESIZE_OBSERVER_BOX_OPTIONS","callMeasure","contentCollection","videoFrame","debouncedMeasure","fn","debounceTimeMs","debounceTimerId","clearTimeout","debouncedFunction","measureInternal","measureDebounced","getInitialElements","mutationObserver","mutations","mutationCallback","setupEventListeners","observeMutations","isLoggingEnabled","videoEl","querySelector","contentElements","querySelectorAll","trackVideoElement","element","trackContentElement","watchNode","documentElement","attributeFilter","attributeOldValue","contentAwareness","reconnect","measure","isConnected","windowSize","measureWindow","measureVideoFrame","measureContent","contentAwarenessMessage","buildUpdateContentAwarenessRequest","innerWidth","innerHeight","videoRect","invalidDimensions","x1","y1","validContent","invalidContent","id","viewWidth","viewHeight","content","untrackVideoElement","getAttribute","untrackContentElement","imagesAdded","nodeType","Node","ELEMENT_NODE","untrackRemovedNodeWithCUE","removedNodes","trackAddedNodeWithCUE","addedNodes","j","hasAttribute","isImage","containsImages","err","attr","attributeName","newValue","oldValue","childElement","VERSION","re","isCompatible","ownVersion","acceptedVersions","Set","rejectedVersions","myVersionMatch","ownVersionParsed","globalVersion","add","_accept","globalVersionMatch","globalVersionParsed","_makeCompatibilityCheck","major","split","GLOBAL_OPENTELEMETRY_API_KEY","for","_global","registerGlobal","instance","diag","allowOverride","api","version","stack","debug","getGlobal","unregisterGlobal","DiagLogLevel","DiagComponentLogger","props","_namespace","namespace","logProxy","info","warn","verbose","funcName","unshift","DiagAPI","_logProxy","setLogger","logLevel","INFO","oldLogger","newLogger","maxLevel","_filterFunc","theLevel","theFunc","NONE","ALL","ERROR","WARN","DEBUG","VERBOSE","createLogLevelDiagLogger","disable","createComponentLogger","_instance","BaggageImpl","_entries","Map","getEntry","getAllEntries","setEntry","newBaggage","removeEntry","delete","removeEntries","keys_1","baggageEntryMetadataSymbol","createBaggage","baggageEntryMetadataFromString","str","__TYPE__","defaultTextMapGetter","carrier","defaultTextMapSetter","createContextKey","TraceFlags","BaseContext","parentContext","_currentContext","getValue","setValue","deleteValue","ROOT_CONTEXT","il","NoopContextManager","with","_context","NOOP_CONTEXT_MANAGER","ContextAPI","getInstance","setGlobalContextManager","contextManager","_getContextManager","INVALID_SPANID","INVALID_TRACEID","INVALID_SPAN_CONTEXT","traceId","spanId","traceFlags","NonRecordingSpan","_spanContext","spanContext","setAttribute","_key","_value","setAttributes","_attributes","addEvent","_name","setStatus","_status","updateName","end","_endTime","isRecording","recordException","_exception","_time","SPAN_KEY","getSpan","getActiveSpan","setSpan","span","deleteSpan","setSpanContext","getSpanContext","VALID_TRACEID_REGEX","VALID_SPANID_REGEX","isValidTraceId","isSpanContextValid","wrapSpanContext","NoopTracer","startSpan","parentFromContext","startActiveSpan","arg2","arg3","arg4","opts","ctx","contextWithSpanSet","SamplingDecision","SpanKind","SpanStatusCode","NOOP_TRACER","ProxyTracer","_provider","_getTracer","_options","_fn","tracer","Reflect","_delegate","getDelegateTracer","NOOP_TRACER_PROVIDER","NoopTracerProvider","getTracer","_version","ProxyTracerProvider","getDelegate","setDelegate","delegate","VALID_KEY_CHAR_RANGE","VALID_KEY_REGEX","RegExp","VALID_VALUE_BASE_REGEX","INVALID_VALUE_COMMA_EQUAL_REGEX","TraceStateImpl","rawTraceState","_internalState","_parse","traceState","_clone","unset","serialize","_keys","agg","part","listMember","trim","validateKey","validateValue","TraceAPI","_proxyTracerProvider","setGlobalTracerProvider","provider","success","getTracerProvider","NoopTextMapPropagator","inject","_carrier","extract","fields","BAGGAGE_KEY","getBaggage","setBaggage","baggage","deleteBaggage","NOOP_TEXT_MAP_PROPAGATOR","PropagationAPI","setGlobalPropagator","propagator","setter","_getGlobalPropagator","getter","trace","propagation","fallbackValue","getUrlHost","outUrl","URL","pathname","ConversationStateTypes","_conversationState","idle","_userActive","_onConversationStateUpdated","processStateMessage","responseBody","persona","dpId","speechState","messageSpeechState","Idle","setSpeechState","Speaking","dpSpeaking","processRecognizeResultsMessage","isErrorMessage","isFinal","results","final","errorMessage","dpProcessing","userSpeaking","getSpeechState","reset","fullfillments","meta","dialogflow","queryResult","fulfillmentMessages","find","fullfillment","formatLegacyDialogflow","formatContextData","output","soulmachines","formatCardData","allowedIds","cardId","values","k","parsedData","component","rest","conversationState","contentCardFormatter","ConversationState","ContentCardFormatter","_onCardChanged","_autoClearCards","cardData","activeCardIds","onConversationStateUpdated","activeCardInfo","onSpeechMarker","messageBody","cardIds","Showcards","addActiveCardIds","Hidecards","removeActiveCards","clearActiveCards","onConversationResult","cards","onCardChanged","activeCards","_previousUrl","href","_observer","observeDocumentChanges","observeUrlChanges","conversationVariables","currentPersonaId","PAGE_METADATA","pageUrl","TOTAL_CONNECTION_STEPS","Disconnected","totalSteps","currentStep","percentageLoaded","_onConnectionStateUpdated","connectionStateType","getConnectionState","SemanticResourceAttributes","SUPPRESS_TRACING_KEY","isTracingSuppressed","BAGGAGE_KEY_PAIR_SEPARATOR","BAGGAGE_PROPERTIES_SEPARATOR","BAGGAGE_HEADER","parsePairKeyValue","valueProps","keyPairPart","keyPair","decodeURIComponent","parseKeyPairsIntoRecord","headers","W3CBaggagePropagator","keyPairs","encodeURIComponent","getKeyPairs","pair","headerValue","hValue","current","serializeKeyPairs","baggageString","isArray","baggageEntry","AnchoredClock","systemClock","monotonicClock","_monotonicClock","_epochMillis","_performanceMillis","delta","TracesSamplerValues","delegateHandler","ex","getOwnPropertyNames","propertyName","flattenException","stringifyException","globalErrorHandler","DEFAULT_LIST_SEPARATOR","ENVIRONMENT_NUMBERS_KEYS","isEnvVarANumber","ENVIRONMENT_LISTS_KEYS","isEnvVarAList","DEFAULT_ATTRIBUTE_VALUE_LENGTH_LIMIT","DEFAULT_ENVIRONMENT","CONTAINER_NAME","ECS_CONTAINER_METADATA_URI_V4","ECS_CONTAINER_METADATA_URI","HOSTNAME","KUBERNETES_SERVICE_HOST","NAMESPACE","OTEL_BSP_EXPORT_TIMEOUT","OTEL_BSP_MAX_EXPORT_BATCH_SIZE","OTEL_BSP_MAX_QUEUE_SIZE","OTEL_BSP_SCHEDULE_DELAY","OTEL_EXPORTER_JAEGER_AGENT_HOST","OTEL_EXPORTER_JAEGER_AGENT_PORT","OTEL_EXPORTER_JAEGER_ENDPOINT","OTEL_EXPORTER_JAEGER_PASSWORD","OTEL_EXPORTER_JAEGER_USER","OTEL_EXPORTER_OTLP_ENDPOINT","OTEL_EXPORTER_OTLP_TRACES_ENDPOINT","OTEL_EXPORTER_OTLP_METRICS_ENDPOINT","OTEL_EXPORTER_OTLP_HEADERS","OTEL_EXPORTER_OTLP_TRACES_HEADERS","OTEL_EXPORTER_OTLP_METRICS_HEADERS","OTEL_EXPORTER_OTLP_TIMEOUT","OTEL_EXPORTER_OTLP_TRACES_TIMEOUT","OTEL_EXPORTER_OTLP_METRICS_TIMEOUT","OTEL_EXPORTER_ZIPKIN_ENDPOINT","OTEL_LOG_LEVEL","OTEL_NO_PATCH_MODULES","OTEL_PROPAGATORS","OTEL_RESOURCE_ATTRIBUTES","OTEL_SERVICE_NAME","OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_ATTRIBUTE_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT","OTEL_SPAN_EVENT_COUNT_LIMIT","OTEL_SPAN_LINK_COUNT_LIMIT","OTEL_TRACES_EXPORTER","OTEL_TRACES_SAMPLER","ParentBasedAlwaysOn","OTEL_TRACES_SAMPLER_ARG","OTEL_EXPORTER_OTLP_INSECURE","OTEL_EXPORTER_OTLP_TRACES_INSECURE","OTEL_EXPORTER_OTLP_METRICS_INSECURE","OTEL_EXPORTER_OTLP_CERTIFICATE","OTEL_EXPORTER_OTLP_TRACES_CERTIFICATE","OTEL_EXPORTER_OTLP_METRICS_CERTIFICATE","OTEL_EXPORTER_OTLP_COMPRESSION","OTEL_EXPORTER_OTLP_TRACES_COMPRESSION","OTEL_EXPORTER_OTLP_METRICS_COMPRESSION","OTEL_EXPORTER_OTLP_CLIENT_KEY","OTEL_EXPORTER_OTLP_TRACES_CLIENT_KEY","OTEL_EXPORTER_OTLP_METRICS_CLIENT_KEY","OTEL_EXPORTER_OTLP_CLIENT_CERTIFICATE","OTEL_EXPORTER_OTLP_TRACES_CLIENT_CERTIFICATE","OTEL_EXPORTER_OTLP_METRICS_CLIENT_CERTIFICATE","parseNumber","environment","min","max","Number","isNaN","parseStringList","input","separator","givenValue","logLevelMap","setLogLevelFromEnv","toUpperCase","parseEnvironment","env","getEnv","globalEnv","hexToBase64","hexStr","hexStrLen","hexAsciiCharsStr","hexPair","substring","hexVal","fromCharCode","btoa","otperformance","performance","SDK_INFO","ExportResultCode","NANOSECOND_DIGITS","SECOND_TO_NANOSECONDS","pow","numberToHrtime","epochMillis","epochSeconds","seconds","trunc","toFixed","getTimeOrigin","timeOrigin","perf","timing","fetchStart","hrTime","performanceNow","nanos","hrTimeToMicroseconds","CompositePropagator","_propagators","propagators","_fields","e_1","_c","e_1_1","return","TraceState","TRACE_PARENT_HEADER","TRACE_STATE_HEADER","TRACE_PARENT_REGEX","RPCType","W3CTraceContextPropagator","traceParent","traceParentHeader","exec","parseTraceParent","isRemote","traceStateHeader","AlwaysOffSampler","shouldSample","decision","NOT_RECORD","AlwaysOnSampler","RECORD_AND_SAMPLED","funcToString","ParentBasedSampler","_d","_root","_remoteParentSampled","remoteParentSampled","_remoteParentNotSampled","remoteParentNotSampled","_localParentSampled","localParentSampled","_localParentNotSampled","localParentNotSampled","spanName","spanKind","links","SAMPLED","TraceIdRatioBasedSampler","_ratio","_normalize","_upperBound","floor","_accumulate","ratio","accumulation","pos","objectProto","func","overArg","_promise","configurable","val","BindOnceFuture","_callback","_that","_isCalled","_deferred","NoopDetector","detect","Resource","empty","EMPTY","default","merge","other","BrowserDetector","browserResource","_getResourceAttributes","_config","EnvDetector","_MAX_LENGTH","_COMMA_SEPARATOR","_LABEL_KEY_VALUE_SPLITTER","_ERROR_MESSAGE_INVALID_CHARS","_ERROR_MESSAGE_INVALID_VALUE","rawAttributes","serviceName","parsedAttributes","_parseResourceAttributes","rawEnvAttributes","rawAttributes_1","rawAttributes_1_1","keyValuePair","_isValidAndNotEmpty","_isValid","_isPrintableString","ch","charAt","ProcessDetector","processResource","pid","title","argv","versions","ENVIRONMENT_BOOLEAN_KEYS","isEnvVarABoolean","OTEL_SDK_DISABLED","OTEL_BLRP_EXPORT_TIMEOUT","OTEL_BLRP_MAX_EXPORT_BATCH_SIZE","OTEL_BLRP_MAX_QUEUE_SIZE","OTEL_BLRP_SCHEDULE_DELAY","OTEL_EXPORTER_OTLP_LOGS_ENDPOINT","OTEL_EXPORTER_OTLP_LOGS_HEADERS","OTEL_EXPORTER_OTLP_LOGS_TIMEOUT","OTEL_LOGRECORD_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_LOGRECORD_ATTRIBUTE_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT","OTEL_LOGS_EXPORTER","OTEL_EXPORTER_OTLP_LOGS_INSECURE","OTEL_EXPORTER_OTLP_LOGS_CERTIFICATE","OTEL_EXPORTER_OTLP_LOGS_COMPRESSION","OTEL_EXPORTER_OTLP_LOGS_CLIENT_KEY","OTEL_EXPORTER_OTLP_LOGS_CLIENT_CERTIFICATE","OTEL_EXPORTER_OTLP_PROTOCOL","OTEL_EXPORTER_OTLP_TRACES_PROTOCOL","OTEL_EXPORTER_OTLP_METRICS_PROTOCOL","OTEL_EXPORTER_OTLP_LOGS_PROTOCOL","OTEL_EXPORTER_OTLP_METRICS_TEMPORALITY_PREFERENCE","parseBoolean","toLowerCase","BatchSpanProcessorBase","_exporter","_finishedSpans","_droppedSpansCount","_maxExportBatchSize","maxExportBatchSize","_maxQueueSize","maxQueueSize","_scheduledDelayMillis","scheduledDelayMillis","_exportTimeoutMillis","exportTimeoutMillis","_shutdownOnce","_shutdown","forceFlush","isCalled","_flushAll","onStart","_span","_parentContext","onEnd","_addToBuffer","shutdown","onShutdown","_maybeStartTimer","promises","ceil","_flushOneBatch","_clearTimer","timer","spans","doExport","export","SUCCESS","pendingResources","resource","asyncAttributesPending","waitForAsyncAttributes","_timer","BatchSpanProcessor","_super","onInit","disableAutoFlushOnDocumentHide","_visibilityChangeListener","visibilityState","_pageHideListener","arg","isOwn","tag","unmasked","proto","Ctor","one","two","objects","twoValue","obj1","obj2","arr1","arr2","arr","asyncAttributesPromise","_syncAttributes","_asyncAttributesPromise","asyncAttributes","mergedSyncAttributes","mergedAttributesPromise","thisAsyncAttributes","otherAsyncAttributes","out","e_2","arr_1","arr_1_1","e_2_1","MILLISECONDS_TO_NANOSECONDS","millisToHrTime","addHrTimes","time1","time2","Span","parentTracer","parentSpanId","startTime","_deprecatedClock","_droppedAttributesCount","_droppedEventsCount","_droppedLinksCount","UNSET","endTime","_ended","_duration","_performanceStartTime","_performanceOffset","_startTimeProvided","_getTime","instrumentationLibrary","_spanLimits","getSpanLimits","_spanProcessor","getActiveSpanProcessor","_attributeValueLengthLimit","attributeValueLengthLimit","_isSpanEnded","attributeCountLimit","_truncateToSize","attributesOrStartTime","timeStamp","eventCountLimit","droppedAttributesCount","inp","getTime","msDuration","exception","_truncateToLimitUtil","limit","substr","FALLBACK_OTEL_TRACES_SAMPLER","AlwaysOn","DEFAULT_RATIO","loadDefaultConfig","sampler","buildSamplerFromEnv","forceFlushTimeoutMillis","generalLimits","spanLimits","linkCountLimit","attributePerEventCountLimit","attributePerLinkCountLimit","AlwaysOff","ParentBasedAlwaysOff","TraceIdRatio","getSamplerProbabilityFromEnv","ParentBasedTraceIdRatio","probability","reconfigureLimits","userConfig","_e","_f","_g","_h","_j","_k","_l","_m","parsedEnvConfig","generateTraceId","generateSpanId","bytes","random","ForceFlushState","Tracer","_tracerProvider","perInstanceDefaults","DEFAULT_CONFIG","localConfig","_sampler","_generalLimits","_idGenerator","idGenerator","parentSpan","parentSpanContext","INTERNAL","link","samplingResult","initAttributes","getGeneralLimits","MultiSpanProcessor","_spanProcessors","spanProcessor","e_3","e_3_1","e_4","e_4_1","NoopSpanProcessor","BasicTracerProvider","_registeredSpanProcessors","_tracers","mergedConfig","defaultExporter","_buildExporterFromEnv","batchProcessor","activeSpanProcessor","schemaUrl","addSpanProcessor","register","_buildPropagatorFromEnv","timeoutInterval","resolved","errors","_getPropagator","_registeredPropagators","_getSpanExporter","_registeredExporters","uniquePropagatorNames","validPropagators","list","exporterName","exporter","StackContextManager","_enabled","_bindFunction","manager","contextWrapper","previousContext","WebTracerProvider","DEFAULT_TRACE_TIMEOUT","configureExporterTimeout","timeoutMillis","invalidTimeout","definedTimeout","getExporterTimeoutFromEnv","defaultTimeout","OTLPExporterBase","_sendingPromises","getDefaultUrl","hostname","_concurrencyLimit","concurrencyLimit","items","resultCallback","FAILED","_export","OTLPExporterError","ESpanKind","OTLPExporterBrowserBase","_useXHR","sendBeacon","_headers","partialHeaders","parseHeaders","onSuccess","onError","serviceRequest","convert","exporterTimeout","reqIsDestroyed","exporterTimer","abort","setRequestHeader","sendWithXhr","blobPropertyBag","Blob","sendWithBeacon","popPromise","toKeyValue","toAnyValue","stringValue","isInteger","intValue","doubleValue","boolValue","bytesValue","arrayValue","kvlistValue","sdkSpanToOtlpSpan","useHex","startTimeUnixNano","endTimeUnixNano","toOtlpSpanEvent","droppedEventsCount","toOtlpLink","droppedLinksCount","timedEvent","timeUnixNano","spanRecordsToResourceSpans","readableSpans","resourceMap","readableSpans_1","readableSpans_1_1","record","ilmMap","instrumentationLibraryKey","records","createResourceMap","entryIterator","scopeResourceSpans","ilmIterator","ilmEntry","scopeSpans","name_1","readableSpan","transformedSpans","NoopMeter","createHistogram","NOOP_HISTOGRAM_METRIC","createCounter","NOOP_COUNTER_METRIC","createUpDownCounter","NOOP_UP_DOWN_COUNTER_METRIC","createObservableGauge","NOOP_OBSERVABLE_GAUGE_METRIC","createObservableCounter","NOOP_OBSERVABLE_COUNTER_METRIC","createObservableUpDownCounter","NOOP_OBSERVABLE_UP_DOWN_COUNTER_METRIC","addBatchObservableCallback","_observables","removeBatchObservableCallback","NoopMetric","NoopCounterMetric","NoopUpDownCounterMetric","NoopHistogramMetric","NoopObservableMetric","addCallback","removeCallback","NoopObservableCounterMetric","NoopObservableGaugeMetric","NoopObservableUpDownCounterMetric","NOOP_METER","ValueType","NOOP_METER_PROVIDER","NoopMeterProvider","getMeter","GLOBAL_METRICS_API_KEY","MetricsAPI","setGlobalMeterProvider","getMeterProvider","requiredVersion","fallback","AggregationTemporality","DataPointType","isNotNullish","hashAttributes","sort","AggregatorKind","TimeoutError","callWithTimeout","timeoutHandle","timeoutPromise","race","PromiseAllSettled","isPromiseAllSettledRejectionResult","it","FlatMap","InstrumentType","DropAggregator","DROP","createAccumulation","_previous","_delta","diff","_current","toMetricData","_descriptor","_aggregationTemporality","_accumulationByAttributes","createInstrumentDescriptor","unit","valueType","DOUBLE","HistogramAccumulation","_boundaries","_recordMinMax","boundaries","counts","buckets","sum","count","hasMinMax","setStartTime","toPointValue","HistogramAggregator","HISTOGRAM","previous","previousValue","deltaValue","previousCounts","deltaCounts","mergedCounts","idx","currentValue","currentCounts","diffedCounts","descriptor","aggregationTemporality","accumulationByAttributes","dataPointType","dataPoints","pointValue","allowsNegativeValues","UP_DOWN_COUNTER","OBSERVABLE_GAUGE","OBSERVABLE_UP_DOWN_COUNTER","LastValueAccumulation","sampleTime","LastValueAggregator","LAST_VALUE","latestAccumulation","GAUGE","SumAccumulation","monotonic","SumAggregator","SUM","prevPv","deltaPv","currPv","isMonotonic","Aggregation","Drop","DROP_AGGREGATION","Sum","SUM_AGGREGATION","LastValue","LAST_VALUE_AGGREGATION","Histogram","HISTOGRAM_AGGREGATION","Default","DEFAULT_AGGREGATION","DropAggregation","createAggregator","_instrument","DEFAULT_INSTANCE","SumAggregation","instrument","COUNTER","OBSERVABLE_COUNTER","MONOTONIC_INSTANCE","NON_MONOTONIC_INSTANCE","LastValueAggregation","HistogramAggregation","DefaultAggregation","ExplicitBucketHistogramAggregation","minusInfinityIndex","lastIndexOf","infinityIndex","DEFAULT_AGGREGATION_SELECTOR","_instrumentType","DEFAULT_AGGREGATION_TEMPORALITY_SELECTOR","CUMULATIVE","MetricReader","_aggregationSelector","aggregationSelector","_aggregationTemporalitySelector","aggregationTemporalitySelector","setMetricProducer","metricProducer","_metricProducer","onInitialized","selectAggregation","instrumentType","selectAggregationTemporality","collect","onForceFlush","PeriodicExportingMetricReader","exportIntervalMillis","_exportInterval","_exportTimeout","_runOnce","resourceMetrics","_interval","setInterval","err_1","clearInterval","InMemoryMetricExporter","_metrics","metrics","getMetrics","ViewRegistry","ConsoleMetricExporter","_sendMetrics","setImmediate","scopeMetrics","metric","dir","_registeredViews","addView","findViews","meter","registeredView","_matchInstrument","instrumentSelector","_matchMeter","meterSelector","selector","getType","getNameFilter","getVersionFilter","getSchemaUrlFilter","SyncInstrument","_writableMetricStorage","_record","INT","UpDownCounterInstrument","CounterInstrument","HistogramInstrument","ObservableInstrument","metricStorages","_observableRegistry","_metricStorages","ObservableCounterInstrument","ObservableGaugeInstrument","ObservableUpDownCounterInstrument","isObservableInstrument","Meter","_meterSharedState","storage","registerMetricStorage","storages","registerAsyncMetricStorage","observableRegistry","observables","addBatchCallback","removeBatchCallback","MetricStorage","_instrumentDescriptor","getInstrumentDescriptor","updateDescription","HashMap","_hash","_valueMap","_keyMap","hashCode","getOrDefault","defaultFactory","hash","keyIterator","valueIterator","AttributeHashMap","DeltaMetricProcessor","_aggregator","_activeCollectionStorage","_cumulativeMemoStorage","collectionTime","batchCumulate","measurements","unreportedDelta","TemporalMetricProcessor","_unreportedAccumulations","_reportHistory","buildMetrics","collector","collectors","instrumentDescriptor","currentAccumulations","_stashAccumulations","unreportedAccumulations","_getMergedUnreportedAccumulations","last","lastCollectionTime","accumulations","calibrateStartTime","currentAccumulation","stash","unreportedList","unreportedList_1","unreportedList_1_1","it_1","aggregator","lastAccumulation","AsyncMetricStorage","_attributesProcessor","_deltaMetricStorage","_temporalMetricStorage","observationTime","processed","getIncompatibilityDetails","existing","otherDescriptor","incompatibility","getConflictResolutionRecipe","getValueTypeConflictResolutionRecipe","getUnitConflictResolutionRecipe","selectorString","getTypeConflictResolutionRecipe","getDescriptionResolutionRecipe","MetricStorageRegistry","_sharedRegistry","_perCollectorRegistry","getStorages","perCollectorStorages","_registerStorage","registerForCollector","storageMap","findOrUpdateCompatibleStorage","expectedDescriptor","_findOrUpdateCompatibleStorage","findOrUpdateCompatibleCollectorStorage","existingStorages","compatibleStorage","existingStorages_1","existingStorages_1_1","existingStorage","existingDescriptor","MultiMetricStorage","_backingStorages","recordTime","ObservableResultImpl","_buffer","BatchObservableResultImpl","ObservableRegistry","_batchCallbacks","_findCallback","instruments","observableInstruments","_findBatchCallback","callbackFutures","batchCallbackFutures","_observeCallbacks","_observeBatchCallbacks","observableResult","callPromise","metricStorage","findIndex","lhs","rhs","lhs_1","lhs_1_1","setEquals","SyncMetricStorage","AttributesProcessor","Noop","NOOP","NoopAttributesProcessor","incoming","FilteringAttributesProcessor","_allowedAttributeNames","filteredAttributes","MeterSharedState","_meterProviderSharedState","_instrumentationScope","metricStorageRegistry","_registerMetricStorage","metricDataList","metricCollectors","MetricStorageType","viewRegistry","viewDescriptor","createInstrumentDescriptorWithView","aggregation","viewStorage","attributesProcessor","collectorStorages","selectAggregations","MeterProviderSharedState","meterSharedStates","getMeterSharedState","instrumentationScope","instrumentationScopeId","meterSharedState","MetricCollector","_sharedState","_metricReader","meterCollectionPromises","ESCAPE","MeterProvider","views","addMetricReader","metricReader","PatternPredicate","pattern","_matchAll","_regexp","escapePattern","hasWildcard","ExactPredicate","_pattern","InstrumentSelector","criteria","_nameFilter","_type","MeterSelector","_versionFilter","_schemaUrlFilter","DEFAULT_COLLECTOR_RESOURCE_PATH","DEFAULT_COLLECTOR_URL","OTLPTraceExporter","resourceSpans","createExportTraceServiceRequest","path","endsWith","appendResourcePathToUrl","DEFAULT_URL","SmTracerProvider","init","webSDKVersion","Authorization","isInitialized","defaultUrl","websdkVersion","SM_WEBSDK_VERSION","retry","task","retryOptions","maxRetries","delay","delayMs","connectionResult","retries","clearSessionData","getSessionData","sessionStorage","getItem","savedApiKey","removeItem","videoOrOptions","contentAwarenessDebounceTime","loggingConfig","tracerOptions","_onConversationResultEvents","_onSpeechMarkerEvents","_session","_isWebSocketOnly","_transactionId","_pendingResponses","_microphoneUnmuteTimer","_echoCancellationEnabled","_serverControlledCameras","_stopSpeakingWhenNotVisible","_loggingConfig","_tracerOptions","disableTracing","parentCtx","_sessionResumeEnabled","_sendMetadata","webSdk","platformSdk","iosVisibilityChange","visible","stopSpeakingWhenNotVisible","stopSpeakingWhenUnloaded","isSceneOptions","_apiKey","apiKey","requestedMediaDevices","requiredMediaDevices","sendMetadata","_onStateEvent","_onState","_onRecognizeResultsEvent","_onRecognizeResults","_onDisconnectedEvent","cleanupEventListeners","_onDisconnected","_onUserTextEvent","_onDemoModeEvent","_underRuntimeHost","randArray","Uint32Array","crypto","getRandomValues","conversation","Conversation","ConnectionState","_metadataSender","MetadataSender","isDefined","isHTMLElement","connectionValid","serverConnection","keepAlive","serverUriOrOptions","connectStartTime","connectArgsToConfig","recordEventsToSpan","onConnectionStateUpdated","LocalSession","hasPassedInTokenServerAuth","tokenServerUri","tokenServerAccessToken","fetchAuthConfig","json","initializeTracer","initTracerStartTime","initTracerEndTime","WebSocketSession","Session","onConnected","sessionConnected","onMessage","onClose","sessionClosed","onUserText","rtcUserText","microphoneActiveCallbacks","cameraActiveCallbacks","finally","initTelemetryToken","authToken","base","ReferenceError","tracesEndpoint","telemetryHost","fetch","resp","ok","otelResponse","telemetryJwt","sceneMessage","onSceneMessage","Scene","Request","transaction","pending","featureFlags","enableFlaggedFeatures","sdkVersion","controlMicrophoneMute","Persona","Response","processResponse","SceneResponseError","persona_state","ContentAwareness","setItem","storeSessionData","UI_SDK_CAMERA_CONTROL","sendContent","configure","configuration","startRecognize","audioSource","stopRecognize","hasContentAwareness","hasServerControlledCameras","supportsSessionPersistence","getState","onState","onDisconnected","onRecognizeResults","offsetX","offsetY","isWebSocketOnly","startVideo","playVideo","play","authServer","atob","tokenServer","uri","token","smwebsdk","none","microphoneAndCamera","DetectCapabilities"],"sourceRoot":""}